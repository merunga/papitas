!function(){var t,e;(function(){e={}}).call(this),function(){(function(){var t=this,i=t._,n={},r=Array.prototype,s=Object.prototype,o=Function.prototype,a=r.push,h=r.slice,u=r.concat,c=s.toString,l=s.hasOwnProperty,d=r.forEach,p=r.map,f=r.reduce,m=r.reduceRight,g=r.filter,y=r.every,v=r.some,_=r.indexOf,b=r.lastIndexOf,x=Array.isArray,w=Object.keys,T=o.bind,S=function(t){return t instanceof S?t:this instanceof S?(this._wrapped=t,void 0):new S(t)};"undefined"!=typeof e?("undefined"!=typeof module&&module.exports&&(e=module.exports=S),e._=S):t._=S,S.VERSION="1.5.2";var C=function(t){return"[object Arguments]"===c.call(t)};C(arguments)||(C=function(t){return!(!t||!l.call(t,"callee")||"function"!=typeof t.callee)});var P=function(t){return t.length===+t.length&&(C(t)||t.constructor!==Object)},k=S.each=S.forEach=function(t,e,i){if(null!=t)if(d&&t.forEach===d)t.forEach(e,i);else if(P(t)){for(var r=0,s=t.length;s>r;r++)if(e.call(i,t[r],r,t)===n)return}else for(var o=S.keys(t),r=0,s=o.length;s>r;r++)if(e.call(i,t[o[r]],o[r],t)===n)return};S.map=S.collect=function(t,e,i){var n=[];return null==t?n:p&&t.map===p?t.map(e,i):(k(t,function(t,r,s){n.push(e.call(i,t,r,s))}),n)};var E="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return n&&(e=S.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(k(t,function(t,s,o){r?i=e.call(n,i,t,s,o):(i=t,r=!0)}),!r)throw new TypeError(E);return i},S.reduceRight=S.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),m&&t.reduceRight===m)return n&&(e=S.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var s=t.length;if(!P(t)){var o=S.keys(t);s=o.length}if(k(t,function(a,h,u){h=o?o[--s]:--s,r?i=e.call(n,i,t[h],h,u):(i=t[h],r=!0)}),!r)throw new TypeError(E);return i},S.find=S.detect=function(t,e,i){var n;return A(t,function(t,r,s){return e.call(i,t,r,s)?(n=t,!0):void 0}),n},S.filter=S.select=function(t,e,i){var n=[];return null==t?n:g&&t.filter===g?t.filter(e,i):(k(t,function(t,r,s){e.call(i,t,r,s)&&n.push(t)}),n)},S.reject=function(t,e,i){return S.filter(t,function(t,n,r){return!e.call(i,t,n,r)},i)},S.every=S.all=function(t,e,i){e||(e=S.identity);var r=!0;return null==t?r:y&&t.every===y?t.every(e,i):(k(t,function(t,s,o){return(r=r&&e.call(i,t,s,o))?void 0:n}),!!r)};var A=S.some=S.any=function(t,e,i){e||(e=S.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,i):(k(t,function(t,s,o){return r||(r=e.call(i,t,s,o))?n:void 0}),!!r)};S.contains=S.include=function(t,e){return null==t?!1:_&&t.indexOf===_?-1!=t.indexOf(e):A(t,function(t){return t===e})},S.invoke=function(t,e){var i=h.call(arguments,2),n=S.isFunction(e);return S.map(t,function(t){return(n?e:t[e]).apply(t,i)})},S.pluck=function(t,e){return S.map(t,function(t){return t[e]})},S.where=function(t,e,i){return S.isEmpty(e)?i?void 0:[]:S[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},S.findWhere=function(t,e){return S.where(t,e,!0)},S.max=function(t,e,i){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&S.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return k(t,function(t,r,s){var o=e?e.call(i,t,r,s):t;o>n.computed&&(n={value:t,computed:o})}),n.value},S.min=function(t,e,i){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&S.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return k(t,function(t,r,s){var o=e?e.call(i,t,r,s):t;o<n.computed&&(n={value:t,computed:o})}),n.value},S.shuffle=function(t){var e,i=0,n=[];return k(t,function(t){e=S.random(i++),n[i-1]=n[e],n[e]=t}),n},S.sample=function(t,e,i){return arguments.length<2||i?t[S.random(t.length-1)]:S.shuffle(t).slice(0,Math.max(0,e))};var O=function(t){return S.isFunction(t)?t:function(e){return e[t]}};S.sortBy=function(t,e,i){var n=O(e);return S.pluck(S.map(t,function(t,e,r){return{value:t,index:e,criteria:n.call(i,t,e,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var M=function(t){return function(e,i,n){var r={},s=null==i?S.identity:O(i);return k(e,function(i,o){var a=s.call(n,i,o,e);t(r,a,i)}),r}};S.groupBy=M(function(t,e,i){(S.has(t,e)?t[e]:t[e]=[]).push(i)}),S.indexBy=M(function(t,e,i){t[e]=i}),S.countBy=M(function(t,e){S.has(t,e)?t[e]++:t[e]=1}),S.sortedIndex=function(t,e,i,n){i=null==i?S.identity:O(i);for(var r=i.call(n,e),s=0,o=t.length;o>s;){var a=s+o>>>1;i.call(n,t[a])<r?s=a+1:o=a}return s},S.toArray=function(t){return t?S.isArray(t)?h.call(t):P(t)?S.map(t,S.identity):S.values(t):[]},S.size=function(t){return null==t?0:P(t)?t.length:S.keys(t).length},S.first=S.head=S.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:h.call(t,0,e)},S.initial=function(t,e,i){return h.call(t,0,t.length-(null==e||i?1:e))},S.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:h.call(t,Math.max(t.length-e,0))},S.rest=S.tail=S.drop=function(t,e,i){return h.call(t,null==e||i?1:e)},S.compact=function(t){return S.filter(t,S.identity)};var I=function(t,e,i){return e&&S.every(t,S.isArray)?u.apply(i,t):(k(t,function(t){S.isArray(t)||S.isArguments(t)?e?a.apply(i,t):I(t,e,i):i.push(t)}),i)};S.flatten=function(t,e){return I(t,e,[])},S.without=function(t){return S.difference(t,h.call(arguments,1))},S.uniq=S.unique=function(t,e,i,n){S.isFunction(e)&&(n=i,i=e,e=!1);var r=i?S.map(t,i,n):t,s=[],o=[];return k(r,function(i,n){(e?n&&o[o.length-1]===i:S.contains(o,i))||(o.push(i),s.push(t[n]))}),s},S.union=function(){return S.uniq(S.flatten(arguments,!0))},S.intersection=function(t){var e=h.call(arguments,1);return S.filter(S.uniq(t),function(t){return S.every(e,function(e){return S.indexOf(e,t)>=0})})},S.difference=function(t){var e=u.apply(r,h.call(arguments,1));return S.filter(t,function(t){return!S.contains(e,t)})},S.zip=function(){for(var t=S.max(S.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=S.pluck(arguments,""+i);return e},S.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},S.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return n=S.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,r+i):i}if(_&&t.indexOf===_)return t.indexOf(e,i);for(;r>n;n++)if(t[n]===e)return n;return-1},S.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(b&&t.lastIndexOf===b)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},S.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,s=new Array(n);n>r;)s[r++]=t,t+=i;return s};var D=function(){};S.bind=function(t,e){var i,n;if(T&&t.bind===T)return T.apply(t,h.call(arguments,1));if(!S.isFunction(t))throw new TypeError;return i=h.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(h.call(arguments)));D.prototype=t.prototype;var r=new D;D.prototype=null;var s=t.apply(r,i.concat(h.call(arguments)));return Object(s)===s?s:r}},S.partial=function(t){var e=h.call(arguments,1);return function(){return t.apply(this,e.concat(h.call(arguments)))}},S.bindAll=function(t){var e=h.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return k(e,function(e){t[e]=S.bind(t[e],t)}),t},S.memoize=function(t,e){var i={};return e||(e=S.identity),function(){var n=e.apply(this,arguments);return S.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},S.delay=function(t,e){var i=h.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},S.defer=function(t){return S.delay.apply(S,[t,1].concat(h.call(arguments,1)))},S.throttle=function(t,e,i){var n,r,s,o=null,a=0;i||(i={});var h=function(){a=i.leading===!1?0:new Date,o=null,s=t.apply(n,r)};return function(){var u=new Date;a||i.leading!==!1||(a=u);var c=e-(u-a);return n=this,r=arguments,0>=c?(clearTimeout(o),o=null,a=u,s=t.apply(n,r)):o||i.trailing===!1||(o=setTimeout(h,c)),s}},S.debounce=function(t,e,i){var n,r,s,o,a;return function(){s=this,r=arguments,o=new Date;var h=function(){var u=new Date-o;e>u?n=setTimeout(h,e-u):(n=null,i||(a=t.apply(s,r)))},u=i&&!n;return n||(n=setTimeout(h,e)),u&&(a=t.apply(s,r)),a}},S.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},S.wrap=function(t,e){return function(){var i=[t];return a.apply(i,arguments),e.apply(this,i)}},S.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},S.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},S.keys=w||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)S.has(t,i)&&e.push(i);return e},S.values=function(t){for(var e=S.keys(t),i=e.length,n=new Array(i),r=0;i>r;r++)n[r]=t[e[r]];return n},S.pairs=function(t){for(var e=S.keys(t),i=e.length,n=new Array(i),r=0;i>r;r++)n[r]=[e[r],t[e[r]]];return n},S.invert=function(t){for(var e={},i=S.keys(t),n=0,r=i.length;r>n;n++)e[t[i[n]]]=i[n];return e},S.functions=S.methods=function(t){var e=[];for(var i in t)S.isFunction(t[i])&&e.push(i);return e.sort()},S.extend=function(t){return k(h.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},S.pick=function(t){var e={},i=u.apply(r,h.call(arguments,1));return k(i,function(i){i in t&&(e[i]=t[i])}),e},S.omit=function(t){var e={},i=u.apply(r,h.call(arguments,1));for(var n in t)S.contains(i,n)||(e[n]=t[n]);return e},S.defaults=function(t){return k(h.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},S.clone=function(t){return S.isObject(t)?S.isArray(t)?t.slice():S.extend({},t):t},S.tap=function(t,e){return e(t),t};var R=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof S&&(t=t._wrapped),e instanceof S&&(e=e._wrapped);var r=c.call(t);if(r!=c.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return n[s]==e;var o=t.constructor,a=e.constructor;if(o!==a&&!(S.isFunction(o)&&o instanceof o&&S.isFunction(a)&&a instanceof a))return!1;i.push(t),n.push(e);var h=0,u=!0;if("[object Array]"==r){if(h=t.length,u=h==e.length)for(;h--&&(u=R(t[h],e[h],i,n)););}else{for(var l in t)if(S.has(t,l)&&(h++,!(u=S.has(e,l)&&R(t[l],e[l],i,n))))break;if(u){for(l in e)if(S.has(e,l)&&!h--)break;u=!h}}return i.pop(),n.pop(),u};S.isEqual=function(t,e){return R(t,e,[],[])},S.isEmpty=function(t){if(null==t)return!0;if(S.isArray(t)||S.isString(t))return 0===t.length;for(var e in t)if(S.has(t,e))return!1;return!0},S.isElement=function(t){return!(!t||1!==t.nodeType)},S.isArray=x||function(t){return"[object Array]"==c.call(t)},S.isObject=function(t){return t===Object(t)},k(["Arguments","Function","String","Number","Date","RegExp"],function(t){S["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),S.isArguments(arguments)||(S.isArguments=function(t){return!(!t||!S.has(t,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(t){return"function"==typeof t}),S.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},S.isNaN=function(t){return S.isNumber(t)&&t!=+t},S.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},S.isNull=function(t){return null===t},S.isUndefined=function(t){return void 0===t},S.has=function(t,e){return l.call(t,e)},S.noConflict=function(){return t._=i,this},S.identity=function(t){return t},S.times=function(t,e,i){for(var n=Array(Math.max(0,t)),r=0;t>r;r++)n[r]=e.call(i,r);return n},S.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var L={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};L.unescape=S.invert(L.escape);var N={escape:new RegExp("["+S.keys(L.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(L.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(t){S[t]=function(e){return null==e?"":(""+e).replace(N[t],function(e){return L[t][e]})}}),S.result=function(t,e){if(null==t)return void 0;var i=t[e];return S.isFunction(i)?i.call(t):i},S.mixin=function(t){k(S.functions(t),function(e){var i=S[e]=t[e];S.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),G.call(this,i.apply(S,t))}})};var B=0;S.uniqueId=function(t){var e=++B+"";return t?t+e:e},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(t,e,i){var n;i=S.defaults({},i,S.templateSettings);var r=new RegExp([(i.escape||F).source,(i.interpolate||F).source,(i.evaluate||F).source].join("|")+"|$","g"),s=0,o="__p+='";t.replace(r,function(e,i,n,r,a){return o+=t.slice(s,a).replace(U,function(t){return"\\"+j[t]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),s=a+e.length,e}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return n(e,S);var h=function(t){return n.call(this,t,S)};return h.source="function("+(i.variable||"obj")+"){\n"+o+"}",h},S.chain=function(t){return S(t).chain()};var G=function(t){return this._chain?S(t).chain():t};S.mixin(S),k(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];S.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],G.call(this,i)}}),k(["concat","join","slice"],function(t){var e=r[t];S.prototype[t]=function(){return G.call(this,e.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)}.call(this),function(){t=e._}.call(this),"undefined"==typeof Package&&(Package={}),Package.underscore={_:t}}(),function(){var t,e=Package.underscore._;(function(){t={isClient:!0,isServer:!1},"object"==typeof __meteor_runtime_config__&&__meteor_runtime_config__.PUBLIC_SETTINGS&&(t.settings={"public":__meteor_runtime_config__.PUBLIC_SETTINGS})}).call(this),function(){if(t.isServer)var i=Npm.require("fibers/future");"object"==typeof __meteor_runtime_config__&&__meteor_runtime_config__.meteorRelease&&(t.release=__meteor_runtime_config__.meteorRelease),e.extend(t,{_get:function(t){for(var e=1;e<arguments.length;e++){if(!(arguments[e]in t))return void 0;t=t[arguments[e]]}return t},_ensure:function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];i in t||(t[i]={}),t=t[i]}return t},_delete:function(t){for(var e=[t],i=!0,n=1;n<arguments.length-1;n++){var r=arguments[n];if(!(r in t)){i=!1;break}if(t=t[r],"object"!=typeof t)break;e.push(t)}for(var n=e.length-1;n>=0;n--){var r=arguments[n+1];if(i)i=!1;else for(var s in e[n][r])return;delete e[n][r]}},_wrapAsync:function(n){return function(){for(var r,s,o=this,a=e.toArray(arguments),h=function(e){return e?t._debug("Exception in callback of async function",e.stack?e.stack:e):void 0};a.length>0&&"undefined"==typeof a[a.length-1];)a.pop();a.length>0&&a[a.length-1]instanceof Function?r=a.pop():t.isClient?r=h:(s=new i,r=s.resolver()),a.push(t.bindEnvironment(r));var u=n.apply(o,a);return s?s.wait():u}},_inherits:function(t,i){e.each(i,function(e,i){t[i]=e});var n=function(){this.constructor=t};return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t}})}.call(this),function(){"use strict";function e(){if(r.setImmediate){var t=function(t){r.setImmediate(t)};return t.implementation="setImmediate",t}return null}function i(){function t(t,e){return"string"==typeof t&&t.substring(0,e.length)===e}function e(e){if(e.source===r&&t(e.data,a)){var i=e.data.substring(a.length);try{o[i]&&o[i]()}finally{delete o[i]}}}if(!r.postMessage||r.importScripts)return null;var i=!0,n=r.onmessage;if(r.onmessage=function(){i=!1},r.postMessage("","*"),r.onmessage=n,!i)return null;var s=0,o={},a="Meteor._setImmediate."+Math.random()+".";r.addEventListener?r.addEventListener("message",e,!1):r.attachEvent("onmessage",e);var h=function(t){++s,o[s]=t,r.postMessage(a+s,"*")};return h.implementation="postMessage",h}function n(){var t=function(t){r.setTimeout(t,0)};return t.implementation="setTimeout",t}var r=this;t._setImmediate=e()||i()||n()}.call(this),function(){var i=function(t){if(Package.livedata){var e=Package.livedata.DDP._CurrentInvocation;if(e.get()&&e.get().isSimulation)throw new Error("Can't set timers inside simulations");return function(){e.withValue(null,t)}}return t},n=function(e,n){return t.bindEnvironment(i(n),e)};e.extend(t,{setTimeout:function(t,e){return setTimeout(n("setTimeout callback",t),e)},setInterval:function(t,e){return setInterval(n("setInterval callback",t),e)},clearInterval:function(t){return clearInterval(t)},clearTimeout:function(t){return clearTimeout(t)},defer:function(e){t._setImmediate(n("defer callback",e))}})}.call(this),function(){var e=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t};t.makeErrorType=function(t,i){var n=function(){var e=this;if(Error.captureStackTrace)Error.captureStackTrace(e,n);else{var r=new Error;r.__proto__=n.prototype,r instanceof n&&(e=r)}return i.apply(e,arguments),e.errorType=t,e};return e(n,Error),n},t.Error=t.makeErrorType("Meteor.Error",function(t,e,i){var n=this;n.error=t,n.reason=e,n.details=i,n.message=n.reason?n.reason+" ["+n.error+"]":"["+n.error+"]"}),t.Error.prototype.clone=function(){var e=this;return new t.Error(e.error,e.reason,e.details)}}.call(this),function(){t._noYieldsAllowed=function(t){return t()},t._SynchronousQueue=function(){var t=this;t._tasks=[],t._running=!1},e.extend(t._SynchronousQueue.prototype,{runTask:function(i){var n=this;if(!n.safeToRunTask())throw new Error("Could not synchronously run a task from a running task");n._tasks.push(i);var r=n._tasks;n._tasks=[],n._running=!0;try{for(;!e.isEmpty(r);){var s=r.shift();try{s()}catch(o){if(e.isEmpty(r))throw o;t._debug("Exception in queued task: "+o.stack)}}}finally{n._running=!1}},queueTask:function(t){var i=this,n=e.isEmpty(i._tasks);i._tasks.push(t),n&&setTimeout(e.bind(i.flush,i),0)},flush:function(){var t=this;t.runTask(function(){})},drain:function(){var t=this;if(t.safeToRunTask())for(;!e.isEmpty(t._tasks);)t.flush()},safeToRunTask:function(){var t=this;return!t._running}})}.call(this),function(){var e=[],i="loaded"===document.readyState||"complete"==document.readyState,n=function(){for(i=!0;e.length;)e.shift()()};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("load",n)),t.startup=function(n){var r=!document.addEventListener&&document.documentElement.doScroll;if(r&&window===top){try{r("left")}catch(s){return setTimeout(function(){t.startup(n)},50),void 0}n()}else i?n():e.push(n)}}.call(this),function(){var e=0;t._debug=function(){if(e)return e--,void 0;if("undefined"!=typeof console&&"undefined"!=typeof console.log)if(0==arguments.length)console.log("");else if("function"==typeof console.log.apply){for(var t=!0,i=0;i<arguments.length;i++)"string"!=typeof arguments[i]&&(t=!1);t?console.log.apply(console,[Array.prototype.join.call(arguments," ")]):console.log.apply(console,arguments)}else if("function"==typeof Function.prototype.bind){var n=Function.prototype.bind.call(console.log,console);n.apply(console,arguments)}else Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))},t._suppress_log=function(t){e+=t}}.call(this),function(){var i=0,n=[];t.EnvironmentVariable=function(){this.slot=i++},e.extend(t.EnvironmentVariable.prototype,{get:function(){return n[this.slot]},withValue:function(t,e){var i=n[this.slot];try{n[this.slot]=t;var r=e()}finally{n[this.slot]=i}return r}}),t.bindEnvironment=function(i,r,s){var o=e.clone(n);if(!r||"string"==typeof r){var a=r||"callback of async function";r=function(e){t._debug("Exception in "+a+":",e&&e.stack||e)}}return function(){var t=n;try{n=o;var a=i.apply(s,e.toArray(arguments))}catch(h){r(h)}finally{n=t}return a}},t._nodeCodeMustBeInFiber=function(){}}.call(this),function(){t.absoluteUrl=function(i,n){n||"object"!=typeof i||(n=i,i=void 0),n=e.extend({},t.absoluteUrl.defaultOptions,n||{});var r=n.rootUrl;if(!r)throw new Error("Must pass options.rootUrl or set ROOT_URL in the server environment");return/^http[s]?:\/\//i.test(r)||(r="http://"+r),/\/$/.test(r)||(r+="/"),i&&(r+=i),n.secure&&/^http:/.test(r)&&!/http:\/\/localhost[:\/]/.test(r)&&!/http:\/\/127\.0\.0\.1[:\/]/.test(r)&&(r=r.replace(/^http:/,"https:")),n.replaceLocalhost&&(r=r.replace(/^http:\/\/localhost([:\/].*)/,"http://127.0.0.1$1")),r},t.absoluteUrl.defaultOptions={},"object"==typeof __meteor_runtime_config__&&__meteor_runtime_config__.ROOT_URL&&(t.absoluteUrl.defaultOptions.rootUrl=__meteor_runtime_config__.ROOT_URL),t._relativeToSiteRootUrl=function(t){return"object"==typeof __meteor_runtime_config__&&"/"===t.substr(0,1)&&(t=(__meteor_runtime_config__.ROOT_URL_PATH_PREFIX||"")+t),t}}.call(this),"undefined"==typeof Package&&(Package={}),Package.meteor={Meteor:t}}(),function(){var Meteor=Package.meteor.Meteor,JSON;(function(){window.JSON&&(JSON=window.JSON)}).call(this),function(){"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,r,s,o,a=gap,h=e[t];switch(h&&"object"==typeof h&&"function"==typeof h.toJSON&&(h=h.toJSON(t)),"function"==typeof rep&&(h=rep.call(e,t,h)),typeof h){case"string":return quote(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(h)){for(s=h.length,i=0;s>i;i+=1)o[i]=str(i,h)||"null";return r=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(s=rep.length,i=0;s>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],r=str(n,h),r&&o.push(quote(n)+(gap?": ":":")+r));else for(n in h)Object.prototype.hasOwnProperty.call(h,n)&&(r=str(n,h),r&&o.push(quote(n)+(gap?": ":":")+r));return r=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,r}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var i,n,r=t[e];if(r&&"object"==typeof r)for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n=walk(r,i),void 0!==n?r[i]=n:delete r[i]);return reviver.call(t,e,r)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()}.call(this),"undefined"==typeof Package&&(Package={}),Package.json={JSON:JSON}}(),function(){var t,e,i,n,r=(Package.meteor.Meteor,Package.json.JSON),s=Package.underscore._;(function(){t={},e={};var o={};t.addType=function(t,e){if(s.has(o,t))throw new Error("Type "+t+" already present");o[t]=e};var a=function(t){return s.isNaN(t)||1/0===t||t===-1/0},h=[{matchJSONValue:function(t){return s.has(t,"$date")&&1===s.size(t)},matchObject:function(t){return t instanceof Date},toJSONValue:function(t){return{$date:t.getTime()}},fromJSONValue:function(t){return new Date(t.$date)}},{matchJSONValue:function(t){return s.has(t,"$InfNaN")&&1===s.size(t)},matchObject:a,toJSONValue:function(t){var e;return e=s.isNaN(t)?0:1/0===t?1:-1,{$InfNaN:e}},fromJSONValue:function(t){return t.$InfNaN/0}},{matchJSONValue:function(t){return s.has(t,"$binary")&&1===s.size(t)},matchObject:function(t){return"undefined"!=typeof Uint8Array&&t instanceof Uint8Array||t&&s.has(t,"$Uint8ArrayPolyfill")},toJSONValue:function(t){return{$binary:i(t)}},fromJSONValue:function(t){return n(t.$binary)}},{matchJSONValue:function(t){return s.has(t,"$escape")&&1===s.size(t)},matchObject:function(t){return s.isEmpty(t)||s.size(t)>2?!1:s.any(h,function(e){return e.matchJSONValue(t)})},toJSONValue:function(e){var i={};return s.each(e,function(e,n){i[n]=t.toJSONValue(e)}),{$escape:i}},fromJSONValue:function(e){var i={};return s.each(e.$escape,function(e,n){i[n]=t.fromJSONValue(e)}),i}},{matchJSONValue:function(t){return s.has(t,"$type")&&s.has(t,"$value")&&2===s.size(t)},matchObject:function(e){return t._isCustomType(e)},toJSONValue:function(t){return{$type:t.typeName(),$value:t.toJSONValue()}},fromJSONValue:function(t){var e=t.$type;if(!s.has(o,e))throw new Error("Custom EJSON type "+e+" is not defined");var i=o[e];return i(t.$value)}}];t._isCustomType=function(t){return t&&"function"==typeof t.toJSONValue&&"function"==typeof t.typeName&&s.has(o,t.typeName())};var u=t._adjustTypesToJSONValue=function(t){if(null===t)return null;var e=c(t);return void 0!==e?e:"object"!=typeof t?t:(s.each(t,function(e,i){if("object"==typeof e||void 0===e||a(e)){var n=c(e);return n?(t[i]=n,void 0):(u(e),void 0)}}),t)},c=function(t){for(var e=0;e<h.length;e++){var i=h[e];if(i.matchObject(t))return i.toJSONValue(t)}return void 0};t.toJSONValue=function(e){var i=c(e);return void 0!==i?i:("object"==typeof e&&(e=t.clone(e),u(e)),e)};var l=t._adjustTypesFromJSONValue=function(t){if(null===t)return null;var e=d(t);return e!==t?e:"object"!=typeof t?t:(s.each(t,function(e,i){if("object"==typeof e){var n=d(e);if(e!==n)return t[i]=n,void 0;l(e)}}),t)},d=function(t){if("object"==typeof t&&null!==t&&s.size(t)<=2&&s.all(t,function(t,e){return"string"==typeof e&&"$"===e.substr(0,1)}))for(var e=0;e<h.length;e++){var i=h[e];if(i.matchJSONValue(t))return i.fromJSONValue(t)}return t};t.fromJSONValue=function(e){var i=d(e);return i===e&&"object"==typeof e?(e=t.clone(e),l(e),e):i},t.stringify=function(e,i){var n=t.toJSONValue(e);return i&&(i.canonical||i.indent)?t._canonicalStringify(n,i):r.stringify(n)},t.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return t.fromJSONValue(r.parse(e))},t.isBinary=function(t){return!!("undefined"!=typeof Uint8Array&&t instanceof Uint8Array||t&&t.$Uint8ArrayPolyfill)},t.equals=function(e,i,n){var r,o=!(!n||!n.keyOrderSensitive);if(e===i)return!0;if(s.isNaN(e)&&s.isNaN(i))return!0;if(!e||!i)return!1;if("object"!=typeof e||"object"!=typeof i)return!1;if(e instanceof Date&&i instanceof Date)return e.valueOf()===i.valueOf();if(t.isBinary(e)&&t.isBinary(i)){if(e.length!==i.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==i[r])return!1;return!0}if("function"==typeof e.equals)return e.equals(i,n);if("function"==typeof i.equals)return i.equals(e,n);if(e instanceof Array){if(!(i instanceof Array))return!1;if(e.length!==i.length)return!1;for(r=0;r<e.length;r++)if(!t.equals(e[r],i[r],n))return!1;return!0}switch(t._isCustomType(e)+t._isCustomType(i)){case 1:return!1;case 2:return t.equals(t.toJSONValue(e),t.toJSONValue(i))}var a;if(o){var h=[];return s.each(i,function(t,e){h.push(e)}),r=0,a=s.all(e,function(e,s){return r>=h.length?!1:s!==h[r]?!1:t.equals(e,i[h[r]],n)?(r++,!0):!1}),a&&r===h.length}return r=0,a=s.all(e,function(e,o){return s.has(i,o)?t.equals(e,i[o],n)?(r++,!0):!1:!1}),a&&s.size(i)===r},t.clone=function(e){var i;if("object"!=typeof e)return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(t.isBinary(e)){i=t.newBinary(e.length);for(var n=0;n<e.length;n++)i[n]=e[n];return i}if(s.isArray(e)||s.isArguments(e)){for(i=[],n=0;n<e.length;n++)i[n]=t.clone(e[n]);return i}return"function"==typeof e.clone?e.clone():t._isCustomType(e)?t.fromJSONValue(t.clone(t.toJSONValue(e)),!0):(i={},s.each(e,function(e,n){i[n]=t.clone(e)}),i)}}).call(this),function(){function e(t){return r.stringify(t)}var i=function(t,n,r,o,a){var h,u,c,l,d=o,p=n[t];switch(typeof p){case"string":return e(p);case"number":return isFinite(p)?String(p):"null";case"boolean":return String(p);case"object":if(!p)return"null";if(d=o+r,l=[],s.isArray(p)||s.isArguments(p)){for(c=p.length,h=0;c>h;h+=1)l[h]=i(h,p,r,d,a)||"null";return u=0===l.length?"[]":d?"[\n"+d+l.join(",\n"+d)+"\n"+o+"]":"["+l.join(",")+"]"}var f=s.keys(p);return a&&(f=f.sort()),s.each(f,function(t){u=i(t,p,r,d,a),u&&l.push(e(t)+(d?": ":":")+u)}),u=0===l.length?"{}":d?"{\n"+d+l.join(",\n"+d)+"\n"+o+"}":"{"+l.join(",")+"}"}};t._canonicalStringify=function(t,e){if(e=s.extend({indent:"",canonical:!1},e),e.indent===!0)e.indent="  ";else if("number"==typeof e.indent){for(var n="",r=0;r<e.indent;r++)n+=" ";e.indent=n}return i("",{"":t},e.indent,"",e.canonical)}}.call(this),function(){for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s={},o=0;o<r.length;o++)s[r.charAt(o)]=o;i=function(t){for(var e=[],i=null,n=null,r=null,s=null,o=0;o<t.length;o++)switch(o%3){case 0:i=t[o]>>2&63,n=(3&t[o])<<4;break;case 1:n|=t[o]>>4&15,r=(15&t[o])<<2;break;case 2:r|=t[o]>>6&3,s=63&t[o],e.push(a(i)),e.push(a(n)),e.push(a(r)),e.push(a(s)),i=null,n=null,r=null,s=null}return null!=i&&(e.push(a(i)),e.push(a(n)),null==r?e.push("="):e.push(a(r)),null==s&&e.push("=")),e.join("")};var a=function(t){return r.charAt(t)},h=function(t){return"="===t?-1:s[t]};t.newBinary=function(t){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var e=[],i=0;t>i;i++)e.push(0);return e.$Uint8ArrayPolyfill=!0,e}return new Uint8Array(new ArrayBuffer(t))},n=function(e){var i=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(i--,"="==e.charAt(e.length-2)&&i--);for(var n=t.newBinary(i),r=null,s=null,o=null,a=0,u=0;u<e.length;u++){var c=e.charAt(u),l=h(c);switch(u%4){case 0:if(0>l)throw new Error("invalid base64 string");r=l<<2;break;case 1:if(0>l)throw new Error("invalid base64 string");r|=l>>4,n[a++]=r,s=(15&l)<<4;break;case 2:l>=0&&(s|=l>>2,n[a++]=s,o=(3&l)<<6);break;case 3:l>=0&&(n[a++]=o|l)}}return n},e.base64Encode=i,e.base64Decode=n}.call(this),"undefined"==typeof Package&&(Package={}),Package.ejson={EJSON:t,EJSONTest:e}}(),function(){var t,e=Package.meteor.Meteor,i=Package.underscore._,n=Package.ejson.EJSON;
(function(){t=function(){return t.info.apply(this,arguments)};var r=0,s=[],o=0;t._intercept=function(t){r+=t},t._suppress=function(t){o+=t},t._intercepted=function(){var t=s;return s=[],r=0,t},t.outputFormat="json";var a={debug:"green",warn:"magenta",error:"red"},h="blue",u=["time","timeInexact","level","file","line","program","originApp","satellite","stderr"],c=u.concat(["app","message"]),l=function(i){var n=t.format(i),r=i.level;"undefined"!=typeof console&&console[r]?console[r](n):e._debug(n)};t._getCallerDetails=function(){var t=function(){var t=new Error,e=t.stack;return e},e=t();if(!e)return{};for(var i,n=e.split("\n"),r=1;r<n.length;++r){if(i=n[r],i.match(/^\s*at eval \(eval/))return{file:"eval"};if(!i.match(/packages\/logging(?:\/|(?::tests)?\.js)/))break}var s={},o=/(?:[@(]| at )([^(]+?):([0-9:]+)(?:\)|$)/.exec(i);return o?(s.line=o[2].split(":")[0],s.file=o[1].split("/").slice(-1)[0].split("?")[0],s):s},i.each(["debug","info","warn","error"],function(a){t[a]=function(h){if(o)return o--,void 0;var c=!1;r&&(r--,c=!0);var d=!i.isObject(h)||i.isRegExp(h)||i.isDate(h)?{message:new String(h).toString()}:h;if(i.each(u,function(t){if(d[t])throw new Error("Can't set '"+t+"' in log message")}),i.has(d,"message")&&!i.isString(d.message))throw new Error("The 'message' field in log objects must be a string");if(d.omitCallerDetails||(d=i.extend(t._getCallerDetails(),d)),d.time=new Date,d.level=a,"debug"!==a)if(c)s.push(n.stringify(d));else if(e.isServer)if("colored-text"===t.outputFormat)console.log(t.format(d,{color:!0}));else{if("json"!==t.outputFormat)throw new Error("Unknown logging output format: "+t.outputFormat);console.log(n.stringify(d))}else l(d)}}),t.parse=function(t){var e=null;if(t&&"{"===t.charAt(0))try{e=n.parse(t)}catch(i){}return e&&e.time&&e.time instanceof Date?e:null},t.format=function(t,r){t=n.clone(t),r=r||{};var s=t.time;if(!(s instanceof Date))throw new Error("'time' must be a Date object");var o=t.timeInexact,u=t.level||"info",l=t.file,d=t.line,p=t.app||"",f=t.originApp,m=t.message||"",g=t.program||"",y=t.satellite,v=t.stderr||"";i.each(c,function(e){delete t[e]}),i.isEmpty(t)||(m&&(m+=" "),m+=n.stringify(t));var _=function(t){return 10>t?"0"+t:t.toString()},b=function(t){return 100>t?"0"+_(t):t.toString()},x=s.getFullYear().toString()+_(s.getMonth()+1)+_(s.getDate()),w=_(s.getHours())+":"+_(s.getMinutes())+":"+_(s.getSeconds())+"."+b(s.getMilliseconds()),T="("+-((new Date).getTimezoneOffset()/60)+")",S="";p&&(S+=p),f&&f!==p&&(S+=" via "+f),S&&(S="["+S+"] ");var C=l&&d?["(",g?g+":":"",l,":",d,") "].join(""):"";y&&(C+=["[",y,"]"].join(""));var P=v?"(STDERR) ":"",k=[u.charAt(0).toUpperCase(),x,"-",w,T,o?"? ":" ",S,C,P].join(""),E=function(t,i){return r.color&&e.isServer&&i?Npm.require("cli-color")[i](t):t};return E(k,h)+E(m,a[u])},t.objFromText=function(t,e){var n={message:t,level:"info",time:new Date,timeInexact:!0};return i.extend(n,e)}}).call(this),"undefined"==typeof Package&&(Package={}),Package.logging={Log:t}}(),function(){{var t,e=Package.meteor.Meteor;Package.underscore._}(function(){t={},t.active=!1,t.currentComputation=null;var i=function(e){t.currentComputation=e,t.active=!!e},n=Object.prototype.hasOwnProperty,r=function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);return t},s=function(){return"undefined"!=typeof e?e._debug:"undefined"!=typeof console&&console.log?function(){console.log.apply(console,arguments)}:function(){}},o=function(t,e){if(p)throw e;s()("Exception from Deps "+t+" function:",e.stack||e.message)},a=function(t,i){"undefined"==typeof e||e.isClient?t(i):e._noYieldsAllowed(function(){t(i)})},h=1,u=[],c=!1,l=!1,d=!1,p=!1,f=[],m=function(){c||(setTimeout(t.flush,0),c=!0)},g=!1;t.Computation=function(t,e){if(!g)throw new Error("Deps.Computation constructor is private; use Deps.autorun");g=!1;var i=this;i.stopped=!1,i.invalidated=!1,i.firstRun=!0,i._id=h++,i._onInvalidateCallbacks=[],i._parent=e,i._func=t,i._recomputing=!1;var n=!0;try{i._compute(),n=!1}finally{i.firstRun=!1,n&&i.stop()}},r(t.Computation.prototype,{onInvalidate:function(e){var i=this;if("function"!=typeof e)throw new Error("onInvalidate requires a function");i.invalidated?t.nonreactive(function(){a(e,i)}):i._onInvalidateCallbacks.push(e)},invalidate:function(){var e=this;if(!e.invalidated){e._recomputing||e.stopped||(m(),u.push(this)),e.invalidated=!0;for(var i,n=0;i=e._onInvalidateCallbacks[n];n++)t.nonreactive(function(){a(i,e)});e._onInvalidateCallbacks=[]}},stop:function(){this.stopped||(this.stopped=!0,this.invalidate())},_compute:function(){var e=this;e.invalidated=!1;var n=t.currentComputation;i(e);d=!0;try{a(e._func,e)}finally{i(n),d=!1}},_recompute:function(){var t=this;t._recomputing=!0;try{for(;t.invalidated&&!t.stopped;)try{t._compute()}catch(e){o("recompute",e)}}finally{t._recomputing=!1}}}),t.Dependency=function(){this._dependentsById={}},r(t.Dependency.prototype,{depend:function(e){if(!e){if(!t.active)return!1;e=t.currentComputation}var i=this,n=e._id;return n in i._dependentsById?!1:(i._dependentsById[n]=e,e.onInvalidate(function(){delete i._dependentsById[n]}),!0)},changed:function(){var t=this;for(var e in t._dependentsById)t._dependentsById[e].invalidate()},hasDependents:function(){var t=this;for(var e in t._dependentsById)return!0;return!1}}),r(t,{flush:function(e){if(l)throw new Error("Can't call Deps.flush while flushing");if(d)throw new Error("Can't flush inside Deps.autorun");l=!0,c=!0,p=!(!e||!e._throwFirstError);var i=!1;try{for(;u.length||f.length;){for(;u.length;){var n=u.shift();n._recompute()}if(f.length){var r=f.shift();try{r()}catch(s){o("afterFlush function",s)}}}i=!0}finally{i||(l=!1,t.flush({_throwFirstError:!1})),c=!1,l=!1}},autorun:function(e){if("function"!=typeof e)throw new Error("Deps.autorun requires a function argument");g=!0;var i=new t.Computation(e,t.currentComputation);return t.active&&t.onInvalidate(function(){i.stop()}),i},nonreactive:function(e){var n=t.currentComputation;i(null);try{return e()}finally{i(n)}},onInvalidate:function(e){if(!t.active)throw new Error("Deps.onInvalidate requires a currentComputation");t.currentComputation.onInvalidate(e)},afterFlush:function(t){f.push(t),m()}})}).call(this),function(){e.flush=t.flush,e.autorun=t.autorun,e.autosubscribe=t.autorun,t.depend=function(t){return t.depend()}}.call(this),"undefined"==typeof Package&&(Package={}),Package.deps={Deps:t}}(),function(){{var t,e=Package.meteor.Meteor;Package.underscore._}(function(){if(e.isServer)var i=Npm.require("crypto");var n=function(){function t(){var t=4022871197,e=function(e){e=e.toString();for(var i=0;i<e.length;i++){t+=e.charCodeAt(i);var n=.02519603282416938*t;t=n>>>0,n-=t,n*=t,t=n>>>0,n-=t,t+=4294967296*n}return 2.3283064365386963e-10*(t>>>0)};return e.version="Mash 0.9",e}return function(e){var i=0,n=0,r=0,s=1;0==e.length&&(e=[+new Date]);var o=t();i=o(" "),n=o(" "),r=o(" ");for(var a=0;a<e.length;a++)i-=o(e[a]),0>i&&(i+=1),n-=o(e[a]),0>n&&(n+=1),r-=o(e[a]),0>r&&(r+=1);o=null;var h=function(){var t=2091639*i+2.3283064365386963e-10*s;return i=n,n=r,r=t-(s=0|t)};return h.uint32=function(){return 4294967296*h()},h.fract53=function(){return h()+1.1102230246251565e-16*(2097152*h()|0)},h.version="Alea 0.9",h.args=e,h}(Array.prototype.slice.call(arguments))},r="23456789ABCDEFGHJKLMNPQRSTWXYZabcdefghijkmnopqrstuvwxyz",s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_",o=function(t){var e=this;void 0!==t&&(e.alea=n.apply(null,t))};o.prototype.fraction=function(){var t=this;if(t.alea)return t.alea();if(i){var e=parseInt(t.hexString(8),16);return 2.3283064365386963e-10*e}if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var n=new Uint32Array(1);return window.crypto.getRandomValues(n),2.3283064365386963e-10*n[0]}throw new Error("No random generator available")},o.prototype.hexString=function(t){var e=this;if(i&&!e.alea){var n,r=Math.ceil(t/2);try{n=i.randomBytes(r)}catch(s){n=i.pseudoRandomBytes(r)}var o=n.toString("hex");return o.substring(0,t)}for(var a=[],h=0;t>h;++h)a.push(e.choice("0123456789abcdef"));return a.join("")},o.prototype._randomString=function(t,e){for(var i=this,n=[],r=0;t>r;r++)n[r]=i.choice(e);return n.join("")},o.prototype.id=function(t){var e=this;return void 0===t&&(t=17),e._randomString(t,r)},o.prototype.secret=function(t){var e=this;return void 0===t&&(t=43),e._randomString(t,s)},o.prototype.choice=function(t){var e=Math.floor(this.fraction()*t.length);return"string"==typeof t?t.substr(e,1):t[e]};var a="undefined"!=typeof window&&window.innerHeight||"undefined"!=typeof document&&document.documentElement&&document.documentElement.clientHeight||"undefined"!=typeof document&&document.body&&document.body.clientHeight||1,h="undefined"!=typeof window&&window.innerWidth||"undefined"!=typeof document&&document.documentElement&&document.documentElement.clientWidth||"undefined"!=typeof document&&document.body&&document.body.clientWidth||1,u="undefined"!=typeof navigator&&navigator.userAgent||"";t=i||"undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues?new o:new o([new Date,a,h,u,Math.random()]),t.createWithSeeds=function(){if(0===arguments.length)throw new Error("No seeds were provided");return new o(arguments)}}).call(this),function(){e.uuid=function(){for(var e="0123456789abcdef",i=[],n=0;36>n;n++)i[n]=t.choice(e);i[14]="4",i[19]=e.substr(3&parseInt(i[19],16)|8,1),i[8]=i[13]=i[18]=i[23]="-";var r=i.join("");return r}}.call(this),"undefined"==typeof Package&&(Package={}),Package.random={Random:t}}(),function(){var t,e=(Package.meteor.Meteor,Package.underscore._),i=Package.json.JSON,n=Package.ejson.EJSON;(function(){t=function(t,e){var n=this;n._map={},n._idStringify=t||i.stringify,n._idParse=e||i.parse},e.extend(t.prototype,{get:function(t){var e=this,i=e._idStringify(t);return e._map[i]},set:function(t,e){var i=this,n=i._idStringify(t);i._map[n]=e},remove:function(t){var e=this,i=e._idStringify(t);delete e._map[i]},has:function(t){var i=this,n=i._idStringify(t);return e.has(i._map,n)},empty:function(){var t=this;return e.isEmpty(t._map)},clear:function(){var t=this;t._map={}},forEach:function(t){for(var i=this,n=e.keys(i._map),r=0;r<n.length;r++){var s=t.call(null,i._map[n[r]],i._idParse(n[r]));if(s===!1)return}},size:function(){var t=this;return e.size(t._map)},setDefault:function(t,i){var n=this,r=n._idStringify(t);return e.has(n._map,r)?n._map[r]:(n._map[r]=i,i)},clone:function(){var e=this,i=new t(e._idStringify,e._idParse);return e.forEach(function(t,e){i.set(e,n.clone(t))}),i}})}).call(this),"undefined"==typeof Package&&(Package={}),Package["id-map"]={IdMap:t}}(),function(){var t,e=(Package.meteor.Meteor,Package.underscore._);(function(){var i=function(t,e,i,n){return{key:t,value:e,next:i,prev:n}};t=function(){var t=this;t._dict={},t._first=null,t._last=null,t._size=0;var i=e.toArray(arguments);t._stringify=function(t){return t},"function"==typeof i[0]&&(t._stringify=i.shift()),e.each(i,function(e){t.putBefore(e[0],e[1],null)})},e.extend(t.prototype,{_k:function(t){return" "+this._stringify(t)},empty:function(){var t=this;return!t._first},size:function(){var t=this;return t._size},_linkEltIn:function(t){var e=this;t.next?(t.prev=t.next.prev,t.next.prev=t,t.prev&&(t.prev.next=t)):(t.prev=e._last,e._last&&(e._last.next=t),e._last=t),(null===e._first||e._first===t.next)&&(e._first=t)},_linkEltOut:function(t){var e=this;t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===e._last&&(e._last=t.prev),t===e._first&&(e._first=t.next)},putBefore:function(t,e,n){var r=this;if(r._dict[r._k(t)])throw new Error("Item "+t+" already present in OrderedDict");var s=n?i(t,e,r._dict[r._k(n)]):i(t,e,null);if(void 0===s.next)throw new Error("could not find item to put this one before");r._linkEltIn(s),r._dict[r._k(t)]=s,r._size++},append:function(t,e){var i=this;i.putBefore(t,e,null)},remove:function(t){var e=this,i=e._dict[e._k(t)];if(void 0===i)throw new Error("Item "+t+" not present in OrderedDict");return e._linkEltOut(i),e._size--,delete e._dict[e._k(t)],i.value},get:function(t){var e=this;return e.has(t)?e._dict[e._k(t)].value:void 0},has:function(t){var i=this;return e.has(i._dict,i._k(t))},forEach:function(e){for(var i=this,n=0,r=i._first;null!==r;){var s=e(r.value,r.key,n);if(s===t.BREAK)return;r=r.next,n++}},first:function(){var t=this;return t.empty()?void 0:t._first.key},firstValue:function(){var t=this;return t.empty()?void 0:t._first.value},last:function(){var t=this;return t.empty()?void 0:t._last.key},lastValue:function(){var t=this;return t.empty()?void 0:t._last.value},prev:function(t){var e=this;if(e.has(t)){var i=e._dict[e._k(t)];if(i.prev)return i.prev.key}return null},next:function(t){var e=this;if(e.has(t)){var i=e._dict[e._k(t)];if(i.next)return i.next.key}return null},moveBefore:function(t,e){var i=this,n=i._dict[i._k(t)],r=e?i._dict[i._k(e)]:null;if(void 0===n)throw new Error("Item to move is not present");if(void 0===r)throw new Error("Could not find element to move this one before");r!==n.next&&(i._linkEltOut(n),n.next=r,i._linkEltIn(n))},indexOf:function(e){var i=this,n=null;return i.forEach(function(r,s,o){return i._k(s)===i._k(e)?(n=o,t.BREAK):void 0}),n},_checkRep:function(){var t=this;e.each(t._dict,function(t,e){if(e.next===e)throw new Error("Next is a loop");if(e.prev===e)throw new Error("Prev is a loop")})}}),t.BREAK={"break":!0}}).call(this),"undefined"==typeof Package&&(Package={}),Package["ordered-dict"]={OrderedDict:t}}(),function(){{var t,e;Package.meteor.Meteor}(function(){e={exports:{}}}).call(this),function(){!function(){function t(t){for(var e=[],i=[],n=0;n<t[0].length;n++)e.push(t[0][n][1]),i.push(t[0][n][0]);return e=e.sort(function(t,e){return t-e}),i=i.sort(function(t,e){return t-e}),[[e[0],i[0]],[e[e.length-1],i[i.length-1]]]}function i(t,e,i){for(var n=[[0,0]],r=0;r<i.length;r++){for(var s=0;s<i[r].length;s++)n.push(i[r][s]);n.push([0,0])}for(var o=!1,r=0,s=n.length-1;r<n.length;s=r++)n[r][0]>e!=n[s][0]>e&&t<(n[s][1]-n[r][1])*(e-n[r][0])/(n[s][0]-n[r][0])+n[r][1]&&(o=!o);return o}var n={};"undefined"!=typeof e&&e.exports&&(e.exports=n),n.lineStringsIntersect=function(t,e){for(var i=[],n=0;n<=t.coordinates.length-2;++n)for(var r=0;r<=e.coordinates.length-2;++r){var s={x:t.coordinates[n][1],y:t.coordinates[n][0]},o={x:t.coordinates[n+1][1],y:t.coordinates[n+1][0]},a={x:e.coordinates[r][1],y:e.coordinates[r][0]},h={x:e.coordinates[r+1][1],y:e.coordinates[r+1][0]},u=(h.x-a.x)*(s.y-a.y)-(h.y-a.y)*(s.x-a.x),c=(o.x-s.x)*(s.y-a.y)-(o.y-s.y)*(s.x-a.x),l=(h.y-a.y)*(o.x-s.x)-(h.x-a.x)*(o.y-s.y);if(0!=l){var d=u/l,p=c/l;d>=0&&1>=d&&p>=0&&1>=p&&i.push({type:"Point",coordinates:[s.x+d*(o.x-s.x),s.y+d*(o.y-s.y)]})}}return 0==i.length&&(i=!1),i},n.pointInBoundingBox=function(t,e){return!(t.coordinates[1]<e[0][0]||t.coordinates[1]>e[1][0]||t.coordinates[0]<e[0][1]||t.coordinates[0]>e[1][1])},n.pointInPolygon=function(e,r){for(var s="Polygon"==r.type?[r.coordinates]:r.coordinates,o=!1,a=0;a<s.length;a++)n.pointInBoundingBox(e,t(s[a]))&&(o=!0);if(!o)return!1;for(var h=!1,a=0;a<s.length;a++)i(e.coordinates[1],e.coordinates[0],s[a])&&(h=!0);return h},n.numberToRadius=function(t){return t*Math.PI/180},n.numberToDegree=function(t){return 180*t/Math.PI},n.drawCircle=function(t,e,i){for(var r=[e.coordinates[1],e.coordinates[0]],s=t/1e3/6371,o=[n.numberToRadius(r[0]),n.numberToRadius(r[1])],i=i||15,a=[[r[0],r[1]]],h=0;i>h;h++){var u=2*Math.PI*h/i,c=Math.asin(Math.sin(o[0])*Math.cos(s)+Math.cos(o[0])*Math.sin(s)*Math.cos(u)),l=o[1]+Math.atan2(Math.sin(u)*Math.sin(s)*Math.cos(o[0]),Math.cos(s)-Math.sin(o[0])*Math.sin(c));a[h]=[],a[h][1]=n.numberToDegree(c),a[h][0]=n.numberToDegree(l)}return{type:"Polygon",coordinates:[a]}},n.rectangleCentroid=function(t){var e=t.coordinates[0],i=e[0][0],n=e[0][1],r=e[2][0],s=e[2][1],o=r-i,a=s-n;return{type:"Point",coordinates:[i+o/2,n+a/2]}},n.pointDistance=function(t,e){var i=t.coordinates[0],r=t.coordinates[1],s=e.coordinates[0],o=e.coordinates[1],a=n.numberToRadius(o-r),h=n.numberToRadius(s-i),u=Math.pow(Math.sin(a/2),2)+Math.cos(n.numberToRadius(r))*Math.cos(n.numberToRadius(o))*Math.pow(Math.sin(h/2),2),c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return 6371*c*1e3},n.geometryWithinRadius=function(t,e,i){if("Point"==t.type)return n.pointDistance(t,e)<=i;if("LineString"==t.type||"Polygon"==t.type){var r,s={};r="Polygon"==t.type?t.coordinates[0]:t.coordinates;for(var o in r)if(s.coordinates=r[o],n.pointDistance(s,e)>i)return!1}return!0},n.area=function(t){for(var e,i,n=0,r=t.coordinates[0],s=r.length-1,o=0;o<r.length;s=o++){var e={x:r[o][1],y:r[o][0]},i={x:r[s][1],y:r[s][0]};n+=e.x*i.y,n-=e.y*i.x}return n/=2},n.centroid=function(t){for(var e,i,r,s=0,o=0,a=t.coordinates[0],h=a.length-1,u=0;u<a.length;h=u++){var i={x:a[u][1],y:a[u][0]},r={x:a[h][1],y:a[h][0]};e=i.x*r.y-r.x*i.y,s+=(i.x+r.x)*e,o+=(i.y+r.y)*e}return e=6*n.area(t),{type:"Point",coordinates:[o/e,s/e]}},n.simplify=function(t,e){e=e||20,t=t.map(function(t){return{lng:t.coordinates[0],lat:t.coordinates[1]}});var i,n,r,s,o,a,h,u,c,l,d,p,f,m,g,y,v,_,b,x=Math.PI/180*.5,w=new Array,T=new Array,S=new Array;if(t.length<3)return t;for(i=t.length,l=360*e/(2*Math.PI*6378137),l*=l,r=0,T[0]=0,S[0]=i-1,n=1;n>0;)if(s=T[n-1],o=S[n-1],n--,o-s>1){for(d=t[o].lng()-t[s].lng(),p=t[o].lat()-t[s].lat(),Math.abs(d)>180&&(d=360-Math.abs(d)),d*=Math.cos(x*(t[o].lat()+t[s].lat())),f=d*d+p*p,a=s+1,h=s,c=-1;o>a;a++)m=t[a].lng()-t[s].lng(),g=t[a].lat()-t[s].lat(),Math.abs(m)>180&&(m=360-Math.abs(m)),m*=Math.cos(x*(t[a].lat()+t[s].lat())),y=m*m+g*g,v=t[a].lng()-t[o].lng(),_=t[a].lat()-t[o].lat(),Math.abs(v)>180&&(v=360-Math.abs(v)),v*=Math.cos(x*(t[a].lat()+t[o].lat())),b=v*v+_*_,u=y>=f+b?b:b>=f+y?y:(m*p-g*d)*(m*p-g*d)/f,u>c&&(h=a,c=u);l>c?(w[r]=s,r++):(n++,T[n-1]=h,S[n-1]=o,n++,T[n-1]=s,S[n-1]=h)}else w[r]=s,r++;w[r]=i-1,r++;for(var C=new Array,a=0;r>a;a++)C.push(t[w[a]]);return C.map(function(t){return{type:"Point",coordinates:[t.lng,t.lat]}})},n.destinationPoint=function(t,e,i){i/=6371,e=n.numberToRadius(e);var r=n.numberToRadius(t.coordinates[0]),s=n.numberToRadius(t.coordinates[1]),o=Math.asin(Math.sin(r)*Math.cos(i)+Math.cos(r)*Math.sin(i)*Math.cos(e)),a=s+Math.atan2(Math.sin(e)*Math.sin(i)*Math.cos(r),Math.cos(i)-Math.sin(r)*Math.sin(o));return a=(a+3*Math.PI)%(2*Math.PI)-Math.PI,{type:"Point",coordinates:[n.numberToDegree(o),n.numberToDegree(a)]}}}()}.call(this),function(){t=e.exports}.call(this),"undefined"==typeof Package&&(Package={}),Package["geojson-utils"]={GeoJSON:t}}(),function(){var t,e,i,n,r,s,o,a,h,u,c,l,d,p,f,m,g=Package.meteor.Meteor,y=Package.underscore._,v=Package.json.JSON,_=Package.ejson.EJSON,b=Package["id-map"].IdMap,x=Package["ordered-dict"].OrderedDict,w=Package.deps.Deps,T=Package.random.Random,S=Package["geojson-utils"].GeoJSON;(function(){t=function(e){var i=this;i.name=e,i._docs=new t._IdMap,i._observeQueue=new g._SynchronousQueue,i.next_qid=1,i.queries={},i._savedOriginals=null,i.paused=!1},e={},i={},t._applyChanges=function(t,e){y.each(e,function(e,i){void 0===e?delete t[i]:t[i]=e})},n=function(t){var e=new Error(t);return e.name="MinimongoError",e},t.prototype.find=function(e,i){return 0===arguments.length&&(e={}),new t.Cursor(this,e,i)},t.Cursor=function(i,n,r){var s=this;r||(r={}),s.collection=i,s.sorter=null,t._selectorIsId(n)?(s._selectorId=n,s.matcher=new e.Matcher(n,s)):(s._selectorId=void 0,s.matcher=new e.Matcher(n,s),(s.matcher.hasGeoQuery()||r.sort)&&(s.sorter=new e.Sorter(r.sort||[],{matcher:s.matcher}))),s.skip=r.skip,s.limit=r.limit,s.fields=r.fields,s.fields&&(s.projectionFn=t._compileProjection(s.fields)),s._transform=t.wrapTransform(r.transform),s.db_objects=null,s.cursor_pos=0,"undefined"!=typeof w&&(s.reactive=void 0===r.reactive?!0:r.reactive)},t.Cursor.prototype.rewind=function(){var t=this;t.db_objects=null,t.cursor_pos=0},t.prototype.findOne=function(t,e){return 0===arguments.length&&(t={}),e=e||{},e.limit=1,this.find(t,e).fetch()[0]},t.Cursor.prototype.forEach=function(t,e){var i=this;for(null===i.db_objects&&(i.db_objects=i._getRawObjects({ordered:!0})),i.reactive&&i._depend({addedBefore:!0,removed:!0,changed:!0,movedBefore:!0});i.cursor_pos<i.db_objects.length;){var n=_.clone(i.db_objects[i.cursor_pos]);i.projectionFn&&(n=i.projectionFn(n)),i._transform&&(n=i._transform(n)),t.call(e,n,i.cursor_pos,i),++i.cursor_pos}},t.Cursor.prototype.getTransform=function(){return this._transform},t.Cursor.prototype.map=function(t,e){var i=this,n=[];return i.forEach(function(r,s){n.push(t.call(e,r,s,i))}),n},t.Cursor.prototype.fetch=function(){var t=this,e=[];return t.forEach(function(t){e.push(t)}),e},t.Cursor.prototype.count=function(){var t=this;return t.reactive&&t._depend({added:!0,removed:!0},!0),null===t.db_objects&&(t.db_objects=t._getRawObjects({ordered:!0})),t.db_objects.length},t.Cursor.prototype._publishCursor=function(t){var e=this;if(!e.collection.name)throw new Error("Can't publish a cursor from a collection without a name.");var i=e.collection.name;return g.Collection._publishCursor(e,t,i)},t.Cursor.prototype._getCollectionName=function(){var t=this;return t.collection.name},t._observeChangesCallbacksAreOrdered=function(t){if(t.added&&t.addedBefore)throw new Error("Please specify only one of added() and addedBefore()");return!(!t.addedBefore&&!t.movedBefore)},t._observeCallbacksAreOrdered=function(t){if(t.addedAt&&t.added)throw new Error("Please specify only one of added() and addedAt()");if(t.changedAt&&t.changed)throw new Error("Please specify only one of changed() and changedAt()");if(t.removed&&t.removedAt)throw new Error("Please specify only one of removed() and removedAt()");return!!(t.addedAt||t.movedTo||t.changedAt||t.removedAt)},t.ObserveHandle=function(){},y.extend(t.Cursor.prototype,{observe:function(e){var i=this;return t._observeFromObserveChanges(i,e)},observeChanges:function(e){var i=this,n=t._observeChangesCallbacksAreOrdered(e);if(!e._allow_unordered&&!n&&(i.skip||i.limit))throw new Error("must use ordered observe with skip or limit");if(i.fields&&(0===i.fields._id||i.fields._id===!1))throw Error("You may not observe a cursor with {fields: {_id: 0}}");var r,s={matcher:i.matcher,sorter:n&&i.sorter,distances:i.matcher.hasGeoQuery()&&n&&new t._IdMap,resultsSnapshot:null,ordered:n,cursor:i,projectionFn:i.projectionFn};i.reactive&&(r=i.collection.next_qid++,i.collection.queries[r]=s),s.results=i._getRawObjects({ordered:n,distances:s.distances}),i.collection.paused&&(s.resultsSnapshot=n?[]:new t._IdMap);var o=function(t,e,n){return t?function(){var r=this,s=arguments;i.collection.paused||void 0!==e&&i.projectionFn&&(s[e]=i.projectionFn(s[e]),n&&y.isEmpty(s[e]))||i.collection._observeQueue.queueTask(function(){t.apply(r,s)})}:function(){}};if(s.added=o(e.added,1),s.changed=o(e.changed,1,!0),s.removed=o(e.removed),n&&(s.addedBefore=o(e.addedBefore,1),s.movedBefore=o(e.movedBefore)),!e._suppress_initial&&!i.collection.paused){var a=n?y.bind(y.each,null,s.results):y.bind(s.results.forEach,s.results);a(function(t){var e=_.clone(t);delete e._id,n&&s.addedBefore(t._id,e,null),s.added(t._id,e)})}var h=new t.ObserveHandle;return y.extend(h,{collection:i.collection,stop:function(){i.reactive&&delete i.collection.queries[r]}}),i.reactive&&w.active&&w.onInvalidate(function(){h.stop()}),i.collection._observeQueue.drain(),h}}),t.Cursor.prototype._getRawObjects=function(e){var i=this;e=e||{};var n=e.ordered?[]:new t._IdMap;if(void 0!==i._selectorId){if(i.skip)return n;var r=i.collection._docs.get(i._selectorId);return r&&(e.ordered?n.push(r):n.set(i._selectorId,r)),n}var s;if(i.matcher.hasGeoQuery()&&e.ordered&&(e.distances?(s=e.distances,s.clear()):s=new t._IdMap),i.collection._docs.forEach(function(t,r){var o=i.matcher.documentMatches(t);return o.result&&(e.ordered?(n.push(t),s&&void 0!==o.distance&&s.set(r,o.distance)):n.set(r,t)),!i.limit||i.skip||i.sorter||n.length!==i.limit?!0:!1}),!e.ordered)return n;if(i.sorter){var o=i.sorter.getComparator({distances:s});n.sort(o)}var a=i.skip||0,h=i.limit?i.limit+a:n.length;return n.slice(a,h)},t.Cursor.prototype._depend=function(t,e){var i=this;if(w.active){var n=new w.Dependency;n.depend();var r=y.bind(n.changed,n),s={_suppress_initial:!0,_allow_unordered:e};y.each(["added","changed","removed","addedBefore","movedBefore"],function(e){t[e]&&(s[e]=r)}),i.observeChanges(s)}},t.prototype.insert=function(e,i){var r=this;e=_.clone(e),y.has(e,"_id")||(e._id=t._useOID?new t._ObjectID:T.id());var s=e._id;if(r._docs.has(s))throw n("Duplicate _id '"+s+"'");r._saveOriginal(s,void 0),r._docs.set(s,e);var o=[];for(var a in r.queries){var h=r.queries[a],u=h.matcher.documentMatches(e);u.result&&(h.distances&&void 0!==u.distance&&h.distances.set(s,u.distance),h.cursor.skip||h.cursor.limit?o.push(a):t._insertInResults(h,e))}return y.each(o,function(e){r.queries[e]&&t._recomputeResults(r.queries[e])}),r._observeQueue.drain(),i&&g.defer(function(){i(null,s)}),s},t.prototype._eachPossiblyMatchingDoc=function(e,i){var n=this,r=t._idsMatchedBySelector(e);if(r)for(var s=0;s<r.length;++s){var o=r[s],a=n._docs.get(o);if(a){var h=i(a,o);if(h===!1)break}}else n._docs.forEach(i)},t.prototype.remove=function(i,n){var r=this;if(r.paused&&!r._savedOriginals&&_.equals(i,{})){var s=r._docs.size();return r._docs.clear(),y.each(r.queries,function(t){t.ordered?t.results=[]:t.results.clear()}),n&&g.defer(function(){n(null,s)}),s}var o=new e.Matcher(i,r),a=[];r._eachPossiblyMatchingDoc(i,function(t,e){o.documentMatches(t).result&&a.push(e)});for(var h=[],u=[],c=0;c<a.length;c++){var l=a[c],d=r._docs.get(l);y.each(r.queries,function(t,e){t.matcher.documentMatches(d).result&&(t.cursor.skip||t.cursor.limit?h.push(e):u.push({qid:e,doc:d}))}),r._saveOriginal(l,d),r._docs.remove(l)}return y.each(u,function(e){var i=r.queries[e.qid];i&&(i.distances&&i.distances.remove(e.doc._id),t._removeFromResults(i,e.doc))}),y.each(h,function(e){var i=r.queries[e];i&&t._recomputeResults(i)}),r._observeQueue.drain(),s=a.length,n&&g.defer(function(){n(null,s)}),s},t.prototype.update=function(i,n,r,s){var o=this;!s&&r instanceof Function&&(s=r,r=null),r||(r={});var a=new e.Matcher(i,o),h={};y.each(o.queries,function(t,e){!t.cursor.skip&&!t.cursor.limit||t.paused||(h[e]=_.clone(t.results))});var u={},c=0;o._eachPossiblyMatchingDoc(i,function(t,e){var i=a.documentMatches(t);return i.result&&(o._saveOriginal(e,t),o._modifyAndNotify(t,n,u,i.arrayIndices),++c,!r.multi)?!1:!0}),y.each(u,function(e,i){var n=o.queries[i];n&&t._recomputeResults(n,h[i])}),o._observeQueue.drain();var l;if(0===c&&r.upsert){var d=t._removeDollarOperators(i);t._modify(d,n,{isInsert:!0}),!d._id&&r.insertedId&&(d._id=r.insertedId),l=o.insert(d),c=1}var p;return r._returnObject?(p={numberAffected:c},void 0!==l&&(p.insertedId=l)):p=c,s&&g.defer(function(){s(null,p)}),p},t.prototype.upsert=function(t,e,i,n){var r=this;return n||"function"!=typeof i||(n=i,i={}),r.update(t,e,y.extend({},i,{upsert:!0,_returnObject:!0}),n)},t.prototype._modifyAndNotify=function(e,i,n,r){var s=this,o={};for(var a in s.queries){var h=s.queries[a];o[a]=h.ordered?h.matcher.documentMatches(e).result:h.results.has(e._id)}var u=_.clone(e);t._modify(e,i,{arrayIndices:r});for(a in s.queries){h=s.queries[a];var c=o[a],l=h.matcher.documentMatches(e),d=l.result;d&&h.distances&&void 0!==l.distance&&h.distances.set(e._id,l.distance),h.cursor.skip||h.cursor.limit?(c||d)&&(n[a]=!0):c&&!d?t._removeFromResults(h,e):!c&&d?t._insertInResults(h,e):c&&d&&t._updateInResults(h,e,u)}},t._insertInResults=function(e,i){var n=_.clone(i);if(delete n._id,e.ordered){if(e.sorter){var r=t._insertInSortedList(e.sorter.getComparator({distances:e.distances}),e.results,i),s=e.results[r+1];s=s?s._id:null,e.addedBefore(i._id,n,s)}else e.addedBefore(i._id,n,null),e.results.push(i);e.added(i._id,n)}else e.added(i._id,n),e.results.set(i._id,i)},t._removeFromResults=function(e,i){if(e.ordered){var n=t._findInOrderedResults(e,i);e.removed(i._id),e.results.splice(n,1)}else{var r=i._id;e.removed(i._id),e.results.remove(r)}},t._updateInResults=function(e,i,n){if(!_.equals(i._id,n._id))throw new Error("Can't change a doc's _id while updating");var r=t._makeChangedFields(i,n);if(!e.ordered)return y.isEmpty(r)||(e.changed(i._id,r),e.results.set(i._id,i)),void 0;var s=t._findInOrderedResults(e,i);if(y.isEmpty(r)||e.changed(i._id,r),e.sorter){e.results.splice(s,1);var o=t._insertInSortedList(e.sorter.getComparator({distances:e.distances}),e.results,i);if(s!==o){var a=e.results[o+1];a=a?a._id:null,e.movedBefore&&e.movedBefore(i._id,a)}}},t._recomputeResults=function(e,i){i||(i=e.results),e.distances&&e.distances.clear(),e.results=e.cursor._getRawObjects({ordered:e.ordered,distances:e.distances}),e.paused||t._diffQueryChanges(e.ordered,i,e.results,e)},t._findInOrderedResults=function(t,e){if(!t.ordered)throw new Error("Can't call _findInOrderedResults on unordered query");for(var i=0;i<t.results.length;i++)if(t.results[i]===e)return i;throw Error("object missing from query")},t._binarySearch=function(t,e,i){for(var n=0,r=e.length;r>0;){var s=Math.floor(r/2);t(i,e[n+s])>=0?(n+=s+1,r-=s+1):r=s}return n},t._insertInSortedList=function(e,i,n){if(0===i.length)return i.push(n),0;var r=t._binarySearch(e,i,n);return i.splice(r,0,n),r},t.prototype.saveOriginals=function(){var e=this;if(e._savedOriginals)throw new Error("Called saveOriginals twice without retrieveOriginals");e._savedOriginals=new t._IdMap},t.prototype.retrieveOriginals=function(){var t=this;if(!t._savedOriginals)throw new Error("Called retrieveOriginals without saveOriginals");var e=t._savedOriginals;return t._savedOriginals=null,e},t.prototype._saveOriginal=function(t,e){var i=this;i._savedOriginals&&(i._savedOriginals.has(t)||i._savedOriginals.set(t,_.clone(e)))},t.prototype.pauseObservers=function(){if(!this.paused){this.paused=!0;for(var t in this.queries){var e=this.queries[t];e.resultsSnapshot=_.clone(e.results)}}},t.prototype.resumeObservers=function(){var e=this;if(this.paused){this.paused=!1;for(var i in this.queries){var n=e.queries[i];t._diffQueryChanges(n.ordered,n.resultsSnapshot,n.results,n),n.resultsSnapshot=null}e._observeQueue.drain()}},t._idStringify=function(e){if(e instanceof t._ObjectID)return e.valueOf();if("string"==typeof e)return""===e?e:"-"===e.substr(0,1)||"~"===e.substr(0,1)||t._looksLikeObjectID(e)||"{"===e.substr(0,1)?"-"+e:e;if(void 0===e)return"-";if("object"==typeof e&&null!==e)throw new Error("Meteor does not currently support objects other than ObjectID as ids");return"~"+v.stringify(e)},t._idParse=function(e){return""===e?e:"-"===e?void 0:"-"===e.substr(0,1)?e.substr(1):"~"===e.substr(0,1)?v.parse(e.substr(1)):t._looksLikeObjectID(e)?new t._ObjectID(e):e},t._makeChangedFields=function(e,i){var n={};return t._diffObjects(i,e,{leftOnly:function(t){n[t]=void 0},rightOnly:function(t,e){n[t]=e},both:function(t,e,i){_.equals(e,i)||(n[t]=i)}}),n}}).call(this),function(){t.wrapTransform=function(t){return t?function(e){if(!y.has(e,"_id"))throw new Error("can only transform documents with _id");var i=e._id,n=w.nonreactive(function(){return t(e)});if(!s(n))throw new Error("transform must return object");if(y.has(n,"_id")){if(!_.equals(n._id,i))throw new Error("transformed document can't have different _id")}else n._id=i;return n}:null}}.call(this),function(){r=function(t){return y.isArray(t)&&!_.isBinary(t)},s=function(e){return e&&3===t._f._type(e)},o=function(t){return r(t)||s(t)},a=function(t,e){if(!s(t))return!1;var i=void 0;return y.each(t,function(n,r){var s="$"===r.substr(0,1);if(void 0===i)i=s;else if(i!==s){if(!e)throw new Error("Inconsistent operator: "+v.stringify(t));i=!1}}),!!i},h=function(t){return/^[0-9]+$/.test(t)}}.call(this),function(){e.Matcher=function(t){var e=this;e._paths={},e._hasGeoQuery=!1,e._hasWhere=!1,e._isSimple=!0,e._matchingDocument=void 0,e._selector=null,e._docMatcher=e._compileSelector(t)},y.extend(e.Matcher.prototype,{documentMatches:function(t){if(!t||"object"!=typeof t)throw Error("documentMatches needs a document");return this._docMatcher(t)},hasGeoQuery:function(){return this._hasGeoQuery},hasWhere:function(){return this._hasWhere
},isSimple:function(){return this._isSimple},_compileSelector:function(e){var i=this;if(e instanceof Function)return i._isSimple=!1,i._selector=e,i._recordPathUsed(""),function(t){return{result:!!e.call(t)}};if(t._selectorIsId(e))return i._selector={_id:e},i._recordPathUsed("_id"),function(t){return{result:_.equals(t._id,e)}};if(!e||"_id"in e&&!e._id)return i._isSimple=!1,k;if("boolean"==typeof e||r(e)||_.isBinary(e))throw new Error("Invalid selector: "+e);return i._selector=_.clone(e),n(e,i,{isRoot:!0})},_recordPathUsed:function(t){this._paths[t]=!0},_getPaths:function(){return y.keys(this._paths)}});var n=function(t,e,i){i=i||{};var n=[];return y.each(t,function(t,r){if("$"===r.substr(0,1)){if(!y.has(b,r))throw new Error("Unrecognized logical operator: "+r);e._isSimple=!1,n.push(b[r](t,e,i.inElemMatch))}else{i.inElemMatch||e._recordPathUsed(r);var s=d(r),o=f(t,e,i.isRoot);n.push(function(t){var e=s(t);return o(e)})}}),O(n)},f=function(t,e,i){return t instanceof RegExp?(e._isSimple=!1,m(u(t))):a(t)?g(t,e,i):m(c(t))},m=function(t,e){return e=e||{},function(i){var n=i;e.dontExpandLeafArrays||(n=p(i,e.dontIncludeLeafArrays));var r={};return r.result=y.any(n,function(e){var i=t(e.value);return"number"==typeof i&&(e.arrayIndices||(e.arrayIndices=[i]),i=!0),i&&e.arrayIndices&&(r.arrayIndices=e.arrayIndices),i}),r}};u=function(t){return function(e){return e instanceof RegExp?y.isEqual(e,t):"string"!=typeof e?!1:t.test(e)}},c=function(e){if(a(e))throw Error("Can't create equalityValueSelector for operator object");return null==e?function(t){return null==t}:function(i){return t._f._equal(e,i)}};var g=function(t,e,i){var n=[];return y.each(t,function(r,s){var o=y.contains(["$lt","$lte","$gt","$gte"],s)&&y.isNumber(r),a="$ne"===s&&!y.isObject(r),h=y.contains(["$in","$nin"],s)&&y.isArray(r)&&!y.any(r,y.isObject);if("$eq"===s||o||h||a||(e._isSimple=!1),y.has(w,s))n.push(w[s](r,t,e,i));else{if(!y.has(l,s))throw new Error("Unrecognized operator: "+s);var u=l[s];n.push(m(u.compileElementSelector(r,t,e),u))}}),M(n)},v=function(t,e,i){if(!r(t)||y.isEmpty(t))throw Error("$and/$or/$nor must be nonempty array");return y.map(t,function(t){if(!s(t))throw Error("$or/$and/$nor entries need to be full objects");return n(t,e,{inElemMatch:i})})},b={$and:function(t,e,i){var n=v(t,e,i);return O(n)},$or:function(t,e,i){var n=v(t,e,i);return 1===n.length?n[0]:function(t){var e=y.any(n,function(e){return e(t).result});return{result:e}}},$nor:function(t,e,i){var n=v(t,e,i);return function(t){var e=y.all(n,function(e){return!e(t).result});return{result:e}}},$where:function(t,e){return e._recordPathUsed(""),e._hasWhere=!0,t instanceof Function||(t=Function("obj","return "+t)),function(e){return{result:t.call(e,e)}}},$comment:function(){return function(){return{result:!0}}}},x=function(t){return function(e){var i=t(e);return{result:!i.result}}},w={$not:function(t,e,i){return x(f(t,i))},$ne:function(t){return x(m(c(t)))},$nin:function(t){return x(m(l.$in.compileElementSelector(t)))},$exists:function(t){var e=m(function(t){return void 0!==t});return t?e:x(e)},$options:function(t,e){if(!y.has(e,"$regex"))throw Error("$options needs a $regex");return E},$maxDistance:function(t,e){if(!e.$near)throw Error("$maxDistance needs a $near");return E},$all:function(t,e,i){if(!r(t))throw Error("$all requires array");if(y.isEmpty(t))return k;var n=[];return y.each(t,function(t){if(a(t))throw Error("no $ expressions in $all");n.push(f(t,i))}),M(n)},$near:function(t,e,i,n){if(!n)throw Error("$near can't be inside another $ operator");i._hasGeoQuery=!0;var o,a,h;if(s(t)&&y.has(t,"$geometry"))o=t.$maxDistance,a=t.$geometry,h=function(t){return t&&t.type?"Point"===t.type?S.pointDistance(a,t):S.geometryWithinRadius(t,a,o)?0:o+1:null};else{if(o=e.$maxDistance,!r(t)&&!s(t))throw Error("$near argument must be coordinate pair or GeoJSON");a=C(t),h=function(t){return r(t)||s(t)?T(a,t):null}}return function(t){t=p(t);var e={result:!1};return y.each(t,function(t){var i=h(t.value);null===i||i>o||void 0!==e.distance&&e.distance<=i||(e.result=!0,e.distance=i,t.arrayIndices?e.arrayIndices=t.arrayIndices:delete e.arrayIndices)}),e}}},T=function(t,e){t=C(t),e=C(e);var i=t[0]-e[0],n=t[1]-e[1];return y.isNaN(i)||y.isNaN(n)?null:Math.sqrt(i*i+n*n)},C=function(t){return y.map(t,y.identity)},P=function(e){return{compileElementSelector:function(i){if(r(i))return function(){return!1};void 0===i&&(i=null);var n=t._f._type(i);return function(r){return void 0===r&&(r=null),t._f._type(r)!==n?!1:e(t._f._cmp(r,i))}}}};l={$lt:P(function(t){return 0>t}),$gt:P(function(t){return t>0}),$lte:P(function(t){return 0>=t}),$gte:P(function(t){return t>=0}),$mod:{compileElementSelector:function(t){if(!r(t)||2!==t.length||"number"!=typeof t[0]||"number"!=typeof t[1])throw Error("argument to $mod must be an array of two numbers");var e=t[0],i=t[1];return function(t){return"number"==typeof t&&t%e===i}}},$in:{compileElementSelector:function(t){if(!r(t))throw Error("$in needs an array");var e=[];return y.each(t,function(t){if(t instanceof RegExp)e.push(u(t));else{if(a(t))throw Error("cannot nest $ under $in");e.push(c(t))}}),function(t){return void 0===t&&(t=null),y.any(e,function(e){return e(t)})}}},$size:{dontExpandLeafArrays:!0,compileElementSelector:function(t){if("string"==typeof t)t=0;else if("number"!=typeof t)throw Error("$size needs a number");return function(e){return r(e)&&e.length===t}}},$type:{dontIncludeLeafArrays:!0,compileElementSelector:function(e){if("number"!=typeof e)throw Error("$type needs a number");return function(i){return void 0!==i&&t._f._type(i)===e}}},$regex:{compileElementSelector:function(t,e){if(!("string"==typeof t||t instanceof RegExp))throw Error("$regex has to be a string or RegExp");var i;if(void 0!==e.$options){if(/[^gim]/.test(e.$options))throw new Error("Only the i, m, and g regexp options are supported");var n=t instanceof RegExp?t.source:t;i=new RegExp(n,e.$options)}else i=t instanceof RegExp?t:new RegExp(t);return u(i)}},$elemMatch:{dontExpandLeafArrays:!0,compileElementSelector:function(t,e,i){if(!s(t))throw Error("$elemMatch need an object");var o,h;return a(t,!0)?(o=f(t,i),h=!1):(o=n(t,i,{inElemMatch:!0}),h=!0),function(t){if(!r(t))return!1;for(var e=0;e<t.length;++e){var i,n=t[e];if(h){if(!s(n)&&!r(n))return!1;i=n}else i=[{value:n,dontIterate:!0}];if(o(i).result)return e}return!1}}}},d=function(t){var e,i=t.split("."),n=i.length?i[0]:"",a=h(n);i.length>1&&(e=d(i.slice(1).join(".")));var u=function(t){return t.dontIterate||delete t.dontIterate,t.arrayIndices&&!t.arrayIndices.length&&delete t.arrayIndices,t};return function(t,i){if(i||(i=[]),r(t)){if(!(a&&n<t.length))return[];i=i.concat(+n,"x")}var h=t[n];if(!e)return[u({value:h,dontIterate:r(t)&&r(h),arrayIndices:i})];if(!o(h))return r(t)?[]:[u({value:void 0,arrayIndices:i})];var c=[],l=function(t){Array.prototype.push.apply(c,t)};return l(e(h,i)),r(h)&&y.each(h,function(t,n){s(t)&&l(e(t,i.concat(n)))}),c}},i.makeLookupFunction=d,p=function(t,e){var i=[];return y.each(t,function(t){var n=r(t.value);e&&n&&!t.dontIterate||i.push({value:t.value,arrayIndices:t.arrayIndices}),n&&!t.dontIterate&&y.each(t.value,function(e,n){i.push({value:e,arrayIndices:(t.arrayIndices||[]).concat(n)})})}),i};var k=function(){return{result:!1}},E=function(){return{result:!0}},A=function(t){return 0===t.length?E:1===t.length?t[0]:function(e){var i={};return i.result=y.all(t,function(t){var n=t(e);return n.result&&void 0!==n.distance&&void 0===i.distance&&(i.distance=n.distance),n.result&&n.arrayIndices&&(i.arrayIndices=n.arrayIndices),n.result}),i.result||(delete i.distance,delete i.arrayIndices),i}},O=A,M=A;t._f={_type:function(e){return"number"==typeof e?1:"string"==typeof e?2:"boolean"==typeof e?8:r(e)?4:null===e?10:e instanceof RegExp?11:"function"==typeof e?13:e instanceof Date?9:_.isBinary(e)?5:e instanceof t._ObjectID?7:3},_equal:function(t,e){return _.equals(t,e,{keyOrderSensitive:!0})},_typeorder:function(t){return[-1,1,2,3,4,5,-1,6,7,8,0,9,-1,100,2,100,1,8,1][t]},_cmp:function(e,i){if(void 0===e)return void 0===i?0:-1;if(void 0===i)return 1;var n=t._f._type(e),r=t._f._type(i),s=t._f._typeorder(n),o=t._f._typeorder(r);if(s!==o)return o>s?-1:1;if(n!==r)throw Error("Missing type coercion logic in _cmp");if(7===n&&(n=r=2,e=e.toHexString(),i=i.toHexString()),9===n&&(n=r=1,e=e.getTime(),i=i.getTime()),1===n)return e-i;if(2===r)return i>e?-1:e===i?0:1;if(3===n){var a=function(t){var e=[];for(var i in t)e.push(i),e.push(t[i]);return e};return t._f._cmp(a(e),a(i))}if(4===n)for(var h=0;;h++){if(h===e.length)return h===i.length?0:-1;if(h===i.length)return 1;var u=t._f._cmp(e[h],i[h]);if(0!==u)return u}if(5===n){if(e.length!==i.length)return e.length-i.length;for(h=0;h<e.length;h++){if(e[h]<i[h])return-1;if(e[h]>i[h])return 1}return 0}if(8===n)return e?i?0:1:i?-1:0;if(10===n)return 0;if(11===n)throw Error("Sorting not supported on regular expression");if(13===n)throw Error("Sorting not supported on Javascript code");throw Error("Unknown type to sort")}},t._removeDollarOperators=function(t){var e={};for(var i in t)"$"!==i.substr(0,1)&&(e[i]=t[i]);return e}}.call(this),function(){e.Sorter=function(t,n){var r=this;n=n||{},r._sortSpecParts=[];var s=function(t,e){if(!t)throw Error("sort keys must be non-empty");if("$"===t.charAt(0))throw Error("unsupported sort key: "+t);r._sortSpecParts.push({path:t,lookup:d(t),ascending:e})};if(t instanceof Array)for(var o=0;o<t.length;o++)"string"==typeof t[o]?s(t[o],!0):s(t[o][0],"desc"!==t[o][1]);else{if("object"!=typeof t)throw Error("Bad sort specification: "+v.stringify(t));y.each(t,function(t,e){s(e,t>=0)})}if(r.affectedByModifier){var a={};y.each(r._sortSpecParts,function(t){a[t.path]=1}),r._selectorForAffectedByModifier=new e.Matcher(a)}r._keyComparator=i(y.map(r._sortSpecParts,function(t,e){return r._keyFieldComparator(e)})),r._keyFilter=null,n.matcher&&r._useWithMatcher(n.matcher)},y.extend(e.Sorter.prototype,{getComparator:function(t){var e=this;if(!t||!t.distances)return e._getBaseComparator();var n=t.distances;return i([e._getBaseComparator(),function(t,e){if(!n.has(t._id))throw Error("Missing distance for "+t._id);if(!n.has(e._id))throw Error("Missing distance for "+e._id);return n.get(t._id)-n.get(e._id)}])},_getPaths:function(){var t=this;return y.pluck(t._sortSpecParts,"path")},_getMinKeyFromDoc:function(t){var e=this,i=null;if(e._generateKeysFromDoc(t,function(t){return e._keyCompatibleWithSelector(t)?null===i?(i=t,void 0):(e._compareKeys(t,i)<0&&(i=t),void 0):void 0}),null===i)throw Error("sort selector found no keys in doc?");return i},_keyCompatibleWithSelector:function(t){var e=this;return!e._keyFilter||e._keyFilter(t)},_generateKeysFromDoc:function(t,e){var i=this;if(0===i._sortSpecParts.length)throw new Error("can't generate keys without a spec");var n=[],r=function(t){return t.join(",")+","},s=null;if(y.each(i._sortSpecParts,function(e,i){var o=p(e.lookup(t),!0);o.length||(o=[{value:null}]);var a=!1;if(n[i]={},y.each(o,function(t){if(!t.arrayIndices){if(o.length>1)throw Error("multiple branches but no array used?");return n[i][""]=t.value,void 0}a=!0;var e=r(t.arrayIndices);if(y.has(n[i],e))throw Error("duplicate path: "+e);if(n[i][e]=t.value,s&&!y.has(s,e))throw Error("cannot index parallel arrays")}),s){if(!y.has(n[i],"")&&y.size(s)!==y.size(n[i]))throw Error("cannot index parallel arrays!")}else a&&(s={},y.each(n[i],function(t,e){s[e]=!0}))}),!s){var o=y.map(n,function(t){if(!y.has(t,""))throw Error("no value in sole key case?");return t[""]});return e(o),void 0}y.each(s,function(t,i){var r=y.map(n,function(t){if(y.has(t,""))return t[""];if(!y.has(t,i))throw Error("missing path?");return t[i]});e(r)})},_compareKeys:function(t,e){var i=this;if(t.length!==i._sortSpecParts.length||e.length!==i._sortSpecParts.length)throw Error("Key has wrong length");return i._keyComparator(t,e)},_keyFieldComparator:function(e){var i=this,n=!i._sortSpecParts[e].ascending;return function(i,r){var s=t._f._cmp(i[e],r[e]);return n&&(s=-s),s}},_getBaseComparator:function(){var t=this;return t._sortSpecParts.length?function(e,i){var n=t._getMinKeyFromDoc(e),r=t._getMinKeyFromDoc(i);return t._compareKeys(n,r)}:function(){return 0}},_useWithMatcher:function(t){var e=this;if(e._keyFilter)throw Error("called _useWithMatcher twice?");if(!y.isEmpty(e._sortSpecParts)){var i=t._selector;if(!(i instanceof Function)){var n={};y.each(e._sortSpecParts,function(t){n[t.path]=[]}),y.each(i,function(t,e){var i=n[e];if(i){if(t instanceof RegExp){if(t.ignoreCase||t.multiline)return;return i.push(u(t)),void 0}return a(t)?(y.each(t,function(e,n){y.contains(["$lt","$lte","$gt","$gte"],n)&&i.push(l[n].compileElementSelector(e)),"$regex"!==n||t.$options||i.push(l.$regex.compileElementSelector(e,t))}),void 0):(i.push(c(t)),void 0)}}),y.isEmpty(n[e._sortSpecParts[0].path])||(e._keyFilter=function(t){return y.all(e._sortSpecParts,function(e,i){return y.all(n[e.path],function(e){return e(t[i])})})})}}}});var i=function(t){return function(e,i){for(var n=0;n<t.length;++n){var r=t[n](e,i);if(0!==r)return r}return 0}}}.call(this),function(){t._compileProjection=function(e){t._checkSupportedProjection(e);var i=y.isUndefined(e._id)?!0:e._id,n=f(e),r=function(t,e){if(y.isArray(t))return y.map(t,function(t){return r(t,e)});var i=n.including?{}:_.clone(t);return y.each(e,function(e,s){y.has(t,s)&&(y.isObject(e)?y.isObject(t[s])&&(i[s]=r(t[s],e)):n.including?i[s]=_.clone(t[s]):delete i[s])}),i};return function(t){var e=r(t,n.tree);return i&&y.has(t,"_id")&&(e._id=t._id),!i&&y.has(e,"_id")&&delete e._id,e}},f=function(t){var e=y.keys(t).sort();e.length>0&&(1!==e.length||"_id"!==e[0])&&(e=y.reject(e,function(t){return"_id"===t}));var i=null;y.each(e,function(e){var r=!!t[e];if(null===i&&(i=r),i!==r)throw n("You cannot currently mix including and excluding fields.")});var r=m(e,function(){return i},function(t,e,i){var r=i,s=e;throw n("both "+r+" and "+s+" found in fields option, using both of them may trigger unexpected behavior. Did you mean to use only one of them?")});return{tree:r,including:i}},m=function(t,e,i,n){return n=n||{},y.each(t,function(t){var r=n,s=t.split("."),o=y.all(s.slice(0,-1),function(e,n){if(y.has(r,e)){if(!y.isObject(r[e])&&(r[e]=i(r[e],s.slice(0,n+1).join("."),t),!y.isObject(r[e])))return!1}else r[e]={};return r=r[e],!0});if(o){var a=y.last(s);r[a]=y.has(r,a)?i(r[a],t,t):e(t)}}),n},t._checkSupportedProjection=function(t){if(!y.isObject(t)||y.isArray(t))throw n("fields option must be an object");y.each(t,function(t,e){if(y.contains(e.split("."),"$"))throw n("Minimongo doesn't support $ operator in projections yet.");if(-1===y.indexOf([1,0,!0,!1],t))throw n("Projection values should be one of 1, 0, true, or false")})}}.call(this),function(){t._modify=function(t,e,o){if(o=o||{},!s(e))throw n("Modifier must be an object");var h,c=a(e);if(c)h=_.clone(t),y.each(e,function(t,e){var s=u[e];if(o.isInsert&&"$setOnInsert"===e&&(s=u.$set),!s)throw n("Invalid modifier specified "+e);y.each(t,function(t,a){if(a.length&&"."===a[a.length-1])throw n("Invalid mod field name, may not end in a period");if("_id"===a)throw n("Mod on _id not allowed");var u=a.split("."),c=(y.has(r,e),i(h,u,{noCreate:r[e],forbidArray:"$rename"===e,arrayIndices:o.arrayIndices})),l=u.pop();s(c,l,t,a,h)})});else{if(e._id&&!_.equals(t._id,e._id))throw n("Cannot change the _id of a document");for(var l in e)if(/\./.test(l))throw n("When replacing document, field name may not contain '.'");h=e}y.each(y.keys(t),function(e){("_id"!==e||o.isInsert)&&delete t[e]}),y.each(h,function(e,i){t[i]=e})};var i=function(t,e,i){i=i||{};for(var r=!1,s=0;s<e.length;s++){var a=s===e.length-1,u=e[s],c=o(t);if(!c){if(i.noCreate)return void 0;var l=n("cannot use the part '"+u+"' to traverse "+t);throw l.setPropertyError=!0,l}if(t instanceof Array){if(i.forbidArray)return null;if("$"===u){if(r)throw n("Too many positional (i.e. '$') elements");if(!i.arrayIndices||!i.arrayIndices.length)throw n("The positional operator did not find the match needed from the query");u=i.arrayIndices[0],r=!0}else{if(!h(u)){if(i.noCreate)return void 0;throw n("can't append to array using string field name ["+u+"]")}u=parseInt(u)}if(a&&(e[s]=u),i.noCreate&&u>=t.length)return void 0;for(;t.length<u;)t.push(null);if(!a)if(t.length===u)t.push({});else if("object"!=typeof t[u])throw n("can't modify field '"+e[s+1]+"' of list value "+v.stringify(t[u]))}else{if(u.length&&"$"===u.substr(0,1))throw n("can't set field named "+u);if(!(u in t)){if(i.noCreate)return void 0;a||(t[u]={})}}if(a)return t;t=t[u]}},r={$unset:!0,$pop:!0,$rename:!0,$pull:!0,$pullAll:!0},u={$inc:function(t,e,i){if("number"!=typeof i)throw n("Modifier $inc allowed for numbers only");if(e in t){if("number"!=typeof t[e])throw n("Cannot apply $inc modifier to non-number");t[e]+=i}else t[e]=i},$set:function(t,e,i){if(!y.isObject(t)){var r=n("Cannot set property on non-object field");throw r.setPropertyError=!0,r}if(null===t){var r=n("Cannot set property on null");throw r.setPropertyError=!0,r}t[e]=_.clone(i)},$setOnInsert:function(){},$unset:function(t,e){void 0!==t&&(t instanceof Array?e in t&&(t[e]=null):delete t[e])},$push:function(i,r,s){if(void 0===i[r]&&(i[r]=[]),!(i[r]instanceof Array))throw n("Cannot apply $push modifier to non-array");if(!s||!s.$each)return i[r].push(_.clone(s)),void 0;var o=s.$each;if(!(o instanceof Array))throw n("$each must be an array");var a=void 0;if("$slice"in s){if("number"!=typeof s.$slice)throw n("$slice must be a numeric value");if(s.$slice>0)throw n("$slice in $push must be zero or negative");a=s.$slice}var h=void 0;if(s.$sort){if(void 0===a)throw n("$sort requires $slice to be present");h=new e.Sorter(s.$sort).getComparator();for(var u=0;u<o.length;u++)if(3!==t._f._type(o[u]))throw n("$push like modifiers using $sort require all elements to be objects")}for(var c=0;c<o.length;c++)i[r].push(_.clone(o[c]));h&&i[r].sort(h),void 0!==a&&(i[r]=0===a?[]:i[r].slice(a))},$pushAll:function(t,e,i){if(!("object"==typeof i&&i instanceof Array))throw n("Modifier $pushAll/pullAll allowed for arrays only");var r=t[e];if(void 0===r)t[e]=i;else{if(!(r instanceof Array))throw n("Cannot apply $pushAll modifier to non-array");for(var s=0;s<i.length;s++)r.push(i[s])}},$addToSet:function(e,i,r){var s=e[i];if(void 0===s)e[i]=[r];else{if(!(s instanceof Array))throw n("Cannot apply $addToSet modifier to non-array");var o=!1;if("object"==typeof r)for(var a in r){"$each"===a&&(o=!0);break}var h=o?r.$each:[r];y.each(h,function(e){for(var i=0;i<s.length;i++)if(t._f._equal(e,s[i]))return;s.push(_.clone(e))})}},$pop:function(t,e,i){if(void 0!==t){var r=t[e];if(void 0!==r){if(!(r instanceof Array))throw n("Cannot apply $pop modifier to non-array");"number"==typeof i&&0>i?r.splice(0,1):r.pop()}}},$pull:function(i,r,s){if(void 0!==i){var o=i[r];if(void 0!==o){if(!(o instanceof Array))throw n("Cannot apply $pull/pullAll modifier to non-array");var a=[];if("object"!=typeof s||s instanceof Array)for(var h=0;h<o.length;h++)t._f._equal(o[h],s)||a.push(o[h]);else for(var u=new e.Matcher(s),h=0;h<o.length;h++)u.documentMatches(o[h]).result||a.push(o[h]);i[r]=a}}},$pullAll:function(e,i,r){if(!("object"==typeof r&&r instanceof Array))throw n("Modifier $pushAll/pullAll allowed for arrays only");if(void 0!==e){var s=e[i];if(void 0!==s){if(!(s instanceof Array))throw n("Cannot apply $pull/pullAll modifier to non-array");for(var o=[],a=0;a<s.length;a++){for(var h=!1,u=0;u<r.length;u++)if(t._f._equal(s[a],r[u])){h=!0;break}h||o.push(s[a])}e[i]=o}}},$rename:function(t,e,r,s,o){if(s===r)throw n("$rename source must differ from target");if(null===t)throw n("$rename source field invalid");if("string"!=typeof r)throw n("$rename target must be a string");if(void 0!==t){var a=t[e];delete t[e];var h=r.split("."),u=i(o,h,{forbidArray:!0});if(null===u)throw n("$rename target field invalid");var c=h.pop();u[c]=a}},$bit:function(){throw n("$bit is not supported")}}}.call(this),function(){t._diffQueryChanges=function(e,i,n,r){e?t._diffQueryOrderedChanges(i,n,r):t._diffQueryUnorderedChanges(i,n,r)},t._diffQueryUnorderedChanges=function(e,i,n){if(n.movedBefore)throw new Error("_diffQueryUnordered called with a movedBefore observer!");i.forEach(function(i,r){var s=e.get(r);if(s)n.changed&&!_.equals(s,i)&&n.changed(r,t._makeChangedFields(i,s));else if(n.added){var o=_.clone(i);delete o._id,n.added(i._id,o)}}),n.removed&&e.forEach(function(t,e){i.has(e)||n.removed(e)})},t._diffQueryOrderedChanges=function(e,i,n){var r={};y.each(i,function(t){r[t._id]&&g._debug("Duplicate _id in new_results"),r[t._id]=!0});var s={};y.each(e,function(t,e){t._id in s&&g._debug("Duplicate _id in old_results"),s[t._id]=e});for(var o=[],a=0,h=i.length,u=new Array(h),c=new Array(h),l=function(t){return s[i[t]._id]},d=0;h>d;d++)if(void 0!==s[i[d]._id]){for(var p=a;p>0&&!(l(u[p-1])<l(d));)p--;c[d]=0===p?-1:u[p-1],u[p]=d,p+1>a&&(a=p+1)}for(var f=0===a?-1:u[a-1];f>=0;)o.push(f),f=c[f];o.reverse(),o.push(i.length),y.each(e,function(t){r[t._id]||n.removed&&n.removed(t._id)});var m=0;y.each(o,function(r){for(var o,a,h,u=i[r]?i[r]._id:null,c=m;r>c;c++)a=i[c],y.has(s,a._id)?(o=e[s[a._id]],h=t._makeChangedFields(a,o),y.isEmpty(h)||n.changed&&n.changed(a._id,h),n.movedBefore&&n.movedBefore(a._id,u)):(h=_.clone(a),delete h._id,n.addedBefore&&n.addedBefore(a._id,h,u),n.added&&n.added(a._id,h));u&&(a=i[r],o=e[s[a._id]],h=t._makeChangedFields(a,o),y.isEmpty(h)||n.changed&&n.changed(a._id,h)),m=r+1})},t._diffObjects=function(t,e,i){y.each(t,function(t,n){y.has(e,n)?i.both&&i.both(n,t,e[n]):i.leftOnly&&i.leftOnly(n,t)}),i.rightOnly&&y.each(e,function(e,n){y.has(t,n)||i.rightOnly(n,e)})}}.call(this),function(){t._IdMap=function(){var e=this;b.call(e,t._idStringify,t._idParse)},g._inherits(t._IdMap,b)}.call(this),function(){t._CachingChangeObserver=function(e){var i=this;e=e||{};var n=e.callbacks&&t._observeChangesCallbacksAreOrdered(e.callbacks);if(y.has(e,"ordered")){if(i.ordered=e.ordered,e.callbacks&&e.ordered!==n)throw Error("ordered option doesn't match callbacks")}else{if(!e.callbacks)throw Error("must provide ordered or callbacks");i.ordered=n}var r=e.callbacks||{};i.ordered?(i.docs=new x(t._idStringify),i.applyChange={addedBefore:function(t,e,n){var s=_.clone(e);s._id=t,r.addedBefore&&r.addedBefore.call(i,t,e,n),r.added&&r.added.call(i,t,e),i.docs.putBefore(t,s,n||null)},movedBefore:function(t,e){i.docs.get(t);r.movedBefore&&r.movedBefore.call(i,t,e),i.docs.moveBefore(t,e||null)}}):(i.docs=new t._IdMap,i.applyChange={added:function(t,e){var n=_.clone(e);r.added&&r.added.call(i,t,e),n._id=t,i.docs.set(t,n)}}),i.applyChange.changed=function(e,n){var s=i.docs.get(e);if(!s)throw new Error("Unknown id for changed: "+e);r.changed&&r.changed.call(i,e,_.clone(n)),t._applyChanges(s,n)},i.applyChange.removed=function(t){r.removed&&r.removed.call(i,t),i.docs.remove(t)}},t._observeFromObserveChanges=function(e,i){var n,r=e.getTransform()||function(t){return t},s=!!i._suppress_initial;if(t._observeCallbacksAreOrdered(i)){var o=!i._no_indices;n={addedBefore:function(t,e,n){var a=this;if(!s&&(i.addedAt||i.added)){var h=r(y.extend(e,{_id:t}));if(i.addedAt){var u=o?n?a.docs.indexOf(n):a.docs.size():-1;i.addedAt(h,u,n)}else i.added(h)}},changed:function(e,n){var s=this;if(i.changedAt||i.changed){var a=_.clone(s.docs.get(e));if(!a)throw new Error("Unknown id for changed: "+e);var h=r(_.clone(a));if(t._applyChanges(a,n),a=r(a),i.changedAt){var u=o?s.docs.indexOf(e):-1;i.changedAt(a,h,u)}else i.changed(a,h)}},movedBefore:function(t,e){var n=this;if(i.movedTo){var s=o?n.docs.indexOf(t):-1,a=o?e?n.docs.indexOf(e):n.docs.size():-1;a>s&&--a,i.movedTo(r(_.clone(n.docs.get(t))),s,a,e||null)}},removed:function(t){var e=this;if(i.removedAt||i.removed){var n=r(e.docs.get(t));if(i.removedAt){var s=o?e.docs.indexOf(t):-1;i.removedAt(n,s)}else i.removed(n)}}}}else n={added:function(t,e){if(!s&&i.added){var n=y.extend(e,{_id:t});i.added(r(n))}},changed:function(e,n){var s=this;if(i.changed){var o=s.docs.get(e),a=_.clone(o);t._applyChanges(a,n),i.changed(r(a),r(o))}},removed:function(t){var e=this;i.removed&&i.removed(r(e.docs.get(t)))}};var a=new t._CachingChangeObserver({callbacks:n}),h=e.observeChanges(a.applyChange);return s=!1,a.ordered&&(h._fetch=function(){var t=[];return a.docs.forEach(function(e){t.push(r(_.clone(e)))}),t}),h}}.call(this),function(){t._looksLikeObjectID=function(t){return 24===t.length&&t.match(/^[0-9a-f]*$/)},t._ObjectID=function(e){var i=this;if(e){if(e=e.toLowerCase(),!t._looksLikeObjectID(e))throw new Error("Invalid hexadecimal string for creating an ObjectID");i._str=e}else i._str=T.hexString(24)},t._ObjectID.prototype.toString=function(){var t=this;return'ObjectID("'+t._str+'")'},t._ObjectID.prototype.equals=function(e){var i=this;return e instanceof t._ObjectID&&i.valueOf()===e.valueOf()},t._ObjectID.prototype.clone=function(){var e=this;return new t._ObjectID(e._str)},t._ObjectID.prototype.typeName=function(){return"oid"},t._ObjectID.prototype.getTimestamp=function(){var t=this;return parseInt(t._str.substr(0,8),16)},t._ObjectID.prototype.valueOf=t._ObjectID.prototype.toJSONValue=t._ObjectID.prototype.toHexString=function(){return this._str},t._selectorIsId=function(e){return"string"==typeof e||"number"==typeof e||e instanceof t._ObjectID},t._selectorIsIdPerhapsAsObject=function(e){return t._selectorIsId(e)||e&&"object"==typeof e&&e._id&&t._selectorIsId(e._id)&&1===y.size(e)},t._idsMatchedBySelector=function(e){if(t._selectorIsId(e))return[e];if(!e)return null;if(y.has(e,"_id"))return t._selectorIsId(e._id)?[e._id]:e._id&&e._id.$in&&y.isArray(e._id.$in)&&!y.isEmpty(e._id.$in)&&y.all(e._id.$in,t._selectorIsId)?e._id.$in:null;if(e.$and&&y.isArray(e.$and))for(var i=0;i<e.$and.length;++i){var n=t._idsMatchedBySelector(e.$and[i]);if(n)return n}return null},_.addType("oid",function(e){return new t._ObjectID(e)})}.call(this),"undefined"==typeof Package&&(Package={}),Package.minimongo={LocalCollection:t,Minimongo:e,MinimongoTest:i}}(),function(){var t,e,i=Package.meteor.Meteor,n=Package.underscore._,r=Package.ejson.EJSON;(function(){var s=new i.EnvironmentVariable;t=function(t,i){var n=s.get();n&&n.checking(t);try{l(t,i)}catch(r){throw r instanceof e.Error&&r.path&&(r.message+=" in field "+r.path),r}},e={Optional:function(t){return new o(t)},OneOf:function(){return new a(n.toArray(arguments))},Any:["__any__"],Where:function(t){return new h(t)},ObjectIncluding:function(t){return new u(t)},Integer:["__integer__"],Error:i.makeErrorType("Match.Error",function(t){this.message="Match error: "+t,this.path="",this.sanitizedError=new i.Error(400,"Match failed")}),test:function(t,i){try{return l(t,i),!0}catch(n){if(n instanceof e.Error)return!1;throw n}},_failIfArgumentsAreNotAllChecked:function(t,e,i,n){var r=new d(i,n),o=s.withValue(r,function(){return t.apply(e,i)});return r.throwUnlessAllArgumentsHaveBeenChecked(),o}};var o=function(t){this.pattern=t},a=function(t){if(n.isEmpty(t))throw new Error("Must provide at least one choice to Match.OneOf");this.choices=t},h=function(t){this.condition=t},u=function(t){this.pattern=t},c=[[String,"string"],[Number,"number"],[Boolean,"boolean"],[void 0,"undefined"]],l=function(t,i){if(i!==e.Any){for(var s=0;s<c.length;++s)if(i===c[s][0]){if(typeof t===c[s][1])return;throw new e.Error("Expected "+c[s][1]+", got "+typeof t)}if(null===i){if(null===t)return;throw new e.Error("Expected null, got "+r.stringify(t))}if(i===e.Integer){if("number"==typeof t&&(0|t)===t)return;throw new e.Error("Expected Integer, got "+(t instanceof Object?r.stringify(t):t))}if(i===Object&&(i=e.ObjectIncluding({})),i instanceof Array){if(1!==i.length)throw Error("Bad pattern: arrays must have one type element"+r.stringify(i));if(!n.isArray(t)&&!n.isArguments(t))throw new e.Error("Expected array, got "+r.stringify(t));return n.each(t,function(t,n){try{l(t,i[0])}catch(r){throw r instanceof e.Error&&(r.path=f(n,r.path)),r}}),void 0}if(i instanceof h){if(i.condition(t))return;throw new e.Error("Failed Match.Where validation")}if(i instanceof o&&(i=e.OneOf(void 0,i.pattern)),i instanceof a){for(var s=0;s<i.choices.length;++s)try{return l(t,i.choices[s]),void 0}catch(d){if(!(d instanceof e.Error))throw d}throw new e.Error("Failed Match.OneOf or Match.Optional validation")}if(i instanceof Function){if(t instanceof i)return;throw new e.Error("Expected "+i.name)}var p=!1;if(i instanceof u&&(p=!0,i=i.pattern),"object"!=typeof i)throw Error("Bad pattern: unknown pattern type");if("object"!=typeof t)throw new e.Error("Expected object, got "+typeof t);if(null===t)throw new e.Error("Expected object, got null");if(t.constructor!==Object)throw new e.Error("Expected plain object");var m={},g={};n.each(i,function(t,e){t instanceof o?g[e]=t.pattern:m[e]=t}),n.each(t,function(t,i){try{if(n.has(m,i))l(t,m[i]),delete m[i];else if(n.has(g,i))l(t,g[i]);else if(!p)throw new e.Error("Unknown key")}catch(r){throw r instanceof e.Error&&(r.path=f(i,r.path)),r}}),n.each(m,function(t,i){throw new e.Error("Missing key '"+i+"'")})}},d=function(t,e){var i=this;i.args=n.clone(t),i.args.reverse(),i.description=e};n.extend(d.prototype,{checking:function(t){var e=this;e._checkingOneValue(t)||(n.isArray(t)||n.isArguments(t))&&n.each(t,n.bind(e._checkingOneValue,e))},_checkingOneValue:function(t){for(var e=this,i=0;i<e.args.length;++i)if(t===e.args[i])return e.args.splice(i,1),!0;return!1},throwUnlessAllArgumentsHaveBeenChecked:function(){var t=this;if(!n.isEmpty(t.args))throw new Error("Did not check() all arguments during "+t.description)}});var p=["do","if","in","for","let","new","try","var","case","else","enum","eval","false","null","this","true","void","with","break","catch","class","const","super","throw","while","yield","delete","export","import","public","return","static","switch","typeof","default","extends","finally","package","private","continue","debugger","function","arguments","interface","protected","implements","instanceof"],f=function(t,e){return"number"==typeof t||t.match(/^[0-9]+$/)?t="["+t+"]":(!t.match(/^[a-z_$][0-9a-z_$]*$/i)||n.contains(p,t))&&(t=JSON.stringify([t])),e&&"["!==e[0]?t+"."+e:t+e}}).call(this),"undefined"==typeof Package&&(Package={}),Package.check={check:t,Match:e}}(),function(){var t,e=Package.meteor.Meteor,i=Package.underscore._,n=Package.random.Random;(function(){t=function(t){var e=this;i.extend(e,i.defaults(i.clone(t||{}),{baseTimeout:1e3,exponent:2.2,maxTimeout:3e5,minTimeout:10,minCount:2,fuzz:.5})),e.retryTimer=null},i.extend(t.prototype,{clear:function(){var t=this;t.retryTimer&&clearTimeout(t.retryTimer),t.retryTimer=null},_timeout:function(t){var e=this;if(t<e.minCount)return e.minTimeout;var i=Math.min(e.maxTimeout,e.baseTimeout*Math.pow(e.exponent,t));return i*=n.fraction()*e.fuzz+(1-e.fuzz/2)},retryLater:function(t,i){var n=this,r=n._timeout(t);return n.retryTimer&&clearTimeout(n.retryTimer),n.retryTimer=e.setTimeout(i,r),r}})}).call(this),"undefined"==typeof Package&&(Package={}),Package.retry={Retry:t}}(),function(){var t,e=Package.meteor.Meteor,i=Package.underscore._,n=(Package.logging.Log,Package.json.JSON);(function(){var r,s="Meteor_Reload",o=3e4,a={};"undefined"!=typeof sessionStorage&&sessionStorage&&(r=sessionStorage.getItem(s),sessionStorage.removeItem(s)),r||(r="{}");var h={};try{h=n.parse(r),"object"!=typeof h&&(e._debug("Got bad data on reload. Ignoring."),h={})}catch(u){e._debug("Got invalid JSON on reload. Ignoring.")}h.reload&&"object"==typeof h.data&&h.time+o>(new Date).getTime()&&(a=h.data);var c=[];t={},t._onMigrate=function(t,e){e||(e=t,t=void 0),c.push({name:t,callback:e})},t._migrationData=function(t){return a[t]};var l=!1;t._reload=function(){if(!l){l=!0;var t=function(){i.defer(function(){for(var r={},o=i.clone(c);o.length;){var a=o.shift(),h=a.callback(t);if(!h[0])return;h.length>1&&a.name&&(r[a.name]=h[1])}try{var u=n.stringify({time:(new Date).getTime(),data:r,reload:!0})}catch(l){throw e._debug("Couldn't serialize data for migration",r),l}if("undefined"!=typeof sessionStorage&&sessionStorage)try{sessionStorage.setItem(s,u)}catch(l){e._debug("Couldn't save data for migration to sessionStorage",l)
}else e._debug("Browser does not support sessionStorage. Not saving migration state.");window.location.reload()})};t()}}}).call(this),function(){e._reload={onMigrate:t._onMigrate,migrationData:t._migrationData,reload:t._reload}}.call(this),"undefined"==typeof Package&&(Package={}),Package.reload={Reload:t}}(),function(){{var t,e,i,n,r,s,o,a,h,u,c,l,d,p=Package.meteor.Meteor,f=(Package.check.check,Package.check.Match,Package.random.Random),m=Package.ejson.EJSON,g=Package.json.JSON,y=Package.underscore._,v=Package.deps.Deps,_=(Package.logging.Log,Package.retry.Retry),b=Package.minimongo.LocalCollection;Package.minimongo.Minimongo}(function(){e={}}).call(this),function(){i=function(){var t=document,e=window,i={},n=function(){};n.prototype.addEventListener=function(t,e){this._listeners||(this._listeners={}),t in this._listeners||(this._listeners[t]=[]);var n=this._listeners[t];-1===i.arrIndexOf(n,e)&&n.push(e)},n.prototype.removeEventListener=function(t,e){if(this._listeners&&t in this._listeners){var n=this._listeners[t],r=i.arrIndexOf(n,e);return-1!==r?(n.length>1?this._listeners[t]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[t],void 0):void 0}},n.prototype.dispatchEvent=function(t){var e=t.type,i=Array.prototype.slice.call(arguments,0);if(this["on"+e]&&this["on"+e].apply(this,i),this._listeners&&e in this._listeners)for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].apply(this,i)};var r=function(t,e){if(this.type=t,"undefined"!=typeof e)for(var i in e)e.hasOwnProperty(i)&&(this[i]=e[i])};r.prototype.toString=function(){var t=[];for(var e in this)if(this.hasOwnProperty(e)){var i=this[e];"function"==typeof i&&(i="[function]"),t.push(e+"="+i)}return"SimpleEvent("+t.join(", ")+")"};var s=function(t){var e=this;e._events=t||[],e._listeners={}};s.prototype.emit=function(t){var e=this;if(e._verifyType(t),!e._nuked){var i=Array.prototype.slice.call(arguments,1);if(e["on"+t]&&e["on"+t].apply(e,i),t in e._listeners)for(var n=0;n<e._listeners[t].length;n++)e._listeners[t][n].apply(e,i)}},s.prototype.on=function(t,e){var i=this;i._verifyType(t),i._nuked||(t in i._listeners||(i._listeners[t]=[]),i._listeners[t].push(e))},s.prototype._verifyType=function(t){var e=this;-1===i.arrIndexOf(e._events,t)&&i.log("Event "+g.stringify(t)+" not listed "+g.stringify(e._events)+" in "+e)},s.prototype.nuke=function(){var t=this;t._nuked=!0;for(var e=0;e<t._events.length;e++)delete t[t._events[e]];t._listeners={}};var o="abcdefghijklmnopqrstuvwxyz0123456789_";i.random_string=function(t,e){e=e||o.length;var i,n=[];for(i=0;t>i;i++)n.push(o.substr(Math.floor(Math.random()*e),1));return n.join("")},i.random_number=function(t){return Math.floor(Math.random()*t)},i.random_number_string=function(t){var e=(""+(t-1)).length,n=Array(e+1).join("0");return(n+i.random_number(t)).slice(-e)},i.getOrigin=function(t){t+="/";var e=t.split("/").slice(0,3);return e.join("/")},i.isSameOriginUrl=function(t,i){return i||(i=e.location.href),t.split("/").slice(0,3).join("/")===i.split("/").slice(0,3).join("/")},i.isSameOriginScheme=function(t,i){return i||(i=e.location.href),t.split(":")[0]===i.split(":")[0]},i.getParentDomain=function(t){if(/^[0-9.]*$/.test(t))return t;if(/^\[/.test(t))return t;if(!/[.]/.test(t))return t;var e=t.split(".").slice(1);return e.join(".")},i.objectExtend=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t};var a="_jp";i.polluteGlobalNamespace=function(){a in e||(e[a]={})},i.closeFrame=function(t,e){return"c"+g.stringify([t,e])},i.userSetCode=function(t){return 1e3===t||t>=3e3&&4999>=t},i.countRTO=function(t){var e;return e=t>100?3*t:t+200},i.log=function(){e.console&&console.log&&console.log.apply&&console.log.apply(console,arguments)},i.bind=function(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}},i.flatUrl=function(t){return-1===t.indexOf("?")&&-1===t.indexOf("#")},i.amendUrl=function(e,n){var r;if(void 0===n)r=t.location;else{var s=/^([a-z0-9.+-]+:)/i.exec(n);if(s){var o=s[0].toLowerCase(),a=n.substring(o.length),h=/[a-z0-9\.-]+(:[0-9]+)?/.exec(a);if(h)var u=h[0]}if(!o||!u)throw new Error("relativeTo must be an absolute url");r={protocol:o,host:u}}if(!e)throw new Error("Wrong url for SockJS");if(!i.flatUrl(e))throw new Error("Only basic urls are supported in SockJS");0===e.indexOf("//")&&(e=r.protocol+e),0===e.indexOf("/")&&(e=r.protocol+"//"+r.host+e),e=e.replace(/[/]+$/,"");var c=e.split("/");return("http:"===c[0]&&/:80$/.test(c[2])||"https:"===c[0]&&/:443$/.test(c[2]))&&(c[2]=c[2].replace(/:(80|443)$/,"")),e=c.join("/")},i.arrIndexOf=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},i.arrSkip=function(t,e){var n=i.arrIndexOf(t,e);if(-1===n)return t.slice();var r=t.slice(0,n);return r.concat(t.slice(n+1))},i.isArray=Array.isArray||function(t){return{}.toString.call(t).indexOf("Array")>=0},i.delay=function(t,e){return"function"==typeof t&&(e=t,t=0),setTimeout(e,t)};var h,u=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\x00":"\\u0000","":"\\u0001","":"\\u0002","":"\\u0003","":"\\u0004","":"\\u0005","":"\\u0006","":"\\u0007","\b":"\\b","	":"\\t","\n":"\\n","":"\\u000b","\f":"\\f","\r":"\\r","":"\\u000e","":"\\u000f","":"\\u0010","":"\\u0011","":"\\u0012","":"\\u0013","":"\\u0014","":"\\u0015","":"\\u0016","":"\\u0017","":"\\u0018","":"\\u0019","":"\\u001a","":"\\u001b","":"\\u001c","":"\\u001d","":"\\u001e","":"\\u001f",'"':'\\"',"\\":"\\\\","":"\\u007f","":"\\u0080","":"\\u0081","":"\\u0082","":"\\u0083","":"\\u0084","":"\\u0085","":"\\u0086","":"\\u0087","":"\\u0088","":"\\u0089","":"\\u008a","":"\\u008b","":"\\u008c","":"\\u008d","":"\\u008e","":"\\u008f","":"\\u0090","":"\\u0091","":"\\u0092","":"\\u0093","":"\\u0094","":"\\u0095","":"\\u0096","":"\\u0097","":"\\u0098","":"\\u0099","":"\\u009a","":"\\u009b","":"\\u009c","":"\\u009d","":"\\u009e","":"\\u009f","­":"\\u00ad","؀":"\\u0600","؁":"\\u0601","؂":"\\u0602","؃":"\\u0603","؄":"\\u0604","܏":"\\u070f","឴":"\\u17b4","឵":"\\u17b5","‌":"\\u200c","‍":"\\u200d","‎":"\\u200e","‏":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","‪":"\\u202a","‫":"\\u202b","‬":"\\u202c","‭":"\\u202d","‮":"\\u202e"," ":"\\u202f","⁠":"\\u2060","⁡":"\\u2061","⁢":"\\u2062","⁣":"\\u2063","⁤":"\\u2064","⁥":"\\u2065","⁦":"\\u2066","⁧":"\\u2067","⁨":"\\u2068","⁩":"\\u2069","⁪":"\\u206a","⁫":"\\u206b","⁬":"\\u206c","⁭":"\\u206d","⁮":"\\u206e","⁯":"\\u206f","﻿":"\\ufeff","￰":"\\ufff0","￱":"\\ufff1","￲":"\\ufff2","￳":"\\ufff3","￴":"\\ufff4","￵":"\\ufff5","￶":"\\ufff6","￷":"\\ufff7","￸":"\\ufff8","￹":"\\ufff9","￺":"\\ufffa","￻":"\\ufffb","￼":"\\ufffc","�":"\\ufffd","￾":"\\ufffe","￿":"\\uffff"},l=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,d=g&&g.stringify||function(t){return u.lastIndex=0,u.test(t)&&(t=t.replace(u,function(t){return c[t]})),'"'+t+'"'},p=function(t){var e,i={},n=[];for(e=0;65536>e;e++)n.push(String.fromCharCode(e));return t.lastIndex=0,n.join("").replace(t,function(t){return i[t]="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,i};i.quote=function(t){var e=d(t);return l.lastIndex=0,l.test(e)?(h||(h=p(l)),e.replace(l,function(t){return h[t]})):e};var f=["websocket","xdr-streaming","xhr-streaming","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"];i.probeProtocols=function(){for(var t={},e=0;e<f.length;e++){var i=f[e];t[i]=C[i]&&C[i].enabled()}return t},i.detectProtocols=function(t,e,i){var n={},r=[];e||(e=f);for(var s=0;s<e.length;s++){var o=e[s];n[o]=t[o]}var a=function(t){var e=t.shift();n[e]?r.push(e):t.length>0&&a(t)};return i.websocket!==!1&&a(["websocket"]),n["xhr-streaming"]&&!i.null_origin?r.push("xhr-streaming"):!n["xdr-streaming"]||i.cookie_needed||i.null_origin?a(["iframe-eventsource","iframe-htmlfile"]):r.push("xdr-streaming"),n["xhr-polling"]&&!i.null_origin?r.push("xhr-polling"):!n["xdr-polling"]||i.cookie_needed||i.null_origin?a(["iframe-xhr-polling","jsonp-polling"]):r.push("xdr-polling"),r};var m="_sockjs_global";i.createHook=function(){var t="a"+i.random_string(8);if(!(m in e)){var n={};e[m]=function(t){return t in n||(n[t]={id:t,del:function(){delete n[t]}}),n[t]}}return e[m](t)},i.attachMessage=function(t){i.attachEvent("message",t)},i.attachEvent=function(i,n){"undefined"!=typeof e.addEventListener?e.addEventListener(i,n,!1):(t.attachEvent("on"+i,n),e.attachEvent("on"+i,n))},i.detachMessage=function(t){i.detachEvent("message",t)},i.detachEvent=function(i,n){"undefined"!=typeof e.addEventListener?e.removeEventListener(i,n,!1):(t.detachEvent("on"+i,n),e.detachEvent("on"+i,n))};var y={},v=!1,_=function(){for(var t in y)y[t](),delete y[t]},b=function(){v||(v=!0,_())};i.attachEvent("unload",b),i.unload_add=function(t){var e=i.random_string(8);return y[e]=t,v&&i.delay(_),e},i.unload_del=function(t){t in y&&delete y[t]},i.createIframe=function(e,n){var r,s,o=t.createElement("iframe"),a=function(){clearTimeout(r);try{o.onload=null}catch(t){}o.onerror=null},h=function(){o&&(a(),setTimeout(function(){o&&o.parentNode.removeChild(o),o=null},0),i.unload_del(s))},u=function(t){o&&(h(),n(t))},c=function(t,e){try{o&&o.contentWindow&&o.contentWindow.postMessage(t,e)}catch(i){}};return o.src=e,o.style.display="none",o.style.position="absolute",o.onerror=function(){u("onerror")},o.onload=function(){clearTimeout(r),r=setTimeout(function(){u("onload timeout")},2e3)},t.body.appendChild(o),r=setTimeout(function(){u("timeout")},15e3),s=i.unload_add(h),{post:c,cleanup:h,loaded:a}},i.createHtmlfile=function(t,n){var r,s,o,h=new ActiveXObject("htmlfile"),u=function(){clearTimeout(r)},c=function(){h&&(u(),i.unload_del(s),o.parentNode.removeChild(o),o=h=null,CollectGarbage())},l=function(t){h&&(c(),n(t))},d=function(t,e){try{o&&o.contentWindow&&o.contentWindow.postMessage(t,e)}catch(i){}};h.open(),h.write('<html><script>document.domain="'+document.domain+'";</script></html>'),h.close(),h.parentWindow[a]=e[a];var p=h.createElement("div");return h.body.appendChild(p),o=h.createElement("iframe"),p.appendChild(o),o.src=t,r=setTimeout(function(){l("timeout")},15e3),s=i.unload_add(c),{post:d,cleanup:c,loaded:u}};var x=function(){};x.prototype=new s(["chunk","finish"]),x.prototype._start=function(t,n,r,s){var o=this;try{o.xhr=new XMLHttpRequest}catch(a){}if(!o.xhr)try{o.xhr=new e.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}(e.ActiveXObject||e.XDomainRequest)&&(n+=(-1===n.indexOf("?")?"?":"&")+"t="+ +new Date),o.unload_ref=i.unload_add(function(){o._cleanup(!0)});try{o.xhr.open(t,n,!0)}catch(h){return o.emit("finish",0,""),o._cleanup(),void 0}if(s&&s.no_credentials||(o.xhr.withCredentials="true"),s&&s.headers)for(var u in s.headers)o.xhr.setRequestHeader(u,s.headers[u]);o.xhr.onreadystatechange=function(){if(o.xhr){var t=o.xhr;switch(t.readyState){case 3:try{var e=t.status,i=t.responseText}catch(t){}1223===e&&(e=204),i&&i.length>0&&o.emit("chunk",e,i);break;case 4:var e=t.status;1223===e&&(e=204),o.emit("finish",e,t.responseText),o._cleanup(!1)}}},o.xhr.send(r)},x.prototype._cleanup=function(t){var e=this;if(e.xhr){if(i.unload_del(e.unload_ref),e.xhr.onreadystatechange=function(){},t)try{e.xhr.abort()}catch(n){}e.unload_ref=e.xhr=null}},x.prototype.close=function(){var t=this;t.nuke(),t._cleanup(!0)};var w=i.XHRCorsObject=function(){var t=this,e=arguments;i.delay(function(){t._start.apply(t,e)})};w.prototype=new x;var T=i.XHRLocalObject=function(t,e,n){var r=this;i.delay(function(){r._start(t,e,n,{no_credentials:!0})})};T.prototype=new x;var S=i.XDRObject=function(t,e,n){var r=this;i.delay(function(){r._start(t,e,n)})};S.prototype=new s(["chunk","finish"]),S.prototype._start=function(t,e,n){var r=this,s=new XDomainRequest;e+=(-1===e.indexOf("?")?"?":"&")+"t="+ +new Date;var o=s.ontimeout=s.onerror=function(){r.emit("finish",0,""),r._cleanup(!1)};s.onprogress=function(){r.emit("chunk",200,s.responseText)},s.onload=function(){r.emit("finish",200,s.responseText),r._cleanup(!1)},r.xdr=s,r.unload_ref=i.unload_add(function(){r._cleanup(!0)});try{r.xdr.open(t,e),r.xdr.send(n)}catch(a){o()}},S.prototype._cleanup=function(t){var e=this;if(e.xdr){if(i.unload_del(e.unload_ref),e.xdr.ontimeout=e.xdr.onerror=e.xdr.onprogress=e.xdr.onload=null,t)try{e.xdr.abort()}catch(n){}e.unload_ref=e.xdr=null}},S.prototype.close=function(){var t=this;t.nuke(),t._cleanup(!0)},i.isXHRCorsCapable=function(){return e.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?1:e.XDomainRequest&&t.domain?2:F.enabled()?3:4};var C=function(t,e,n){if(!(this instanceof C))return new C(t,e,n);var r,s=this;s._options={devel:!1,debug:!1,protocols_whitelist:[],info:void 0,rtt:void 0},n&&i.objectExtend(s._options,n),s._base_url=i.amendUrl(t),s._server=s._options.server||i.random_number_string(1e3),s._options.protocols_whitelist&&s._options.protocols_whitelist.length?r=s._options.protocols_whitelist:(r="string"==typeof e&&e.length>0?[e]:i.isArray(e)?e:null,r&&s._debug('Deprecated API: Use "protocols_whitelist" option instead of supplying protocol list as a second parameter to SockJS constructor.')),s._protocols=[],s.protocol=null,s.readyState=C.CONNECTING,s._ir=V(s._base_url),s._ir.onfinish=function(t,e){s._ir=null,t?(s._options.info&&(t=i.objectExtend(t,s._options.info)),s._options.rtt&&(e=s._options.rtt),s._applyInfo(t,e,r),s._didClose()):s._didClose(1002,"Can't connect to server",!0)}};C.prototype=new n,C.version="0.3.4",C.CONNECTING=0,C.OPEN=1,C.CLOSING=2,C.CLOSED=3,C.prototype._debug=function(){this._options.debug&&i.log.apply(i,arguments)},C.prototype._dispatchOpen=function(){var t=this;t.readyState===C.CONNECTING?(t._transport_tref&&(clearTimeout(t._transport_tref),t._transport_tref=null),t.readyState=C.OPEN,t.dispatchEvent(new r("open"))):t._didClose(1006,"Server lost session")},C.prototype._dispatchMessage=function(t){var e=this;e.readyState===C.OPEN&&e.dispatchEvent(new r("message",{data:t}))},C.prototype._dispatchHeartbeat=function(){var t=this;t.readyState===C.OPEN&&t.dispatchEvent(new r("heartbeat",{}))},C.prototype._didClose=function(t,e,n){var s=this;if(s.readyState!==C.CONNECTING&&s.readyState!==C.OPEN&&s.readyState!==C.CLOSING)throw new Error("INVALID_STATE_ERR");s._ir&&(s._ir.nuke(),s._ir=null),s._transport&&(s._transport.doCleanup(),s._transport=null);var o=new r("close",{code:t,reason:e,wasClean:i.userSetCode(t)});if(!i.userSetCode(t)&&s.readyState===C.CONNECTING&&!n){if(s._try_next_protocol(o))return;o=new r("close",{code:2e3,reason:"All transports failed",wasClean:!1,last_event:o})}s.readyState=C.CLOSED,i.delay(function(){s.dispatchEvent(o)})},C.prototype._didMessage=function(t){var e=this,i=t.slice(0,1);switch(i){case"o":e._dispatchOpen();break;case"a":for(var n=g.parse(t.slice(1)||"[]"),r=0;r<n.length;r++)e._dispatchMessage(n[r]);break;case"m":var n=g.parse(t.slice(1)||"null");e._dispatchMessage(n);break;case"c":var n=g.parse(t.slice(1)||"[]");e._didClose(n[0],n[1]);break;case"h":e._dispatchHeartbeat()}},C.prototype._try_next_protocol=function(e){var n=this;for(n.protocol&&(n._debug("Closed transport:",n.protocol,""+e),n.protocol=null),n._transport_tref&&(clearTimeout(n._transport_tref),n._transport_tref=null);;){var r=n.protocol=n._protocols.shift();if(!r)return!1;if(C[r]&&C[r].need_body===!0&&(!t.body||"undefined"!=typeof t.readyState&&"complete"!==t.readyState))return n._protocols.unshift(r),n.protocol="waiting-for-load",i.attachEvent("load",function(){n._try_next_protocol()}),!0;if(C[r]&&C[r].enabled(n._options)){var s=C[r].roundTrips||1,o=(n._options.rto||0)*s||5e3;n._transport_tref=i.delay(o,function(){n.readyState===C.CONNECTING&&n._didClose(2007,"Transport timeouted")});var a=i.random_string(8),h=n._base_url+"/"+n._server+"/"+a;return n._debug("Opening transport:",r," url:"+h," RTO:"+n._options.rto),n._transport=new C[r](n,h,n._base_url),!0}n._debug("Skipping transport:",r)}},C.prototype.close=function(t,e){var n=this;if(t&&!i.userSetCode(t))throw new Error("INVALID_ACCESS_ERR");return n.readyState!==C.CONNECTING&&n.readyState!==C.OPEN?!1:(n.readyState=C.CLOSING,n._didClose(t||1e3,e||"Normal closure"),!0)},C.prototype.send=function(t){var e=this;if(e.readyState===C.CONNECTING)throw new Error("INVALID_STATE_ERR");return e.readyState===C.OPEN&&e._transport.doSend(i.quote(""+t)),!0},C.prototype._applyInfo=function(e,n,r){var s=this;s._options.info=e,s._options.rtt=n,s._options.rto=i.countRTO(n),s._options.info.null_origin=!t.domain,e.base_url&&(s._base_url=i.amendUrl(e.base_url,s._base_url));var o=i.probeProtocols();s._protocols=i.detectProtocols(o,r,e),i.isSameOriginScheme(s._base_url)||2!==i.isXHRCorsCapable()||(s._protocols=["jsonp-polling"])};var P=C.websocket=function(t,n){var r=this,s=n+"/websocket";s="https"===s.slice(0,5)?"wss"+s.slice(5):"ws"+s.slice(4),r.ri=t,r.url=s;var o=e.WebSocket||e.MozWebSocket;r.ws=new o(r.url),r.ws.onmessage=function(t){r.ri._didMessage(t.data)},r.unload_ref=i.unload_add(function(){r.ws.close()}),r.ws.onclose=function(){r.ri._didMessage(i.closeFrame(1006,"WebSocket connection broken"))}};P.prototype.doSend=function(t){this.ws.send("["+t+"]")},P.prototype.doCleanup=function(){var t=this,e=t.ws;e&&(e.onmessage=e.onclose=null,e.close(),i.unload_del(t.unload_ref),t.unload_ref=t.ri=t.ws=null)},P.enabled=function(){return!(!e.WebSocket&&!e.MozWebSocket)},P.roundTrips=2;var k=function(){};k.prototype.send_constructor=function(t){var e=this;e.send_buffer=[],e.sender=t},k.prototype.doSend=function(t){var e=this;e.send_buffer.push(t),e.send_stop||e.send_schedule()},k.prototype.send_schedule_wait=function(){var t,e=this;e.send_stop=function(){e.send_stop=null,clearTimeout(t)},t=i.delay(25,function(){e.send_stop=null,e.send_schedule()})},k.prototype.send_schedule=function(){var t=this;if(t.send_buffer.length>0){var e="["+t.send_buffer.join(",")+"]";t.send_stop=t.sender(t.trans_url,e,function(e,i){t.send_stop=null,e===!1?t.ri._didClose(1006,"Sending error "+i):t.send_schedule_wait()}),t.send_buffer=[]}},k.prototype.send_destructor=function(){var t=this;t._send_stop&&t._send_stop(),t._send_stop=null};var E=function(e,n,r){var s=this;if(!("_send_form"in s)){var o=s._send_form=t.createElement("form"),a=s._send_area=t.createElement("textarea");a.name="d",o.style.display="none",o.style.position="absolute",o.method="POST",o.enctype="application/x-www-form-urlencoded",o.acceptCharset="UTF-8",o.appendChild(a),t.body.appendChild(o)}var o=s._send_form,a=s._send_area,h="a"+i.random_string(8);o.target=h,o.action=e+"/jsonp_send?i="+h;var u;try{u=t.createElement('<iframe name="'+h+'">')}catch(c){u=t.createElement("iframe"),u.name=h}u.id=h,o.appendChild(u),u.style.display="none";try{a.value=n}catch(l){i.log("Your browser is seriously broken. Go home! "+l.message)}o.submit();var d=function(){u.onerror&&(u.onreadystatechange=u.onerror=u.onload=null,i.delay(500,function(){u.parentNode.removeChild(u),u=null}),a.value="",r(!0))};return u.onerror=u.onload=d,u.onreadystatechange=function(){"complete"==u.readyState&&d()},d},A=function(t){return function(e,i,n){var r=new t("POST",e+"/xhr_send",i);return r.onfinish=function(t){n(200===t||204===t,"http status "+t)},function(t){n(!1,t)}}},O=function(e,n){var r,s,o=t.createElement("script"),a=function(t){s&&(s.parentNode.removeChild(s),s=null),o&&(clearTimeout(r),o.parentNode.removeChild(o),o.onreadystatechange=o.onerror=o.onload=o.onclick=null,o=null,n(t),n=null)},h=!1,u=null;if(o.id="a"+i.random_string(8),o.src=e,o.type="text/javascript",o.charset="UTF-8",o.onerror=function(){u||(u=setTimeout(function(){h||a(i.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))},1e3))},o.onload=function(){a(i.closeFrame(1006,"JSONP script loaded abnormally (onload)"))},o.onreadystatechange=function(){if(/loaded|closed/.test(o.readyState)){if(o&&o.htmlFor&&o.onclick){h=!0;try{o.onclick()}catch(t){}}o&&a(i.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}},"undefined"==typeof o.async&&t.attachEvent)if(/opera/i.test(navigator.userAgent))s=t.createElement("script"),s.text="try{var a = document.getElementById('"+o.id+"'); if(a)a.onerror();}catch(x){};",o.async=s.async=!1;else{try{o.htmlFor=o.id,o.event="onclick"}catch(c){}o.async=!0}"undefined"!=typeof o.async&&(o.async=!0),r=setTimeout(function(){a(i.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35e3);var l=t.getElementsByTagName("head")[0];return l.insertBefore(o,l.firstChild),s&&l.insertBefore(s,l.firstChild),a},M=C["jsonp-polling"]=function(t,e){i.polluteGlobalNamespace();var n=this;n.ri=t,n.trans_url=e,n.send_constructor(E),n._schedule_recv()};M.prototype=new k,M.prototype._schedule_recv=function(){var t=this,e=function(e){t._recv_stop=null,e&&(t._is_closing||t.ri._didMessage(e)),t._is_closing||t._schedule_recv()};t._recv_stop=I(t.trans_url+"/jsonp",O,e)},M.enabled=function(){return!0},M.need_body=!0,M.prototype.doCleanup=function(){var t=this;t._is_closing=!0,t._recv_stop&&t._recv_stop(),t.ri=t._recv_stop=null,t.send_destructor()};var I=function(t,n,r){var s="a"+i.random_string(6),o=t+"?c="+escape(a+"."+s),h=0,u=function(t){switch(h){case 0:delete e[a][s],r(t);break;case 1:r(t),h=2;break;case 2:delete e[a][s]}},c=n(o,u);e[a][s]=c;var l=function(){e[a][s]&&(h=1,e[a][s](i.closeFrame(1e3,"JSONP user aborted read")))};return l},D=function(){};D.prototype=new k,D.prototype.run=function(t,e,i,n,r){var s=this;s.ri=t,s.trans_url=e,s.send_constructor(A(r)),s.poll=new Z(t,n,e+i,r)},D.prototype.doCleanup=function(){var t=this;t.poll&&(t.poll.abort(),t.poll=null)};var R=C["xhr-streaming"]=function(t,e){this.run(t,e,"/xhr_streaming",re,i.XHRCorsObject)};R.prototype=new D,R.enabled=function(){return e.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&!/opera/i.test(navigator.userAgent)},R.roundTrips=2,R.need_body=!0;var L=C["xdr-streaming"]=function(t,e){this.run(t,e,"/xhr_streaming",re,i.XDRObject)};L.prototype=new D,L.enabled=function(){return!!e.XDomainRequest},L.roundTrips=2;var N=C["xhr-polling"]=function(t,e){this.run(t,e,"/xhr",re,i.XHRCorsObject)};N.prototype=new D,N.enabled=R.enabled,N.roundTrips=2;var B=C["xdr-polling"]=function(t,e){this.run(t,e,"/xhr",re,i.XDRObject)};B.prototype=new D,B.enabled=L.enabled,B.roundTrips=2;var F=function(){};F.prototype.i_constructor=function(t,e,n){var r=this;r.ri=t,r.origin=i.getOrigin(n),r.base_url=n,r.trans_url=e;var s=n+"/iframe.html";r.ri._options.devel&&(s+="?t="+ +new Date),r.window_id=i.random_string(8),s+="#"+r.window_id,r.iframeObj=i.createIframe(s,function(t){r.ri._didClose(1006,"Unable to load an iframe ("+t+")")}),r.onmessage_cb=i.bind(r.onmessage,r),i.attachMessage(r.onmessage_cb)},F.prototype.doCleanup=function(){var t=this;if(t.iframeObj){i.detachMessage(t.onmessage_cb);try{t.iframeObj.iframe.contentWindow&&t.postMessage("c")}catch(e){}t.iframeObj.cleanup(),t.iframeObj=null,t.onmessage_cb=t.iframeObj=null}},F.prototype.onmessage=function(t){var e=this;if(t.origin===e.origin){var i=t.data.slice(0,8),n=t.data.slice(8,9),r=t.data.slice(9);if(i===e.window_id)switch(n){case"s":e.iframeObj.loaded(),e.postMessage("s",g.stringify([C.version,e.protocol,e.trans_url,e.base_url]));break;case"t":e.ri._didMessage(r)}}},F.prototype.postMessage=function(t,e){var i=this;i.iframeObj.post(i.window_id+t+(e||""),i.origin)},F.prototype.doSend=function(t){this.postMessage("m",t)},F.enabled=function(){var t=navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Konqueror");return("function"==typeof e.postMessage||"object"==typeof e.postMessage)&&!t};var j,U=function(t,n){parent!==e?parent.postMessage(j+t+(n||""),"*"):i.log("Can't postMessage, no parent window.",t,n)},G=function(){};G.prototype._didClose=function(t,e){U("t",i.closeFrame(t,e))},G.prototype._didMessage=function(t){U("t",t)},G.prototype._doSend=function(t){this._transport.doSend(t)},G.prototype._doCleanup=function(){this._transport.doCleanup()},i.parent_origin=void 0,C.bootstrap_iframe=function(){var n;j=t.location.hash.slice(1);var r=function(t){if(t.source===parent&&("undefined"==typeof i.parent_origin&&(i.parent_origin=t.origin),t.origin===i.parent_origin)){var r=t.data.slice(0,8),s=t.data.slice(8,9),o=t.data.slice(9);if(r===j)switch(s){case"s":var a=g.parse(o),h=a[0],u=a[1],c=a[2],l=a[3];if(h!==C.version&&i.log('Incompatibile SockJS! Main site uses: "'+h+'", the iframe: "'+C.version+'".'),!i.flatUrl(c)||!i.flatUrl(l))return i.log("Only basic urls are supported in SockJS"),void 0;if(!i.isSameOriginUrl(c)||!i.isSameOriginUrl(l))return i.log("Can't connect to different domain from within an iframe. ("+g.stringify([e.location.href,c,l])+")"),void 0;n=new G,n._transport=new G[u](n,c,l);break;case"m":n._doSend(o);break;case"c":n&&n._doCleanup(),n=null}}};i.attachMessage(r),U("s")};var X=function(t,e){var n=this;i.delay(function(){n.doXhr(t,e)})};X.prototype=new s(["finish"]),X.prototype.doXhr=function(t,e){var n=this,r=(new Date).getTime(),s=new e("GET",t+"/info?cb="+i.random_string(10)),o=i.delay(8e3,function(){s.ontimeout()});s.onfinish=function(t,e){if(clearTimeout(o),o=null,200===t){var i=(new Date).getTime()-r,s=g.parse(e);"object"!=typeof s&&(s={}),n.emit("finish",s,i)}else n.emit("finish")},s.ontimeout=function(){s.close(),n.emit("finish")}};var H=function(e){var n=this,r=function(){var t=new F;t.protocol="w-iframe-info-receiver";var i=function(e){if("string"==typeof e&&"m"===e.substr(0,1)){var i=g.parse(e.substr(1)),r=i[0],s=i[1];n.emit("finish",r,s)}else n.emit("finish");t.doCleanup(),t=null},r={_options:{},_didClose:i,_didMessage:i};t.i_constructor(r,e,e)};t.body?r():i.attachEvent("load",r)};H.prototype=new s(["finish"]);var W=function(){var t=this;i.delay(function(){t.emit("finish",{},2e3)})};W.prototype=new s(["finish"]);var V=function(t){if(i.isSameOriginUrl(t))return new X(t,i.XHRLocalObject);switch(i.isXHRCorsCapable()){case 1:return new X(t,i.XHRLocalObject);case 2:return i.isSameOriginScheme(t)?new X(t,i.XDRObject):new W;case 3:return new H(t);default:return new W}},z=G["w-iframe-info-receiver"]=function(t,e,n){var r=new X(n,i.XHRLocalObject);r.onfinish=function(e,i){t._didMessage("m"+g.stringify([e,i])),t._didClose()}};z.prototype.doCleanup=function(){};var Y=C["iframe-eventsource"]=function(){var t=this;t.protocol="w-iframe-eventsource",t.i_constructor.apply(t,arguments)};Y.prototype=new F,Y.enabled=function(){return"EventSource"in e&&F.enabled()},Y.need_body=!0,Y.roundTrips=3;var q=G["w-iframe-eventsource"]=function(t,e){this.run(t,e,"/eventsource",te,i.XHRLocalObject)};q.prototype=new D;var $=C["iframe-xhr-polling"]=function(){var t=this;t.protocol="w-iframe-xhr-polling",t.i_constructor.apply(t,arguments)};$.prototype=new F,$.enabled=function(){return e.XMLHttpRequest&&F.enabled()},$.need_body=!0,$.roundTrips=3;var K=G["w-iframe-xhr-polling"]=function(t,e){this.run(t,e,"/xhr",re,i.XHRLocalObject)};K.prototype=new D;var J=C["iframe-htmlfile"]=function(){var t=this;t.protocol="w-iframe-htmlfile",t.i_constructor.apply(t,arguments)};J.prototype=new F,J.enabled=function(){return F.enabled()},J.need_body=!0,J.roundTrips=3;var Q=G["w-iframe-htmlfile"]=function(t,e){this.run(t,e,"/htmlfile",ne,i.XHRLocalObject)};Q.prototype=new D;var Z=function(t,e,i,n){var r=this;r.ri=t,r.Receiver=e,r.recv_url=i,r.AjaxObject=n,r._scheduleRecv()};Z.prototype._scheduleRecv=function(){var t=this,e=t.poll=new t.Receiver(t.recv_url,t.AjaxObject),i=0;e.onmessage=function(e){i+=1,t.ri._didMessage(e.data)},e.onclose=function(i){t.poll=e=e.onmessage=e.onclose=null,t.poll_is_closing||("permanent"===i.reason?t.ri._didClose(1006,"Polling error ("+i.reason+")"):t._scheduleRecv())}},Z.prototype.abort=function(){var t=this;t.poll_is_closing=!0,t.poll&&t.poll.abort()};var te=function(t){var e=this,n=new EventSource(t);n.onmessage=function(t){e.dispatchEvent(new r("message",{data:unescape(t.data)}))},e.es_close=n.onerror=function(t,s){var o=s?"user":2!==n.readyState?"network":"permanent";e.es_close=n.onmessage=n.onerror=null,n.close(),n=null,i.delay(200,function(){e.dispatchEvent(new r("close",{reason:o}))})}};te.prototype=new n,te.prototype.abort=function(){var t=this;t.es_close&&t.es_close({},!0)};var ee,ie=function(){if(void 0===ee)if("ActiveXObject"in e)try{ee=!!new ActiveXObject("htmlfile")}catch(t){}else ee=!1;return ee},ne=function(t){var n=this;i.polluteGlobalNamespace(),n.id="a"+i.random_string(6,26),t+=(-1===t.indexOf("?")?"?":"&")+"c="+escape(a+"."+n.id);var s,o=ie()?i.createHtmlfile:i.createIframe;e[a][n.id]={start:function(){s.loaded()},message:function(t){n.dispatchEvent(new r("message",{data:t}))},stop:function(){n.iframe_close({},"network")}},n.iframe_close=function(t,i){s.cleanup(),n.iframe_close=s=null,delete e[a][n.id],n.dispatchEvent(new r("close",{reason:i}))},s=o(t,function(){n.iframe_close({},"permanent")})};ne.prototype=new n,ne.prototype.abort=function(){var t=this;t.iframe_close&&t.iframe_close({},"user")};var re=function(t,e){var i=this,n=0;i.xo=new e("POST",t,null),i.xo.onchunk=function(t,e){if(200===t)for(;;){var s=e.slice(n),o=s.indexOf("\n");if(-1===o)break;n+=o+1;var a=s.slice(0,o);i.dispatchEvent(new r("message",{data:a}))}},i.xo.onfinish=function(t,e){i.xo.onchunk(t,e),i.xo=null;var n=200===t?"network":"permanent";i.dispatchEvent(new r("close",{reason:n}))}};return re.prototype=new n,re.prototype.abort=function(){var t=this;t.xo&&(t.xo.close(),t.dispatchEvent(new r("close",{reason:"user"})),t.xo=null)},C.getUtils=function(){return i},C.getIframeTransport=function(){return F},C}(),"_sockjs_onload"in window&&setTimeout(_sockjs_onload,1),"function"==typeof define&&define.amd&&define("sockjs",[],function(){return i})}.call(this),function(){e.ClientStream=function(t,e){var i=this;i.options=y.extend({retry:!0},e),i._initCommon(),i.HEARTBEAT_TIMEOUT=1e5,i.rawUrl=t,i.socket=null,i.heartbeatTimer=null,"undefined"!=typeof window&&window.addEventListener&&window.addEventListener("online",y.bind(i._online,i),!1),i._launchConnection()},y.extend(e.ClientStream.prototype,{send:function(t){var e=this;e.currentStatus.connected&&e.socket.send(t)},_changeUrl:function(t){var e=this;e.rawUrl=t},_connected:function(){var t=this;t.connectionTimer&&(clearTimeout(t.connectionTimer),t.connectionTimer=null),t.currentStatus.connected||(t.currentStatus.status="connected",t.currentStatus.connected=!0,t.currentStatus.retryCount=0,t.statusChanged(),y.each(t.eventCallbacks.reset,function(t){t()}))},_cleanup:function(){var t=this;t._clearConnectionAndHeartbeatTimers(),t.socket&&(t.socket.onmessage=t.socket.onclose=t.socket.onerror=t.socket.onheartbeat=function(){},t.socket.close(),t.socket=null),y.each(t.eventCallbacks.disconnect,function(t){t()})},_clearConnectionAndHeartbeatTimers:function(){var t=this;t.connectionTimer&&(clearTimeout(t.connectionTimer),t.connectionTimer=null),t.heartbeatTimer&&(clearTimeout(t.heartbeatTimer),t.heartbeatTimer=null)},_heartbeat_timeout:function(){var t=this;p._debug("Connection timeout. No sockjs heartbeat received."),t._lostConnection()},_heartbeat_received:function(){var t=this;t._forcedToDisconnect||(t.heartbeatTimer&&clearTimeout(t.heartbeatTimer),t.heartbeatTimer=setTimeout(y.bind(t._heartbeat_timeout,t),t.HEARTBEAT_TIMEOUT))
},_sockjsProtocolsWhitelist:function(){var t=["xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"],e=navigator&&/iPhone|iPad|iPod/.test(navigator.userAgent)&&/OS 4_|OS 5_/.test(navigator.userAgent);return e||(t=["websocket"].concat(t)),t},_launchConnection:function(){var t=this;t._cleanup();var e=y.extend({protocols_whitelist:t._sockjsProtocolsWhitelist()},t.options._sockjsOptions);t.socket=new i(n(t.rawUrl),void 0,e),t.socket.onopen=function(){t._connected()},t.socket.onmessage=function(e){t._heartbeat_received(),t.currentStatus.connected&&y.each(t.eventCallbacks.message,function(t){t(e.data)})},t.socket.onclose=function(){t._lostConnection()},t.socket.onerror=function(){p._debug("stream error",y.toArray(arguments),(new Date).toDateString())},t.socket.onheartbeat=function(){t._heartbeat_received()},t.connectionTimer&&clearTimeout(t.connectionTimer),t.connectionTimer=setTimeout(y.bind(t._lostConnection,t),t.CONNECT_TIMEOUT)}})}.call(this),function(){var t=function(t,e){return t.length>=e.length&&t.substring(0,e.length)===e},i=function(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e},s=function(e,n,r){n||(n="http");var s,o=e.match(/^ddp(i?)\+sockjs:\/\//),a=e.match(/^http(s?):\/\//);if(o){var h=e.substr(o[0].length);s="i"===o[1]?n:n+"s";var u=h.indexOf("/"),c=-1===u?h:h.substr(0,u),l=-1===u?"":h.substr(u);return c=c.replace(/\*/g,function(){return Math.floor(10*f.fraction())}),s+"://"+c+l}if(a){s=a[1]?n+"s":n;var d=e.substr(a[0].length);e=s+"://"+d}return-1!==e.indexOf("://")||t(e,"/")||(e=n+"://"+e),e=p._relativeToSiteRootUrl(e),i(e,"/")?e+r:e+"/"+r};n=function(t){return s(t,"http","sockjs")},r=function(t){var e=s(t,"ws","websocket");return e},e.toSockjsUrl=n,y.extend(e.ClientStream.prototype,{on:function(t,e){var i=this;if("message"!==t&&"reset"!==t&&"disconnect"!==t)throw new Error("unknown event type: "+t);i.eventCallbacks[t]||(i.eventCallbacks[t]=[]),i.eventCallbacks[t].push(e)},_initCommon:function(){var t=this;t.CONNECT_TIMEOUT=1e4,t.eventCallbacks={},t._forcedToDisconnect=!1,t.currentStatus={status:"connecting",connected:!1,retryCount:0},t.statusListeners="undefined"!=typeof v&&new v.Dependency,t.statusChanged=function(){t.statusListeners&&t.statusListeners.changed()},t._retry=new _,t.connectionTimer=null},reconnect:function(t){var e=this;return t=t||{},t.url&&e._changeUrl(t.url),t._sockjsOptions&&(e.options._sockjsOptions=t._sockjsOptions),e.currentStatus.connected?((t._force||t.url)&&e._lostConnection(),void 0):("connecting"===e.currentStatus.status&&e._lostConnection(),e._retry.clear(),e.currentStatus.retryCount-=1,e._retryNow(),void 0)},disconnect:function(t){var e=this;t=t||{},e._forcedToDisconnect||(t._permanent&&(e._forcedToDisconnect=!0),e._cleanup(),e._retry.clear(),e.currentStatus={status:t._permanent?"failed":"offline",connected:!1,retryCount:0},t._permanent&&t._error&&(e.currentStatus.reason=t._error),e.statusChanged())},_lostConnection:function(){var t=this;t._cleanup(),t._retryLater()},_online:function(){"offline"!=this.currentStatus.status&&this.reconnect()},_retryLater:function(){var t=this,e=0;t.options.retry&&(e=t._retry.retryLater(t.currentStatus.retryCount,y.bind(t._retryNow,t))),t.currentStatus.status="waiting",t.currentStatus.connected=!1,t.currentStatus.retryTime=(new Date).getTime()+e,t.statusChanged()},_retryNow:function(){var t=this;t._forcedToDisconnect||(t.currentStatus.retryCount+=1,t.currentStatus.status="connecting",t.currentStatus.connected=!1,delete t.currentStatus.retryTime,t.statusChanged(),t._launchConnection())},status:function(){var t=this;return t.statusListeners&&t.statusListeners.depend(),t.currentStatus}})}.call(this),function(){s=function(t){var e=this;e.heartbeatInterval=t.heartbeatInterval,e.heartbeatTimeout=t.heartbeatTimeout,e._sendPing=t.sendPing,e._onTimeout=t.onTimeout,e._heartbeatIntervalHandle=null,e._heartbeatTimeoutHandle=null},y.extend(s.prototype,{stop:function(){var t=this;t._clearHeartbeatIntervalTimer(),t._clearHeartbeatTimeoutTimer()},start:function(){var t=this;t.stop(),t._startHeartbeatIntervalTimer()},_startHeartbeatIntervalTimer:function(){var t=this;t._heartbeatIntervalHandle=p.setTimeout(y.bind(t._heartbeatIntervalFired,t),t.heartbeatInterval)},_startHeartbeatTimeoutTimer:function(){var t=this;t._heartbeatTimeoutHandle=p.setTimeout(y.bind(t._heartbeatTimeoutFired,t),t.heartbeatTimeout)},_clearHeartbeatIntervalTimer:function(){var t=this;t._heartbeatIntervalHandle&&(p.clearTimeout(t._heartbeatIntervalHandle),t._heartbeatIntervalHandle=null)},_clearHeartbeatTimeoutTimer:function(){var t=this;t._heartbeatTimeoutHandle&&(p.clearTimeout(t._heartbeatTimeoutHandle),t._heartbeatTimeoutHandle=null)},_heartbeatIntervalFired:function(){var t=this;t._heartbeatIntervalHandle=null,t._sendPing(),t._startHeartbeatTimeoutTimer()},_heartbeatTimeoutFired:function(){var t=this;t._heartbeatTimeoutHandle=null,t._onTimeout()},pingReceived:function(){var t=this;t._heartbeatIntervalHandle&&(t._clearHeartbeatIntervalTimer(),t._startHeartbeatIntervalTimer())},pongReceived:function(){var t=this;t._heartbeatTimeoutHandle&&(t._clearHeartbeatTimeoutTimer(),t._startHeartbeatIntervalTimer())}})}.call(this),function(){t={},o=["pre2","pre1"],e.SUPPORTED_DDP_VERSIONS=o,a=function(t){this.isSimulation=t.isSimulation,this._unblock=t.unblock||function(){},this._calledUnblock=!1,this.userId=t.userId,this._setUserId=t.setUserId||function(){},this.connection=t.connection,this.randomSeed=t.randomSeed,this.randomStream=null},y.extend(a.prototype,{unblock:function(){var t=this;t._calledUnblock=!0,t._unblock()},setUserId:function(t){var e=this;if(e._calledUnblock)throw new Error("Can't call setUserId in a method after calling unblock");e.userId=t,e._setUserId(t)}}),h=function(t){try{var e=g.parse(t)}catch(i){return p._debug("Discarding message with invalid JSON",t),null}return null===e||"object"!=typeof e?(p._debug("Discarding non-object DDP message",t),null):(y.has(e,"cleared")&&(y.has(e,"fields")||(e.fields={}),y.each(e.cleared,function(t){e.fields[t]=void 0}),delete e.cleared),y.each(["fields","params","result"],function(t){y.has(e,t)&&(e[t]=m._adjustTypesFromJSONValue(e[t]))}),e)},u=function(t){var e=m.clone(t);if(y.has(t,"fields")){var i=[];y.each(t.fields,function(t,n){void 0===t&&(i.push(n),delete e.fields[n])}),y.isEmpty(i)||(e.cleared=i),y.isEmpty(e.fields)&&delete e.fields}if(y.each(["fields","params","result"],function(t){y.has(e,t)&&(e[t]=m._adjustTypesToJSONValue(e[t]))}),t.id&&"string"!=typeof t.id)throw new Error("Message id is not a string");return g.stringify(e)},t._CurrentInvocation=new p.EnvironmentVariable}.call(this),function(){function e(){return f.hexString(20)}c=function(t){this.seed=[].concat(t.seed||e()),this.sequences={}},c.get=function(t,e){if(e||(e="default"),!t)return f;var i=t.randomStream;return i||(t.randomStream=i=new c({seed:t.randomSeed})),i._sequence(e)},t.randomStream=function(e){var i=t._CurrentInvocation.get();return c.get(i,e)},l=function(t,e){var i=c.get(t,"/rpc/"+e);return i.hexString(20)},y.extend(c.prototype,{_sequence:function(t){var e=this,i=e.sequences[t]||null;if(null===i){for(var n=e.seed.concat(t),r=0;r<n.length;r++)y.isFunction(n[r])&&(n[r]=n[r]());e.sequences[t]=i=f.createWithSeeds.apply(null,n)}return i}})}.call(this),function(){if(p.isServer)var i=Npm.require("path"),n=(Npm.require("fibers"),Npm.require(i.join("fibers","future")));var r=function(t,i){var n=this;i=y.extend({onConnected:function(){},onDDPVersionNegotiationFailure:function(t){p._debug(t)},heartbeatInterval:35e3,heartbeatTimeout:15e3,reloadWithOutstanding:!1,supportedDDPVersions:o,retry:!0,respondToPings:!0},i),n.onReconnect=null,n._stream="object"==typeof t?t:new e.ClientStream(t,{retry:i.retry,headers:i.headers,_sockjsOptions:i._sockjsOptions,_dontPrintErrors:i._dontPrintErrors}),n._lastSessionId=null,n._versionSuggestion=null,n._version=null,n._stores={},n._methodHandlers={},n._nextMethodId=1,n._supportedDDPVersions=i.supportedDDPVersions,n._heartbeatInterval=i.heartbeatInterval,n._heartbeatTimeout=i.heartbeatTimeout,n._methodInvokers={},n._outstandingMethodBlocks=[],n._documentsWrittenByStub={},n._serverDocuments={},n._afterUpdateCallbacks=[],n._messagesBufferedUntilQuiescence=[],n._methodsBlockingQuiescence={},n._subsBeingRevived={},n._resetStores=!1,n._updatesForUnknownStores={},n._retryMigrate=null,n._subscriptions={},n._userId=null,n._userIdDeps="undefined"!=typeof v&&new v.Dependency,p.isClient&&Package.reload&&!i.reloadWithOutstanding&&Package.reload.Reload._onMigrate(function(t){if(n._readyToMigrate())return[!0];if(n._retryMigrate)throw new Error("Two migrations in progress?");return n._retryMigrate=t,!1});var r=function(t){try{var e=h(t)}catch(r){return p._debug("Exception while parsing DDP",r),void 0}if(null===e||!e.msg)return e&&e.server_id||p._debug("discarding invalid livedata message",e),void 0;if("connected"===e.msg)n._version=n._versionSuggestion,i.onConnected(),n._livedata_connected(e);else if("failed"==e.msg)if(y.contains(n._supportedDDPVersions,e.version))n._versionSuggestion=e.version,n._stream.reconnect({_force:!0});else{var s="DDP version negotiation failed; server requested version "+e.version;n._stream.disconnect({_permanent:!0,_error:s}),i.onDDPVersionNegotiationFailure(s)}else"ping"===e.msg?(i.respondToPings&&n._send({msg:"pong",id:e.id}),n._heartbeat&&n._heartbeat.pingReceived()):"pong"===e.msg?n._heartbeat&&n._heartbeat.pongReceived():y.include(["added","changed","removed","ready","updated"],e.msg)?n._livedata_data(e):"nosub"===e.msg?n._livedata_nosub(e):"result"===e.msg?n._livedata_result(e):"error"===e.msg?n._livedata_error(e):p._debug("discarding unknown livedata message type",e)},s=function(){var t={msg:"connect"};n._lastSessionId&&(t.session=n._lastSessionId),t.version=n._versionSuggestion||n._supportedDDPVersions[0],n._versionSuggestion=t.version,t.support=n._supportedDDPVersions,n._send(t),!y.isEmpty(n._outstandingMethodBlocks)&&y.isEmpty(n._outstandingMethodBlocks[0].methods)&&n._outstandingMethodBlocks.shift(),y.each(n._methodInvokers,function(t){t.sentMessage=!1}),n.onReconnect?n._callOnReconnectAndSendAppropriateOutstandingMethods():n._sendOutstandingMethods(),y.each(n._subscriptions,function(t,e){n._send({msg:"sub",id:e,name:t.name,params:t.params})})},a=function(){n._heartbeat&&(n._heartbeat.stop(),n._heartbeat=null)};p.isServer?(n._stream.on("message",p.bindEnvironment(r,p._debug)),n._stream.on("reset",p.bindEnvironment(s,p._debug)),n._stream.on("disconnect",p.bindEnvironment(a,p._debug))):(n._stream.on("message",r),n._stream.on("reset",s),n._stream.on("disconnect",a))},c=function(t){var e=this;e.methodId=t.methodId,e.sentMessage=!1,e._callback=t.callback,e._connection=t.connection,e._message=t.message,e._onResultReceived=t.onResultReceived||function(){},e._wait=t.wait,e._methodResult=null,e._dataVisible=!1,e._connection._methodInvokers[e.methodId]=e};y.extend(c.prototype,{sendMessage:function(){var t=this;if(t.gotResult())throw new Error("sendingMethod is called on method with result");t._dataVisible=!1,t.sentMessage=!0,t._wait&&(t._connection._methodsBlockingQuiescence[t.methodId]=!0),t._connection._send(t._message)},_maybeInvokeCallback:function(){var t=this;t._methodResult&&t._dataVisible&&(t._callback(t._methodResult[0],t._methodResult[1]),delete t._connection._methodInvokers[t.methodId],t._connection._outstandingMethodFinished())},receiveResult:function(t,e){var i=this;if(i.gotResult())throw new Error("Methods should only receive results once");i._methodResult=[t,e],i._onResultReceived(t,e),i._maybeInvokeCallback()},dataVisible:function(){var t=this;t._dataVisible=!0,t._maybeInvokeCallback()},gotResult:function(){var t=this;return!!t._methodResult}}),y.extend(r.prototype,{registerStore:function(t,e){var i=this;if(t in i._stores)return!1;var n={};y.each(["update","beginUpdate","endUpdate","saveOriginals","retrieveOriginals"],function(t){n[t]=function(){return e[t]?e[t].apply(e,arguments):void 0}}),i._stores[t]=n;var r=i._updatesForUnknownStores[t];return r&&(n.beginUpdate(r.length,!1),y.each(r,function(t){n.update(t)}),n.endUpdate(),delete i._updatesForUnknownStores[t]),!0},subscribe:function(t){var e=this,i=Array.prototype.slice.call(arguments,1),n={};if(i.length){var r=i[i.length-1];"function"==typeof r?n.onReady=i.pop():!r||"function"!=typeof r.onReady&&"function"!=typeof r.onError||(n=i.pop())}var s,o=y.find(e._subscriptions,function(e){return e.inactive&&e.name===t&&m.equals(e.params,i)});o?(s=o.id,o.inactive=!1,n.onReady&&(o.ready||(o.readyCallback=n.onReady)),n.onError&&(o.errorCallback=n.onError)):(s=f.id(),e._subscriptions[s]={id:s,name:t,params:m.clone(i),inactive:!1,ready:!1,readyDeps:"undefined"!=typeof v&&new v.Dependency,readyCallback:n.onReady,errorCallback:n.onError},e._send({msg:"sub",id:s,name:t,params:i}));var a={stop:function(){y.has(e._subscriptions,s)&&(e._send({msg:"unsub",id:s}),delete e._subscriptions[s])},ready:function(){if(!y.has(e._subscriptions,s))return!1;var t=e._subscriptions[s];return t.readyDeps&&t.readyDeps.depend(),t.ready}};return v.active&&v.onInvalidate(function(){y.has(e._subscriptions,s)&&(e._subscriptions[s].inactive=!0),v.afterFlush(function(){y.has(e._subscriptions,s)&&e._subscriptions[s].inactive&&a.stop()})}),a},_subscribeAndWait:function(t,e,i){var r,s=this,o=new n,a=!1;return e=e||[],e.push({onReady:function(){a=!0,o["return"]()},onError:function(t){a?i&&i.onLateError&&i.onLateError(t):o["throw"](t)}}),r=s.subscribe.apply(s,[t].concat(e)),o.wait(),r},methods:function(t){var e=this;y.each(t,function(t,i){if(e._methodHandlers[i])throw new Error("A method named '"+i+"' is already defined");e._methodHandlers[i]=t})},call:function(t){var e=Array.prototype.slice.call(arguments,1);if(e.length&&"function"==typeof e[e.length-1])var i=e.pop();return this.apply(t,e,i)},apply:function(e,i,r,s){var o=this;s||"function"!=typeof r||(s=r,r={}),r=r||{},s&&(s=p.bindEnvironment(s,"delivering result of invoking '"+e+"'")),i=m.clone(i);var h=function(){var t;return function(){return void 0===t&&(t=""+o._nextMethodId++),t}}(),u=t._CurrentInvocation.get(),d=u&&u.isSimulation,f=null,g=function(){return null===f&&(f=l(u,e)),f},v=o._methodHandlers[e];if(v){var _=function(t){o.setUserId(t)},b=new a({isSimulation:!0,userId:o.userId(),setUserId:_,randomSeed:function(){return g()}});d||o._saveOriginals();try{var x=t._CurrentInvocation.withValue(b,function(){return p.isServer?p._noYieldsAllowed(function(){return v.apply(b,m.clone(i))}):v.apply(b,m.clone(i))})}catch(w){var T=w}d||o._retrieveAndStoreOriginals(h())}if(d){if(s)return s(T,x),void 0;if(T)throw T;return x}if(T&&!T.expected&&p._debug("Exception while simulating the effect of invoking '"+e+"'",T,T.stack),!s)if(p.isClient)s=function(){};else{var S=new n;s=S.resolver()}var C={msg:"method",method:e,params:i,id:h()};null!==f&&(C.randomSeed=f);var P=new c({methodId:h(),callback:s,connection:o,onResultReceived:r.onResultReceived,wait:!!r.wait,message:C});return r.wait?o._outstandingMethodBlocks.push({wait:!0,methods:[P]}):((y.isEmpty(o._outstandingMethodBlocks)||y.last(o._outstandingMethodBlocks).wait)&&o._outstandingMethodBlocks.push({wait:!1,methods:[]}),y.last(o._outstandingMethodBlocks).methods.push(P)),1===o._outstandingMethodBlocks.length&&P.sendMessage(),S?S.wait():r.returnStubValue?x:void 0},_saveOriginals:function(){var t=this;y.each(t._stores,function(t){t.saveOriginals()})},_retrieveAndStoreOriginals:function(t){var e=this;if(e._documentsWrittenByStub[t])throw new Error("Duplicate methodId in _retrieveAndStoreOriginals");var i=[];y.each(e._stores,function(n,r){var s=n.retrieveOriginals();s&&s.forEach(function(n,s){i.push({collection:r,id:s}),y.has(e._serverDocuments,r)||(e._serverDocuments[r]=new b._IdMap);var o=e._serverDocuments[r].setDefault(s,{});o.writtenByStubs?o.writtenByStubs[t]=!0:(o.document=n,o.flushCallbacks=[],o.writtenByStubs={},o.writtenByStubs[t]=!0)})}),y.isEmpty(i)||(e._documentsWrittenByStub[t]=i)},_unsubscribeAll:function(){var t=this;y.each(y.clone(t._subscriptions),function(e,i){"meteor_autoupdate_clientVersions"!==e.name&&(t._send({msg:"unsub",id:i}),delete t._subscriptions[i])})},_send:function(t){var e=this;e._stream.send(u(t))},_lostConnection:function(){var t=this;t._stream._lostConnection()},status:function(){var t=this;return t._stream.status.apply(t._stream,arguments)},reconnect:function(){var t=this;return t._stream.reconnect.apply(t._stream,arguments)},disconnect:function(){var t=this;return t._stream.disconnect.apply(t._stream,arguments)},close:function(){var t=this;return t._stream.disconnect({_permanent:!0})},userId:function(){var t=this;return t._userIdDeps&&t._userIdDeps.depend(),t._userId},setUserId:function(t){var e=this;e._userId!==t&&(e._userId=t,e._userIdDeps&&e._userIdDeps.changed())},_waitingForQuiescence:function(){var t=this;return!y.isEmpty(t._subsBeingRevived)||!y.isEmpty(t._methodsBlockingQuiescence)},_anyMethodsAreOutstanding:function(){var t=this;return y.any(y.pluck(t._methodInvokers,"sentMessage"))},_livedata_connected:function(t){var e=this;if("pre1"!==e._version&&0!==e._heartbeatInterval&&(e._heartbeat=new s({heartbeatInterval:e._heartbeatInterval,heartbeatTimeout:e._heartbeatTimeout,onTimeout:function(){p.isClient&&p._debug("Connection timeout. No DDP heartbeat received."),e._lostConnection()},sendPing:function(){e._send({msg:"ping"})}}),e._heartbeat.start()),e._lastSessionId&&(e._resetStores=!0),"string"==typeof t.session){var i=e._lastSessionId===t.session;e._lastSessionId=t.session}i||(e._updatesForUnknownStores={},e._resetStores&&(e._documentsWrittenByStub={},e._serverDocuments={}),e._afterUpdateCallbacks=[],e._subsBeingRevived={},y.each(e._subscriptions,function(t,i){t.ready&&(e._subsBeingRevived[i]=!0)}),e._methodsBlockingQuiescence={},e._resetStores&&y.each(e._methodInvokers,function(t){t.gotResult()?e._afterUpdateCallbacks.push(y.bind(t.dataVisible,t)):t.sentMessage&&(e._methodsBlockingQuiescence[t.methodId]=!0)}),e._messagesBufferedUntilQuiescence=[],e._waitingForQuiescence()||(e._resetStores&&(y.each(e._stores,function(t){t.beginUpdate(0,!0),t.endUpdate()}),e._resetStores=!1),e._runAfterUpdateCallbacks()))},_processOneDataMessage:function(t,e){var i=this;i["_process_"+t.msg](t,e)},_livedata_data:function(t){var e=this,i={};if(e._waitingForQuiescence()){if(e._messagesBufferedUntilQuiescence.push(t),"nosub"===t.msg&&delete e._subsBeingRevived[t.id],y.each(t.subs||[],function(t){delete e._subsBeingRevived[t]}),y.each(t.methods||[],function(t){delete e._methodsBlockingQuiescence[t]}),e._waitingForQuiescence())return;y.each(e._messagesBufferedUntilQuiescence,function(t){e._processOneDataMessage(t,i)}),e._messagesBufferedUntilQuiescence=[]}else e._processOneDataMessage(t,i);(e._resetStores||!y.isEmpty(i))&&(y.each(e._stores,function(t,n){t.beginUpdate(y.has(i,n)?i[n].length:0,e._resetStores)}),e._resetStores=!1,y.each(i,function(t,i){var n=e._stores[i];n?y.each(t,function(t){n.update(t)}):(y.has(e._updatesForUnknownStores,i)||(e._updatesForUnknownStores[i]=[]),Array.prototype.push.apply(e._updatesForUnknownStores[i],t))}),y.each(e._stores,function(t){t.endUpdate()})),e._runAfterUpdateCallbacks()},_runAfterUpdateCallbacks:function(){var t=this,e=t._afterUpdateCallbacks;t._afterUpdateCallbacks=[],y.each(e,function(t){t()})},_pushUpdate:function(t,e,i){y.has(t,e)||(t[e]=[]),t[e].push(i)},_getServerDoc:function(t,e){var i=this;if(!y.has(i._serverDocuments,t))return null;var n=i._serverDocuments[t];return n.get(e)||null},_process_added:function(t,e){var i=this,n=b._idParse(t.id),r=i._getServerDoc(t.collection,n);if(r){if(void 0!==r.document)throw new Error("Server sent add for existing id: "+t.id);r.document=t.fields||{},r.document._id=n}else i._pushUpdate(e,t.collection,t)},_process_changed:function(t,e){var i=this,n=i._getServerDoc(t.collection,b._idParse(t.id));if(n){if(void 0===n.document)throw new Error("Server sent changed for nonexisting id: "+t.id);b._applyChanges(n.document,t.fields)}else i._pushUpdate(e,t.collection,t)},_process_removed:function(t,e){var i=this,n=i._getServerDoc(t.collection,b._idParse(t.id));if(n){if(void 0===n.document)throw new Error("Server sent removed for nonexisting id:"+t.id);n.document=void 0}else i._pushUpdate(e,t.collection,{msg:"removed",collection:t.collection,id:t.id})},_process_updated:function(t,e){var i=this;y.each(t.methods,function(t){y.each(i._documentsWrittenByStub[t],function(n){var r=i._getServerDoc(n.collection,n.id);if(!r)throw new Error("Lost serverDoc for "+g.stringify(n));if(!r.writtenByStubs[t])throw new Error("Doc "+g.stringify(n)+" not written by  method "+t);delete r.writtenByStubs[t],y.isEmpty(r.writtenByStubs)&&(i._pushUpdate(e,n.collection,{msg:"replace",id:b._idStringify(n.id),replace:r.document}),y.each(r.flushCallbacks,function(t){t()}),i._serverDocuments[n.collection].remove(n.id))}),delete i._documentsWrittenByStub[t];var n=i._methodInvokers[t];if(!n)throw new Error("No callback invoker for method "+t);i._runWhenAllServerDocsAreFlushed(y.bind(n.dataVisible,n))})},_process_ready:function(t){var e=this;y.each(t.subs,function(t){e._runWhenAllServerDocsAreFlushed(function(){var i=e._subscriptions[t];i&&(i.ready||(i.readyCallback&&i.readyCallback(),i.ready=!0,i.readyDeps&&i.readyDeps.changed()))})})},_runWhenAllServerDocsAreFlushed:function(t){var e=this,i=function(){e._afterUpdateCallbacks.push(t)},n=0,r=function(){--n,0===n&&i()};y.each(e._serverDocuments,function(t){t.forEach(function(t){var i=y.any(t.writtenByStubs,function(t,i){var n=e._methodInvokers[i];return n&&n.sentMessage});i&&(++n,t.flushCallbacks.push(r))})}),0===n&&i()},_livedata_nosub:function(t){var e=this;if(e._livedata_data(t),y.has(e._subscriptions,t.id)){var i=e._subscriptions[t.id].errorCallback;delete e._subscriptions[t.id],i&&t.error&&i(new p.Error(t.error.error,t.error.reason,t.error.details))}},_process_nosub:function(){},_livedata_result:function(t){var e=this;if(y.isEmpty(e._outstandingMethodBlocks))return p._debug("Received method result but no methods outstanding"),void 0;for(var i,n=e._outstandingMethodBlocks[0].methods,r=0;r<n.length&&(i=n[r],i.methodId!==t.id);r++);return i?(n.splice(r,1),y.has(t,"error")?i.receiveResult(new p.Error(t.error.error,t.error.reason,t.error.details)):i.receiveResult(void 0,t.result),void 0):(p._debug("Can't match method response to original method call",t),void 0)},_outstandingMethodFinished:function(){var t=this;if(!t._anyMethodsAreOutstanding()){if(!y.isEmpty(t._outstandingMethodBlocks)){var e=t._outstandingMethodBlocks.shift();if(!y.isEmpty(e.methods))throw new Error("No methods outstanding but nonempty block: "+g.stringify(e));y.isEmpty(t._outstandingMethodBlocks)||t._sendOutstandingMethods()}t._maybeMigrate()}},_sendOutstandingMethods:function(){var t=this;y.isEmpty(t._outstandingMethodBlocks)||y.each(t._outstandingMethodBlocks[0].methods,function(t){t.sendMessage()})},_livedata_error:function(t){p._debug("Received error from server: ",t.reason),t.offendingMessage&&p._debug("For: ",t.offendingMessage)},_callOnReconnectAndSendAppropriateOutstandingMethods:function(){var t=this,e=t._outstandingMethodBlocks;if(t._outstandingMethodBlocks=[],t.onReconnect(),!y.isEmpty(e)){if(y.isEmpty(t._outstandingMethodBlocks))return t._outstandingMethodBlocks=e,t._sendOutstandingMethods(),void 0;y.last(t._outstandingMethodBlocks).wait||e[0].wait||(y.each(e[0].methods,function(e){y.last(t._outstandingMethodBlocks).methods.push(e),1===t._outstandingMethodBlocks.length&&e.sendMessage()}),e.shift()),y.each(e,function(e){t._outstandingMethodBlocks.push(e)})}},_readyToMigrate:function(){var t=this;return y.isEmpty(t._methodInvokers)},_maybeMigrate:function(){var t=this;t._retryMigrate&&t._readyToMigrate()&&(t._retryMigrate(),t._retryMigrate=null)}}),e.Connection=r,t.connect=function(t,e){var i=new r(t,e);return d.push(i),i},d=[],t._allSubscriptionsReady=function(){return y.all(d,function(t){return y.all(t._subscriptions,function(t){return t.ready})})}}.call(this),function(){if(p.refresh=function(){},p.isClient){var e="/";"undefined"!=typeof __meteor_runtime_config__&&__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL&&(e=__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL);var i=new _,n=function(t){if(p._debug(t),Package.reload){var e=Package.reload.Reload._migrationData("livedata")||{},n=e.DDPVersionNegotiationFailures||0;++n,Package.reload.Reload._onMigrate("livedata",function(){return[!0,{DDPVersionNegotiationFailures:n}]}),i.retryLater(n,function(){Package.reload.Reload._reload()})}};p.connection=t.connect(e,{onDDPVersionNegotiationFailure:n}),y.each(["subscribe","methods","call","apply","status","reconnect","disconnect"],function(t){p[t]=y.bind(p.connection[t],p.connection)})}else p.connection=null;p.default_connection=p.connection,p.connect=t.connect}.call(this),"undefined"==typeof Package&&(Package={}),Package.livedata={DDP:t,LivedataTest:e}}(),function(){{var t;Package.meteor.Meteor,Package.logging.Log,Package.underscore._,Package.livedata.DDP,Package.ejson.EJSON}"undefined"==typeof Package&&(Package={}),Package["follower-livedata"]={Follower:t}}(),function(){Package.meteor.Meteor,Package.logging.Log,Package.underscore._,Package.livedata.DDP,Package.ejson.EJSON,Package["follower-livedata"].Follower;"undefined"==typeof Package&&(Package={}),Package["application-configuration"]={}}(),function(){var t,e=Package.meteor.Meteor,i=Package.random.Random,n=Package.ejson.EJSON,r=(Package.json.JSON,Package.underscore._),s=Package.minimongo.LocalCollection,o=(Package.minimongo.Minimongo,Package.logging.Log,Package.livedata.DDP),a=(Package.deps.Deps,Package.check.check),h=Package.check.Match;(function(){t=function(){var t=this;t.noConnCollections={}};var e=function(t,e){return t in e||(e[t]=new s(t)),e[t]};r.extend(t.prototype,{open:function(t,i){var n=this;return t?i?(i._mongo_livedata_collections||(i._mongo_livedata_collections={}),e(t,i._mongo_livedata_collections)):e(t,n.noConnCollections):new s}}),t=new t}).call(this),function(){e.Collection=function(n,a){var h=this;if(!(h instanceof e.Collection))throw new Error('use "new" to construct a Meteor.Collection');if(n||null===n||(e._debug("Warning: creating anonymous collection. It will not be saved or synchronized over the network. (Pass null for the collection name to turn off this warning.)"),n=null),null!==n&&"string"!=typeof n)throw new Error("First argument to new Meteor.Collection must be a string or null");switch(a&&a.methods&&(a={connection:a}),a&&a.manager&&!a.connection&&(a.connection=a.manager),a=r.extend({connection:void 0,idGeneration:"STRING",transform:null,_driver:void 0,_preventAutopublish:!1},a),a.idGeneration){case"MONGO":h._makeNewID=function(){var t=n?o.randomStream("/collection/"+n):i;return new e.Collection.ObjectID(t.hexString(24))};break;case"STRING":default:h._makeNewID=function(){var t=n?o.randomStream("/collection/"+n):i;return t.id()}}if(h._transform=s.wrapTransform(a.transform),h._connection=n&&null!==a.connection?a.connection?a.connection:e.isClient?e.connection:e.server:null,a._driver||(a._driver=n&&h._connection===e.server&&"undefined"!=typeof MongoInternals&&MongoInternals.defaultRemoteCollectionDriver?MongoInternals.defaultRemoteCollectionDriver():t),h._collection=a._driver.open(n,h._connection),h._name=n,h._connection&&h._connection.registerStore){var u=h._connection.registerStore(n,{beginUpdate:function(t,e){(t>1||e)&&h._collection.pauseObservers(),e&&h._collection.remove({})},update:function(t){var e=s._idParse(t.id),i=h._collection.findOne(e);if("replace"===t.msg){var n=t.replace;return n?i?h._collection.update(e,n):h._collection.insert(n):i&&h._collection.remove(e),void 0}if("added"===t.msg){if(i)throw new Error("Expected not to find a document already present for an add");h._collection.insert(r.extend({_id:e},t.fields))}else if("removed"===t.msg){if(!i)throw new Error("Expected to find a document already present for removed");h._collection.remove(e)}else{if("changed"!==t.msg)throw new Error("I don't know how to deal with this message");if(!i)throw new Error("Expected to find a document to change");if(!r.isEmpty(t.fields)){var o={};r.each(t.fields,function(t,e){void 0===t?(o.$unset||(o.$unset={}),o.$unset[e]=1):(o.$set||(o.$set={}),o.$set[e]=t)}),h._collection.update(e,o)}}},endUpdate:function(){h._collection.resumeObservers()},saveOriginals:function(){h._collection.saveOriginals()},retrieveOriginals:function(){return h._collection.retrieveOriginals()}});if(!u)throw new Error("There is already a collection named '"+n+"'")}h._defineMutationMethods(),Package.autopublish&&!a._preventAutopublish&&h._connection&&h._connection.publish&&h._connection.publish(null,function(){return h.find()},{is_auto:!0})},r.extend(e.Collection.prototype,{_getFindSelector:function(t){return 0==t.length?{}:t[0]},_getFindOptions:function(t){var e=this;return t.length<2?{transform:e._transform}:(a(t[1],h.Optional(h.ObjectIncluding({fields:h.Optional(h.OneOf(Object,void 0)),sort:h.Optional(h.OneOf(Object,Array,void 0)),limit:h.Optional(h.OneOf(Number,void 0)),skip:h.Optional(h.OneOf(Number,void 0))}))),r.extend({transform:e._transform},t[1]))},find:function(){var t=this,e=r.toArray(arguments);return t._collection.find(t._getFindSelector(e),t._getFindOptions(e))},findOne:function(){var t=this,e=r.toArray(arguments);return t._collection.findOne(t._getFindSelector(e),t._getFindOptions(e))}}),e.Collection._publishCursor=function(t,e,i){var n=t.observeChanges({added:function(t,n){e.added(i,t,n)},changed:function(t,n){e.changed(i,t,n)},removed:function(t){e.removed(i,t)}});e.onStop(function(){n.stop()})},e.Collection._rewriteSelector=function(t){if(s._selectorIsId(t)&&(t={_id:t}),!t||"_id"in t&&!t._id)return{_id:i.id()};var n={};return r.each(t,function(t,i){t instanceof RegExp?n[i]=u(t):t&&t.$regex instanceof RegExp?(n[i]=u(t.$regex),void 0!==t.$options&&(n[i].$options=t.$options)):n[i]=r.contains(["$or","$and","$nor"],i)?r.map(t,function(t){return e.Collection._rewriteSelector(t)}):t}),n};var u=function(t){a(t,RegExp);var e={$regex:t.source},i="";return t.ignoreCase&&(i+="i"),t.multiline&&(i+="m"),i&&(e.$options=i),e},c=function(t,i){if(!s._selectorIsIdPerhapsAsObject(t))throw new e.Error(403,"Not permitted. Untrusted code may only "+i+" documents by ID.")};r.each(["insert","update","remove"],function(t){e.Collection.prototype[t]=function(){var i,n,s,a=this,h=r.toArray(arguments);if(h.length&&h[h.length-1]instanceof Function&&(i=h.pop()),"insert"===t){if(!h.length)throw new Error("insert requires an argument");if(h[0]=r.extend({},h[0]),"_id"in h[0]){if(n=h[0]._id,!n||!("string"==typeof n||n instanceof e.Collection.ObjectID))throw new Error("Meteor requires document _id fields to be non-empty strings or ObjectIDs")}else{var u=!0;if(a._connection&&a._connection!==e.server){var l=o._CurrentInvocation.get();l||(u=!1)}u&&(n=h[0]._id=a._makeNewID())}}else if(h[0]=e.Collection._rewriteSelector(h[0]),"update"===t){var d=h[2]=r.clone(h[2])||{};if(d&&"function"!=typeof d&&d.upsert)if(d.insertedId){if(!("string"==typeof d.insertedId||d.insertedId instanceof e.Collection.ObjectID))throw new Error("insertedId must be string or ObjectID")}else d.insertedId=a._makeNewID()}var p,f=function(e){return"insert"===t?(!n&&e&&(n=e),n):e};if(i&&(p=function(t,e){i(t,!t&&f(e))}),a._connection&&a._connection!==e.server){var l=o._CurrentInvocation.get(),m=l&&l.isSimulation;!e.isClient||p||m||(p=function(i){i&&e._debug(t+" failed: "+(i.reason||i.stack))}),m||"insert"===t||c(h[0],t),s=f(a._connection.apply(a._prefix+t,h,{returnStubValue:!0},p))}else{h.push(p);try{var g=a._collection[t].apply(a._collection,h);s=f(g)}catch(y){if(i)return i(y),null;throw y}}return s}}),e.Collection.prototype.upsert=function(t,e,i,n){var s=this;return n||"function"!=typeof i||(n=i,i={}),s.update(t,e,r.extend({},i,{_returnObject:!0,upsert:!0}),n)},e.Collection.prototype._ensureIndex=function(t,e){var i=this;if(!i._collection._ensureIndex)throw new Error("Can only call _ensureIndex on server collections");i._collection._ensureIndex(t,e)},e.Collection.prototype._dropIndex=function(t){var e=this;
if(!e._collection._dropIndex)throw new Error("Can only call _dropIndex on server collections");e._collection._dropIndex(t)},e.Collection.prototype._dropCollection=function(){var t=this;if(!t._collection.dropCollection)throw new Error("Can only call _dropCollection on server collections");t._collection.dropCollection()},e.Collection.prototype._createCappedCollection=function(t){var e=this;if(!e._collection._createCappedCollection)throw new Error("Can only call _createCappedCollection on server collections");e._collection._createCappedCollection(t)},e.Collection.ObjectID=s._ObjectID,function(){var t=function(t,e){var i=["insert","update","remove","fetch","transform"];r.each(r.keys(e),function(e){if(!r.contains(i,e))throw new Error(t+": Invalid key: "+e)});var n=this;if(n._restricted=!0,r.each(["insert","update","remove"],function(i){if(e[i]){if(!(e[i]instanceof Function))throw new Error(t+": Value for `"+i+"` must be a function");e[i].transform=void 0===e.transform?n._transform:s.wrapTransform(e.transform),n._validators[i][t].push(e[i])}}),e.update||e.remove||e.fetch){if(e.fetch&&!(e.fetch instanceof Array))throw new Error(t+": Value for `fetch` must be an array");n._updateFetch(e.fetch)}};e.Collection.prototype.allow=function(e){t.call(this,"allow",e)},e.Collection.prototype.deny=function(e){t.call(this,"deny",e)}}(),e.Collection.prototype._defineMutationMethods=function(){var t=this;if(t._restricted=!1,t._insecure=void 0,t._validators={insert:{allow:[],deny:[]},update:{allow:[],deny:[]},remove:{allow:[],deny:[]},upsert:{allow:[],deny:[]},fetch:[],fetchAllFields:!1},t._name&&(t._prefix="/"+t._name+"/",t._connection)){var i={};r.each(["insert","update","remove"],function(n){i[t._prefix+n]=function(){a(arguments,[h.Any]);var i=r.toArray(arguments);try{var s=null;if("insert"!==n||r.has(i[0],"_id")||(s=t._makeNewID()),this.isSimulation)return null!==s&&(i[0]._id=s),t._collection[n].apply(t._collection,i);if("insert"!==n&&c(i[0],n),t._restricted){if(0===t._validators[n].allow.length)throw new e.Error(403,"Access denied. No allow validators set on restricted collection for method '"+n+"'.");var o="_validated"+n.charAt(0).toUpperCase()+n.slice(1);return i.unshift(this.userId),"insert"===n&&i.push(s),t[o].apply(t,i)}if(t._isInsecure())return null!==s&&(i[0]._id=s),t._collection[n].apply(t._collection,i);throw new e.Error(403,"Access denied")}catch(u){throw"MongoError"===u.name||"MinimongoError"===u.name?new e.Error(409,u.toString()):u}}}),(e.isClient||t._connection===e.server)&&t._connection.methods(i)}},e.Collection.prototype._updateFetch=function(t){var e=this;e._validators.fetchAllFields||(t?e._validators.fetch=r.union(e._validators.fetch,t):(e._validators.fetchAllFields=!0,e._validators.fetch=null))},e.Collection.prototype._isInsecure=function(){var t=this;return void 0===t._insecure?!!Package.insecure:t._insecure};var l=function(t,e,i){var r=e;return t.transform&&(r=n.clone(e),null!==i&&(r._id=i),r=t.transform(r)),r};e.Collection.prototype._validatedInsert=function(t,i,n){var s=this;if(r.any(s._validators.insert.deny,function(e){return e(t,l(e,i,n))}))throw new e.Error(403,"Access denied");if(r.all(s._validators.insert.allow,function(e){return!e(t,l(e,i,n))}))throw new e.Error(403,"Access denied");null!==n&&(i._id=n),s._collection.insert.call(s._collection,i)};var d=function(t,e){return t.transform?t.transform(e):e};e.Collection.prototype._validatedUpdate=function(t,i,n,o){var a=this;if(o=o||{},!s._selectorIsIdPerhapsAsObject(i))throw new Error("validated update should be of a single ID");if(o.upsert)throw new e.Error(403,"Access denied. Upserts not allowed in a restricted collection.");var h=[];r.each(n,function(t,i){if("$"!==i.charAt(0))throw new e.Error(403,"Access denied. In a restricted collection you can only update documents, not replace them. Use a Mongo update operator, such as '$set'.");if(!r.has(p,i))throw new e.Error(403,"Access denied. Operator "+i+" not allowed in a restricted collection.");r.each(r.keys(t),function(t){-1!==t.indexOf(".")&&(t=t.substring(0,t.indexOf("."))),r.contains(h,t)||h.push(t)})});var u={transform:null};a._validators.fetchAllFields||(u.fields={},r.each(a._validators.fetch,function(t){u.fields[t]=1}));var c=a._collection.findOne(i,u);if(!c)return 0;var l;if(r.any(a._validators.update.deny,function(e){return l||(l=d(e,c)),e(t,l,h,n)}))throw new e.Error(403,"Access denied");if(r.all(a._validators.update.allow,function(e){return l||(l=d(e,c)),!e(t,l,h,n)}))throw new e.Error(403,"Access denied");return a._collection.update.call(a._collection,i,n,o)};var p={$inc:1,$set:1,$unset:1,$addToSet:1,$pop:1,$pullAll:1,$pull:1,$pushAll:1,$push:1,$bit:1};e.Collection.prototype._validatedRemove=function(t,i){var n=this,s={transform:null};n._validators.fetchAllFields||(s.fields={},r.each(n._validators.fetch,function(t){s.fields[t]=1}));var o=n._collection.findOne(i,s);if(!o)return 0;if(r.any(n._validators.remove.deny,function(e){return e(t,d(e,o))}))throw new e.Error(403,"Access denied");if(r.all(n._validators.remove.allow,function(e){return!e(t,d(e,o))}))throw new e.Error(403,"Access denied");return n._collection.remove.call(n._collection,i)}}.call(this),"undefined"==typeof Package&&(Package={}),Package["mongo-livedata"]={}}(),function(){var t,e=Package.meteor.Meteor,i=Package.underscore._,n=Package.deps.Deps,r=Package.ejson.EJSON;(function(){var s=function(t){return void 0===t?"undefined":r.stringify(t)},o=function(t){return void 0===t||"undefined"===t?void 0:r.parse(t)};t=function(t){this.keys=t||{},this.keyDeps={},this.keyValueDeps={}},i.extend(t.prototype,{set:function(t,e){var n=this;e=s(e);var r="undefined";if(i.has(n.keys,t)&&(r=n.keys[t]),e!==r){n.keys[t]=e;var o=function(t){t&&t.changed()};o(n.keyDeps[t]),n.keyValueDeps[t]&&(o(n.keyValueDeps[t][r]),o(n.keyValueDeps[t][e]))}},setDefault:function(t,e){var i=this;void 0===i.keys[t]&&i.set(t,e)},get:function(t){var e=this;return e._ensureKey(t),e.keyDeps[t].depend(),o(e.keys[t])},equals:function(t,a){var h=this,u=Package["mongo-livedata"]&&e.Collection.ObjectID;if(!("string"==typeof a||"number"==typeof a||"boolean"==typeof a||"undefined"==typeof a||a instanceof Date||u&&a instanceof u||null===a))throw new Error("ReactiveDict.equals: value must be scalar");var c=s(a);if(n.active){h._ensureKey(t),i.has(h.keyValueDeps[t],c)||(h.keyValueDeps[t][c]=new n.Dependency);var l=h.keyValueDeps[t][c].depend();l&&n.onInvalidate(function(){h.keyValueDeps[t][c].hasDependents()||delete h.keyValueDeps[t][c]})}var d=void 0;return i.has(h.keys,t)&&(d=o(h.keys[t])),r.equals(d,a)},_ensureKey:function(t){var e=this;t in e.keyDeps||(e.keyDeps[t]=new n.Dependency,e.keyValueDeps[t]={})},getMigrationData:function(){return this.keys}})}).call(this),"undefined"==typeof Package&&(Package={}),Package["reactive-dict"]={ReactiveDict:t}}(),function(){{var t,e=(Package.meteor.Meteor,Package.underscore._,Package["reactive-dict"].ReactiveDict);Package.ejson.EJSON}(function(){var i={};if(Package.reload){var n=Package.reload.Reload._migrationData("session");n&&n.keys&&(i=n.keys)}t=new e(i),Package.reload&&Package.reload.Reload._onMigrate("session",function(){return[!0,{keys:t.keys}]})}).call(this),"undefined"==typeof Package&&(Package={}),Package.session={Session:t}}(),function(){{var t,e;Package.meteor.Meteor}(function(){!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=t.length,i=se.type(t);return"function"===i||se.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t}function n(t,e,i){if(se.isFunction(e))return se.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return se.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(pe.test(e))return se.filter(e,t,i);e=se.filter(e,t)}return se.grep(t,function(t){return se.inArray(t,e)>=0!==i})}function r(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function s(t){var e=xe[t]={};return se.each(t.match(be)||[],function(t,i){e[i]=!0}),e}function o(){me.addEventListener?(me.removeEventListener("DOMContentLoaded",a,!1),t.removeEventListener("load",a,!1)):(me.detachEvent("onreadystatechange",a),t.detachEvent("onload",a))}function a(){(me.addEventListener||"load"===event.type||"complete"===me.readyState)&&(o(),se.ready())}function h(t,e,i){if(void 0===i&&1===t.nodeType){var n="data-"+e.replace(Pe,"-$1").toLowerCase();if(i=t.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Ce.test(i)?se.parseJSON(i):i}catch(r){}se.data(t,e,i)}else i=void 0}return i}function u(t){var e;for(e in t)if(("data"!==e||!se.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function c(t,e,i,n){if(se.acceptData(t)){var r,s,o=se.expando,a=t.nodeType,h=a?se.cache:t,u=a?t[o]:t[o]&&o;if(u&&h[u]&&(n||h[u].data)||void 0!==i||"string"!=typeof e)return u||(u=a?t[o]=q.pop()||se.guid++:o),h[u]||(h[u]=a?{}:{toJSON:se.noop}),("object"==typeof e||"function"==typeof e)&&(n?h[u]=se.extend(h[u],e):h[u].data=se.extend(h[u].data,e)),s=h[u],n||(s.data||(s.data={}),s=s.data),void 0!==i&&(s[se.camelCase(e)]=i),"string"==typeof e?(r=s[e],null==r&&(r=s[se.camelCase(e)])):r=s,r}}function l(t,e,i){if(se.acceptData(t)){var n,r,s=t.nodeType,o=s?se.cache:t,a=s?t[se.expando]:se.expando;if(o[a]){if(e&&(n=i?o[a]:o[a].data)){se.isArray(e)?e=e.concat(se.map(e,se.camelCase)):e in n?e=[e]:(e=se.camelCase(e),e=e in n?[e]:e.split(" ")),r=e.length;for(;r--;)delete n[e[r]];if(i?!u(n):!se.isEmptyObject(n))return}(i||(delete o[a].data,u(o[a])))&&(s?se.cleanData([t],!0):ne.deleteExpando||o!=o.window?delete o[a]:o[a]=null)}}}function d(){return!0}function p(){return!1}function f(){try{return me.activeElement}catch(t){}}function m(t){var e=Be.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function g(t,e){var i,n,r=0,s=typeof t.getElementsByTagName!==Se?t.getElementsByTagName(e||"*"):typeof t.querySelectorAll!==Se?t.querySelectorAll(e||"*"):void 0;if(!s)for(s=[],i=t.childNodes||t;null!=(n=i[r]);r++)!e||se.nodeName(n,e)?s.push(n):se.merge(s,g(n,e));return void 0===e||e&&se.nodeName(t,e)?se.merge([t],s):s}function y(t){Me.test(t.type)&&(t.defaultChecked=t.checked)}function v(t,e){return se.nodeName(t,"table")&&se.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function _(t){return t.type=(null!==se.find.attr(t,"type"))+"/"+t.type,t}function b(t){var e=qe.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function x(t,e){for(var i,n=0;null!=(i=t[n]);n++)se._data(i,"globalEval",!e||se._data(e[n],"globalEval"))}function w(t,e){if(1===e.nodeType&&se.hasData(t)){var i,n,r,s=se._data(t),o=se._data(e,s),a=s.events;if(a){delete o.handle,o.events={};for(i in a)for(n=0,r=a[i].length;r>n;n++)se.event.add(e,i,a[i][n])}o.data&&(o.data=se.extend({},o.data))}}function T(t,e){var i,n,r;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!ne.noCloneEvent&&e[se.expando]){r=se._data(e);for(n in r.events)se.removeEvent(e,n,r.handle);e.removeAttribute(se.expando)}"script"===i&&e.text!==t.text?(_(e).text=t.text,b(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),ne.html5Clone&&t.innerHTML&&!se.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&Me.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function S(e,i){var n=se(i.createElement(e)).appendTo(i.body),r=t.getDefaultComputedStyle?t.getDefaultComputedStyle(n[0]).display:se.css(n[0],"display");return n.detach(),r}function C(t){var e=me,i=ti[t];return i||(i=S(t,e),"none"!==i&&i||(Ze=(Ze||se("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=(Ze[0].contentWindow||Ze[0].contentDocument).document,e.write(),e.close(),i=S(t,e),Ze.detach()),ti[t]=i),i}function P(t,e){return{get:function(){var i=t();if(null!=i)return i?(delete this.get,void 0):(this.get=e).apply(this,arguments)}}}function k(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,r=pi.length;r--;)if(e=pi[r]+i,e in t)return e;return n}function E(t,e){for(var i,n,r,s=[],o=0,a=t.length;a>o;o++)n=t[o],n.style&&(s[o]=se._data(n,"olddisplay"),i=n.style.display,e?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&Ae(n)&&(s[o]=se._data(n,"olddisplay",C(n.nodeName)))):s[o]||(r=Ae(n),(i&&"none"!==i||!r)&&se._data(n,"olddisplay",r?i:se.css(n,"display"))));for(o=0;a>o;o++)n=t[o],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?s[o]||"":"none"));return t}function A(t,e,i){var n=ui.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function O(t,e,i,n,r){for(var s=i===(n?"border":"content")?4:"width"===e?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=se.css(t,i+Ee[s],!0,r)),n?("content"===i&&(o-=se.css(t,"padding"+Ee[s],!0,r)),"margin"!==i&&(o-=se.css(t,"border"+Ee[s]+"Width",!0,r))):(o+=se.css(t,"padding"+Ee[s],!0,r),"padding"!==i&&(o+=se.css(t,"border"+Ee[s]+"Width",!0,r)));return o}function M(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,s=ei(t),o=ne.boxSizing()&&"border-box"===se.css(t,"boxSizing",!1,s);if(0>=r||null==r){if(r=ii(t,e,s),(0>r||null==r)&&(r=t.style[e]),ri.test(r))return r;n=o&&(ne.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+O(t,e,i||(o?"border":"content"),n,s)+"px"}function I(t,e,i,n,r){return new I.prototype.init(t,e,i,n,r)}function D(){return setTimeout(function(){fi=void 0}),fi=se.now()}function R(t,e){var i,n={height:t},r=0;for(e=e?1:0;4>r;r+=2-e)i=Ee[r],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function L(t,e,i){for(var n,r=(bi[e]||[]).concat(bi["*"]),s=0,o=r.length;o>s;s++)if(n=r[s].call(i,e,t))return n}function N(t,e,i){var n,r,s,o,a,h,u,c,l=this,d={},p=t.style,f=t.nodeType&&Ae(t),m=se._data(t,"fxshow");i.queue||(a=se._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,h=a.empty.fire,a.empty.fire=function(){a.unqueued||h()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,se.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],u=se.css(t,"display"),c=C(t.nodeName),"none"===u&&(u=c),"inline"===u&&"none"===se.css(t,"float")&&(ne.inlineBlockNeedsLayout&&"inline"!==c?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",ne.shrinkWrapBlocks()||l.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],gi.exec(r)){if(delete e[n],s=s||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;f=!0}d[n]=m&&m[n]||se.style(t,n)}if(!se.isEmptyObject(d)){m?"hidden"in m&&(f=m.hidden):m=se._data(t,"fxshow",{}),s&&(m.hidden=!f),f?se(t).show():l.done(function(){se(t).hide()}),l.done(function(){var e;se._removeData(t,"fxshow");for(e in d)se.style(t,e,d[e])});for(n in d)o=L(f?m[n]:0,n,l),n in m||(m[n]=o.start,f&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}}function B(t,e){var i,n,r,s,o;for(i in t)if(n=se.camelCase(i),r=e[n],s=t[i],se.isArray(s)&&(r=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),o=se.cssHooks[n],o&&"expand"in o){s=o.expand(s),delete t[n];for(i in s)i in t||(t[i]=s[i],e[i]=r)}else e[n]=r}function F(t,e,i){var n,r,s=0,o=_i.length,a=se.Deferred().always(function(){delete h.elem}),h=function(){if(r)return!1;for(var e=fi||D(),i=Math.max(0,u.startTime+u.duration-e),n=i/u.duration||0,s=1-n,o=0,h=u.tweens.length;h>o;o++)u.tweens[o].run(s);return a.notifyWith(t,[u,s,i]),1>s&&h?i:(a.resolveWith(t,[u]),!1)},u=a.promise({elem:t,props:se.extend({},e),opts:se.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:fi||D(),duration:i.duration,tweens:[],createTween:function(e,i){var n=se.Tween(t,u.opts,e,i,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(n),n},stop:function(e){var i=0,n=e?u.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)u.tweens[i].run(1);return e?a.resolveWith(t,[u,e]):a.rejectWith(t,[u,e]),this}}),c=u.props;for(B(c,u.opts.specialEasing);o>s;s++)if(n=_i[s].call(u,t,c,u.opts))return n;return se.map(c,L,u),se.isFunction(u.opts.start)&&u.opts.start.call(t,u),se.fx.timer(se.extend(h,{elem:t,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function j(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,s=e.toLowerCase().match(be)||[];if(se.isFunction(i))for(;n=s[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function U(t,e,i,n){function r(a){var h;return s[a]=!0,se.each(t[a]||[],function(t,a){var u=a(e,i,n);return"string"!=typeof u||o||s[u]?o?!(h=u):void 0:(e.dataTypes.unshift(u),r(u),!1)}),h}var s={},o=t===Wi;return r(e.dataTypes[0])||!s["*"]&&r("*")}function G(t,e){var i,n,r=se.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&se.extend(!0,t,i),t}function X(t,e,i){for(var n,r,s,o,a=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(o in a)if(a[o]&&a[o].test(r)){h.unshift(o);break}if(h[0]in i)s=h[0];else{for(o in i){if(!h[0]||t.converters[o+" "+h[0]]){s=o;break}n||(n=o)}s=s||n}return s?(s!==h[0]&&h.unshift(s),i[s]):void 0}function H(t,e,i,n){var r,s,o,a,h,u={},c=t.dataTypes.slice();if(c[1])for(o in t.converters)u[o.toLowerCase()]=t.converters[o];for(s=c.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!h&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),h=s,s=c.shift())if("*"===s)s=h;else if("*"!==h&&h!==s){if(o=u[h+" "+s]||u["* "+s],!o)for(r in u)if(a=r.split(" "),a[1]===s&&(o=u[h+" "+a[0]]||u["* "+a[0]])){o===!0?o=u[r]:u[r]!==!0&&(s=a[0],c.unshift(a[1]));break}if(o!==!0)if(o&&t["throws"])e=o(e);else try{e=o(e)}catch(l){return{state:"parsererror",error:o?l:"No conversion from "+h+" to "+s}}}return{state:"success",data:e}}function W(t,e,i,n){var r;if(se.isArray(e))se.each(e,function(e,r){i||qi.test(t)?n(t,r):W(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==se.type(e))n(t,e);else for(r in e)W(t+"["+r+"]",e[r],i,n)}function V(){try{return new t.XMLHttpRequest}catch(e){}}function z(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function Y(t){return se.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var q=[],$=q.slice,K=q.concat,J=q.push,Q=q.indexOf,Z={},te=Z.toString,ee=Z.hasOwnProperty,ie="".trim,ne={},re="1.11.0",se=function(t,e){return new se.fn.init(t,e)},oe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ae=/^-ms-/,he=/-([\da-z])/gi,ue=function(t,e){return e.toUpperCase()};se.fn=se.prototype={jquery:re,constructor:se,selector:"",length:0,toArray:function(){return $.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:$.call(this)},pushStack:function(t){var e=se.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return se.each(this,t,e)},map:function(t){return this.pushStack(se.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack($.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:q.sort,splice:q.splice},se.extend=se.fn.extend=function(){var t,e,i,n,r,s,o=arguments[0]||{},a=1,h=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[a]||{},a++),"object"==typeof o||se.isFunction(o)||(o={}),a===h&&(o=this,a--);h>a;a++)if(null!=(r=arguments[a]))for(n in r)t=o[n],i=r[n],o!==i&&(u&&i&&(se.isPlainObject(i)||(e=se.isArray(i)))?(e?(e=!1,s=t&&se.isArray(t)?t:[]):s=t&&se.isPlainObject(t)?t:{},o[n]=se.extend(u,s,i)):void 0!==i&&(o[n]=i));return o},se.extend({expando:"jQuery"+(re+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===se.type(t)},isArray:Array.isArray||function(t){return"array"===se.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return t-parseFloat(t)>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==se.type(t)||t.nodeType||se.isWindow(t))return!1;try{if(t.constructor&&!ee.call(t,"constructor")&&!ee.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ne.ownLast)for(e in t)return ee.call(t,e);for(e in t);return void 0===e||ee.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?Z[te.call(t)]||"object":typeof t},globalEval:function(e){e&&se.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(ae,"ms-").replace(he,ue)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var r,s=0,o=t.length,a=i(t);if(n){if(a)for(;o>s&&(r=e.apply(t[s],n),r!==!1);s++);else for(s in t)if(r=e.apply(t[s],n),r===!1)break}else if(a)for(;o>s&&(r=e.call(t[s],s,t[s]),r!==!1);s++);else for(s in t)if(r=e.call(t[s],s,t[s]),r===!1)break;return t},trim:ie&&!ie.call("﻿ ")?function(t){return null==t?"":ie.call(t)}:function(t){return null==t?"":(t+"").replace(oe,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?se.merge(n,"string"==typeof t?[t]:t):J.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(Q)return Q.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;i>n;)t[r++]=e[n++];if(i!==i)for(;void 0!==e[n];)t[r++]=e[n++];return t.length=r,t},grep:function(t,e,i){for(var n,r=[],s=0,o=t.length,a=!i;o>s;s++)n=!e(t[s],s),n!==a&&r.push(t[s]);return r},map:function(t,e,n){var r,s=0,o=t.length,a=i(t),h=[];if(a)for(;o>s;s++)r=e(t[s],s,n),null!=r&&h.push(r);else for(s in t)r=e(t[s],s,n),null!=r&&h.push(r);return K.apply([],h)},guid:1,proxy:function(t,e){var i,n,r;return"string"==typeof e&&(r=t[e],e=t,t=r),se.isFunction(t)?(i=$.call(arguments,2),n=function(){return t.apply(e||this,i.concat($.call(arguments)))},n.guid=t.guid=t.guid||se.guid++,n):void 0},now:function(){return+new Date},support:ne}),se.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Z["[object "+e+"]"]=e.toLowerCase()});var ce=function(t){function e(t,e,i,n){var r,s,o,a,h,u,l,f,m,g;if((e?e.ownerDocument||e:U)!==I&&M(e),e=e||I,i=i||[],!t||"string"!=typeof t)return i;if(1!==(a=e.nodeType)&&9!==a)return[];if(R&&!n){if(r=ve.exec(t))if(o=r[1]){if(9===a){if(s=e.getElementById(o),!s||!s.parentNode)return i;if(s.id===o)return i.push(s),i}else if(e.ownerDocument&&(s=e.ownerDocument.getElementById(o))&&F(e,s)&&s.id===o)return i.push(s),i}else{if(r[2])return Z.apply(i,e.getElementsByTagName(t)),i;if((o=r[3])&&T.getElementsByClassName&&e.getElementsByClassName)return Z.apply(i,e.getElementsByClassName(o)),i}if(T.qsa&&(!L||!L.test(t))){if(f=l=j,m=e,g=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(u=d(t),(l=e.getAttribute("id"))?f=l.replace(be,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",h=u.length;h--;)u[h]=f+p(u[h]);m=_e.test(t)&&c(e.parentNode)||e,g=u.join(",")}if(g)try{return Z.apply(i,m.querySelectorAll(g)),i}catch(y){}finally{l||e.removeAttribute("id")}}}return x(t.replace(he,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>S.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[j]=!0,t}function r(t){var e=I.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function s(t,e){for(var i=t.split("|"),n=t.length;n--;)S.attrHandle[i[n]]=e}function o(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||q)-(~t.sourceIndex||q);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function h(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function u(t){return n(function(e){return e=+e,n(function(i,n){for(var r,s=t([],i.length,e),o=s.length;o--;)i[r=s[o]]&&(i[r]=!(n[r]=i[r]))})})}function c(t){return t&&typeof t.getElementsByTagName!==Y&&t}function l(){}function d(t,i){var n,r,s,o,a,h,u,c=W[t+" "];if(c)return i?0:c.slice(0);for(a=t,h=[],u=S.preFilter;a;){(!n||(r=ue.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),h.push(s=[])),n=!1,(r=ce.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(he," ")}),a=a.slice(n.length));for(o in S.filter)!(r=fe[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):W(t,h).slice(0)}function p(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function f(t,e,i){var n=e.dir,r=i&&"parentNode"===n,s=X++;return e.first?function(e,i,s){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,s)}:function(e,i,o){var a,h,u=[G,s];if(o){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||r){if(h=e[j]||(e[j]={}),(a=h[n])&&a[0]===G&&a[1]===s)return u[2]=a[2];if(h[n]=u,u[2]=t(e,i,o))return!0}}}function m(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function g(t,e,i,n,r){for(var s,o=[],a=0,h=t.length,u=null!=e;h>a;a++)(s=t[a])&&(!i||i(s,n,r))&&(o.push(s),u&&e.push(a));return o}function y(t,e,i,r,s,o){return r&&!r[j]&&(r=y(r)),s&&!s[j]&&(s=y(s,o)),n(function(n,o,a,h){var u,c,l,d=[],p=[],f=o.length,m=n||b(e||"*",a.nodeType?[a]:a,[]),y=!t||!n&&e?m:g(m,d,t,a,h),v=i?s||(n?t:f||r)?[]:o:y;if(i&&i(y,v,a,h),r)for(u=g(v,p),r(u,[],a,h),c=u.length;c--;)(l=u[c])&&(v[p[c]]=!(y[p[c]]=l));if(n){if(s||t){if(s){for(u=[],c=v.length;c--;)(l=v[c])&&u.push(y[c]=l);s(null,v=[],u,h)}for(c=v.length;c--;)(l=v[c])&&(u=s?ee.call(n,l):d[c])>-1&&(n[u]=!(o[u]=l))}}else v=g(v===o?v.splice(f,v.length):v),s?s(null,o,v,h):Z.apply(o,v)})}function v(t){for(var e,i,n,r=t.length,s=S.relative[t[0].type],o=s||S.relative[" "],a=s?1:0,h=f(function(t){return t===e},o,!0),u=f(function(t){return ee.call(e,t)>-1},o,!0),c=[function(t,i,n){return!s&&(n||i!==E)||((e=i).nodeType?h(t,i,n):u(t,i,n))}];r>a;a++)if(i=S.relative[t[a].type])c=[f(m(c),i)];else{if(i=S.filter[t[a].type].apply(null,t[a].matches),i[j]){for(n=++a;r>n&&!S.relative[t[n].type];n++);return y(a>1&&m(c),a>1&&p(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(he,"$1"),i,n>a&&v(t.slice(a,n)),r>n&&v(t=t.slice(n)),r>n&&p(t))}c.push(i)}return m(c)}function _(t,i){var r=i.length>0,s=t.length>0,o=function(n,o,a,h,u){var c,l,d,p=0,f="0",m=n&&[],y=[],v=E,_=n||s&&S.find.TAG("*",u),b=G+=null==v?1:Math.random()||.1,x=_.length;for(u&&(E=o!==I&&o);f!==x&&null!=(c=_[f]);f++){if(s&&c){for(l=0;d=t[l++];)if(d(c,o,a)){h.push(c);break}u&&(G=b)}r&&((c=!d&&c)&&p--,n&&m.push(c))}if(p+=f,r&&f!==p){for(l=0;d=i[l++];)d(m,y,o,a);if(n){if(p>0)for(;f--;)m[f]||y[f]||(y[f]=J.call(h));y=g(y)}Z.apply(h,y),u&&!n&&y.length>0&&p+i.length>1&&e.uniqueSort(h)}return u&&(G=b,E=v),m};return r?n(o):o}function b(t,i,n){for(var r=0,s=i.length;s>r;r++)e(t,i[r],n);return n}function x(t,e,i,n){var r,s,o,a,h,u=d(t);if(!n&&1===u.length){if(s=u[0]=u[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&T.getById&&9===e.nodeType&&R&&S.relative[s[1].type]){if(e=(S.find.ID(o.matches[0].replace(xe,we),e)||[])[0],!e)return i;t=t.slice(s.shift().value.length)}for(r=fe.needsContext.test(t)?0:s.length;r--&&(o=s[r],!S.relative[a=o.type]);)if((h=S.find[a])&&(n=h(o.matches[0].replace(xe,we),_e.test(s[0].type)&&c(e.parentNode)||e))){if(s.splice(r,1),t=n.length&&p(s),!t)return Z.apply(i,n),i;break}}return k(t,u)(n,e,!R,i,_e.test(t)&&c(e.parentNode)||e),i}var w,T,S,C,P,k,E,A,O,M,I,D,R,L,N,B,F,j="sizzle"+-new Date,U=t.document,G=0,X=0,H=i(),W=i(),V=i(),z=function(t,e){return t===e&&(O=!0),0},Y="undefined",q=1<<31,$={}.hasOwnProperty,K=[],J=K.pop,Q=K.push,Z=K.push,te=K.slice,ee=K.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},ie="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",se=re.replace("w","w#"),oe="\\["+ne+"*("+re+")"+ne+"*(?:([*^$|!~]?=)"+ne+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+se+")|)|)"+ne+"*\\]",ae=":("+re+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+oe.replace(3,8)+")*)|.*)\\)|)",he=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ue=new RegExp("^"+ne+"*,"+ne+"*"),ce=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),le=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),de=new RegExp(ae),pe=new RegExp("^"+se+"$"),fe={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+ie+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},me=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ye=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_e=/[+~]/,be=/'|\\/g,xe=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),we=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Z.apply(K=te.call(U.childNodes),U.childNodes),K[U.childNodes.length].nodeType}catch(Te){Z={apply:K.length?function(t,e){Q.apply(t,te.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}T=e.support={},P=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},M=e.setDocument=function(t){var e,i=t?t.ownerDocument||t:U,n=i.defaultView;return i!==I&&9===i.nodeType&&i.documentElement?(I=i,D=i.documentElement,R=!P(i),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){M()},!1):n.attachEvent&&n.attachEvent("onunload",function(){M()})),T.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),T.getElementsByTagName=r(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),T.getElementsByClassName=ye.test(i.getElementsByClassName)&&r(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),T.getById=r(function(t){return D.appendChild(t).id=j,!i.getElementsByName||!i.getElementsByName(j).length}),T.getById?(S.find.ID=function(t,e){if(typeof e.getElementById!==Y&&R){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},S.filter.ID=function(t){var e=t.replace(xe,we);return function(t){return t.getAttribute("id")===e}}):(delete S.find.ID,S.filter.ID=function(t){var e=t.replace(xe,we);return function(t){var i=typeof t.getAttributeNode!==Y&&t.getAttributeNode("id");return i&&i.value===e}}),S.find.TAG=T.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==Y?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},S.find.CLASS=T.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==Y&&R?e.getElementsByClassName(t):void 0},N=[],L=[],(T.qsa=ye.test(i.querySelectorAll))&&(r(function(t){t.innerHTML="<select t=''><option selected=''></option></select>",t.querySelectorAll("[t^='']").length&&L.push("[*^$]="+ne+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||L.push("\\["+ne+"*(?:value|"+ie+")"),t.querySelectorAll(":checked").length||L.push(":checked")
}),r(function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&L.push("name"+ne+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||L.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),L.push(",.*:")})),(T.matchesSelector=ye.test(B=D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&r(function(t){T.disconnectedMatch=B.call(t,"div"),B.call(t,"[s!='']:x"),N.push("!=",ae)}),L=L.length&&new RegExp(L.join("|")),N=N.length&&new RegExp(N.join("|")),e=ye.test(D.compareDocumentPosition),F=e||ye.test(D.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},z=e?function(t,e){if(t===e)return O=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!T.sortDetached&&e.compareDocumentPosition(t)===n?t===i||t.ownerDocument===U&&F(U,t)?-1:e===i||e.ownerDocument===U&&F(U,e)?1:A?ee.call(A,t)-ee.call(A,e):0:4&n?-1:1)}:function(t,e){if(t===e)return O=!0,0;var n,r=0,s=t.parentNode,a=e.parentNode,h=[t],u=[e];if(!s||!a)return t===i?-1:e===i?1:s?-1:a?1:A?ee.call(A,t)-ee.call(A,e):0;if(s===a)return o(t,e);for(n=t;n=n.parentNode;)h.unshift(n);for(n=e;n=n.parentNode;)u.unshift(n);for(;h[r]===u[r];)r++;return r?o(h[r],u[r]):h[r]===U?-1:u[r]===U?1:0},i):I},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==I&&M(t),i=i.replace(le,"='$1']"),!(!T.matchesSelector||!R||N&&N.test(i)||L&&L.test(i)))try{var n=B.call(t,i);if(n||T.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(r){}return e(i,I,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==I&&M(t),F(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==I&&M(t);var i=S.attrHandle[e.toLowerCase()],n=i&&$.call(S.attrHandle,e.toLowerCase())?i(t,e,!R):void 0;return void 0!==n?n:T.attributes||!R?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(O=!T.detectDuplicates,A=!T.sortStable&&t.slice(0),t.sort(z),O){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return A=null,t},C=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=C(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=C(e);return i},S=e.selectors={cacheLength:50,createPseudo:n,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(xe,we),t[3]=(t[4]||t[5]||"").replace(xe,we),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return fe.CHILD.test(t[0])?null:(t[3]&&void 0!==t[4]?t[2]=t[4]:i&&de.test(i)&&(e=d(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(xe,we).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=H[t+" "];return e||(e=new RegExp("(^|"+ne+")"+t+"("+ne+"|$)"))&&H(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==Y&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var s=e.attr(r,t);return null==s?"!="===i:i?(s+="","="===i?s===n:"!="===i?s!==n:"^="===i?n&&0===s.indexOf(n):"*="===i?n&&s.indexOf(n)>-1:"$="===i?n&&s.slice(-n.length)===n:"~="===i?(" "+s+" ").indexOf(n)>-1:"|="===i?s===n||s.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,h){var u,c,l,d,p,f,m=s!==o?"nextSibling":"previousSibling",g=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!h&&!a;if(g){if(s){for(;m;){for(l=e;l=l[m];)if(a?l.nodeName.toLowerCase()===y:1===l.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&v){for(c=g[j]||(g[j]={}),u=c[t]||[],p=u[0]===G&&u[1],d=u[0]===G&&u[2],l=p&&g.childNodes[p];l=++p&&l&&l[m]||(d=p=0)||f.pop();)if(1===l.nodeType&&++d&&l===e){c[t]=[G,p,d];break}}else if(v&&(u=(e[j]||(e[j]={}))[t])&&u[0]===G)d=u[1];else for(;(l=++p&&l&&l[m]||(d=p=0)||f.pop())&&((a?l.nodeName.toLowerCase()!==y:1!==l.nodeType)||!++d||(v&&((l[j]||(l[j]={}))[t]=[G,d]),l!==e)););return d-=r,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,i){var r,s=S.pseudos[t]||S.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return s[j]?s(i):s.length>1?(r=[t,t,"",i],S.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=s(t,i),o=r.length;o--;)n=ee.call(t,r[o]),t[n]=!(e[n]=r[o])}):function(t){return s(t,0,r)}):s}},pseudos:{not:n(function(t){var e=[],i=[],r=k(t.replace(he,"$1"));return r[j]?n(function(t,e,i,n){for(var s,o=r(t,null,n,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))}):function(t,n,s){return e[0]=t,r(e,null,s,i),!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return function(e){return(e.textContent||e.innerText||C(e)).indexOf(t)>-1}}),lang:n(function(t){return pe.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(xe,we).toLowerCase(),function(e){var i;do if(i=R?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===D},focus:function(t){return t===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!S.pseudos.empty(t)},header:function(t){return ge.test(t.nodeName)},input:function(t){return me.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,i){return[0>i?i+e:i]}),even:u(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:u(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:u(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:u(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}},S.pseudos.nth=S.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[w]=a(w);for(w in{submit:!0,reset:!0})S.pseudos[w]=h(w);return l.prototype=S.filters=S.pseudos,S.setFilters=new l,k=e.compile=function(t,e){var i,n=[],r=[],s=V[t+" "];if(!s){for(e||(e=d(t)),i=e.length;i--;)s=v(e[i]),s[j]?n.push(s):r.push(s);s=V(t,_(r,n))}return s},T.sortStable=j.split("").sort(z).join("")===j,T.detectDuplicates=!!O,M(),T.sortDetached=r(function(t){return 1&t.compareDocumentPosition(I.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||s("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),T.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||s("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||s(ie,function(t,e,i){var n;return i?void 0:t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);se.find=ce,se.expr=ce.selectors,se.expr[":"]=se.expr.pseudos,se.unique=ce.uniqueSort,se.text=ce.getText,se.isXMLDoc=ce.isXML,se.contains=ce.contains;var le=se.expr.match.needsContext,de=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,pe=/^.[^:#\[\.,]*$/;se.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?se.find.matchesSelector(n,t)?[n]:[]:se.find.matches(t,se.grep(e,function(t){return 1===t.nodeType}))},se.fn.extend({find:function(t){var e,i=[],n=this,r=n.length;if("string"!=typeof t)return this.pushStack(se(t).filter(function(){for(e=0;r>e;e++)if(se.contains(n[e],this))return!0}));for(e=0;r>e;e++)se.find(t,n[e],i);return i=this.pushStack(r>1?se.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(n(this,t||[],!1))},not:function(t){return this.pushStack(n(this,t||[],!0))},is:function(t){return!!n(this,"string"==typeof t&&le.test(t)?se(t):t||[],!1).length}});var fe,me=t.document,ge=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ye=se.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:ge.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||fe).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof se?e[0]:e,se.merge(this,se.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:me,!0)),de.test(i[1])&&se.isPlainObject(e))for(i in e)se.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}if(n=me.getElementById(i[2]),n&&n.parentNode){if(n.id!==i[2])return fe.find(t);this.length=1,this[0]=n}return this.context=me,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):se.isFunction(t)?"undefined"!=typeof fe.ready?fe.ready(t):t(se):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),se.makeArray(t,this))};ye.prototype=se.fn,fe=se(me);var ve=/^(?:parents|prev(?:Until|All))/,_e={children:!0,contents:!0,next:!0,prev:!0};se.extend({dir:function(t,e,i){for(var n=[],r=t[e];r&&9!==r.nodeType&&(void 0===i||1!==r.nodeType||!se(r).is(i));)1===r.nodeType&&n.push(r),r=r[e];return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),se.fn.extend({has:function(t){var e,i=se(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(se.contains(this,i[e]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,s=[],o=le.test(t)||"string"!=typeof t?se(t,e||this.context):0;r>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&se.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?se.unique(s):s)},index:function(t){return t?"string"==typeof t?se.inArray(this[0],se(t)):se.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(se.unique(se.merge(this.get(),se(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),se.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return se.dir(t,"parentNode")},parentsUntil:function(t,e,i){return se.dir(t,"parentNode",i)},next:function(t){return r(t,"nextSibling")},prev:function(t){return r(t,"previousSibling")},nextAll:function(t){return se.dir(t,"nextSibling")},prevAll:function(t){return se.dir(t,"previousSibling")},nextUntil:function(t,e,i){return se.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return se.dir(t,"previousSibling",i)},siblings:function(t){return se.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return se.sibling(t.firstChild)},contents:function(t){return se.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:se.merge([],t.childNodes)}},function(t,e){se.fn[t]=function(i,n){var r=se.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=se.filter(n,r)),this.length>1&&(_e[t]||(r=se.unique(r)),ve.test(t)&&(r=r.reverse())),this.pushStack(r)}});var be=/\S+/g,xe={};se.Callbacks=function(t){t="string"==typeof t?xe[t]||s(t):se.extend({},t);var e,i,n,r,o,a,h=[],u=!t.once&&[],c=function(s){for(i=t.memory&&s,n=!0,o=a||0,a=0,r=h.length,e=!0;h&&r>o;o++)if(h[o].apply(s[0],s[1])===!1&&t.stopOnFalse){i=!1;break}e=!1,h&&(u?u.length&&c(u.shift()):i?h=[]:l.disable())},l={add:function(){if(h){var n=h.length;!function s(e){se.each(e,function(e,i){var n=se.type(i);"function"===n?t.unique&&l.has(i)||h.push(i):i&&i.length&&"string"!==n&&s(i)})}(arguments),e?r=h.length:i&&(a=n,c(i))}return this},remove:function(){return h&&se.each(arguments,function(t,i){for(var n;(n=se.inArray(i,h,n))>-1;)h.splice(n,1),e&&(r>=n&&r--,o>=n&&o--)}),this},has:function(t){return t?se.inArray(t,h)>-1:!(!h||!h.length)},empty:function(){return h=[],r=0,this},disable:function(){return h=u=i=void 0,this},disabled:function(){return!h},lock:function(){return u=void 0,i||l.disable(),this},locked:function(){return!u},fireWith:function(t,i){return!h||n&&!u||(i=i||[],i=[t,i.slice?i.slice():i],e?u.push(i):c(i)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},se.extend({Deferred:function(t){var e=[["resolve","done",se.Callbacks("once memory"),"resolved"],["reject","fail",se.Callbacks("once memory"),"rejected"],["notify","progress",se.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return se.Deferred(function(i){se.each(e,function(e,s){var o=se.isFunction(t[e])&&t[e];r[s[1]](function(){var t=o&&o.apply(this,arguments);t&&se.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s[0]+"With"](this===n?i.promise():this,o?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?se.extend(t,n):n}},r={};return n.pipe=n.then,se.each(e,function(t,s){var o=s[2],a=s[3];n[s[1]]=o.add,a&&o.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),r[s[0]]=function(){return r[s[0]+"With"](this===r?n:this,arguments),this},r[s[0]+"With"]=o.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,s=$.call(arguments),o=s.length,a=1!==o||t&&se.isFunction(t.promise)?o:0,h=1===a?t:se.Deferred(),u=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?$.call(arguments):r,n===e?h.notifyWith(i,n):--a||h.resolveWith(i,n)}};if(o>1)for(e=new Array(o),i=new Array(o),n=new Array(o);o>r;r++)s[r]&&se.isFunction(s[r].promise)?s[r].promise().done(u(r,n,s)).fail(h.reject).progress(u(r,i,e)):--a;return a||h.resolveWith(n,s),h.promise()}});var we;se.fn.ready=function(t){return se.ready.promise().done(t),this},se.extend({isReady:!1,readyWait:1,holdReady:function(t){t?se.readyWait++:se.ready(!0)},ready:function(t){if(t===!0?!--se.readyWait:!se.isReady){if(!me.body)return setTimeout(se.ready);se.isReady=!0,t!==!0&&--se.readyWait>0||(we.resolveWith(me,[se]),se.fn.trigger&&se(me).trigger("ready").off("ready"))}}}),se.ready.promise=function(e){if(!we)if(we=se.Deferred(),"complete"===me.readyState)setTimeout(se.ready);else if(me.addEventListener)me.addEventListener("DOMContentLoaded",a,!1),t.addEventListener("load",a,!1);else{me.attachEvent("onreadystatechange",a),t.attachEvent("onload",a);var i=!1;try{i=null==t.frameElement&&me.documentElement}catch(n){}i&&i.doScroll&&!function r(){if(!se.isReady){try{i.doScroll("left")}catch(t){return setTimeout(r,50)}o(),se.ready()}}()}return we.promise(e)};var Te,Se="undefined";for(Te in se(ne))break;ne.ownLast="0"!==Te,ne.inlineBlockNeedsLayout=!1,se(function(){var t,e,i=me.getElementsByTagName("body")[0];i&&(t=me.createElement("div"),t.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",e=me.createElement("div"),i.appendChild(t).appendChild(e),typeof e.style.zoom!==Se&&(e.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(ne.inlineBlockNeedsLayout=3===e.offsetWidth)&&(i.style.zoom=1)),i.removeChild(t),t=e=null)}),function(){var t=me.createElement("div");if(null==ne.deleteExpando){ne.deleteExpando=!0;try{delete t.test}catch(e){ne.deleteExpando=!1}}t=null}(),se.acceptData=function(t){var e=se.noData[(t.nodeName+" ").toLowerCase()],i=+t.nodeType||1;return 1!==i&&9!==i?!1:!e||e!==!0&&t.getAttribute("classid")===e};var Ce=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Pe=/([A-Z])/g;se.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?se.cache[t[se.expando]]:t[se.expando],!!t&&!u(t)},data:function(t,e,i){return c(t,e,i)},removeData:function(t,e){return l(t,e)},_data:function(t,e,i){return c(t,e,i,!0)},_removeData:function(t,e){return l(t,e,!0)}}),se.fn.extend({data:function(t,e){var i,n,r,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(r=se.data(s),1===s.nodeType&&!se._data(s,"parsedAttrs"))){for(i=o.length;i--;)n=o[i].name,0===n.indexOf("data-")&&(n=se.camelCase(n.slice(5)),h(s,n,r[n]));se._data(s,"parsedAttrs",!0)}return r}return"object"==typeof t?this.each(function(){se.data(this,t)}):arguments.length>1?this.each(function(){se.data(this,t,e)}):s?h(s,t,se.data(s,t)):void 0},removeData:function(t){return this.each(function(){se.removeData(this,t)})}}),se.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=se._data(t,e),i&&(!n||se.isArray(i)?n=se._data(t,e,se.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=se.queue(t,e),n=i.length,r=i.shift(),s=se._queueHooks(t,e),o=function(){se.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete s.stop,r.call(t,o,s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return se._data(t,i)||se._data(t,i,{empty:se.Callbacks("once memory").add(function(){se._removeData(t,e+"queue"),se._removeData(t,i)})})}}),se.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?se.queue(this[0],t):void 0===e?this:this.each(function(){var i=se.queue(this,t,e);se._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&se.dequeue(this,t)})},dequeue:function(t){return this.each(function(){se.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=se.Deferred(),s=this,o=this.length,a=function(){--n||r.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)i=se._data(s[o],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});var ke=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ee=["Top","Right","Bottom","Left"],Ae=function(t,e){return t=e||t,"none"===se.css(t,"display")||!se.contains(t.ownerDocument,t)},Oe=se.access=function(t,e,i,n,r,s,o){var a=0,h=t.length,u=null==i;if("object"===se.type(i)){r=!0;for(a in i)se.access(t,e,a,i[a],!0,s,o)}else if(void 0!==n&&(r=!0,se.isFunction(n)||(o=!0),u&&(o?(e.call(t,n),e=null):(u=e,e=function(t,e,i){return u.call(se(t),i)})),e))for(;h>a;a++)e(t[a],i,o?n:n.call(t[a],a,e(t[a],i)));return r?t:u?e.call(t):h?e(t[0],i):s},Me=/^(?:checkbox|radio)$/i;!function(){var t=me.createDocumentFragment(),e=me.createElement("div"),i=me.createElement("input");if(e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a>",ne.leadingWhitespace=3===e.firstChild.nodeType,ne.tbody=!e.getElementsByTagName("tbody").length,ne.htmlSerialize=!!e.getElementsByTagName("link").length,ne.html5Clone="<:nav></:nav>"!==me.createElement("nav").cloneNode(!0).outerHTML,i.type="checkbox",i.checked=!0,t.appendChild(i),ne.appendChecked=i.checked,e.innerHTML="<textarea>x</textarea>",ne.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,t.appendChild(e),e.innerHTML="<input type='radio' checked='checked' name='t'/>",ne.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,ne.noCloneEvent=!0,e.attachEvent&&(e.attachEvent("onclick",function(){ne.noCloneEvent=!1}),e.cloneNode(!0).click()),null==ne.deleteExpando){ne.deleteExpando=!0;try{delete e.test}catch(n){ne.deleteExpando=!1}}t=e=i=null}(),function(){var e,i,n=me.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})i="on"+e,(ne[e+"Bubbles"]=i in t)||(n.setAttribute(i,"t"),ne[e+"Bubbles"]=n.attributes[i].expando===!1);n=null}();var Ie=/^(?:input|select|textarea)$/i,De=/^key/,Re=/^(?:mouse|contextmenu)|click/,Le=/^(?:focusinfocus|focusoutblur)$/,Ne=/^([^.]*)(?:\.(.+)|)$/;se.event={global:{},add:function(t,e,i,n,r){var s,o,a,h,u,c,l,d,p,f,m,g=se._data(t);if(g){for(i.handler&&(h=i,i=h.handler,r=h.selector),i.guid||(i.guid=se.guid++),(o=g.events)||(o=g.events={}),(c=g.handle)||(c=g.handle=function(t){return typeof se===Se||t&&se.event.triggered===t.type?void 0:se.event.dispatch.apply(c.elem,arguments)},c.elem=t),e=(e||"").match(be)||[""],a=e.length;a--;)s=Ne.exec(e[a])||[],p=m=s[1],f=(s[2]||"").split(".").sort(),p&&(u=se.event.special[p]||{},p=(r?u.delegateType:u.bindType)||p,u=se.event.special[p]||{},l=se.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&se.expr.match.needsContext.test(r),namespace:f.join(".")},h),(d=o[p])||(d=o[p]=[],d.delegateCount=0,u.setup&&u.setup.call(t,n,f,c)!==!1||(t.addEventListener?t.addEventListener(p,c,!1):t.attachEvent&&t.attachEvent("on"+p,c))),u.add&&(u.add.call(t,l),l.handler.guid||(l.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,l):d.push(l),se.event.global[p]=!0);t=null}},remove:function(t,e,i,n,r){var s,o,a,h,u,c,l,d,p,f,m,g=se.hasData(t)&&se._data(t);if(g&&(c=g.events)){for(e=(e||"").match(be)||[""],u=e.length;u--;)if(a=Ne.exec(e[u])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p){for(l=se.event.special[p]||{},p=(n?l.delegateType:l.bindType)||p,d=c[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),h=s=d.length;s--;)o=d[s],!r&&m!==o.origType||i&&i.guid!==o.guid||a&&!a.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(d.splice(s,1),o.selector&&d.delegateCount--,l.remove&&l.remove.call(t,o));h&&!d.length&&(l.teardown&&l.teardown.call(t,f,g.handle)!==!1||se.removeEvent(t,p,g.handle),delete c[p])}else for(p in c)se.event.remove(t,p+e[u],i,n,!0);se.isEmptyObject(c)&&(delete g.handle,se._removeData(t,"events"))}},trigger:function(e,i,n,r){var s,o,a,h,u,c,l,d=[n||me],p=ee.call(e,"type")?e.type:e,f=ee.call(e,"namespace")?e.namespace.split("."):[];if(a=c=n=n||me,3!==n.nodeType&&8!==n.nodeType&&!Le.test(p+se.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),o=p.indexOf(":")<0&&"on"+p,e=e[se.expando]?e:new se.Event(p,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=f.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:se.makeArray(i,[e]),u=se.event.special[p]||{},r||!u.trigger||u.trigger.apply(n,i)!==!1)){if(!r&&!u.noBubble&&!se.isWindow(n)){for(h=u.delegateType||p,Le.test(h+p)||(a=a.parentNode);a;a=a.parentNode)d.push(a),c=a;c===(n.ownerDocument||me)&&d.push(c.defaultView||c.parentWindow||t)}for(l=0;(a=d[l++])&&!e.isPropagationStopped();)e.type=l>1?h:u.bindType||p,s=(se._data(a,"events")||{})[e.type]&&se._data(a,"handle"),s&&s.apply(a,i),s=o&&a[o],s&&s.apply&&se.acceptData(a)&&(e.result=s.apply(a,i),e.result===!1&&e.preventDefault());if(e.type=p,!r&&!e.isDefaultPrevented()&&(!u._default||u._default.apply(d.pop(),i)===!1)&&se.acceptData(n)&&o&&n[p]&&!se.isWindow(n)){c=n[o],c&&(n[o]=null),se.event.triggered=p;try{n[p]()}catch(m){}se.event.triggered=void 0,c&&(n[o]=c)}return e.result}},dispatch:function(t){t=se.event.fix(t);var e,i,n,r,s,o=[],a=$.call(arguments),h=(se._data(this,"events")||{})[t.type]||[],u=se.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,t)!==!1){for(o=se.event.handlers.call(this,t,h),e=0;(r=o[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,s=0;(n=r.handlers[s++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(n.namespace))&&(t.handleObj=n,t.data=n.data,i=((se.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,a),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,s,o=[],a=e.delegateCount,h=t.target;if(a&&h.nodeType&&(!t.button||"click"!==t.type))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(h.disabled!==!0||"click"!==t.type)){for(r=[],s=0;a>s;s++)n=e[s],i=n.selector+" ",void 0===r[i]&&(r[i]=n.needsContext?se(i,this).index(h)>=0:se.find(i,this,null,[h]).length),r[i]&&r.push(n);r.length&&o.push({elem:h,handlers:r})}return a<e.length&&o.push({elem:this,handlers:e.slice(a)}),o},fix:function(t){if(t[se.expando])return t;var e,i,n,r=t.type,s=t,o=this.fixHooks[r];for(o||(this.fixHooks[r]=o=Re.test(r)?this.mouseHooks:De.test(r)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new se.Event(s),e=n.length;e--;)i=n[e],t[i]=s[i];return t.target||(t.target=s.srcElement||me),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,o.filter?o.filter(t,s):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,s=e.button,o=e.fromElement;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||me,r=n.documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&o&&(t.relatedTarget=o===t.target?e.toElement:o),t.which||void 0===s||(t.which=1&s?1:2&s?3:4&s?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return se.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return se.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=se.extend(new se.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?se.event.trigger(r,null,e):se.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},se.removeEvent=me.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===Se&&(t[n]=null),t.detachEvent(n,i))},se.Event=function(t,e){return this instanceof se.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&(t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault())?d:p):this.type=t,e&&se.extend(this,e),this.timeStamp=t&&t.timeStamp||se.now(),this[se.expando]=!0,void 0):new se.Event(t,e)},se.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=d,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=d,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=d,this.stopPropagation()}},se.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){se.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,s=t.handleObj;return(!r||r!==n&&!se.contains(n,r))&&(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}}),ne.submitBubbles||(se.event.special.submit={setup:function(){return se.nodeName(this,"form")?!1:(se.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,i=se.nodeName(e,"input")||se.nodeName(e,"button")?e.form:void 0;i&&!se._data(i,"submitBubbles")&&(se.event.add(i,"submit._submit",function(t){t._submit_bubble=!0}),se._data(i,"submitBubbles",!0))}),void 0)},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&se.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return se.nodeName(this,"form")?!1:(se.event.remove(this,"._submit"),void 0)}}),ne.changeBubbles||(se.event.special.change={setup:function(){return Ie.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(se.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),se.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),se.event.simulate("change",this,t,!0)})),!1):(se.event.add(this,"beforeactivate._change",function(t){var e=t.target;Ie.test(e.nodeName)&&!se._data(e,"changeBubbles")&&(se.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||se.event.simulate("change",this.parentNode,t,!0)}),se._data(e,"changeBubbles",!0))}),void 0)},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return se.event.remove(this,"._change"),!Ie.test(this.nodeName)}}),ne.focusinBubbles||se.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){se.event.simulate(e,t.target,se.event.fix(t),!0)};se.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=se._data(n,e);r||n.addEventListener(t,i,!0),se._data(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=se._data(n,e)-1;r?se._data(n,e,r):(n.removeEventListener(t,i,!0),se._removeData(n,e))}}}),se.fn.extend({on:function(t,e,i,n,r){var s,o;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(s in t)this.on(s,e,i,t[s],r);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=p;else if(!n)return this;return 1===r&&(o=n,n=function(t){return se().off(t),o.apply(this,arguments)},n.guid=o.guid||(o.guid=se.guid++)),this.each(function(){se.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,se(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return(e===!1||"function"==typeof e)&&(i=e,e=void 0),i===!1&&(i=p),this.each(function(){se.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){se.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?se.event.trigger(t,e,i,!0):void 0}});var Be="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Fe=/ jQuery\d+="(?:null|\d+)"/g,je=new RegExp("<(?:"+Be+")[\\s/>]","i"),Ue=/^\s+/,Ge=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Xe=/<([\w:]+)/,He=/<tbody/i,We=/<|&#?\w+;/,Ve=/<(?:script|style|link)/i,ze=/checked\s*(?:[^=]|=\s*.checked.)/i,Ye=/^$|\/(?:java|ecma)script/i,qe=/^true\/(.*)/,$e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ke={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ne.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Je=m(me),Qe=Je.appendChild(me.createElement("div"));
Ke.optgroup=Ke.option,Ke.tbody=Ke.tfoot=Ke.colgroup=Ke.caption=Ke.thead,Ke.th=Ke.td,se.extend({clone:function(t,e,i){var n,r,s,o,a,h=se.contains(t.ownerDocument,t);if(ne.html5Clone||se.isXMLDoc(t)||!je.test("<"+t.nodeName+">")?s=t.cloneNode(!0):(Qe.innerHTML=t.outerHTML,Qe.removeChild(s=Qe.firstChild)),!(ne.noCloneEvent&&ne.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||se.isXMLDoc(t)))for(n=g(s),a=g(t),o=0;null!=(r=a[o]);++o)n[o]&&T(r,n[o]);if(e)if(i)for(a=a||g(t),n=n||g(s),o=0;null!=(r=a[o]);o++)w(r,n[o]);else w(t,s);return n=g(s,"script"),n.length>0&&x(n,!h&&g(t,"script")),n=a=r=null,s},buildFragment:function(t,e,i,n){for(var r,s,o,a,h,u,c,l=t.length,d=m(e),p=[],f=0;l>f;f++)if(s=t[f],s||0===s)if("object"===se.type(s))se.merge(p,s.nodeType?[s]:s);else if(We.test(s)){for(a=a||d.appendChild(e.createElement("div")),h=(Xe.exec(s)||["",""])[1].toLowerCase(),c=Ke[h]||Ke._default,a.innerHTML=c[1]+s.replace(Ge,"<$1></$2>")+c[2],r=c[0];r--;)a=a.lastChild;if(!ne.leadingWhitespace&&Ue.test(s)&&p.push(e.createTextNode(Ue.exec(s)[0])),!ne.tbody)for(s="table"!==h||He.test(s)?"<table>"!==c[1]||He.test(s)?0:a:a.firstChild,r=s&&s.childNodes.length;r--;)se.nodeName(u=s.childNodes[r],"tbody")&&!u.childNodes.length&&s.removeChild(u);for(se.merge(p,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=d.lastChild}else p.push(e.createTextNode(s));for(a&&d.removeChild(a),ne.appendChecked||se.grep(g(p,"input"),y),f=0;s=p[f++];)if((!n||-1===se.inArray(s,n))&&(o=se.contains(s.ownerDocument,s),a=g(d.appendChild(s),"script"),o&&x(a),i))for(r=0;s=a[r++];)Ye.test(s.type||"")&&i.push(s);return a=null,d},cleanData:function(t,e){for(var i,n,r,s,o=0,a=se.expando,h=se.cache,u=ne.deleteExpando,c=se.event.special;null!=(i=t[o]);o++)if((e||se.acceptData(i))&&(r=i[a],s=r&&h[r])){if(s.events)for(n in s.events)c[n]?se.event.remove(i,n):se.removeEvent(i,n,s.handle);h[r]&&(delete h[r],u?delete i[a]:typeof i.removeAttribute!==Se?i.removeAttribute(a):i[a]=null,q.push(r))}}}),se.fn.extend({text:function(t){return Oe(this,function(t){return void 0===t?se.text(this):this.empty().append((this[0]&&this[0].ownerDocument||me).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=v(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=v(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?se.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||se.cleanData(g(i)),i.parentNode&&(e&&se.contains(i.ownerDocument,i)&&x(g(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&se.cleanData(g(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&se.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return se.clone(this,t,e)})},html:function(t){return Oe(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(Fe,""):void 0;if(!("string"!=typeof t||Ve.test(t)||!ne.htmlSerialize&&je.test(t)||!ne.leadingWhitespace&&Ue.test(t)||Ke[(Xe.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Ge,"<$1></$2>");try{for(;n>i;i++)e=this[i]||{},1===e.nodeType&&(se.cleanData(g(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,se.cleanData(g(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=K.apply([],t);var i,n,r,s,o,a,h=0,u=this.length,c=this,l=u-1,d=t[0],p=se.isFunction(d);if(p||u>1&&"string"==typeof d&&!ne.checkClone&&ze.test(d))return this.each(function(i){var n=c.eq(i);p&&(t[0]=d.call(this,i,n.html())),n.domManip(t,e)});if(u&&(a=se.buildFragment(t,this[0].ownerDocument,!1,this),i=a.firstChild,1===a.childNodes.length&&(a=i),i)){for(s=se.map(g(a,"script"),_),r=s.length;u>h;h++)n=a,h!==l&&(n=se.clone(n,!0,!0),r&&se.merge(s,g(n,"script"))),e.call(this[h],n,h);if(r)for(o=s[s.length-1].ownerDocument,se.map(s,b),h=0;r>h;h++)n=s[h],Ye.test(n.type||"")&&!se._data(n,"globalEval")&&se.contains(o,n)&&(n.src?se._evalUrl&&se._evalUrl(n.src):se.globalEval((n.text||n.textContent||n.innerHTML||"").replace($e,"")));a=i=null}return this}}),se.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){se.fn[t]=function(t){for(var i,n=0,r=[],s=se(t),o=s.length-1;o>=n;n++)i=n===o?this:this.clone(!0),se(s[n])[e](i),J.apply(r,i.get());return this.pushStack(r)}});var Ze,ti={};!function(){var t,e,i=me.createElement("div"),n="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=i.getElementsByTagName("a")[0],t.style.cssText="float:left;opacity:.5",ne.opacity=/^0.5/.test(t.style.opacity),ne.cssFloat=!!t.style.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===i.style.backgroundClip,t=i=null,ne.shrinkWrapBlocks=function(){var t,i,r,s;if(null==e){if(t=me.getElementsByTagName("body")[0],!t)return;s="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",i=me.createElement("div"),r=me.createElement("div"),t.appendChild(i).appendChild(r),e=!1,typeof r.style.zoom!==Se&&(r.style.cssText=n+";width:1px;padding:1px;zoom:1",r.innerHTML="<div></div>",r.firstChild.style.width="5px",e=3!==r.offsetWidth),t.removeChild(i),t=i=r=null}return e}}();var ei,ii,ni=/^margin/,ri=new RegExp("^("+ke+")(?!px)[a-z%]+$","i"),si=/^(top|right|bottom|left)$/;t.getComputedStyle?(ei=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)},ii=function(t,e,i){var n,r,s,o,a=t.style;return i=i||ei(t),o=i?i.getPropertyValue(e)||i[e]:void 0,i&&(""!==o||se.contains(t.ownerDocument,t)||(o=se.style(t,e)),ri.test(o)&&ni.test(e)&&(n=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=r,a.maxWidth=s)),void 0===o?o:o+""}):me.documentElement.currentStyle&&(ei=function(t){return t.currentStyle},ii=function(t,e,i){var n,r,s,o,a=t.style;return i=i||ei(t),o=i?i[e]:void 0,null==o&&a&&a[e]&&(o=a[e]),ri.test(o)&&!si.test(e)&&(n=a.left,r=t.runtimeStyle,s=r&&r.left,s&&(r.left=t.currentStyle.left),a.left="fontSize"===e?"1em":o,o=a.pixelLeft+"px",a.left=n,s&&(r.left=s)),void 0===o?o:o+""||"auto"}),function(){function e(){var e,i,n=me.getElementsByTagName("body")[0];n&&(e=me.createElement("div"),i=me.createElement("div"),e.style.cssText=u,n.appendChild(e).appendChild(i),i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",se.swap(n,null!=n.style.zoom?{zoom:1}:{},function(){r=4===i.offsetWidth}),s=!0,o=!1,a=!0,t.getComputedStyle&&(o="1%"!==(t.getComputedStyle(i,null)||{}).top,s="4px"===(t.getComputedStyle(i,null)||{width:"4px"}).width),n.removeChild(e),i=n=null)}var i,n,r,s,o,a,h=me.createElement("div"),u="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=h.getElementsByTagName("a")[0],i.style.cssText="float:left;opacity:.5",ne.opacity=/^0.5/.test(i.style.opacity),ne.cssFloat=!!i.style.cssFloat,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===h.style.backgroundClip,i=h=null,se.extend(ne,{reliableHiddenOffsets:function(){if(null!=n)return n;var t,e,i,r=me.createElement("div"),s=me.getElementsByTagName("body")[0];if(s)return r.setAttribute("className","t"),r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=me.createElement("div"),t.style.cssText=u,s.appendChild(t).appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=r.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",i=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",n=i&&0===e[0].offsetHeight,s.removeChild(t),r=s=null,n},boxSizing:function(){return null==r&&e(),r},boxSizingReliable:function(){return null==s&&e(),s},pixelPosition:function(){return null==o&&e(),o},reliableMarginRight:function(){var e,i,n,r;if(null==a&&t.getComputedStyle){if(e=me.getElementsByTagName("body")[0],!e)return;i=me.createElement("div"),n=me.createElement("div"),i.style.cssText=u,e.appendChild(i).appendChild(n),r=n.appendChild(me.createElement("div")),r.style.cssText=n.style.cssText=c,r.style.marginRight=r.style.width="0",n.style.width="1px",a=!parseFloat((t.getComputedStyle(r,null)||{}).marginRight),e.removeChild(i)}return a}})}(),se.swap=function(t,e,i,n){var r,s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];r=i.apply(t,n||[]);for(s in e)t.style[s]=o[s];return r};var oi=/alpha\([^)]*\)/i,ai=/opacity\s*=\s*([^)]*)/,hi=/^(none|table(?!-c[ea]).+)/,ui=new RegExp("^("+ke+")(.*)$","i"),ci=new RegExp("^([+-])=("+ke+")","i"),li={position:"absolute",visibility:"hidden",display:"block"},di={letterSpacing:0,fontWeight:400},pi=["Webkit","O","Moz","ms"];se.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ii(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ne.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=se.camelCase(e),h=t.style;if(e=se.cssProps[a]||(se.cssProps[a]=k(h,a)),o=se.cssHooks[e]||se.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(r=o.get(t,!1,n))?r:h[e];if(s=typeof i,"string"===s&&(r=ci.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(se.css(t,e)),s="number"),null!=i&&i===i&&("number"!==s||se.cssNumber[a]||(i+="px"),ne.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),!(o&&"set"in o&&void 0===(i=o.set(t,i,n)))))try{h[e]="",h[e]=i}catch(u){}}},css:function(t,e,i,n){var r,s,o,a=se.camelCase(e);return e=se.cssProps[a]||(se.cssProps[a]=k(t.style,a)),o=se.cssHooks[e]||se.cssHooks[a],o&&"get"in o&&(s=o.get(t,!0,i)),void 0===s&&(s=ii(t,e,n)),"normal"===s&&e in di&&(s=di[e]),""===i||i?(r=parseFloat(s),i===!0||se.isNumeric(r)?r||0:s):s}}),se.each(["height","width"],function(t,e){se.cssHooks[e]={get:function(t,i,n){return i?0===t.offsetWidth&&hi.test(se.css(t,"display"))?se.swap(t,li,function(){return M(t,e,n)}):M(t,e,n):void 0},set:function(t,i,n){var r=n&&ei(t);return A(t,i,n?O(t,e,n,ne.boxSizing()&&"border-box"===se.css(t,"boxSizing",!1,r),r):0)}}}),ne.opacity||(se.cssHooks.opacity={get:function(t,e){return ai.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,r=se.isNumeric(e)?"alpha(opacity="+100*e+")":"",s=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===se.trim(s.replace(oi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=oi.test(s)?s.replace(oi,r):s+" "+r)}}),se.cssHooks.marginRight=P(ne.reliableMarginRight,function(t,e){return e?se.swap(t,{display:"inline-block"},ii,[t,"marginRight"]):void 0}),se.each({margin:"",padding:"",border:"Width"},function(t,e){se.cssHooks[t+e]={expand:function(i){for(var n=0,r={},s="string"==typeof i?i.split(" "):[i];4>n;n++)r[t+Ee[n]+e]=s[n]||s[n-2]||s[0];return r}},ni.test(t)||(se.cssHooks[t+e].set=A)}),se.fn.extend({css:function(t,e){return Oe(this,function(t,e,i){var n,r,s={},o=0;if(se.isArray(e)){for(n=ei(t),r=e.length;r>o;o++)s[e[o]]=se.css(t,e[o],!1,n);return s}return void 0!==i?se.style(t,e,i):se.css(t,e)},t,e,arguments.length>1)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ae(this)?se(this).show():se(this).hide()})}}),se.Tween=I,I.prototype={constructor:I,init:function(t,e,i,n,r,s){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(se.cssNumber[i]?"":"px")},cur:function(){var t=I.propHooks[this.prop];return t&&t.get?t.get(this):I.propHooks._default.get(this)},run:function(t){var e,i=I.propHooks[this.prop];return this.pos=e=this.options.duration?se.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=se.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){se.fx.step[t.prop]?se.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[se.cssProps[t.prop]]||se.cssHooks[t.prop])?se.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},se.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},se.fx=I.prototype.init,se.fx.step={};var fi,mi,gi=/^(?:toggle|show|hide)$/,yi=new RegExp("^(?:([+-])=|)("+ke+")([a-z%]*)$","i"),vi=/queueHooks$/,_i=[N],bi={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=yi.exec(e),s=r&&r[3]||(se.cssNumber[t]?"":"px"),o=(se.cssNumber[t]||"px"!==s&&+n)&&yi.exec(se.css(i.elem,t)),a=1,h=20;if(o&&o[3]!==s){s=s||o[3],r=r||[],o=+n||1;do a=a||".5",o/=a,se.style(i.elem,t,o+s);while(a!==(a=i.cur()/n)&&1!==a&&--h)}return r&&(o=i.start=+o||+n||0,i.unit=s,i.end=r[1]?o+(r[1]+1)*r[2]:+r[2]),i}]};se.Animation=se.extend(F,{tweener:function(t,e){se.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;r>n;n++)i=t[n],bi[i]=bi[i]||[],bi[i].unshift(e)},prefilter:function(t,e){e?_i.unshift(t):_i.push(t)}}),se.speed=function(t,e,i){var n=t&&"object"==typeof t?se.extend({},t):{complete:i||!i&&e||se.isFunction(t)&&t,duration:t,easing:i&&e||e&&!se.isFunction(e)&&e};return n.duration=se.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in se.fx.speeds?se.fx.speeds[n.duration]:se.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){se.isFunction(n.old)&&n.old.call(this),n.queue&&se.dequeue(this,n.queue)},n},se.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Ae).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=se.isEmptyObject(t),s=se.speed(e,i,n),o=function(){var e=F(this,se.extend({},t),s);(r||se._data(this,"finish"))&&e.stop(!0)};return o.finish=o,r||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",s=se.timers,o=se._data(this);if(r)o[r]&&o[r].stop&&n(o[r]);else for(r in o)o[r]&&o[r].stop&&vi.test(r)&&n(o[r]);for(r=s.length;r--;)s[r].elem!==this||null!=t&&s[r].queue!==t||(s[r].anim.stop(i),e=!1,s.splice(r,1));(e||!i)&&se.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=se._data(this),n=i[t+"queue"],r=i[t+"queueHooks"],s=se.timers,o=n?n.length:0;for(i.finish=!0,se.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;o>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),se.each(["toggle","show","hide"],function(t,e){var i=se.fn[e];se.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(R(e,!0),t,n,r)}}),se.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){se.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),se.timers=[],se.fx.tick=function(){var t,e=se.timers,i=0;for(fi=se.now();i<e.length;i++)t=e[i],t()||e[i]!==t||e.splice(i--,1);e.length||se.fx.stop(),fi=void 0},se.fx.timer=function(t){se.timers.push(t),t()?se.fx.start():se.timers.pop()},se.fx.interval=13,se.fx.start=function(){mi||(mi=setInterval(se.fx.tick,se.fx.interval))},se.fx.stop=function(){clearInterval(mi),mi=null},se.fx.speeds={slow:600,fast:200,_default:400},se.fn.delay=function(t,e){return t=se.fx?se.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t,e,i,n,r=me.createElement("div");r.setAttribute("className","t"),r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=r.getElementsByTagName("a")[0],i=me.createElement("select"),n=i.appendChild(me.createElement("option")),e=r.getElementsByTagName("input")[0],t.style.cssText="top:1px",ne.getSetAttribute="t"!==r.className,ne.style=/top/.test(t.getAttribute("style")),ne.hrefNormalized="/a"===t.getAttribute("href"),ne.checkOn=!!e.value,ne.optSelected=n.selected,ne.enctype=!!me.createElement("form").enctype,i.disabled=!0,ne.optDisabled=!n.disabled,e=me.createElement("input"),e.setAttribute("value",""),ne.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),ne.radioValue="t"===e.value,t=e=i=n=r=null}();var xi=/\r/g;se.fn.extend({val:function(t){var e,i,n,r=this[0];{if(arguments.length)return n=se.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,se(this).val()):t,null==r?r="":"number"==typeof r?r+="":se.isArray(r)&&(r=se.map(r,function(t){return null==t?"":t+""})),e=se.valHooks[this.type]||se.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return e=se.valHooks[r.type]||se.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(xi,""):null==i?"":i)}}}),se.extend({valHooks:{option:{get:function(t){var e=se.find.attr(t,"value");return null!=e?e:se.text(t)}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,s="select-one"===t.type||0>r,o=s?null:[],a=s?r+1:n.length,h=0>r?a:s?r:0;a>h;h++)if(i=n[h],!(!i.selected&&h!==r||(ne.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&se.nodeName(i.parentNode,"optgroup"))){if(e=se(i).val(),s)return e;o.push(e)}return o},set:function(t,e){for(var i,n,r=t.options,s=se.makeArray(e),o=r.length;o--;)if(n=r[o],se.inArray(se.valHooks.option.get(n),s)>=0)try{n.selected=i=!0}catch(a){n.scrollHeight}else n.selected=!1;return i||(t.selectedIndex=-1),r}}}}),se.each(["radio","checkbox"],function(){se.valHooks[this]={set:function(t,e){return se.isArray(e)?t.checked=se.inArray(se(t).val(),e)>=0:void 0}},ne.checkOn||(se.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var wi,Ti,Si=se.expr.attrHandle,Ci=/^(?:checked|selected)$/i,Pi=ne.getSetAttribute,ki=ne.input;se.fn.extend({attr:function(t,e){return Oe(this,se.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){se.removeAttr(this,t)})}}),se.extend({attr:function(t,e,i){var n,r,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return typeof t.getAttribute===Se?se.prop(t,e,i):(1===s&&se.isXMLDoc(t)||(e=e.toLowerCase(),n=se.attrHooks[e]||(se.expr.match.bool.test(e)?Ti:wi)),void 0===i?n&&"get"in n&&null!==(r=n.get(t,e))?r:(r=se.find.attr(t,e),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:(t.setAttribute(e,i+""),i):(se.removeAttr(t,e),void 0))},removeAttr:function(t,e){var i,n,r=0,s=e&&e.match(be);if(s&&1===t.nodeType)for(;i=s[r++];)n=se.propFix[i]||i,se.expr.match.bool.test(i)?ki&&Pi||!Ci.test(i)?t[n]=!1:t[se.camelCase("default-"+i)]=t[n]=!1:se.attr(t,i,""),t.removeAttribute(Pi?i:n)},attrHooks:{type:{set:function(t,e){if(!ne.radioValue&&"radio"===e&&se.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),Ti={set:function(t,e,i){return e===!1?se.removeAttr(t,i):ki&&Pi||!Ci.test(i)?t.setAttribute(!Pi&&se.propFix[i]||i,i):t[se.camelCase("default-"+i)]=t[i]=!0,i}},se.each(se.expr.match.bool.source.match(/\w+/g),function(t,e){var i=Si[e]||se.find.attr;Si[e]=ki&&Pi||!Ci.test(e)?function(t,e,n){var r,s;return n||(s=Si[e],Si[e]=r,r=null!=i(t,e,n)?e.toLowerCase():null,Si[e]=s),r}:function(t,e,i){return i?void 0:t[se.camelCase("default-"+e)]?e.toLowerCase():null}}),ki&&Pi||(se.attrHooks.value={set:function(t,e,i){return se.nodeName(t,"input")?(t.defaultValue=e,void 0):wi&&wi.set(t,e,i)}}),Pi||(wi={set:function(t,e,i){var n=t.getAttributeNode(i);return n||t.setAttributeNode(n=t.ownerDocument.createAttribute(i)),n.value=e+="","value"===i||e===t.getAttribute(i)?e:void 0}},Si.id=Si.name=Si.coords=function(t,e,i){var n;return i?void 0:(n=t.getAttributeNode(e))&&""!==n.value?n.value:null},se.valHooks.button={get:function(t,e){var i=t.getAttributeNode(e);return i&&i.specified?i.value:void 0},set:wi.set},se.attrHooks.contenteditable={set:function(t,e,i){wi.set(t,""===e?!1:e,i)}},se.each(["width","height"],function(t,e){se.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}})),ne.style||(se.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var Ei=/^(?:input|select|textarea|button|object)$/i,Ai=/^(?:a|area)$/i;se.fn.extend({prop:function(t,e){return Oe(this,se.prop,t,e,arguments.length>1)},removeProp:function(t){return t=se.propFix[t]||t,this.each(function(){try{this[t]=void 0,delete this[t]}catch(e){}})}}),se.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,i){var n,r,s,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return s=1!==o||!se.isXMLDoc(t),s&&(e=se.propFix[e]||e,r=se.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=se.find.attr(t,"tabindex");return e?parseInt(e,10):Ei.test(t.nodeName)||Ai.test(t.nodeName)&&t.href?0:-1}}}}),ne.hrefNormalized||se.each(["href","src"],function(t,e){se.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ne.optSelected||(se.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),se.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){se.propFix[this.toLowerCase()]=this}),ne.enctype||(se.propFix.enctype="encoding");var Oi=/[\t\r\n\f]/g;se.fn.extend({addClass:function(t){var e,i,n,r,s,o,a=0,h=this.length,u="string"==typeof t&&t;if(se.isFunction(t))return this.each(function(e){se(this).addClass(t.call(this,e,this.className))});if(u)for(e=(t||"").match(be)||[];h>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Oi," "):" ")){for(s=0;r=e[s++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");o=se.trim(n),i.className!==o&&(i.className=o)}return this},removeClass:function(t){var e,i,n,r,s,o,a=0,h=this.length,u=0===arguments.length||"string"==typeof t&&t;if(se.isFunction(t))return this.each(function(e){se(this).removeClass(t.call(this,e,this.className))});if(u)for(e=(t||"").match(be)||[];h>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Oi," "):"")){for(s=0;r=e[s++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");o=t?se.trim(n):"",i.className!==o&&(i.className=o)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):se.isFunction(t)?this.each(function(i){se(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var e,n=0,r=se(this),s=t.match(be)||[];e=s[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(i===Se||"boolean"===i)&&(this.className&&se._data(this,"__className__",this.className),this.className=this.className||t===!1?"":se._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Oi," ").indexOf(e)>=0)return!0;return!1}}),se.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){se.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),se.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Mi=se.now(),Ii=/\?/,Di=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;se.parseJSON=function(e){if(t.JSON&&t.JSON.parse)return t.JSON.parse(e+"");var i,n=null,r=se.trim(e+"");return r&&!se.trim(r.replace(Di,function(t,e,r,s){return i&&e&&(n=0),0===n?t:(i=r||e,n+=!s-!r,"")}))?Function("return "+r)():se.error("Invalid JSON: "+e)},se.parseXML=function(e){var i,n;if(!e||"string"!=typeof e)return null;try{t.DOMParser?(n=new DOMParser,i=n.parseFromString(e,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(e))}catch(r){i=void 0}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||se.error("Invalid XML: "+e),i};var Ri,Li,Ni=/#.*$/,Bi=/([?&])_=[^&]*/,Fi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,ji=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ui=/^(?:GET|HEAD)$/,Gi=/^\/\//,Xi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hi={},Wi={},Vi="*/".concat("*");try{Li=location.href}catch(zi){Li=me.createElement("a"),Li.href="",Li=Li.href}Ri=Xi.exec(Li.toLowerCase())||[],se.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Li,type:"GET",isLocal:ji.test(Ri[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Vi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":se.parseJSON,"text xml":se.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?G(G(t,se.ajaxSettings),e):G(se.ajaxSettings,t)},ajaxPrefilter:j(Hi),ajaxTransport:j(Wi),ajax:function(t,e){function i(t,e,i,n){var r,c,y,v,b,w=e;2!==_&&(_=2,a&&clearTimeout(a),u=void 0,o=n||"",x.readyState=t>0?4:0,r=t>=200&&300>t||304===t,i&&(v=X(l,x,i)),v=H(l,v,x,r),r?(l.ifModified&&(b=x.getResponseHeader("Last-Modified"),b&&(se.lastModified[s]=b),b=x.getResponseHeader("etag"),b&&(se.etag[s]=b)),204===t||"HEAD"===l.type?w="nocontent":304===t?w="notmodified":(w=v.state,c=v.data,y=v.error,r=!y)):(y=w,(t||!w)&&(w="error",0>t&&(t=0))),x.status=t,x.statusText=(e||w)+"",r?f.resolveWith(d,[c,w,x]):f.rejectWith(d,[x,w,y]),x.statusCode(g),g=void 0,h&&p.trigger(r?"ajaxSuccess":"ajaxError",[x,l,r?c:y]),m.fireWith(d,[x,w]),h&&(p.trigger("ajaxComplete",[x,l]),--se.active||se.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,s,o,a,h,u,c,l=se.ajaxSetup({},e),d=l.context||l,p=l.context&&(d.nodeType||d.jquery)?se(d):se.event,f=se.Deferred(),m=se.Callbacks("once memory"),g=l.statusCode||{},y={},v={},_=0,b="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!c)for(c={};e=Fi.exec(o);)c[e[1].toLowerCase()]=e[2];e=c[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return _||(t=v[i]=v[i]||t,y[t]=e),this},overrideMimeType:function(t){return _||(l.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>_)for(e in t)g[e]=[g[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||b;return u&&u.abort(e),i(0,e),this}};if(f.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,l.url=((t||l.url||Li)+"").replace(Ni,"").replace(Gi,Ri[1]+"//"),l.type=e.method||e.type||l.method||l.type,l.dataTypes=se.trim(l.dataType||"*").toLowerCase().match(be)||[""],null==l.crossDomain&&(n=Xi.exec(l.url.toLowerCase()),l.crossDomain=!(!n||n[1]===Ri[1]&&n[2]===Ri[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Ri[3]||("http:"===Ri[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=se.param(l.data,l.traditional)),U(Hi,l,e,x),2===_)return x;h=l.global,h&&0===se.active++&&se.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Ui.test(l.type),s=l.url,l.hasContent||(l.data&&(s=l.url+=(Ii.test(s)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Bi.test(s)?s.replace(Bi,"$1_="+Mi++):s+(Ii.test(s)?"&":"?")+"_="+Mi++)),l.ifModified&&(se.lastModified[s]&&x.setRequestHeader("If-Modified-Since",se.lastModified[s]),se.etag[s]&&x.setRequestHeader("If-None-Match",se.etag[s])),(l.data&&l.hasContent&&l.contentType!==!1||e.contentType)&&x.setRequestHeader("Content-Type",l.contentType),x.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+Vi+"; q=0.01":""):l.accepts["*"]);for(r in l.headers)x.setRequestHeader(r,l.headers[r]);if(l.beforeSend&&(l.beforeSend.call(d,x,l)===!1||2===_))return x.abort();b="abort";for(r in{success:1,error:1,complete:1})x[r](l[r]);if(u=U(Wi,l,e,x)){x.readyState=1,h&&p.trigger("ajaxSend",[x,l]),l.async&&l.timeout>0&&(a=setTimeout(function(){x.abort("timeout")},l.timeout));try{_=1,u.send(y,i)}catch(w){if(!(2>_))throw w;i(-1,w)}}else i(-1,"No Transport");return x},getJSON:function(t,e,i){return se.get(t,e,i,"json")},getScript:function(t,e){return se.get(t,void 0,e,"script")}}),se.each(["get","post"],function(t,e){se[e]=function(t,i,n,r){return se.isFunction(i)&&(r=r||n,n=i,i=void 0),se.ajax({url:t,type:e,dataType:r,data:i,success:n})}}),se.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){se.fn[e]=function(t){return this.on(e,t)}}),se._evalUrl=function(t){return se.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},se.fn.extend({wrapAll:function(t){if(se.isFunction(t))return this.each(function(e){se(this).wrapAll(t.call(this,e))});if(this[0]){var e=se(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return se.isFunction(t)?this.each(function(e){se(this).wrapInner(t.call(this,e))}):this.each(function(){var e=se(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=se.isFunction(t);return this.each(function(i){se(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){se.nodeName(this,"body")||se(this).replaceWith(this.childNodes)}).end()}}),se.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ne.reliableHiddenOffsets()&&"none"===(t.style&&t.style.display||se.css(t,"display"))},se.expr.filters.visible=function(t){return!se.expr.filters.hidden(t)};
var Yi=/%20/g,qi=/\[\]$/,$i=/\r?\n/g,Ki=/^(?:submit|button|image|reset|file)$/i,Ji=/^(?:input|select|textarea|keygen)/i;se.param=function(t,e){var i,n=[],r=function(t,e){e=se.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=se.ajaxSettings&&se.ajaxSettings.traditional),se.isArray(t)||t.jquery&&!se.isPlainObject(t))se.each(t,function(){r(this.name,this.value)});else for(i in t)W(i,t[i],e,r);return n.join("&").replace(Yi,"+")},se.fn.extend({serialize:function(){return se.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=se.prop(this,"elements");return t?se.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!se(this).is(":disabled")&&Ji.test(this.nodeName)&&!Ki.test(t)&&(this.checked||!Me.test(t))}).map(function(t,e){var i=se(this).val();return null==i?null:se.isArray(i)?se.map(i,function(t){return{name:e.name,value:t.replace($i,"\r\n")}}):{name:e.name,value:i.replace($i,"\r\n")}}).get()}}),se.ajaxSettings.xhr=void 0!==t.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&V()||z()}:V;var Qi=0,Zi={},tn=se.ajaxSettings.xhr();t.ActiveXObject&&se(t).on("unload",function(){for(var t in Zi)Zi[t](void 0,!0)}),ne.cors=!!tn&&"withCredentials"in tn,tn=ne.ajax=!!tn,tn&&se.ajaxTransport(function(t){if(!t.crossDomain||ne.cors){var e;return{send:function(i,n){var r,s=t.xhr(),o=++Qi;if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)s[r]=t.xhrFields[r];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)void 0!==i[r]&&s.setRequestHeader(r,i[r]+"");s.send(t.hasContent&&t.data||null),e=function(i,r){var a,h,u;if(e&&(r||4===s.readyState))if(delete Zi[o],e=void 0,s.onreadystatechange=se.noop,r)4!==s.readyState&&s.abort();else{u={},a=s.status,"string"==typeof s.responseText&&(u.text=s.responseText);try{h=s.statusText}catch(c){h=""}a||!t.isLocal||t.crossDomain?1223===a&&(a=204):a=u.text?200:404}u&&n(a,h,u,s.getAllResponseHeaders())},t.async?4===s.readyState?setTimeout(e):s.onreadystatechange=Zi[o]=e:e()},abort:function(){e&&e(void 0,!0)}}}}),se.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return se.globalEval(t),t}}}),se.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),se.ajaxTransport("script",function(t){if(t.crossDomain){var e,i=me.head||se("head")[0]||me.documentElement;return{send:function(n,r){e=me.createElement("script"),e.async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,i){(i||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,i||r(200,"success"))},i.insertBefore(e,i.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}});var en=[],nn=/(=)\?(?=&|$)|\?\?/;se.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=en.pop()||se.expando+"_"+Mi++;return this[t]=!0,t}}),se.ajaxPrefilter("json jsonp",function(e,i,n){var r,s,o,a=e.jsonp!==!1&&(nn.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(e.data)&&"data");return a||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=se.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(nn,"$1"+r):e.jsonp!==!1&&(e.url+=(Ii.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||se.error(r+" was not called"),o[0]},e.dataTypes[0]="json",s=t[r],t[r]=function(){o=arguments},n.always(function(){t[r]=s,e[r]&&(e.jsonpCallback=i.jsonpCallback,en.push(r)),o&&se.isFunction(s)&&s(o[0]),o=s=void 0}),"script"):void 0}),se.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||me;var n=de.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=se.buildFragment([t],e,r),r&&r.length&&se(r).remove(),se.merge([],n.childNodes))};var rn=se.fn.load;se.fn.load=function(t,e,i){if("string"!=typeof t&&rn)return rn.apply(this,arguments);var n,r,s,o=this,a=t.indexOf(" ");return a>=0&&(n=t.slice(a,t.length),t=t.slice(0,a)),se.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(s="POST"),o.length>0&&se.ajax({url:t,type:s,dataType:"html",data:e}).done(function(t){r=arguments,o.html(n?se("<div>").append(se.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){o.each(i,r||[t.responseText,e,t])}),this},se.expr.filters.animated=function(t){return se.grep(se.timers,function(e){return t===e.elem}).length};var sn=t.document.documentElement;se.offset={setOffset:function(t,e,i){var n,r,s,o,a,h,u,c=se.css(t,"position"),l=se(t),d={};"static"===c&&(t.style.position="relative"),a=l.offset(),s=se.css(t,"top"),h=se.css(t,"left"),u=("absolute"===c||"fixed"===c)&&se.inArray("auto",[s,h])>-1,u?(n=l.position(),o=n.top,r=n.left):(o=parseFloat(s)||0,r=parseFloat(h)||0),se.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(d.top=e.top-a.top+o),null!=e.left&&(d.left=e.left-a.left+r),"using"in e?e.using.call(t,d):l.css(d)}},se.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){se.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},r=this[0],s=r&&r.ownerDocument;if(s)return e=s.documentElement,se.contains(e,r)?(typeof r.getBoundingClientRect!==Se&&(n=r.getBoundingClientRect()),i=Y(s),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n},position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===se.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),se.nodeName(t[0],"html")||(i=t.offset()),i.top+=se.css(t[0],"borderTopWidth",!0),i.left+=se.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-se.css(n,"marginTop",!0),left:e.left-i.left-se.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||sn;t&&!se.nodeName(t,"html")&&"static"===se.css(t,"position");)t=t.offsetParent;return t||sn})}}),se.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i=/Y/.test(e);se.fn[t]=function(n){return Oe(this,function(t,n,r){var s=Y(t);return void 0===r?s?e in s?s[e]:s.document.documentElement[n]:t[n]:(s?s.scrollTo(i?se(s).scrollLeft():r,i?r:se(s).scrollTop()):t[n]=r,void 0)},t,n,arguments.length,null)}}),se.each(["top","left"],function(t,e){se.cssHooks[e]=P(ne.pixelPosition,function(t,i){return i?(i=ii(t,e),ri.test(i)?se(t).position()[e]+"px":i):void 0})}),se.each({Height:"height",Width:"width"},function(t,e){se.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){se.fn[n]=function(n,r){var s=arguments.length&&(i||"boolean"!=typeof n),o=i||(n===!0||r===!0?"margin":"border");return Oe(this,function(e,i,n){var r;return se.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?se.css(e,i,o):se.style(e,i,n,o)},e,s?n:void 0,s,null)}})}),se.fn.size=function(){return this.length},se.fn.andSelf=se.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return se});var on=t.jQuery,an=t.$;return se.noConflict=function(e){return t.$===se&&(t.$=an),e&&t.jQuery===se&&(t.jQuery=on),se},typeof e===Se&&(t.jQuery=t.$=se),se})}).call(this),function(){t=e=window.jQuery.noConflict()}.call(this),"undefined"==typeof Package&&(Package={}),Package.jquery={$:t,jQuery:e}}(),function(){{var t,e=(Package.meteor.Meteor,Package.deps.Deps),i=Package.minimongo.LocalCollection;Package.minimongo.Minimongo}(function(){var n=function(){t._suppressWarnings?t._suppressWarnings--:("undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments),t._loggedWarnings++)},r=i._idStringify,s=i._idParse;t={_suppressWarnings:0,_loggedWarnings:0,observe:function(t,i){var s=null,u=null,c=[],l=e.autorun(function(){var l=t();e.nonreactive(function(){var t;if(u&&(c=_.map(u._fetch(),function(t){return{_id:t._id,item:t}}),u.stop(),u=null),l)if(l instanceof Array){var e={};t=_.map(l,function(t,i){var s;if("string"==typeof t)s="-"+t;else if("number"==typeof t||"boolean"==typeof t||void 0===t)s=t;else{if("object"!=typeof t)throw new Error("{{#each}} doesn't support arrays with elements of type "+typeof t);s=t&&t._id||i}var o=r(s);return e[o]?(n("duplicate id "+s+" in",l),s=Random.id()):e[o]=!0,{_id:s,item:t}}),h(c,t,i)}else{if(!a(l))throw o();var d=l;t=[];var p=!0;u=d.observe({addedAt:function(e,n,r){if(p){if(null!==r)throw new Error("Expected initial data from observe in order");t.push({_id:e._id,item:e})}else i.addedAt(e._id,e,n,r)},changedAt:function(t,e,n){i.changedAt(t._id,t,e,n)},removedAt:function(t,e){i.removedAt(t._id,t,e)},movedTo:function(t,e,n,r){i.movedTo(t._id,t,e,n,r)}}),p=!1,h(c,t,i)}else t=[],h(c,t,i);s=l,c=t})});return{stop:function(){l.stop(),u&&u.stop()}}},fetch:function(t){if(t){if(t instanceof Array)return t;if(a(t))return t.fetch();throw o()}return[]}};var o=function(){return new Error("{{#each}} currently only accepts arrays, cursors or falsey values.")},a=function(t){var e=Package.minimongo;return!!e&&t instanceof e.LocalCollection.Cursor},h=function(t,e,i){var n=Package.minimongo.LocalCollection._diffQueryOrderedChanges,o=[],a=[],h={},u={},c={},l=t.length;_.each(e,function(t,e){a.push({_id:t._id}),u[r(t._id)]=e}),_.each(t,function(t,e){o.push({_id:t._id}),h[r(t._id)]=e,c[r(t._id)]=e}),n(o,a,{addedBefore:function(t,n,s){var o=s?c[r(s)]:l;_.each(c,function(t,e){t>=o&&c[e]++}),l++,c[r(t)]=o,i.addedAt(t,e[u[r(t)]].item,o,s)},movedBefore:function(t,n){var s=c[r(t)],o=n?c[r(n)]:l-1;_.each(c,function(t,e){t>=s&&o>=t?c[e]--:s>=t&&t>=o&&c[e]++}),c[r(t)]=o,i.movedTo(t,e[u[r(t)]].item,s,o,n)},removed:function(e){var n=c[r(e)];_.each(c,function(t,e){t>=n&&c[e]--}),delete c[r(e)],l--,i.removedAt(e,t[h[r(e)]].item,n)}}),_.each(u,function(n,r){var o=s(r);if(_.has(h,r)){var a=e[n].item,u=t[h[r]].item;("object"==typeof a||a!==u)&&i.changedAt(o,a,u,n)}})}}).call(this),"undefined"==typeof Package&&(Package={}),Package["observe-sequence"]={ObserveSequence:t}}(),function(){{var t,e,i;Package.meteor.Meteor}(function(){t={},t.isNully=function(e){if(null==e)return!0;if(e instanceof Array){for(var i=0;i<e.length;i++)if(!t.isNully(e[i]))return!1;return!0}return!1},t.escapeData=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;")},t.isValidAttributeName=function(t){return/^[:_A-Za-z][:_A-Za-z0-9.\-]*/.test(t)}}).call(this),function(){t.Tag=function(){},t.Tag.prototype.tagName="",t.Tag.prototype.attrs=null,t.Tag.prototype.children=Object.freeze?Object.freeze([]):[],t.getTag=function(e){var i=t.getSymbolName(e);if(i===e)throw new Error("Use the lowercase or camelCase form of '"+e+"' here");return t[i]||(t[i]=n(e)),t[i]},t.ensureTag=function(e){t.getTag(e)};var n=function(e){var i=function(){var e=this instanceof t.Tag?this:new i,n=0,r=arguments.length&&arguments[0];return r&&"object"==typeof r&&r.constructor===Object&&(e.attrs=r,n++),n<arguments.length&&(e.children=Array.prototype.slice.call(arguments,n)),e};return i.prototype=new t.Tag,i.prototype.constructor=i,i.prototype.tagName=e,i},r=t.CharRef=function(t){if(!(this instanceof r))return new r(t);if(!(t&&t.html&&t.str))throw new Error("HTML.CharRef must be constructed with ({html:..., str:...})");this.html=t.html,this.str=t.str},s=t.Comment=function(t){if(!(this instanceof s))return new s(t);if("string"!=typeof t)throw new Error("HTML.Comment must be constructed with a string");this.value=t,this.sanitizedValue=t.replace(/^-|--+|-$/g,"")};t.knownElementNames="a abbr acronym address applet area b base basefont bdo big blockquote body br button caption center cite code col colgroup dd del dfn dir div dl dt em fieldset font form frame frameset h1 h2 h3 h4 h5 h6 head hr html i iframe img input ins isindex kbd label legend li link map menu meta noframes noscript object ol optgroup option p param pre q s samp script select small span strike strong style sub sup table tbody td textarea tfoot th thead title tr tt u ul var article aside audio bdi canvas command data datagrid datalist details embed eventsource figcaption figure footer header hgroup keygen mark meter nav output progress ruby rp rt section source summary time track video wbr".split(" "),t.knownSVGElementNames="altGlyph altGlyphDef altGlyphItem animate animateColor animateMotion animateTransform circle clipPath color-profile cursor defs desc ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font font-face font-face-format font-face-name font-face-src font-face-uri foreignObject g glyph glyphRef hkern image line linearGradient marker mask metadata missing-glyph path pattern polygon polyline radialGradient rect script set stop style svg switch symbol text textPath title tref tspan use view vkern".split(" "),t.knownElementNames=t.knownElementNames.concat(t.knownSVGElementNames),t.voidElementNames="area base br col command embed hr img input keygen link meta param source track wbr".split(" ");var o={yes:!0},a=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=o;return e},h=a(t.voidElementNames),u=a(t.knownElementNames),c=a(t.knownSVGElementNames);t.isKnownElement=function(t){return u[t]===o},t.isVoidElement=function(t){return h[t]===o},t.isKnownSVGElement=function(t){return c[t]===o},t.isTagEnsured=function(e){return t.isKnownElement(e)},t.getSymbolName=function(t){return t.toUpperCase().replace(/-/g,"_")};for(var l=0;l<t.knownElementNames.length;l++)t.ensureTag(t.knownElementNames[l]);e=function(t){var e,i=Deps.currentComputation,n=Deps.autorun(function(){e=t()});return n.onInvalidate(function(){i&&i.invalidate()}),Deps.active?Deps.onInvalidate(function(){n.stop(),t.stop&&t.stop()}):(n.stop(),t.stop&&t.stop()),e},i=function(t){t.materialized&&t.materialized.isWith&&(Deps.active?t.materialized():t.data?t.data.stop():t.v&&t.v.stop())},t.evaluate=function(n,r){if(null==n)return n;if("function"==typeof n)return t.evaluate(e(n),r);if(n instanceof Array){for(var s=[],o=0;o<n.length;o++)s.push(t.evaluate(n[o],r));return s}if("function"==typeof n.instantiate){var a=n.instantiate(r||null),h=a.render("STATIC");return i(a),t.evaluate(h,a)}if(n instanceof t.Tag){for(var u=[],o=0;o<n.children.length;o++)u.push(t.evaluate(n.children[o],r));var c=t.getTag(n.tagName).apply(null,u);c.attrs={};for(var l in n.attrs)c.attrs[l]=t.evaluate(n.attrs[l],r);return c}return n};var d=function(e,i,n){for(var r in i)if("$dynamic"!==r){if(!t.isValidAttributeName(r))throw new Error("Illegal HTML attribute name: "+r);var s=t.evaluate(i[r],n);t.isNully(s)||(e[r]=s)}};t.evaluateAttributes=function(t,e){if(!t)return t;var i={};if(d(i,t,e),"$dynamic"in t){if(!(t.$dynamic instanceof Array))throw new Error("$dynamic must be an array");for(var n=t.$dynamic,r=0;r<n.length;r++){var s=n[r];"function"==typeof s&&(s=s()),d(i,s,e)}}return i},t.Tag.prototype.evaluateAttributes=function(e){return t.evaluateAttributes(this.attrs,e)},t.Raw=function(e){if(!(this instanceof t.Raw))return new t.Raw(e);if("string"!=typeof e)throw new Error("HTML.Raw must be constructed with a string");this.value=e},t.EmitCode=function(e){if(!(this instanceof t.EmitCode))return new t.EmitCode(e);if("string"!=typeof e)throw new Error("HTML.EmitCode must be constructed with a string");this.value=e}}.call(this),function(){t.toHTML=function(n,r){if(null==n)return"";if("string"==typeof n||"boolean"==typeof n||"number"==typeof n)return t.escapeData(String(n));if(n instanceof Array){for(var s=[],o=0;o<n.length;o++)s.push(t.toHTML(n[o],r));return s.join("")}if("function"==typeof n.instantiate){var a=n.instantiate(r||null),h=a.render("STATIC");return i(a),t.toHTML(h,a)}if("function"==typeof n)return t.toHTML(e(n),r);if(n.toHTML)return n.toHTML(r);throw new Error("Expected tag, string, array, component, null, undefined, or object with a toHTML method; found: "+n)},t.Comment.prototype.toHTML=function(){return"<!--"+this.sanitizedValue+"-->"},t.CharRef.prototype.toHTML=function(){return this.html},t.Raw.prototype.toHTML=function(){return this.value},t.Tag.prototype.toHTML=function(e){var i=[],n=this.evaluateAttributes(e);if(n)for(var r in n){var s=t.toText(n[r],t.TEXTMODE.ATTRIBUTE,e);i.push(" "+r+'="'+s+'"')}var o,a=this.tagName,h="<"+a+i.join("")+">",u=[];if("textarea"===a){for(var c=0;c<this.children.length;c++)u.push(t.toText(this.children[c],t.TEXTMODE.RCDATA,e));o=u.join(""),"\n"===o.slice(0,1)&&(o="\n"+o)}else{for(var c=0;c<this.children.length;c++)u.push(t.toHTML(this.children[c],e));o=u.join("")}var l=h+o;return(this.children.length||!t.isVoidElement(a))&&(l+="</"+a+">"),l},t.TEXTMODE={ATTRIBUTE:1,RCDATA:2,STRING:3},t.toText=function(n,r,s){if(null==n)return"";if("string"==typeof n||"boolean"==typeof n||"number"==typeof n){if(n=String(n),r===t.TEXTMODE.STRING)return n;if(r===t.TEXTMODE.RCDATA)return t.escapeData(n);if(r===t.TEXTMODE.ATTRIBUTE)return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;");throw new Error("Unknown TEXTMODE: "+r)}if(n instanceof Array){for(var o=[],a=0;a<n.length;a++)o.push(t.toText(n[a],r,s));return o.join("")}if("function"==typeof n)return t.toText(e(n),r,s);if("function"==typeof n.instantiate){var h=n.instantiate(s||null),u=h.render("STATIC"),c=t.toText(u,r,h);return i(h),c}if(n.toText)return n.toText(r,s);throw new Error("Expected tag, string, array, component, null, undefined, or object with a toText method; found: "+n)},t.Raw.prototype.toText=function(){return this.value},t.Tag.prototype.toText=function(e,i){if(e===t.TEXTMODE.STRING)return t.toText(this.toHTML(i),e);throw new Error("Can't insert tags in attributes or TEXTAREA elements")},t.CharRef.prototype.toText=function(e){if(e===t.TEXTMODE.STRING)return this.str;if(e===t.TEXTMODE.RCDATA)return this.html;if(e===t.TEXTMODE.ATTRIBUTE)return this.html;throw new Error("Unknown TEXTMODE: "+e)}}.call(this),"undefined"==typeof Package&&(Package={}),Package.htmljs={HTML:t}}(),function(){var t,e,i,n,r,s,o,a,h,u,c,l,d=Package.meteor.Meteor,p=(Package.jquery.$,Package.jquery.jQuery,Package.deps.Deps),f=(Package.random.Random,Package.ejson.EJSON,Package.underscore._),m=(Package["ordered-dict"].OrderedDict,Package.minimongo.LocalCollection),g=(Package.minimongo.Minimongo,Package["observe-sequence"].ObserveSequence),y=Package.htmljs.HTML;(function(){var t;i=function(e,i){t||(t=function(){return"undefined"!=typeof d?d._debug:"undefined"!=typeof console&&console.log?console.log:function(){}}),t()(i||"Exception in Meteor UI:",e.stack||e.message)}}).call(this),function(){t={},n=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t};var e=function(t,e,i){try{Object.defineProperty(t,e,{value:i})}catch(n){t[e]=i}return t};!function(){t.Component=function(t){var i=new t;return e(i,"_constr",t),e(i,"_super",null),i}(function(){})}(),n(t,{nextGuid:2,isComponent:function(e){return e&&t.isKindOf(e,t.Component)},isKindOf:function(t,e){for(;t;){if(t===e)return!0;t=t._super}return!1},_requireNotDestroyed:function(t){if(t.isDestroyed)throw new Error("Component has been destroyed; can't perform this operation")},_requireInited:function(t){if(!t.isInited)throw new Error("Component must be inited to perform this operation")},_requireDom:function(t){if(!t.dom)throw new Error("Component must be built into DOM to perform this operation")}}),r=t.Component,n(t.Component,{kind:"Component",guid:"1",dom:null,isInited:!1,isDestroyed:!1,parent:null,extend:function(i){if(this.isInited)throw new Error("Can't extend an inited Component");var r,s=!1;i&&i.kind?(r=function(){},s=!0):r=this._constr,r.prototype=this;var o=new r;return s&&(o._constr=r),i&&n(o,i),e(o,"_super",this),o.guid=String(t.nextGuid++),o}});s=function(t,e){for(;e;){if("undefined"!=typeof e[t])return e;e=e.parent}return null},o=function(t,e){for(;e;){if(e.__helperHost)return"undefined"!=typeof e[t]?e:null;e=e.parent}return null},a=function(t){return t=s("data",t),t?"function"==typeof t.data?t.data():t.data:null},h=function(t){var e=t.templateInstance;e.data=a(t),t.dom&&!t.isDestroyed?(e.firstNode=t.dom.startNode().nextSibling,e.lastNode=t.dom.endNode().previousSibling,e.lastNode&&e.lastNode.nextSibling===e.firstNode&&(e.lastNode=e.firstNode)):(e.firstNode=null,e.lastNode=null)},n(t.Component,{helpers:function(t){n(this,t)},events:function(t){var e;e=this.hasOwnProperty("_events")?this._events:this._events=[],f.each(t,function(t,i){var n=i.split(/,\s+/);f.each(n,function(i){var n=i.split(/\s+/);if(0!==n.length){var r=n.shift(),s=n.join(" ");e.push({events:r,selector:s,handler:t})}})})}}),t.Component.notifyParented=function(){for(var e=this,i=e;i;i=i._super){var n=i.hasOwnProperty("_events")&&i._events||null;!n&&i.hasOwnProperty("events")&&"object"==typeof i.events&&(t.Component.events.call(i,i.events),n=i._events),f.each(n,function(i){var n=function(n){var r=t.DomRange.getContainingComponent(n.currentTarget),s=r&&a(r),o=f.toArray(arguments);return h(e),p.nonreactive(function(){return o.splice(1,0,e.templateInstance),i.handler.apply(null===s?{}:s,o)})};e.dom.on(i.events,i.selector,n)})}e.rendered&&p.afterFlush(function(){e.isDestroyed||(h(e),e.rendered.call(e.templateInstance))})},t.Component.preserve=function(){d._debug("The 'preserve' method on templates is now unnecessary and deprecated.")},t.getElementData=function(e){var i=t.DomRange.getContainingComponent(e);return i&&a(i)};var i=!1;t._allowJavascriptUrls=function(){i=!0},t._javascriptUrlsAllowed=function(){return i}}.call(this),function(){if(d.isClient){if(!Package.jquery)throw new Error("Meteor UI jQuery adapter: jQuery not found.");var e=Package.jquery.jQuery,i={};t.DomBackend=i;var n="meteor_ui_removal_watcher",r="$meteor_ui_removal_callbacks",s=function(){};i.removeElement=function(t){e(t).remove()},i.onRemoveElement=function(t,i){t[r]||(t[r]=[],e(t).on(n,s)),t[r].push(i)},e.event.special[n]={teardown:function(){var t=this,e=t[r];if(e){for(var i=0;i<e.length;i++)e[i](t);t[r]=null}}},i.parseHTML=function(t){return e.parseHTML(t)||[]},i.findBySelector=function(t,i){return e(t,i)},i.newFragment=function(t){for(var e=document.createDocumentFragment(),i=0;i<t.length;i++)e.appendChild(t[i]);return e},i.delegateEvents=function(t,i,n,r){e(t).on(i,n,r)},i.undelegateEvents=function(t,i,n){e(t).off(i,n)},i.bindEventCapturer=function(t,i,n,r){var s=e(t),o=function(i){i=e.event.fix(i),i.currentTarget=i.target;var o=e(i.currentTarget);o.is(s.find(n))&&r.call(t,i)};r._meteorui_wrapper=o,i=this.parseEventType(i),t.addEventListener(i,o,!0)},i.unbindEventCapturer=function(t,e,i){e=this.parseEventType(e),t.removeEventListener(e,i._meteorui_wrapper,!0)},i.parseEventType=function(t){var e=t.indexOf(".");return e>=0?t.slice(0,e):t}}}.call(this),function(){var e=t.DomBackend,i=function(t){t.parentNode.removeChild(t)},n=function(t,e,i){e.insertBefore(t,i||null)},r=function(t,e,i){e.insertBefore(t,i||null)},s=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},o=function(t,e){if(!t)return!1;for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return!0;return!1},a=function(t){return!("number"!=typeof t.length||!t.sort&&!t.splice)},h=function(t){return!(3===t.nodeType&&(!t.nodeValue||/^\s+$/.test(t.nodeValue)))},u=function(t){if("string"!=typeof t)throw new Error("id must be a string");if(!t)throw new Error("id may not be empty")},c=function(){var t=document.createTextNode("");try{return t.blahblah=!0,!0}catch(e){return!1}}(),l=c?function(){return document.createTextNode("")}:function(){return document.createComment("IE")},d=function(t){if(!t.isParented){if(t.isParented=!0,!t.owner){var i=t.parentNode(),n=i.$_uiranges||(i.$_uiranges={});n[t._rangeId]=t,t._rangeDict=n,e.onRemoveElement(i,function(){p(t)})}t.component&&t.component.notifyParented&&t.component.notifyParented();var r=t.members;for(var s in r){var o=r[s];o instanceof y&&d(o)}}},p=function(t){t.isRemoved||(t.isRemoved=!0,t._rangeDict&&delete t._rangeDict[t._rangeId],t.removed&&t.removed(),m(t))},f=function(t,i){if(1===t.nodeType){for(var n=y.getComponents(t),r=0,s=n.length;s>r;r++)p(n[r]);i||e.removeElement(t)}},m=function(t){var e=t.members;for(var i in e){var n=e[i];n instanceof y?p(n):f(n)}},g=1,y=function(){var t=l(),i=l(),n=e.newFragment([t,i]);n.$_uiIsOffscreen=!0,this.start=t,this.end=i,t.$ui=this,i.$ui=this,this.members={},this.nextMemberId=1,this.owner=null,this._rangeId=g++,this._rangeDict=null,this.isParented=!1,this.isRemoved=!1};s(y.prototype,{getNodes:function(){if(!this.parentNode())return[];this.refresh();for(var t=this.end.nextSibling,e=[],i=this.start;i&&i!==t;i=i.nextSibling)e.push(i);return e},removeAll:function(){if(this.parentNode()){this.refresh();for(var t=this.end,e=[],n=this.start.nextSibling;n&&n!==t;n=n.nextSibling)e.push(n);for(var r=0,s=e.length;s>r;r++)i(e[r]);m(this),this.members={}}},add:function(t,e,i,r){if(null!=t&&"string"!=typeof t){if("object"!=typeof t)throw new Error("id must be a string");i=e,e=t,t=null}if(!e||"object"!=typeof e)throw new Error("Expected component, node, or array");if(a(e)){if(1!==e.length){if(null!=t)throw new Error("Can only add one node or one component if id is given");var s=e;r=this.getInsertionPoint(i);for(var o=0;o<s.length;o++)this.add(null,s[o],i,r);return}e=e[0]}var h=this.parentNode();if(h){var c=r||this.getInsertionPoint(i),l=e;null==t?t=this.nextMemberId++:(u(t),t=" "+t);var m=this.members;if(m.hasOwnProperty(t)){var g=m[t];if(g instanceof y){var v=g;if(v.start.parentNode===h)throw new Error("Member already exists: "+t.slice(1));delete m[t],v.owner=null,p(v)}else{var _=g;if(_.parentNode===h)throw new Error("Member already exists: "+t.slice(1));f(_),delete m[t]}}if(l instanceof y){var b=l;b.owner=this;var x=b.getNodes();m[t]=l;for(var o=0;o<x.length;o++)n(x[o],h,c);this.isParented&&d(b)}else{if("number"!=typeof l.nodeType)throw new Error("Expected Component or Node");var w=l;3!==w.nodeType&&(w.$ui=this),m[t]=l,n(w,h,c)}}},remove:function(t){if(null==t)return this.removeAll(),i(this.start),i(this.end),this.owner=null,p(this),void 0;u(t),t=" "+t;var e=this.members,n=e.hasOwnProperty(t)&&e[t];if(delete e[t],n){var r=this.parentNode();if(r)if(n instanceof y){var s=n;s.owner=null,s.start.parentNode===r&&n.remove()}else{var o=n;o.parentNode===r&&i(o)}}},moveBefore:function(t,e){var i=this.getInsertionPoint(e);u(t),t=" "+t;var n=this.members,s=n.hasOwnProperty(t)&&n[t];if(s){var o=this.parentNode();if(o)if(s instanceof y){var a=s;if(a.start.parentNode===o){a.refresh();for(var h=a.getNodes(),c=0;c<h.length;c++)r(h[c],o,i)}}else{var l=s;r(l,o,i)}}},get:function(t){u(t),t=" "+t;var e=this.members;return e.hasOwnProperty(t)?e[t]:null},parentNode:function(){return this.start.parentNode},startNode:function(){return this.start},endNode:function(){return this.end},eachMember:function(t,e){var i=this.members,n=this.parentNode();for(var r in i){var s=i[r];if(s instanceof y){var o=s;o.start.parentNode===n?e&&e(o):(o.owner=null,delete i[r],p(o))}else{var a=s;a.parentNode===n?t&&t(a):(delete i[r],f(a))}}},refresh:function(){var t=this.parentNode();if(t){var e=null,i=null,r=0,s=null;this.eachMember(function(t){e=t,r++,3===t.nodeType&&(s=s||[],s.push(t))},function(t){t.refresh(),i=t,r++});var a=null,u=null;if(0===r);else if(1===r)e?(a=e,u=e):i&&(a=i.start,u=i.end);else for(var c=t.firstChild;c;c=c.nextSibling){var l;if(c.$ui&&(l=c.$ui)&&(l===this&&c!==this.start&&c!==this.end&&h(c)||l!==this&&l.owner===this&&l.start===c)){if(a)for(var d=a.previousSibling;d&&!d.$ui;d=d.previousSibling)this.members[this.nextMemberId++]=d,3!==d.nodeType&&(d.$ui=this);c.$ui===this?(a=a||c,u=c):(a=a||c,c=c.$ui.end,u=c)}}if(a){for(var d;(d=a.previousSibling)&&(d.$ui&&d.$ui===this||o(s,d));)a=d;for(var d;(d=u.nextSibling)&&(d.$ui&&d.$ui===this||o(s,d));)u=d;a!==this.start&&n(this.start,t,a),u!==this.end&&n(this.end,t,u.nextSibling)}}},getInsertionPoint:function(t){var e=this.members,i=this.parentNode();if(!t)return this.end;u(t),t=" "+t;var n=e[t];if(n instanceof y){var r=n;if(r.start.parentNode===i)return r.refresh(),r.start;r.owner=null,p(r)}else{var s=n;if(s.parentNode===i)return s;f(s)}return delete e[t],this.end}}),y.prototype.elements=function(t){return t=t||[],this.eachMember(function(e){1===e.nodeType&&t.push(e)},function(e){e.elements(t)}),t},y.refresh=function(t){for(var e=y.getComponents(t),i=0,n=e.length;n>i;i++)e[i].refresh()},y.getComponents=function(t){for(var e=[],i=t.firstChild;i;i=i.nextSibling)i.$ui&&i===i.$ui.start&&!i.$ui.owner&&e.push(i.$ui);return e},y.insert=function(t,e,i){for(var r=t.getNodes(),s=0;s<r.length;s++)n(r[s],e,i);d(t)},y.getContainingComponent=function(t){for(;t&&!t.$ui;)t=t.parentNode;for(var e=t&&t.$ui;e;){if(e.component)return e.component;e=e.owner}return null},y.prototype.contains=function(t){if(!t)throw new Error("Expected Component or Node");var e=this.parentNode();if(!e)return!1;var i;if(t instanceof y){i=t;var n=i.parentNode();if(!n)return!1;if(n!==e)return this.contains(n);if(i===this)return!1}else{var r=t;if(!T(e,r))return!1;for(;r.parentNode!==e;)r=r.parentNode;i=r.$ui}for(;i&&i!==this;)i=i.owner;return i===this},y.prototype.$=function(t){var i=this,n=this.parentNode();if(!n)throw new Error("Can't select in removed DomRange");if(11===n.nodeType||n.$_uiIsOffscreen)throw new Error("Can't use $ on an offscreen component");var r=e.findBySelector(t,n),s=function(t){return"number"==typeof t&&(t=this),i.contains(t)};if(r.filter)r=r.filter(s);else{for(var o=[],a=0;a<r.length;a++){var h=r[a];s(h)&&o.push(h)}r=o}return r};var v={blur:1,change:1,click:1,focus:1,focusin:1,focusout:1,reset:1,submit:1},_=0,b=1,x=2,w=function(t,i,n,r,s){this.elem=t,this.type=i,this.selector=n,this.handler=r,this.$ui=s,this.mode=_,this.delegatedHandler=function(t){return function(e){return(t.selector||e.currentTarget===e.target)&&t.$ui.contains(e.currentTarget)?t.handler.apply(t.$ui,arguments):void 0}}(this);var o=t.addEventListener&&!v.hasOwnProperty(e.parseEventType(i));o?this.capturingHandler=function(t){return function(i){if(t.mode===_){if(i.bubbles)return t.mode=b,e.unbindEventCapturer(t.elem,t.type,t.capturingHandler),void 0;t.mode=x,e.undelegateEvents(t.elem,t.type,t.delegatedHandler)}t.delegatedHandler(i)}}(this):this.mode=b};w.prototype.bind=function(){this.mode!==b&&e.bindEventCapturer(this.elem,this.type,this.selector||"*",this.capturingHandler),this.mode!==x&&e.delegateEvents(this.elem,this.type,this.selector||"*",this.delegatedHandler)},w.prototype.unbind=function(){this.mode!==b&&e.unbindEventCapturer(this.elem,this.type,this.capturingHandler),this.mode!==x&&e.undelegateEvents(this.elem,this.type,this.delegatedHandler)},y.prototype.on=function(t,e,i){var n=this.parentNode();if(n){if(n.$_uiIsOffscreen)throw new Error("Can't bind events before DomRange is inserted");var r=[];t.replace(/[^ /]+/g,function(t){r.push(t)}),i||"function"!=typeof e?e||(e=null):(i=e,e=null);for(var s=0,o=r.length;o>s;s++){var a=r[s],h=n.$_uievents;h||(h=n.$_uievents={});var u=h[a];u||(u=h[a]={},u.handlers=[]);var c=u.handlers,l=new w(n,a,e,i,this);l.bind(),c.push(l);for(var d=this.owner;d;d=d.owner)for(var p=0,f=c.length;f>p;p++){var m=c[p];m.$ui===d&&(m.unbind(),m.bind(),c.splice(p,1),c.push(m),p--,f--)}}}};var T=function(t,e){return 1!==t.nodeType?!1:t===e?!1:t.compareDocumentPosition?16&t.compareDocumentPosition(e):(e=e.parentNode,e&&1===e.nodeType?t===e?!0:t.contains(e):!1)};t.DomRange=y}.call(this),function(){u=function(t,e){this.name=t,this.value=e},u.prototype.update=function(t,e,i){null===i?null!==e&&t.removeAttribute(this.name):t.setAttribute(this.name,i)},u.extend=function(t){var e=this,i=function(){u.apply(this,arguments)
};return i.prototype=new e,i.extend=e.extend,t&&f.extend(i.prototype,t),i};var e=u.extend({update:function(t,e,i){if(!this.getCurrentValue||!this.setValue)throw new Error("Missing methods in subclass of 'BaseClassHandler'");for(var n=e?f.compact(e.split(" ")):[],r=i?f.compact(i.split(" ")):[],s=f.compact(this.getCurrentValue(t).split(" ")),o=0;o<n.length;o++){var a=n[o];f.contains(r,a)||(s=f.without(s,a))}for(var o=0;o<r.length;o++){var a=r[o];f.contains(n,a)||f.contains(s,a)||s.push(a)}this.setValue(t,s.join(" "))}}),i=e.extend({getCurrentValue:function(t){return t.className},setValue:function(t,e){t.className=e}}),n=e.extend({getCurrentValue:function(t){return t.className.baseVal},setValue:function(t,e){t.setAttribute("class",e)}}),r=u.extend({update:function(t,e,i){var n=this.focused(t);if(!n){var r=this.name;null==i?null!=e&&(t[r]=!1):t[r]=!0}},focused:function(t){if("INPUT"===t.tagName)return t===document.activeElement;if("OPTION"===t.tagName){for(var e=t;e&&"SELECT"!==e.tagName;)e=e.parentNode;return e?e===document.activeElement:!1}throw new Error("Expected INPUT or OPTION element")}}),s=u.extend({update:function(t,e,i){var n=t===document.activeElement;n||(t.value=i)}}),o=u.extend({update:function(t,e,i){var n="http://www.w3.org/1999/xlink";null===i?null!==e&&t.removeAttributeNS(n,this.name):t.setAttributeNS(n,this.name,this.value)}}),a=function(t){return"ownerSVGElement"in t},h=function(t,e){var i={FORM:["action"],BODY:["background"],BLOCKQUOTE:["cite"],Q:["cite"],DEL:["cite"],INS:["cite"],OBJECT:["classid","codebase","data","usemap"],APPLET:["codebase"],A:["href"],AREA:["href"],LINK:["href"],BASE:["href"],IMG:["longdesc","src","usemap"],FRAME:["longdesc","src"],IFRAME:["longdesc","src"],HEAD:["profile"],SCRIPT:["src"],INPUT:["src","usemap","formaction"],BUTTON:["formaction"],BASE:["href"],MENUITEM:["icon"],HTML:["manifest"],VIDEO:["poster"]};if("itemid"===e)return!0;var n=i[t]||[];return f.contains(n,e)};if(d.isClient)var p=document.createElement("A");var m=function(t){if(d.isClient)return p.href=t,p.href;throw new Error("normalizeUrl not implemented on the server")},g=u.prototype.update,y=u.extend({update:function(e,i,n){var r=this,s=arguments;if(t._javascriptUrlsAllowed())g.apply(r,s);else{var o=0===m(n).indexOf("javascript:");o?(d._debug("URLs that use the 'javascript:' protocol are not allowed in URL attribute values. Call UI._allowJavascriptUrls() to enable them."),g.apply(r,[e,i,null])):g.apply(r,s)}}});c=function(t,e,c){return"class"===e?a(t)?new n(e,c):new i(e,c):"OPTION"===t.tagName&&"selected"===e||"INPUT"===t.tagName&&"checked"===e?new r(e,c):"TEXTAREA"!==t.tagName&&"INPUT"!==t.tagName||"value"!==e?"xlink:"===e.substring(0,6)?new o(e.substring(6),c):h(t.tagName,e)?new y(e,c):new u(e,c):new s(e,c)},l=function(t){this.elem=t,this.handlers={}},l.prototype.update=function(t){var e=this.elem,i=this.handlers;for(var n in i)if(!t.hasOwnProperty(n)){var r=i[n],s=r.value;r.value=null,r.update(e,s,null),delete i[n]}for(var n in t){var s,r=null,o=t[n];i.hasOwnProperty(n)?(r=i[n],s=r.value):null!==o&&(r=c(e,n,o),i[n]=r,s=null),s!==o&&(r.value=o,r.update(e,s,o),null===o&&delete i[n])}}}.call(this),function(){t.Component.instantiate=function(e){var i=this;if(!t.isComponent(i))throw new Error("Expected Component kind");if(i.isInited)throw new Error("A component kind is required, not an instance");var n=i.extend();return n.isInited=!0,n.templateInstance={findAll:function(t){return n.dom.$(t)},find:function(t){var e=this.findAll(t);return e[0]||null},firstNode:null,lastNode:null,data:null,__component__:n},n.templateInstance.$=n.templateInstance.findAll,n.parent=e||null,n.init&&n.init(),n.created&&(h(n),n.created.call(n.templateInstance)),n},t.Component.render=function(){return null};var e=function(t,e){var i=this;i.func=t,i.equals=e,i.curResult=null,i.dep=new p.Dependency,i.resultComputation=p.nonreactive(function(){return p.autorun(function(t){var e=i.func,n=e();if(!t.firstRun){var r=i.equals,s=i.curResult;if(r?r(n,s):n===s)return}i.curResult=n,i.dep.changed()})})};e.prototype.stop=function(){this.resultComputation.stop()},e.prototype.get=function(){return p.active&&!this.resultComputation.stopped&&this.dep.depend(),this.curResult},t.emboxValue=function(t,i){if("function"==typeof t){var n=t,r=new e(n,i),s=function(){return r.get()};return s.stop=function(){r.stop()},s}var o=t,a=function(){return o};return a._isEmboxedConstant=!0,a},t.namedEmboxValue=function(e,i,n){if(!p.active){var r=t.emboxValue(i,n);return r.stop(),r}var s=p.currentComputation;return s[e]||(s[e]=t.emboxValue(i,n)),s[e]},t.insert=function(e,i,n){if(!e.dom)throw new Error("Expected template rendered with UI.render");t.DomRange.insert(e.dom,i,n)};var n=function(e,i,n){if(!i)throw new Error("Materialization parent required");i instanceof t.DomRange?i.add(e,n):e instanceof t.DomRange?t.DomRange.insert(e,i,n):i.insertBefore(e,n||null)};t.render=function(e,i){if(e.isInited)throw new Error("Can't render component instance, only component kind");var n,r,o;return p.nonreactive(function(){n=e.instantiate(i),r=n.render&&n.render(),o=new t.DomRange,n.dom=o,o.component=n}),s(r,o,null,n),o.removed=function(){n.isDestroyed=!0,n.destroyed&&p.nonreactive(function(){h(n),n.destroyed.call(n.templateInstance)})},n},t.renderWithData=function(e,i,n){if(!t.isComponent(e))throw new Error("Component required here");if(e.isInited)throw new Error("Can't render component instance, only component kind");if("function"==typeof i)throw new Error("Data argument can't be a function");return t.render(e.extend({data:function(){return i}}),n)};var r=function(t,e){return t instanceof y.Raw?e instanceof y.Raw&&t.value===e.value:null==t?null==e:t===e&&("number"==typeof t||"boolean"==typeof t||"string"==typeof t)};t.InTemplateScope=function(e,i){if(!(this instanceof t.InTemplateScope))return new t.InTemplateScope(e,i);var n=e.parent;n.__isTemplateWith&&(n=n.parent),this.parentPtr=n,this.content=i},t.InTemplateScope.prototype.toHTML=function(){return y.toHTML(this.content,this.parentPtr)},t.InTemplateScope.prototype.toText=function(t){return y.toText(this.content,t,this.parentPtr)};var s=function(e,o,a,h){if(null==e);else if("string"==typeof e||"boolean"==typeof e||"number"==typeof e)e=String(e),n(document.createTextNode(e),o,a);else if(e instanceof Array)for(var u=0;u<e.length;u++)s(e[u],o,a,h);else if("function"==typeof e){var c=new t.DomRange,d=null,f=p.autorun(function(t){var i=e();y.isNully(i)?i=null:i instanceof Array&&1===i.length&&(i=i[0]),r(i,d)||(d=i,t.firstRun||c.removeAll(),s(i,c,null,h))});c.removed=function(){f.stop(),e.stop&&e.stop()},p.active&&e.stop&&p.onInvalidate(function(){e.stop()}),n(c,o,a)}else if(e instanceof y.Tag){var m,g=e.tagName;m=y.isKnownSVGElement(g)&&document.createElementNS?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(e.tagName);var v=e.attrs,_=e.children;if("textarea"===e.tagName&&(v=v||{},v.value=_,_=[]),v){var b=p.autorun(function(t){var e=t.updater;e||(e=t.updater=new l(m));try{var n=y.evaluateAttributes(v,h),r={};if(n){for(var s in n)r[s]=y.toText(n[s],y.TEXTMODE.STRING,h);e.update(r)}}catch(o){i(o)}});t.DomBackend.onRemoveElement(m,function(){b.stop()})}s(_,m,null,h),n(m,o,a)}else if("function"==typeof e.instantiate){var x=t.render(e,h);x.materialized&&x.materialized(),n(x.dom,o,a)}else if(e instanceof y.CharRef)n(document.createTextNode(e.str),o,a);else if(e instanceof y.Comment)n(document.createComment(e.sanitizedValue),o,a);else if(e instanceof y.Raw)for(var w=t.DomBackend.parseHTML(e.value),u=0;u<w.length;u++)n(w[u],o,a);else{if(Package["html-tools"]&&e instanceof Package["html-tools"].HTMLTools.Special)throw new Error("Can't materialize Special tag, it's just an intermediate rep");if(!(e instanceof t.InTemplateScope))throw new Error("Unexpected node in htmljs: "+e);s(e.content,o,a,e.parentPtr)}};t.materialize=s,t.body=t.Component.extend({kind:"body",contentParts:[],render:function(){return this.contentParts},INSTANTIATED:!1,__helperHost:!0}),t.block=function(e){return t.Component.extend({render:e})},t.toHTML=function(t,e){return y.toHTML(t,e)},t.toRawText=function(t,e){return y.toText(t,y.TEXTMODE.STRING,e)}}.call(this),function(){t.If=function(t,n,r){e("If",t,n,r);var s=function(){var e=i(t);return s.stop=function(){e.stop()},e()?n:r||null};return s},t.Unless=function(t,n,r){e("Unless",t,n,r);var s=function(){var e=i(t);return s.stop=function(){e.stop()},e()?r||null:n};return s},t.safeEquals=function(t,e){return t!==e?!1:!t||"number"==typeof t||"boolean"==typeof t||"string"==typeof t},t.With=function(i,n){e("With",i,n);var r=n;return"data"in r&&(r=t.block(function(){return n})),r.data=function(){throw new Error("Can't get data for component kind")},r.init=function(){this.data=t.emboxValue(i,t.safeEquals)},r.materialized=function(){var t=this;p.active&&p.onInvalidate(function(){t.data.stop()})},r.materialized.isWith=!0,r},t.Each=function(i,n,r){return e("Each",i,n,r),t.EachImpl.extend({__sequence:i,__content:n,__elseContent:r})};var e=function(e,i,n,r){if("function"!=typeof i)throw new Error("First argument to "+e+" must be a function");if(!t.isComponent(n))throw new Error("Second argument to "+e+" must be a template or UI.block");if(r&&!t.isComponent(r))throw new Error("Third argument to "+e+" must be a template or UI.block if present")},i=function(e){return t.namedEmboxValue("if/unless",function(){var t=e();return t instanceof Array&&0===t.length?!1:!!t})}}.call(this),function(){t.EachImpl=r.extend({typeName:"Each",render:function(t){var e=this,i=e.__content,n=e.__elseContent;if("STATIC"===t){var r=f.map(g.fetch(e.__sequence()),function(t){return i.extend({data:function(){return t}})});return r.length?r:n}return null},materialized:function(){var e=this,i=e.dom,n=e.__content,r=e.__elseContent,s=0,o=function(n){if(r){if(0>s+n)throw new Error("count should never become negative");0===s&&i.removeAll(),s+=n,0===s&&t.materialize(r,i,null,e)}};this.observeHandle=g.observe(function(){return e.__sequence()},{addedAt:function(r,s,a,h){o(1),r=m._idStringify(r);var u=s,c=new p.Dependency,l=function(){return c.depend(),u};l.$set=function(t){u=t,c.changed()},h&&(h=m._idStringify(h));var d=t.render(n.extend({data:l}),e);i.add(r,d.dom,h)},removedAt:function(t){o(-1),i.remove(m._idStringify(t))},movedTo:function(t,e,n,r,s){i.moveBefore(m._idStringify(t),s&&m._idStringify(s))},changedAt:function(t,e){i.get(m._idStringify(t)).component.data.$set(e)}}),o(0)},destroyed:function(){this.__component__.observeHandle&&this.__component__.observeHandle.stop()}})}.call(this),function(){var e=(function(){return this}(),function(t){return r.extend({kind:"NoOp",render:function(){return d._debug("{{#"+t+"}} is now unnecessary and deprecated."),this.__content}})}),i={constant:e("constant"),isolate:e("isolate")};n(t.Component,{lookup:function(e,n){var r,h,u=this,c=n&&n.template;if(!e)throw new Error("must pass id to lookup");if(/^\./.test(e)){if(!/^(\.)+$/.test(e))throw new Error("id starting with dot must be a series of dots");for(var l=s("data",u),d=1;d<e.length;d++)l=l?s("data",l.parent):null;return l?l.data:null}if(h=o(e,u))var r=h[e];else{if(f.has(i,e))return i[e];if(c&&f.has(Template,e))return Template[e];if(!(r=t._globalHelper(e)))return function(){var t=a(u);if(c&&(!t||!f.has(t,e)))throw new Error("Can't find template, helper or data context key: "+e);if(!t)return t;var i=t[e];return"function"==typeof i?i.apply(t,arguments):i}}return"function"!=typeof r||r._isEmboxedConstant?r:function(){var t=a(u);return r.apply(null===t?{}:t,arguments)}},lookupTemplate:function(t){return this.lookup(t,{template:!0})},get:function(t){void 0===t&&(t=".");var e=this.lookup(t);return"function"==typeof e?e():e},set:function(t,e){var i=s(t,this);if(!i||!i[t])throw new Error("Can't find field: "+t);if("function"!=typeof i[t])throw new Error("Not a settable field: "+t);i[t](e)}})}.call(this),function(){var i={};t.registerHelper=function(t,e){i[t]=e},t._globalHelper=function(t){return i[t]},e={},e.registerHelper=t.registerHelper,t._escape=e._escape=function(){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","&":"&amp;"},e=function(e){return t[e]};return function(t){return t.replace(/[&<>"'`]/g,e)}}(),e.SafeString=function(t){this.string=t},e.SafeString.prototype.toString=function(){return this.string.toString()}}.call(this),"undefined"==typeof Package&&(Package={}),Package.ui={UI:t,Handlebars:e}}(),function(){var t,e=(Package.meteor.Meteor,Package.htmljs.HTML),i=Package.ui.UI,n=Package.ui.Handlebars;(function(){t={},t.include=function(t,e,n){if(e&&!i.isComponent(e))throw new Error("Second argument to Spacebars.include must be a template or UI.block if present");if(n&&!i.isComponent(n))throw new Error("Third argument to Spacebars.include must be a template or UI.block if present");var r=null;if(e&&(r=r||{},r.__content=e),n&&(r=r||{},r.__elseContent=n),i.isComponent(t))return t.extend(r);var s=t,o=function(){var t=i.namedEmboxValue("Spacebars.include",s);o.stop=function(){t.stop()};var e=t();if(null===e)return null;if(!i.isComponent(e))throw new Error("Expected null or template in return value from inclusion function, found: "+e);return e.extend(r)};return o},t.mustacheImpl=function(){var e=arguments;if(e.length>1){var i=e[e.length-1];if(i instanceof t.kw){var n={};for(var r in i.hash){var s=i.hash[r];n[r]="function"==typeof s?s():s}e[e.length-1]=t.kw(n)}else i=t.kw(),e=Array.prototype.slice.call(arguments),e.push(i)}return t.call.apply(null,e)},t.mustache=function(){var i=t.mustacheImpl.apply(null,arguments);return i instanceof t.SafeString?e.Raw(i.toString()):null==i||i===!1?null:String(i)},t.attrMustache=function(){var i=t.mustacheImpl.apply(null,arguments);if(null==i||""===i)return null;if("object"==typeof i)return i;if("string"==typeof i&&e.isValidAttributeName(i)){var n={};return n[i]="",n}throw new Error("Expected valid attribute name, '', null, or object")},t.dataMustache=function(){var e=t.mustacheImpl.apply(null,arguments);return e},t.makeRaw=function(t){return null==t?null:t instanceof e.Raw?t:e.Raw(t)},t.call=function(t){if("function"==typeof t){for(var e=[],i=1;i<arguments.length;i++){var n=arguments[i];e[i-1]="function"==typeof n?n():n}return t.apply(null,e)}if(arguments.length>1)throw new Error("Can't call non-function: "+t);return t},t.kw=function(e){return this instanceof t.kw?(this.hash=e||{},void 0):new t.kw(e)},t.SafeString=function(e){return this instanceof t.SafeString?new n.SafeString(e):new t.SafeString(e)},t.SafeString.prototype=n.SafeString.prototype,t.dot=function(e,i){if(arguments.length>2){var n=[];return n.push(t.dot(e,i)),n.push.apply(n,Array.prototype.slice.call(arguments,2)),t.dot.apply(null,n)}if("function"==typeof e&&(e=e()),!e)return e;var r=e[i];return"function"!=typeof r?r:function(){return r.apply(e,arguments)}},t.With=function(t,e,n){return i.Component.extend({init:function(){this.v=i.emboxValue(t,i.safeEquals)},render:function(){return i.If(this.v,i.With(this.v,e),n)},materialized:function(){var t=function(){var t=this;Deps.active&&Deps.onInvalidate(function(){t.v.stop()})};return t.isWith=!0,t}()})},t.TemplateWith=function(t,e){var n=i.With(t,e);return n.__isTemplateWith=!0,n}}).call(this),"undefined"==typeof Package&&(Package={}),Package.spacebars={Spacebars:t}}(),function(){{var t,e=(Package.meteor.Meteor,Package.ui.UI);Package.ui.Handlebars,Package.htmljs.HTML}(function(){t={},t.__define__=function(i,n){if(t.hasOwnProperty(i))throw new Error("There are multiple templates named '"+i+"'. Each template needs a unique name.");t[i]=e.Component.extend({kind:"Template_"+i,render:n,__helperHost:!0})}}).call(this),"undefined"==typeof Package&&(Package={}),Package.templating={Template:t}}(),function(){Package.meteor.Meteor;"undefined"==typeof Package&&(Package={}),Package.less={}}(),function(){var t=(Package.meteor.Meteor,Package.underscore._),e=Package.ejson.EJSON;(function(){e.minify=function(i){var n={"false":0,"true":1,"null":2},r=[!1,!0,null],s=[0],o=function(t){return"undefined"==typeof n[t]&&(n[t]=r.push(t)-1),n[t]},a=function(t){var e=String(t);return"undefined"!=typeof n[e]?n[e]:null},h=function(t){for(var e=null,i=1;i<s.length;i++){for(var n=s[i],r=Math.min(n.length,t.length),o=!0,a=0;r>a;a++)if(n[a]!==t[a]){o=!1;break}if(o&&(e=i,t.length>r&&(s[i]=t)),null!==e)break}return null===e&&(e=s.push(t)-1),e},u=function(e){var i=!t.isArray(e),n=[],r=[];if(t.each(e,function(t,e){var s=i?o(e):0;if(null!==t&&"object"==typeof t)i&&r.push(s),n.push(u(t));else{var h=a(t);null===h?(r.push(s),n.push(t)):(r.push(-s),n.push(h))}}),i){var s=h(r);n.unshift(s)}else n.unshift(0);return n};if("object"!=typeof i)return e.stringify(i);var c=u(e.toJSONValue(i));return r.shift(),r.shift(),r.shift(),JSON.stringify([r,s,c])},e.maxify=function(i){var n=JSON.parse(String(i));if(null===n||3!==n.length)return e.fromJSONValue(n);var r=n[0],s=n[1],o=n[2];r.unshift(!1,!0,null);var a=function(e){var i=e.shift(),n=i?s[i]:null,o=null===n?[]:{};if(null===n)for(var h=0;h<e.length;h++)t.isArray(e[h])?o.push(a(e[h])):o.push(e[h]);else for(var h=0;h<e.length;h++){var u=n[h],c=r[Math.abs(u)];if(t.isArray(e[h]))o[c]=a(e[h]);else{var l=e[h];0>u&&(l=r[l]),o[c]=l}}return o};return e.fromJSONValue(a(o))}}).call(this),"undefined"==typeof Package&&(Package={}),Package["ejson-minimax"]={}}(),function(){{var t,e=Package.meteor.Meteor,i=Package.deps.Deps,n=Package.retry.Retry;Package.livedata.DDP}(function(){var r=__meteor_runtime_config__.autoupdateVersion||"unknown",s=new e.Collection("meteor_autoupdate_clientVersions");t={},t.newClientAvailable=function(){return!!s.findOne({$and:[{current:!0},{_id:{$ne:r}}]})};var o=new n({minCount:0,baseTimeout:3e4}),a=0;t._retrySubscription=function(){e.subscribe("meteor_autoupdate_clientVersions",{onError:function(i){e._debug("autoupdate subscription failed:",i),a++,o.retryLater(a,function(){t._retrySubscription()})},onReady:function(){Package.reload&&i.autorun(function(t){s.findOne({current:!0})&&!s.findOne({_id:r})&&(t.stop(),Package.reload.Reload._reload())})}})},t._retrySubscription()}).call(this),"undefined"==typeof Package&&(Package={}),Package.autoupdate={Autoupdate:t}}(),function(){Package.meteor.Meteor,Package.reload.Reload,Package.autoupdate.Autoupdate;"undefined"==typeof Package&&(Package={}),Package["standard-app-packages"]={}}(),function(){var t,e=(Package.meteor.Meteor,Package.underscore._);(function(){t={_isCssLoaded:function(){return 0===document.styleSheets.length?!0:e.find(document.styleSheets,function(t){return t.cssText&&!t.cssRules?!t.cssText.match(/meteor-css-not-found-error/):!e.find(t.cssRules,function(t){return".meteor-css-not-found-error"===t.selectorText})})}}}).call(this),"undefined"==typeof Package&&(Package={}),Package.webapp={WebApp:t}}(),function(){{var t,e,i=Package.meteor.Meteor,n=Package.underscore._,r=Package.random.Random,s=Package.minimongo.LocalCollection,o=(Package.minimongo.Minimongo,Package.ejson.EJSON),a=Package.deps.Deps;Package.webapp.WebApp,Package.logging.Log,Package.session.Session,Package.livedata.DDP,Package.ui.UI,Package.ui.Handlebars,Package.spacebars.Spacebars,Package.templating.Template,Package.check.check,Package.check.Match,Package.jquery.$,Package.jquery.jQuery,Package.htmljs.HTML}(function(){"use strict";e={},e.connection=i.connection||i.default_connection,e.idParse=s&&s._idParse||i.idParse,e.subscriptionsReady=!1,e.subscriptionsReadyDeps=new a.Dependency,window.Meteor=i,window.console=window&&window.console&&window.console.log?window.console:{log:function(){}},e._isReloading=!1,e._storage=function(){var t,e,i;try{i=r.id(),(t=window.localStorage).setItem(i,i),e=t.getItem(i)!==i,t.removeItem(i),e&&(t=!1)}catch(n){}return t},e.storage=e._storage(),e._prefix="groundDB.",e._getGroundDBPrefix=function(t){return e._prefix+t},e._saveObject=function(i,n){if(e.storage&&e._isReloading===!1){var r=n&&o.minify(n);try{e.storage.setItem(e._getGroundDBPrefix(i),r)}catch(s){t.onQuotaExceeded()}}},e._loadObject=function(t){if(e.storage){var i=e.storage.getItem(e._getGroundDBPrefix(t));return i?o.maxify(i):null}return null},e.minify=function(t){return o.stringify(t)},e.maxify=function(t){return o.parse(t)},e.OneTimeout=function(){var t=this;t._id=null,t.oneTimeout=function(e,n){t._count++,null!==t._id&&i.clearTimeout(t._id),t._id=i.setTimeout(function(){t._id=null,e()},n)}},e._serverTimeDiff=0,e.storage&&(e._serverTimeDiff=1*e.storage.getItem(e._prefix+"timeDiff")||0,i.startup(function(){i.call("getServerTime",function(t,i){t||(e._serverTimeDiff=i-Date.now(),e.storage.setItem(e._prefix+"timeDiff",e._serverTimeDiff))})})),e._groundDatabases={},t=function(r,s){var o;o=r instanceof i.Collection?r:new i.Collection(r,s),o.offlineDatabase=!(null!==o._connection),o.name=o._name?o._name:"null",e._groundDatabases[o.name]=o,o.gdbSuper={},o._connection&&o._connection._stores[o.name]&&(o.gdbSuper.storeUpdate=o._connection._stores[o.name].update,o._connection._stores[o.name].update=function(t){var i=t.id&&e.idParse(t.id),n=t.id&&o._collection.findOne(i);"added"===t.msg&&n&&(delete o._localOnly[i],o._collection.remove(i)),"removed"!==t.msg||n||o._collection.insert({_id:i}),o.gdbSuper.storeUpdate(t)}),o._databaseLoaded=!1,o._localOnly={},o.removeLocalOnly=function(){n.each(o._localOnly,function(t,e){t&&(o._collection.remove({_id:e}),delete o._localOnly[e])})},o.isCleanedUp=!1,a.autorun(function(){t.ready()&&!o.isCleanedUp&&(o.isCleanedUp=!0,o.removeLocalOnly())}),o._checkDocs=function(t){var e={};return n.each(t,function(t,i){e[i]=t}),e},o._loadDatabase=function(){t.onResumeDatabase(o.name);var i=e._loadObject("db."+o.name);n.each(o._checkDocs(i?i._map:{}),function(t){var e=o._collection.findOne({_id:t._id});e||(o.offlineDatabase||(o._localOnly[t._id]=!0),o._collection.insert(t))}),o._databaseLoaded=!0};var h=new e.OneTimeout,u=new a.Dependency,c=function(){u.changed()};return o._saveDatabase=function(){o._databaseLoaded&&h.oneTimeout(function(){t.onCacheDatabase(o.name),e._saveObject("db."+o.name,o._collection._docs)},200)},o.find().observe({added:c,changed:c,removed:c}),i.autorun(function(){u.depend(),o._saveDatabase()}),o._loadDatabase(),o},window.GroundDB=t,t.onQuotaExceeded=function(){throw new Error("Quota exceeded!")},t.onResumeDatabase=function(){},t.onResumeMethods=function(){},t.onMethodCall=function(){},t.onCacheDatabase=function(){},t.onCacheMethods=function(){},t.onTabSync=function(){},t.onFlushInMemoryMethods=function(){},t.ready=function(){return e.subscriptionsReadyDeps.depend(),e.subscriptionsReady},t.saveObject=e._saveObject,t.loadObject=e._loadObject,t.now=function(){return Date.now()+e._serverTimeDiff},e.skipThisMethod={login:!0,getServerTime:!0},t.skipMethods=function(t){if("object"!=typeof t)throw new Error("skipMethods expects parametre as object of method names to skip when caching methods");for(var i in t)t.hasOwnProperty(i)&&(e.skipThisMethod[i]=!!t[i])},t.OneTimeout=e.OneTimeout,e._methodsResumed=!1,e._getMethodsList=function(){var t=[];return n.each(e.connection._methodInvokers,function(i){e.skipThisMethod[i._message.method]||t.push({method:i._message.method,args:i._message.params,options:{wait:i._wait}})}),t},e._flushInMemoryMethods=function(){var i=!1;if(e.connection&&e.connection._outstandingMethodBlocks&&e.connection._outstandingMethodBlocks.length){for(var n=0;n<e.connection._outstandingMethodBlocks.length;n++){var r=e.connection._outstandingMethodBlocks[n];r&&r._message&&!e.skipThisMethod[r._message.method]&&(delete e.connection._outstandingMethodBlocks[n],delete e.connection._methodInvokers[n],i=!0)}i&&t.onFlushInMemoryMethods()}},e._getMethodUpdates=function(i){var n=[];if(i&&i.length>0){var r=e._getMethodsList();r.length&&o.stringify(r[0])!==o.stringify(i[0])&&(e._flushInMemoryMethods(),r=[]);for(var s=0;s<i.length;s++)if(s<r.length){if(o.stringify(r[s])!==o.stringify(i[s]))throw new Error("The method database is corrupted or out of sync at position: "+s)}else n.push(i[s]),t.onMethodCall(i[s])}else e._flushInMemoryMethods();return n},e._loadMethods=function(){var i=e._loadObject("methods");if(i=e._getMethodUpdates(i))for(;i.length>0;){var n=i.shift(),r=n.method.split("/"),s=r[1],o=r[2];if(s&&o&&e._groundDatabases[s]){var a=e.idParse(n.args&&n.args[0]?n.args[0]._id||n.args[0]:""),h=e._groundDatabases[s]._collection.findOne(a);h&&"insert"===o&&(e._groundDatabases[s]._collection.remove(a),delete e._groundDatabases[s]._localOnly[a])}e.connection.apply(n.method,n.args,n.options)}e._methodsResumed=!0,t.onResumeMethods()},e._saveMethods=function(){e._methodsResumed&&(t.onCacheMethods(),e._saveObject("methods",e._getMethodsList()))},i.setInterval(function(){var t=!0;for(var n in i.connection._subscriptions){var r=i.connection._subscriptions[n];if(!r.ready){t=!1;break}}t!==e.subscriptionsReady&&(e.subscriptionsReady=t,e.subscriptionsReadyDeps.changed())},5e3),i.startup(function(){i.setTimeout(function(){e._loadMethods()},500)});var h=new e.OneTimeout;e._syncDatabase=function(i){h.oneTimeout(function(){var r=e._groundDatabases[i];if(r){t.onTabSync("database",i);var s=e._loadObject("db."+i);r.find().forEach(function(t){r._collection.remove(t._id),"undefined"!=typeof s[t._id]&&(r._collection.insert(s[t._id]),delete s[t._id])}),n.each(s,function(t){r._collection.insert(t)})}},150)};var u=new e.OneTimeout;e._syncMethods=function(){e._isReloading=!0,u.oneTimeout(function(){t.onTabSync("methods"),e._loadMethods(),e._isReloading=!1},500)},n.extend(e.connection,{_gdbSuper:{apply:e.connection.apply,_outstandingMethodFinished:e.connection._outstandingMethodFinished},apply:function(){var t=this;t._gdbSuper.apply.apply(t,arguments),e._saveMethods()},_outstandingMethodFinished:function(){var t=this;t._gdbSuper._outstandingMethodFinished.apply(t),e._saveMethods()}}),"undefined"!=typeof window.addEventListener&&window.addEventListener("storage",function(t){var i=new RegExp("^"+e._prefix+"db.");t.key===e._prefix+"methods"&&e._syncMethods("mehods"),i.test(t.key)&&e._syncDatabase(t.key.replace(i,""))},!1)}).call(this),"undefined"==typeof Package&&(Package={}),Package.grounddb={GroundDB:t,_gDB:e}}(),function(){{var t;Package.meteor.Meteor}(function(){(function(){var e=this,i=i||{};i.WEBGL_RENDERER=0,i.CANVAS_RENDERER=1,i.VERSION="v1.5.2",i.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},i.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},i.INTERACTION_FREQUENCY=30,i.AUTO_PREVENT_DEFAULT=!0,i.RAD_TO_DEG=180/Math.PI,i.DEG_TO_RAD=Math.PI/180,i.Point=function(t,e){this.x=t||0,this.y=e||0},i.Point.prototype.clone=function(){return new i.Point(this.x,this.y)},i.Point.prototype.constructor=i.Point,i.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},i.Rectangle=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},i.Rectangle.prototype.clone=function(){return new i.Rectangle(this.x,this.y,this.width,this.height)},i.Rectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(t>=i&&t<=i+this.width){var n=this.y;if(e>=n&&e<=n+this.height)return!0}return!1},i.Rectangle.prototype.constructor=i.Rectangle,i.EmptyRectangle=new i.Rectangle(0,0,0,0),i.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var e=[],n=0,r=t.length;r>n;n+=2)e.push(new i.Point(t[n],t[n+1]));t=e}this.points=t},i.Polygon.prototype.clone=function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].clone());return new i.Polygon(t)},i.Polygon.prototype.contains=function(t,e){for(var i=!1,n=0,r=this.points.length-1;n<this.points.length;r=n++){var s=this.points[n].x,o=this.points[n].y,a=this.points[r].x,h=this.points[r].y,u=o>e!=h>e&&(a-s)*(e-o)/(h-o)+s>t;u&&(i=!i)}return i},i.Polygon.prototype.constructor=i.Polygon,i.Circle=function(t,e,i){this.x=t||0,this.y=e||0,this.radius=i||0},i.Circle.prototype.clone=function(){return new i.Circle(this.x,this.y,this.radius)},i.Circle.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,n=this.y-e,r=this.radius*this.radius;return i*=i,n*=n,r>=i+n},i.Circle.prototype.constructor=i.Circle,i.Ellipse=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},i.Ellipse.prototype.clone=function(){return new i.Ellipse(this.x,this.y,this.width,this.height)},i.Ellipse.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return i*=i,n*=n,1>=i+n},i.Ellipse.prototype.getBounds=function(){return new i.Rectangle(this.x,this.y,this.width,this.height)},i.Ellipse.prototype.constructor=i.Ellipse,i.determineMatrixArrayType=function(){return"undefined"!=typeof Float32Array?Float32Array:Array},i.Matrix2=i.determineMatrixArrayType(),i.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},i.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},i.Matrix.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var e=this.array;return t?(this.array[0]=this.a,this.array[1]=this.c,this.array[2]=0,this.array[3]=this.b,this.array[4]=this.d,this.array[5]=0,this.array[6]=this.tx,this.array[7]=this.ty,this.array[8]=1):(this.array[0]=this.a,this.array[1]=this.b,this.array[2]=this.tx,this.array[3]=this.c,this.array[4]=this.d,this.array[5]=this.ty,this.array[6]=0,this.array[7]=0,this.array[8]=1),e},i.identityMatrix=new i.Matrix,i.DisplayObject=function(){this.position=new i.Point,this.scale=new i.Point(1,1),this.pivot=new i.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new i.Matrix,this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new i.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},i.DisplayObject.prototype.constructor=i.DisplayObject,i.DisplayObject.prototype.setInteractive=function(t){this.interactive=t},Object.defineProperty(i.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(t){this._interactive=t,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(i.DisplayObject.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(i.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(i.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(t){if(t){for(var e=[],i=0;i<t.length;i++)for(var n=t[i].passes,r=0;r<n.length;r++)e.push(n[r]);this._filterBlock={target:this,filterPasses:e}}this._filters=t}}),Object.defineProperty(i.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),i.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.parent.worldTransform,e=this.worldTransform,i=this.pivot.x,n=this.pivot.y,r=this._cr*this.scale.x,s=-this._sr*this.scale.y,o=this._sr*this.scale.x,a=this._cr*this.scale.y,h=this.position.x-r*i-n*s,u=this.position.y-a*n-i*o,c=t.a,l=t.b,d=t.c,p=t.d;e.a=c*r+l*o,e.b=c*s+l*a,e.tx=c*h+l*u+t.tx,e.c=d*r+p*o,e.d=d*s+p*a,e.ty=d*h+p*u+t.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},i.DisplayObject.prototype.getBounds=function(t){return t=t,i.EmptyRectangle},i.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(i.identityMatrix)},i.DisplayObject.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0)
},i.DisplayObject.prototype.generateTexture=function(t){var e=this.getLocalBounds(),n=new i.RenderTexture(0|e.width,0|e.height,t);return n.render(this,new i.Point(-e.x,-e.y)),n},i.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},i.DisplayObject.prototype._renderCachedSprite=function(t){t.gl?i.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):i.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},i.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var e=new i.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new i.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform}var n=this._filters;this._filters=null,this._cachedSprite.filters=n,this._cachedSprite.texture.render(this,new i.Point(-t.x,-t.y)),this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._filters=n,this._cacheAsBitmap=!0},i.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},i.DisplayObject.prototype._renderWebGL=function(t){t=t},i.DisplayObject.prototype._renderCanvas=function(t){t=t},Object.defineProperty(i.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(i.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),i.DisplayObjectContainer=function(){i.DisplayObject.call(this),this.children=[]},i.DisplayObjectContainer.prototype=Object.create(i.DisplayObject.prototype),i.DisplayObjectContainer.prototype.constructor=i.DisplayObjectContainer,i.DisplayObjectContainer.prototype.addChild=function(t){this.addChildAt(t,this.children.length)},i.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(!(e>=0&&e<=this.children.length))throw new Error(t+" The index "+e+" supplied is out of bounds "+this.children.length);t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.stage&&t.setStageReference(this.stage)},i.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.children.indexOf(t),n=this.children.indexOf(e);if(0>i||0>n)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[n]=t}},i.DisplayObjectContainer.prototype.getChildAt=function(t){if(t>=0&&t<this.children.length)return this.children[t];throw new Error("Supplied index does not exist in the child list, or the supplied DisplayObject must be a child of the caller")},i.DisplayObjectContainer.prototype.removeChild=function(t){return this.removeChildAt(this.children.indexOf(t))},i.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},i.DisplayObjectContainer.prototype.removeChildren=function(t,e){var i=t||0,n="number"==typeof e?e:this.children.length,r=n-i;if(r>0&&n>=r){for(var s=this.children.splice(i,r),o=0;o<s.length;o++){var a=s[o];this.stage&&a.removeStageReference(),a.parent=void 0}return s}throw new Error("Range Error, numeric values are outside the acceptable range")},i.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(i.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()},i.DisplayObjectContainer.prototype.getBounds=function(t){if(0===this.children.length)return i.EmptyRectangle;if(t){var e=this.worldTransform;this.worldTransform=t,this.updateTransform(),this.worldTransform=e}for(var n,r,s,o=1/0,a=1/0,h=-1/0,u=-1/0,c=!1,l=0,d=this.children.length;d>l;l++){var p=this.children[l];p.visible&&(c=!0,n=this.children[l].getBounds(t),o=o<n.x?o:n.x,a=a<n.y?a:n.y,r=n.width+n.x,s=n.height+n.y,h=h>r?h:r,u=u>s?u:s)}if(!c)return i.EmptyRectangle;var f=this._bounds;return f.x=o,f.y=a,f.width=h-o,f.height=u-a,f},i.DisplayObjectContainer.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=i.identityMatrix;for(var e=0,n=this.children.length;n>e;e++)this.children[e].updateTransform();var r=this.getBounds();return this.worldTransform=t,r},i.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n.setStageReference(t)}},i.DisplayObjectContainer.prototype.removeStageReference=function(){for(var t=0,e=this.children.length;e>t;t++){var i=this.children[t];i.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},i.DisplayObjectContainer.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return this._renderCachedSprite(t),void 0;var e,i;if(this._mask||this._filters){for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),t.spriteBatch.start()}else for(e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t)}},i.DisplayObjectContainer.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return this._renderCachedSprite(t),void 0;this._mask&&t.maskManager.pushMask(this._mask,t.context);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n._renderCanvas(t)}this._mask&&t.maskManager.popMask(t.context)}},i.Sprite=function(t){i.DisplayObjectContainer.call(this),this.anchor=new i.Point,this.texture=t,this._width=0,this._height=0,this.tint=16777215,this.blendMode=i.blendModes.NORMAL,t.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},i.Sprite.prototype=Object.create(i.DisplayObjectContainer.prototype),i.Sprite.prototype.constructor=i.Sprite,Object.defineProperty(i.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(i.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),i.Sprite.prototype.setTexture=function(t){this.texture.baseTexture!==t.baseTexture?(this.textureChange=!0,this.texture=t):this.texture=t,this.cachedTint=16777215,this.updateFrame=!0},i.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},i.Sprite.prototype.getBounds=function(t){var e=this.texture.frame.width,i=this.texture.frame.height,n=e*(1-this.anchor.x),r=e*-this.anchor.x,s=i*(1-this.anchor.y),o=i*-this.anchor.y,a=t||this.worldTransform,h=a.a,u=a.c,c=a.b,l=a.d,d=a.tx,p=a.ty,f=h*r+c*o+d,m=l*o+u*r+p,g=h*n+c*o+d,y=l*o+u*n+p,v=h*n+c*s+d,_=l*s+u*n+p,b=h*r+c*s+d,x=l*s+u*r+p,w=-1/0,T=-1/0,S=1/0,C=1/0;S=S>f?f:S,S=S>g?g:S,S=S>v?v:S,S=S>b?b:S,C=C>m?m:C,C=C>y?y:C,C=C>_?_:C,C=C>x?x:C,w=f>w?f:w,w=g>w?g:w,w=v>w?v:w,w=b>w?b:w,T=m>T?m:T,T=y>T?y:T,T=_>T?_:T,T=x>T?x:T;var P=this._bounds;return P.x=S,P.width=w-S,P.y=C,P.height=T-C,this._currentBounds=P,P},i.Sprite.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){var e,i;if(this._mask||this._filters){var n=t.spriteBatch;for(this._mask&&(n.stop(),t.maskManager.pushMask(this.mask,t),n.start()),this._filters&&(n.flush(),t.filterManager.pushFilter(this._filterBlock)),n.render(this),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t);n.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),n.start()}else for(t.spriteBatch.render(this),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t)}},i.Sprite.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){var e=this.texture.frame,n=t.context,r=this.texture;if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,n.globalCompositeOperation=i.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t.context),e&&e.width&&e.height&&r.baseTexture.source){n.globalAlpha=this.worldAlpha;var s=this.worldTransform;if(t.roundPixels?n.setTransform(s.a,s.c,s.b,s.d,0|s.tx,0|s.ty):n.setTransform(s.a,s.c,s.b,s.d,s.tx,s.ty),t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,n[t.smoothProperty]=t.scaleMode===i.scaleModes.LINEAR),16777215!==this.tint){if(this.cachedTint!==this.tint){if(!r.baseTexture.hasLoaded)return;this.cachedTint=this.tint,this.tintedTexture=i.CanvasTinter.getTintedTexture(this,this.tint)}n.drawImage(this.tintedTexture,0,0,e.width,e.height,this.anchor.x*-e.width,this.anchor.y*-e.height,e.width,e.height)}else if(r.trim){var o=r.trim;n.drawImage(this.texture.baseTexture.source,e.x,e.y,e.width,e.height,o.x-this.anchor.x*o.width,o.y-this.anchor.y*o.height,e.width,e.height)}else n.drawImage(this.texture.baseTexture.source,e.x,e.y,e.width,e.height,this.anchor.x*-e.width,this.anchor.y*-e.height,e.width,e.height)}for(var a=0,h=this.children.length;h>a;a++){var u=this.children[a];u._renderCanvas(t)}this._mask&&t.maskManager.popMask(t.context)}},i.Sprite.fromFrame=function(t){var e=i.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new i.Sprite(e)},i.Sprite.fromImage=function(t,e,n){var r=i.Texture.fromImage(t,e,n);return new i.Sprite(r)},i.SpriteBatch=function(t){i.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},i.SpriteBatch.prototype=Object.create(i.DisplayObjectContainer.prototype),i.SpriteBatch.constructor=i.SpriteBatch,i.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new i.WebGLFastSpriteBatch(t),this.ready=!0},i.SpriteBatch.prototype.updateTransform=function(){i.DisplayObject.prototype.updateTransform.call(this)},i.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),t.spriteBatch.stop(),t.shaderManager.activateShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.shaderManager.activateShader(t.shaderManager.defaultShader),t.spriteBatch.start())},i.SpriteBatch.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha,i.DisplayObject.prototype.updateTransform.call(this);for(var n=this.worldTransform,r=!0,s=0;s<this.children.length;s++){var o=this.children[s];if(o.visible){var a=o.texture,h=a.frame;if(e.globalAlpha=this.worldAlpha*o.alpha,o.rotation%(2*Math.PI)===0)r&&(e.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),r=!1),e.drawImage(a.baseTexture.source,h.x,h.y,h.width,h.height,o.anchor.x*-h.width*o.scale.x+o.position.x+.5|0,o.anchor.y*-h.height*o.scale.y+o.position.y+.5|0,h.width*o.scale.x,h.height*o.scale.y);else{r||(r=!0),i.DisplayObject.prototype.updateTransform.call(o);var u=o.worldTransform;t.roundPixels?e.setTransform(u.a,u.c,u.b,u.d,0|u.tx,0|u.ty):e.setTransform(u.a,u.c,u.b,u.d,u.tx,u.ty),e.drawImage(a.baseTexture.source,h.x,h.y,h.width,h.height,o.anchor.x*-h.width+.5|0,o.anchor.y*-h.height+.5|0,h.width,h.height)}}}},i.AbstractFilter=function(t,e){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=e||{},this.fragmentSrc=t||[]},i.FilterBlock=function(){this.visible=!0,this.renderable=!0},i.Text=function(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),i.Sprite.call(this,i.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},i.Text.prototype=Object.create(i.Sprite.prototype),i.Text.prototype.constructor=i.Text,i.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||4,t.dropShadowColor=t.dropShadowColor||"black",this.style=t,this.dirty=!0},i.Text.prototype.setText=function(t){this.text=t.toString()||" ",this.dirty=!0},i.Text.prototype.updateText=function(){this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),i=[],n=0,r=0;r<e.length;r++){var s=this.context.measureText(e[r]).width;i[r]=s,n=Math.max(n,s)}var o=n+this.style.strokeThickness;this.style.dropShadow&&(o+=this.style.dropShadowDistance),this.canvas.width=o+this.context.lineWidth;var a=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,h=a*e.length;this.style.dropShadow&&(h+=this.style.dropShadowDistance),this.canvas.height=h,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top";var u,c;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var l=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,d=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(r=0;r<e.length;r++)u=this.style.strokeThickness/2,c=this.style.strokeThickness/2+r*a,"right"===this.style.align?u+=n-i[r]:"center"===this.style.align&&(u+=(n-i[r])/2),this.style.fill&&this.context.fillText(e[r],u+l,c+d)}for(this.context.fillStyle=this.style.fill,r=0;r<e.length;r++)u=this.style.strokeThickness/2,c=this.style.strokeThickness/2+r*a,"right"===this.style.align?u+=n-i[r]:"center"===this.style.align&&(u+=(n-i[r])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[r],u,c),this.style.fill&&this.context.fillText(e[r],u,c);this.updateTexture()},i.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.frame.width=this.canvas.width,this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.requiresUpdate=!0},i.Text.prototype._renderWebGL=function(t){this.requiresUpdate&&(this.requiresUpdate=!1,i.updateWebGLTexture(this.texture.baseTexture,t.gl)),i.Sprite.prototype._renderWebGL.call(this,t)},i.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),i.Sprite.prototype.updateTransform.call(this)},i.Text.prototype.determineFontHeight=function(t){var e=i.Text.heightCache[t];if(!e){var n=document.getElementsByTagName("body")[0],r=document.createElement("div"),s=document.createTextNode("M");r.appendChild(s),r.setAttribute("style",t+";position:absolute;top:0;left:0"),n.appendChild(r),e=r.offsetHeight,i.Text.heightCache[t]=e,n.removeChild(r)}return e},i.Text.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),n=0;n<i.length;n++){for(var r=this.style.wordWrapWidth,s=i[n].split(" "),o=0;o<s.length;o++){var a=this.context.measureText(s[o]).width,h=a+this.context.measureText(" ").width;0===o||h>r?(o>0&&(e+="\n"),e+=s[o],r=this.style.wordWrapWidth-a):(r-=h,e+=" "+s[o])}n<i.length-1&&(e+="\n")}return e},i.Text.prototype.destroy=function(t){t&&this.texture.destroy()},i.Text.heightCache={},i.BitmapText=function(t,e){i.DisplayObjectContainer.call(this),this._pool=[],this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},i.BitmapText.prototype=Object.create(i.DisplayObjectContainer.prototype),i.BitmapText.prototype.constructor=i.BitmapText,i.BitmapText.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},i.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var e=t.font.split(" ");this.fontName=e[e.length-1],this.fontSize=e.length>=2?parseInt(e[e.length-2],10):i.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=t.tint},i.BitmapText.prototype.updateText=function(){for(var t=i.BitmapText.fonts[this.fontName],e=new i.Point,n=null,r=[],s=0,o=[],a=0,h=this.fontSize/t.size,u=0;u<this.text.length;u++){var c=this.text.charCodeAt(u);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(u)))o.push(e.x),s=Math.max(s,e.x),a++,e.x=0,e.y+=t.lineHeight,n=null;else{var l=t.chars[c];l&&(n&&l[n]&&(e.x+=l.kerning[n]),r.push({texture:l.texture,line:a,charCode:c,position:new i.Point(e.x+l.xOffset,e.y+l.yOffset)}),e.x+=l.xAdvance,n=c)}}o.push(e.x),s=Math.max(s,e.x);var d=[];for(u=0;a>=u;u++){var p=0;"right"===this.style.align?p=s-o[u]:"center"===this.style.align&&(p=(s-o[u])/2),d.push(p)}var f=this.children.length,m=r.length,g=this.tint||16777215;for(u=0;m>u;u++){var y=f>u?this.children[u]:this._pool.pop();y?y.setTexture(r[u].texture):y=new i.Sprite(r[u].texture),y.position.x=(r[u].position.x+d[r[u].line])*h,y.position.y=r[u].position.y*h,y.scale.x=y.scale.y=h,y.tint=g,y.parent||this.addChild(y)}for(;this.children.length>m;){var v=this.getChildAt(this.children.length-1);this._pool.push(v),this.removeChild(v)}this.textWidth=s*h,this.textHeight=(e.y+t.lineHeight)*h},i.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),i.DisplayObjectContainer.prototype.updateTransform.call(this)},i.BitmapText.fonts={},i.Stage=function(t){i.DisplayObjectContainer.call(this),this.worldTransform=new i.Matrix,this.interactive=!0,this.interactionManager=new i.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new i.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},i.Stage.prototype=Object.create(i.DisplayObjectContainer.prototype),i.Stage.prototype.constructor=i.Stage,i.Stage.prototype.setInteractionDelegate=function(t){this.interactionManager.setTargetDomElement(t)},i.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},i.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=i.hex2rgb(this.backgroundColor);var e=this.backgroundColor.toString(16);e="000000".substr(0,6-e.length)+e,this.backgroundColorString="#"+e},i.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var n=0,r=["ms","moz","webkit","o"],s=0;s<r.length&&!window.requestAnimationFrame;++s)window.requestAnimationFrame=window[r[s]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[s]+"CancelAnimationFrame"]||window[r[s]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-n)),r=window.setTimeout(function(){t(e+i)},i);return n=e+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.requestAnimFrame=window.requestAnimationFrame,i.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},i.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function i(){var s=r.concat(t.call(arguments));n.apply(this instanceof i?this:e,s)}var n=this,r=t.call(arguments,1);if("function"!=typeof n)throw new TypeError;return i.prototype=function s(t){return t&&(s.prototype=t),this instanceof s?void 0:new s}(n.prototype),i}}()),i.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(i){}},i.canUseNewCanvasBlendModes=function(){var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},i.getNextPowerOfTwo=function(t){if(t>0&&0===(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},i.EventTarget=function(){var t={};this.addEventListener=this.on=function(e,i){void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(i)&&t[e].push(i)},this.dispatchEvent=this.emit=function(e){if(t[e.type]&&t[e.type].length)for(var i=0,n=t[e.type].length;n>i;i++)t[e.type][i](e)},this.removeEventListener=this.off=function(e,i){var n=t[e].indexOf(i);-1!==n&&t[e].splice(n,1)},this.removeAllEventListeners=function(e){var i=t[e];i&&(i.length=0)}},i.PolyK={},i.PolyK.Triangulate=function(t){var e=!0,n=t.length>>1;if(3>n)return[];for(var r=[],s=[],o=0;n>o;o++)s.push(o);o=0;for(var a=n;a>3;){var h=s[(o+0)%a],u=s[(o+1)%a],c=s[(o+2)%a],l=t[2*h],d=t[2*h+1],p=t[2*u],f=t[2*u+1],m=t[2*c],g=t[2*c+1],y=!1;if(i.PolyK._convex(l,d,p,f,m,g,e)){y=!0;for(var v=0;a>v;v++){var _=s[v];if(_!==h&&_!==u&&_!==c&&i.PolyK._PointInTriangle(t[2*_],t[2*_+1],l,d,p,f,m,g)){y=!1;break}}}if(y)r.push(h,u,c),s.splice((o+1)%a,1),a--,o=0;else if(o++>3*a){if(!e)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(r=[],s=[],o=0;n>o;o++)s.push(o);o=0,a=n,e=!1}}return r.push(s[0],s[1],s[2]),r},i.PolyK._PointInTriangle=function(t,e,i,n,r,s,o,a){var h=o-i,u=a-n,c=r-i,l=s-n,d=t-i,p=e-n,f=h*h+u*u,m=h*c+u*l,g=h*d+u*p,y=c*c+l*l,v=c*d+l*p,_=1/(f*y-m*m),b=(y*g-m*v)*_,x=(f*v-m*g)*_;return b>=0&&x>=0&&1>b+x},i.PolyK._convex=function(t,e,i,n,r,s,o){return(e-n)*(r-i)+(i-t)*(s-n)>=0===o},i.initDefaultShaders=function(){},i.CompileVertexShader=function(t,e){return i._CompileShader(t,e,t.VERTEX_SHADER)},i.CompileFragmentShader=function(t,e){return i._CompileShader(t,e,t.FRAGMENT_SHADER)},i._CompileShader=function(t,e,i){var n=e.join("\n"),r=t.createShader(i);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(window.console.log(t.getShaderInfoLog(r)),null)},i.compileProgram=function(t,e,n){var r=i.CompileFragmentShader(t,n),s=i.CompileVertexShader(t,e),o=t.createProgram();return t.attachShader(o,s),t.attachShader(o,r),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),o},i.PixiShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},i.PixiShader.prototype.init=function(){var t=this.gl,e=i.compileProgram(t,this.vertexSrc||i.PixiShader.defaultVertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var n in this.uniforms)this.uniforms[n].uniformLocation=t.getUniformLocation(e,n);this.initUniforms(),this.program=e},i.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var i in this.uniforms){t=this.uniforms[i];var n=t.type;"sampler2D"===n?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===n||"mat3"===n||"mat4"===n?(t.glMatrix=!0,t.glValueLength=1,"mat2"===n?t.glFunc=e.uniformMatrix2fv:"mat3"===n?t.glFunc=e.uniformMatrix3fv:"mat4"===n&&(t.glFunc=e.uniformMatrix4fv)):(t.glFunc=e["uniform"+n],t.glValueLength="2f"===n||"2i"===n?2:"3f"===n||"3i"===n?3:"4f"===n||"4i"===n?4:1)}},i.PixiShader.prototype.initSampler2D=function(t){if(t.value&&t.value.baseTexture&&t.value.baseTexture.hasLoaded){var e=this.gl;if(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),t.textureData){var i=t.textureData,n=i.magFilter?i.magFilter:e.LINEAR,r=i.minFilter?i.minFilter:e.LINEAR,s=i.wrapS?i.wrapS:e.CLAMP_TO_EDGE,o=i.wrapT?i.wrapT:e.CLAMP_TO_EDGE,a=i.luminance?e.LUMINANCE:e.RGBA;if(i.repeat&&(s=e.REPEAT,o=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!i.flipY),i.width){var h=i.width?i.width:512,u=i.height?i.height:2,c=i.border?i.border:0;e.texImage2D(e.TEXTURE_2D,0,a,h,u,c,a,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,a,e.RGBA,e.UNSIGNED_BYTE,t.value.baseTexture.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,o)}e.uniform1i(t.uniformLocation,this.textureCount),t._init=!0,this.textureCount++}},i.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var n in this.uniforms)t=this.uniforms[n],1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(e,t.uniformLocation,t.transpose,t.value):t.glFunc.call(e,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]||i.createWebGLTexture(t.value.baseTexture,e)),e.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},i.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},i.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],i.PixiFastShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},i.PixiFastShader.prototype.init=function(){var t=this.gl,e=i.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.uMatrix=t.getUniformLocation(e,"uMatrix"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(e,"aPositionCoord"),this.aScale=t.getAttribLocation(e,"aScale"),this.aRotation=t.getAttribLocation(e,"aRotation"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=e},i.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},i.StripShader=function(){this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","   gl_FragColor = gl_FragColor * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","uniform vec2 offsetVector;","varying float vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"]},i.StripShader.prototype.init=function(){var t=i.gl,e=i.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},i.PrimitiveShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},i.PrimitiveShader.prototype.init=function(){var t=this.gl,e=i.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},i.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},i.WebGLGraphics=function(){},i.WebGLGraphics.renderGraphics=function(t,e){var n=e.gl,r=e.projection,s=e.offset,o=e.shaderManager.primitiveShader;t._webGL[n.id]||(t._webGL[n.id]={points:[],indices:[],lastIndex:0,buffer:n.createBuffer(),indexBuffer:n.createBuffer()});
var a=t._webGL[n.id];t.dirty&&(t.dirty=!1,t.clearDirty&&(t.clearDirty=!1,a.lastIndex=0,a.points=[],a.indices=[]),i.WebGLGraphics.updateGraphics(t,n)),e.shaderManager.activatePrimitiveShader(),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.uniformMatrix3fv(o.translationMatrix,!1,t.worldTransform.toArray(!0)),n.uniform2f(o.projectionVector,r.x,-r.y),n.uniform2f(o.offsetVector,-s.x,-s.y),n.uniform3fv(o.tintColor,i.hex2rgb(t.tint)),n.uniform1f(o.alpha,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,a.buffer),n.vertexAttribPointer(o.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(o.colorAttribute,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a.indexBuffer),n.drawElements(n.TRIANGLE_STRIP,a.indices.length,n.UNSIGNED_SHORT,0),e.shaderManager.deactivatePrimitiveShader()},i.WebGLGraphics.updateGraphics=function(t,e){for(var n=t._webGL[e.id],r=n.lastIndex;r<t.graphicsData.length;r++){var s=t.graphicsData[r];s.type===i.Graphics.POLY?(s.fill&&s.points.length>3&&i.WebGLGraphics.buildPoly(s,n),s.lineWidth>0&&i.WebGLGraphics.buildLine(s,n)):s.type===i.Graphics.RECT?i.WebGLGraphics.buildRectangle(s,n):(s.type===i.Graphics.CIRC||s.type===i.Graphics.ELIP)&&i.WebGLGraphics.buildCircle(s,n)}n.lastIndex=t.graphicsData.length,n.glPoints=new Float32Array(n.points),e.bindBuffer(e.ARRAY_BUFFER,n.buffer),e.bufferData(e.ARRAY_BUFFER,n.glPoints,e.STATIC_DRAW),n.glIndicies=new Uint16Array(n.indices),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n.glIndicies,e.STATIC_DRAW)},i.WebGLGraphics.buildRectangle=function(t,e){var n=t.points,r=n[0],s=n[1],o=n[2],a=n[3];if(t.fill){var h=i.hex2rgb(t.fillColor),u=t.fillAlpha,c=h[0]*u,l=h[1]*u,d=h[2]*u,p=e.points,f=e.indices,m=p.length/6;p.push(r,s),p.push(c,l,d,u),p.push(r+o,s),p.push(c,l,d,u),p.push(r,s+a),p.push(c,l,d,u),p.push(r+o,s+a),p.push(c,l,d,u),f.push(m,m,m+1,m+2,m+3,m+3)}if(t.lineWidth){var g=t.points;t.points=[r,s,r+o,s,r+o,s+a,r,s+a,r,s],i.WebGLGraphics.buildLine(t,e),t.points=g}},i.WebGLGraphics.buildCircle=function(t,e){var n=t.points,r=n[0],s=n[1],o=n[2],a=n[3],h=40,u=2*Math.PI/h,c=0;if(t.fill){var l=i.hex2rgb(t.fillColor),d=t.fillAlpha,p=l[0]*d,f=l[1]*d,m=l[2]*d,g=e.points,y=e.indices,v=g.length/6;for(y.push(v),c=0;h+1>c;c++)g.push(r,s,p,f,m,d),g.push(r+Math.sin(u*c)*o,s+Math.cos(u*c)*a,p,f,m,d),y.push(v++,v++);y.push(v-1)}if(t.lineWidth){var _=t.points;for(t.points=[],c=0;h+1>c;c++)t.points.push(r+Math.sin(u*c)*o,s+Math.cos(u*c)*a);i.WebGLGraphics.buildLine(t,e),t.points=_}},i.WebGLGraphics.buildLine=function(t,e){var n=0,r=t.points;if(0!==r.length){if(t.lineWidth%2)for(n=0;n<r.length;n++)r[n]+=.5;var s=new i.Point(r[0],r[1]),o=new i.Point(r[r.length-2],r[r.length-1]);if(s.x===o.x&&s.y===o.y){r.pop(),r.pop(),o=new i.Point(r[r.length-2],r[r.length-1]);var a=o.x+.5*(s.x-o.x),h=o.y+.5*(s.y-o.y);r.unshift(a,h),r.push(a,h)}var u,c,l,d,p,f,m,g,y,v,_,b,x,w,T,S,C,P,k,E,A,O,M,I=e.points,D=e.indices,R=r.length/2,L=r.length,N=I.length/6,B=t.lineWidth/2,F=i.hex2rgb(t.lineColor),j=t.lineAlpha,U=F[0]*j,G=F[1]*j,X=F[2]*j;for(l=r[0],d=r[1],p=r[2],f=r[3],y=-(d-f),v=l-p,M=Math.sqrt(y*y+v*v),y/=M,v/=M,y*=B,v*=B,I.push(l-y,d-v,U,G,X,j),I.push(l+y,d+v,U,G,X,j),n=1;R-1>n;n++)l=r[2*(n-1)],d=r[2*(n-1)+1],p=r[2*n],f=r[2*n+1],m=r[2*(n+1)],g=r[2*(n+1)+1],y=-(d-f),v=l-p,M=Math.sqrt(y*y+v*v),y/=M,v/=M,y*=B,v*=B,_=-(f-g),b=p-m,M=Math.sqrt(_*_+b*b),_/=M,b/=M,_*=B,b*=B,T=-v+d-(-v+f),S=-y+p-(-y+l),C=(-y+l)*(-v+f)-(-y+p)*(-v+d),P=-b+g-(-b+f),k=-_+p-(-_+m),E=(-_+m)*(-b+f)-(-_+p)*(-b+g),A=T*k-P*S,Math.abs(A)<.1?(A+=10.1,I.push(p-y,f-v,U,G,X,j),I.push(p+y,f+v,U,G,X,j)):(u=(S*E-k*C)/A,c=(P*C-T*E)/A,O=(u-p)*(u-p)+(c-f)+(c-f),O>19600?(x=y-_,w=v-b,M=Math.sqrt(x*x+w*w),x/=M,w/=M,x*=B,w*=B,I.push(p-x,f-w),I.push(U,G,X,j),I.push(p+x,f+w),I.push(U,G,X,j),I.push(p-x,f-w),I.push(U,G,X,j),L++):(I.push(u,c),I.push(U,G,X,j),I.push(p-(u-p),f-(c-f)),I.push(U,G,X,j)));for(l=r[2*(R-2)],d=r[2*(R-2)+1],p=r[2*(R-1)],f=r[2*(R-1)+1],y=-(d-f),v=l-p,M=Math.sqrt(y*y+v*v),y/=M,v/=M,y*=B,v*=B,I.push(p-y,f-v),I.push(U,G,X,j),I.push(p+y,f+v),I.push(U,G,X,j),D.push(N),n=0;L>n;n++)D.push(N++);D.push(N-1)}},i.WebGLGraphics.buildPoly=function(t,e){var n=t.points;if(!(n.length<6)){var r=e.points,s=e.indices,o=n.length/2,a=i.hex2rgb(t.fillColor),h=t.fillAlpha,u=a[0]*h,c=a[1]*h,l=a[2]*h,d=i.PolyK.Triangulate(n),p=r.length/6,f=0;for(f=0;f<d.length;f+=3)s.push(d[f]+p),s.push(d[f]+p),s.push(d[f+1]+p),s.push(d[f+2]+p),s.push(d[f+2]+p);for(f=0;o>f;f++)r.push(n[2*f],n[2*f+1],u,c,l,h)}},i.glContexts=[],i.WebGLRenderer=function(t,e,n,r,s){i.defaultRenderer||(i.defaultRenderer=this),this.type=i.WEBGL_RENDERER,this.transparent=!!r,this.width=t||800,this.height=e||600,this.view=n||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.contextLost=this.handleContextLost.bind(this),this.contextRestoredLost=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLost,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,!1),this.options={alpha:this.transparent,antialias:!!s,premultipliedAlpha:!!r,stencil:!0};try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(o){try{this.gl=this.view.getContext("webgl",this.options)}catch(a){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var h=this.gl;this.glContextId=h.id=i.WebGLRenderer.glContextId++,i.glContexts[this.glContextId]=h,i.blendModesWebGL||(i.blendModesWebGL=[],i.blendModesWebGL[i.blendModes.NORMAL]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.ADD]=[h.SRC_ALPHA,h.DST_ALPHA],i.blendModesWebGL[i.blendModes.MULTIPLY]=[h.DST_COLOR,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.SCREEN]=[h.SRC_ALPHA,h.ONE],i.blendModesWebGL[i.blendModes.OVERLAY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.DARKEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.LIGHTEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.COLOR_DODGE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.COLOR_BURN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.HARD_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.SOFT_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.DIFFERENCE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.EXCLUSION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.HUE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.SATURATION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.COLOR]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.LUMINOSITY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA]),this.projection=new i.Point,this.projection.x=this.width/2,this.projection.y=-this.height/2,this.offset=new i.Point(0,0),this.resize(this.width,this.height),this.contextLost=!1,this.shaderManager=new i.WebGLShaderManager(h),this.spriteBatch=new i.WebGLSpriteBatch(h),this.maskManager=new i.WebGLMaskManager(h),this.filterManager=new i.WebGLFilterManager(h,this.transparent),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.renderer=this,h.useProgram(this.shaderManager.defaultShader.program),h.disable(h.DEPTH_TEST),h.disable(h.CULL_FACE),h.enable(h.BLEND),h.colorMask(!0,!0,!0,this.transparent)},i.WebGLRenderer.prototype.constructor=i.WebGLRenderer,i.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(t.interactive&&t.interactionManager.removeEvents(),this.__stage=t),i.WebGLRenderer.updateTextures(),t.updateTransform(),t._interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)));var e=this.gl;e.viewport(0,0,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),this.transparent?e.clearColor(0,0,0,0):e.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],1),e.clear(e.COLOR_BUFFER_BIT),this.renderDisplayObject(t,this.projection),t.interactive?t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)):t._interactiveEventsAdded&&(t._interactiveEventsAdded=!1,t.interactionManager.setTarget(this))}},i.WebGLRenderer.prototype.renderDisplayObject=function(t,e,i){this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=e,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,i),t._renderWebGL(this.renderSession),this.spriteBatch.end()},i.WebGLRenderer.updateTextures=function(){var t=0;for(t=0;t<i.Texture.frameUpdates.length;t++)i.WebGLRenderer.updateTextureFrame(i.Texture.frameUpdates[t]);for(t=0;t<i.texturesToDestroy.length;t++)i.WebGLRenderer.destroyTexture(i.texturesToDestroy[t]);i.texturesToUpdate.length=0,i.texturesToDestroy.length=0,i.Texture.frameUpdates.length=0},i.WebGLRenderer.destroyTexture=function(t){for(var e=t._glTextures.length-1;e>=0;e--){var n=t._glTextures[e],r=i.glContexts[e];r&&n&&r.deleteTexture(n)}t._glTextures.length=0},i.WebGLRenderer.updateTextureFrame=function(t){t.updateFrame=!1,t._updateWebGLuvs()},i.WebGLRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2,this.projection.y=-this.height/2},i.createWebGLTexture=function(t,e){return t.hasLoaded&&(t._glTextures[e.id]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===i.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===i.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindTexture(e.TEXTURE_2D,null)),t._glTextures[e.id]},i.updateWebGLTexture=function(t,e){t._glTextures[e.id]&&(e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===i.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===i.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindTexture(e.TEXTURE_2D,null))},i.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},i.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(t){try{this.gl=this.view.getContext("webgl",this.options)}catch(e){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var n=this.gl;n.id=i.WebGLRenderer.glContextId++,this.shaderManager.setContext(n),this.spriteBatch.setContext(n),this.maskManager.setContext(n),this.filterManager.setContext(n),this.renderSession.gl=this.gl,n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE),n.enable(n.BLEND),n.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height);for(var r in i.TextureCache){var s=i.TextureCache[r].baseTexture;s._glTextures=[]}this.contextLost=!1},i.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLost),this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost),i.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null},i.WebGLRenderer.glContextId=0,i.WebGLMaskManager=function(t){this.maskStack=[],this.maskPosition=0,this.setContext(t)},i.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},i.WebGLMaskManager.prototype.pushMask=function(t,e){var n=this.gl;0===this.maskStack.length&&(n.enable(n.STENCIL_TEST),n.stencilFunc(n.ALWAYS,1,1)),this.maskStack.push(t),n.colorMask(!1,!1,!1,!1),n.stencilOp(n.KEEP,n.KEEP,n.INCR),i.WebGLGraphics.renderGraphics(t,e),n.colorMask(!0,!0,!0,!0),n.stencilFunc(n.NOTEQUAL,0,this.maskStack.length),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)},i.WebGLMaskManager.prototype.popMask=function(t){var e=this.gl,n=this.maskStack.pop();n&&(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),i.WebGLGraphics.renderGraphics(n,t),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.NOTEQUAL,0,this.maskStack.length),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)),0===this.maskStack.length&&e.disable(e.STENCIL_TEST)},i.WebGLMaskManager.prototype.destroy=function(){this.maskStack=null,this.gl=null},i.WebGLShaderManager=function(t){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)},i.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new i.PrimitiveShader(t),this.defaultShader=new i.PixiShader(t),this.fastShader=new i.PixiFastShader(t),this.activateShader(this.defaultShader)},i.WebGLShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var i=t[e];this.tempAttribState[i]=!0}var n=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},i.WebGLShaderManager.prototype.activateShader=function(t){this.currentShader=t,this.gl.useProgram(t.program),this.setAttribs(t.attributes)},i.WebGLShaderManager.prototype.activatePrimitiveShader=function(){var t=this.gl;t.useProgram(this.primitiveShader.program),this.setAttribs(this.primitiveShader.attributes)},i.WebGLShaderManager.prototype.deactivatePrimitiveShader=function(){var t=this.gl;t.useProgram(this.defaultShader.program),this.setAttribs(this.defaultShader.attributes)},i.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.gl=null},i.WebGLSpriteBatch=function(t){this.vertSize=6,this.size=2e3;var e=4*this.size*this.vertSize,i=6*this.size;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i),this.lastIndexCount=0;for(var n=0,r=0;i>n;n+=6,r+=4)this.indices[n+0]=r+0,this.indices[n+1]=r+1,this.indices[n+2]=r+2,this.indices[n+3]=r+0,this.indices[n+4]=r+2,this.indices[n+5]=r+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(t)},i.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},i.WebGLSpriteBatch.prototype.begin=function(t){this.renderSession=t,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},i.WebGLSpriteBatch.prototype.end=function(){this.flush()},i.WebGLSpriteBatch.prototype.render=function(t){var e=t.texture;(e.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=e.baseTexture),t.blendMode!==this.currentBlendMode&&this.setBlendMode(t.blendMode);var i=t._uvs||t.texture._uvs;if(i){var n,r,s,o,a=t.worldAlpha,h=t.tint,u=this.vertices,c=t.anchor.x,l=t.anchor.y;if(t.texture.trim){var d=t.texture.trim;r=d.x-c*d.width,n=r+e.frame.width,o=d.y-l*d.height,s=o+e.frame.height}else n=e.frame.width*(1-c),r=e.frame.width*-c,s=e.frame.height*(1-l),o=e.frame.height*-l;var p=4*this.currentBatchSize*this.vertSize,f=t.worldTransform,m=f.a,g=f.c,y=f.b,v=f.d,_=f.tx,b=f.ty;u[p++]=m*r+y*o+_,u[p++]=v*o+g*r+b,u[p++]=i.x0,u[p++]=i.y0,u[p++]=a,u[p++]=h,u[p++]=m*n+y*o+_,u[p++]=v*o+g*n+b,u[p++]=i.x1,u[p++]=i.y1,u[p++]=a,u[p++]=h,u[p++]=m*n+y*s+_,u[p++]=v*s+g*n+b,u[p++]=i.x2,u[p++]=i.y2,u[p++]=a,u[p++]=h,u[p++]=m*r+y*s+_,u[p++]=v*s+g*r+b,u[p++]=i.x3,u[p++]=i.y3,u[p++]=a,u[p++]=h,this.currentBatchSize++}},i.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var e=t.tilingTexture;(e.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=e.baseTexture),t.blendMode!==this.currentBlendMode&&this.setBlendMode(t.blendMode),t._uvs||(t._uvs=new i.TextureUvs);var n=t._uvs;t.tilePosition.x%=e.baseTexture.width*t.tileScaleOffset.x,t.tilePosition.y%=e.baseTexture.height*t.tileScaleOffset.y;var r=t.tilePosition.x/(e.baseTexture.width*t.tileScaleOffset.x),s=t.tilePosition.y/(e.baseTexture.height*t.tileScaleOffset.y),o=t.width/e.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),a=t.height/e.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);n.x0=0-r,n.y0=0-s,n.x1=1*o-r,n.y1=0-s,n.x2=1*o-r,n.y2=1*a-s,n.x3=0-r,n.y3=1*a-s;var h=t.worldAlpha,u=t.tint,c=this.vertices,l=t.width,d=t.height,p=t.anchor.x,f=t.anchor.y,m=l*(1-p),g=l*-p,y=d*(1-f),v=d*-f,_=4*this.currentBatchSize*this.vertSize,b=t.worldTransform,x=b.a,w=b.c,T=b.b,S=b.d,C=b.tx,P=b.ty;c[_++]=x*g+T*v+C,c[_++]=S*v+w*g+P,c[_++]=n.x0,c[_++]=n.y0,c[_++]=h,c[_++]=u,c[_++]=x*m+T*v+C,c[_++]=S*v+w*m+P,c[_++]=n.x1,c[_++]=n.y1,c[_++]=h,c[_++]=u,c[_++]=x*m+T*y+C,c[_++]=S*y+w*m+P,c[_++]=n.x2,c[_++]=n.y2,c[_++]=h,c[_++]=u,c[_++]=x*g+T*y+C,c[_++]=S*y+w*g+P,c[_++]=n.x3,c[_++]=n.y3,c[_++]=h,c[_++]=u,this.currentBatchSize++},i.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]||i.createWebGLTexture(this.currentBaseTexture,t)),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var e=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,e)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},i.WebGLSpriteBatch.prototype.stop=function(){this.flush()},i.WebGLSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,e.x,e.y);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.colorAttribute,2,t.FLOAT,!1,n,16),this.currentBlendMode!==i.blendModes.NORMAL&&this.setBlendMode(i.blendModes.NORMAL)},i.WebGLSpriteBatch.prototype.setBlendMode=function(t){this.flush(),this.currentBlendMode=t;var e=i.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(e[0],e[1])},i.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},i.WebGLFastSpriteBatch=function(t){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var e=4*this.size*this.vertSize,i=6*this.maxSize;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var n=0,r=0;i>n;n+=6,r+=4)this.indices[n+0]=r+0,this.indices[n+1]=r+1,this.indices[n+2]=r+2,this.indices[n+3]=r+0,this.indices[n+4]=r+2,this.indices[n+5]=r+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(t)},i.WebGLFastSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},i.WebGLFastSpriteBatch.prototype.begin=function(t,e){this.renderSession=e,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=t.worldTransform.toArray(!0),this.start()},i.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},i.WebGLFastSpriteBatch.prototype.render=function(t){var e=t.children,i=e[0];if(i.texture._uvs){this.currentBaseTexture=i.texture.baseTexture,i.blendMode!==this.currentBlendMode&&this.setBlendMode(i.blendMode);for(var n=0,r=e.length;r>n;n++)this.renderSprite(e[n]);this.flush()}},i.WebGLFastSpriteBatch.prototype.renderSprite=function(t){if(t.visible&&(t.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=t.texture.baseTexture,t.texture._uvs))){var e,i,n,r,s,o,a,h,u=this.vertices;if(e=t.texture._uvs,i=t.texture.frame.width,n=t.texture.frame.height,t.texture.trim){var c=t.texture.trim;s=c.x-t.anchor.x*c.width,r=s+t.texture.frame.width,a=c.y-t.anchor.y*c.height,o=a+t.texture.frame.height}else r=t.texture.frame.width*(1-t.anchor.x),s=t.texture.frame.width*-t.anchor.x,o=t.texture.frame.height*(1-t.anchor.y),a=t.texture.frame.height*-t.anchor.y;h=4*this.currentBatchSize*this.vertSize,u[h++]=s,u[h++]=a,u[h++]=t.position.x,u[h++]=t.position.y,u[h++]=t.scale.x,u[h++]=t.scale.y,u[h++]=t.rotation,u[h++]=e.x0,u[h++]=e.y1,u[h++]=t.alpha,u[h++]=r,u[h++]=a,u[h++]=t.position.x,u[h++]=t.position.y,u[h++]=t.scale.x,u[h++]=t.scale.y,u[h++]=t.rotation,u[h++]=e.x1,u[h++]=e.y1,u[h++]=t.alpha,u[h++]=r,u[h++]=o,u[h++]=t.position.x,u[h++]=t.position.y,u[h++]=t.scale.x,u[h++]=t.scale.y,u[h++]=t.rotation,u[h++]=e.x2,u[h++]=e.y2,u[h++]=t.alpha,u[h++]=s,u[h++]=o,u[h++]=t.position.x,u[h++]=t.position.y,u[h++]=t.scale.x,u[h++]=t.scale.y,u[h++]=t.rotation,u[h++]=e.x3,u[h++]=e.y3,u[h++]=t.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},i.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.currentBaseTexture._glTextures[t.id]||i.createWebGLTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var e=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,e)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},i.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},i.WebGLFastSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,e.x,e.y),t.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aPositionCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.aScale,2,t.FLOAT,!1,n,16),t.vertexAttribPointer(this.shader.aRotation,1,t.FLOAT,!1,n,24),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,28),t.vertexAttribPointer(this.shader.colorAttribute,1,t.FLOAT,!1,n,36),this.currentBlendMode!==i.blendModes.NORMAL&&this.setBlendMode(i.blendModes.NORMAL)},i.WebGLFastSpriteBatch.prototype.setBlendMode=function(t){this.flush(),this.currentBlendMode=t;var e=i.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(e[0],e[1])},i.WebGLFilterManager=function(t,e){this.transparent=e,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(t)},i.WebGLFilterManager.prototype.setContext=function(t){this.gl=t,this.texturePool=[],this.initShaderBuffers()},i.WebGLFilterManager.prototype.begin=function(t,e){this.renderSession=t,this.defaultShader=t.shaderManager.defaultShader;var i=this.renderSession.projection;this.width=2*i.x,this.height=2*-i.y,this.buffer=e},i.WebGLFilterManager.prototype.pushFilter=function(t){var e=this.gl,n=this.renderSession.projection,r=this.renderSession.offset;t._filterArea=t.target.filterArea||t.target.getBounds(),this.filterStack.push(t);var s=t.filterPasses[0];this.offsetX+=t._filterArea.x,this.offsetY+=t._filterArea.y;var o=this.texturePool.pop();o?o.resize(this.width,this.height):o=new i.FilterTexture(this.gl,this.width,this.height),e.bindTexture(e.TEXTURE_2D,o.texture);var a=t._filterArea,h=s.padding;a.x-=h,a.y-=h,a.width+=2*h,a.height+=2*h,a.x<0&&(a.x=0),a.width>this.width&&(a.width=this.width),a.y<0&&(a.y=0),a.height>this.height&&(a.height=this.height),e.bindFramebuffer(e.FRAMEBUFFER,o.frameBuffer),e.viewport(0,0,a.width,a.height),n.x=a.width/2,n.y=-a.height/2,r.x=-a.x,r.y=-a.y,e.uniform2f(this.defaultShader.projectionVector,a.width/2,-a.height/2),e.uniform2f(this.defaultShader.offsetVector,-a.x,-a.y),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),t._glFilterTexture=o},i.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,e=this.filterStack.pop(),n=e._filterArea,r=e._glFilterTexture,s=this.renderSession.projection,o=this.renderSession.offset;if(e.filterPasses.length>1){t.viewport(0,0,n.width,n.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=n.height,this.vertexArray[2]=n.width,this.vertexArray[3]=n.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=n.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=n.width/this.width,this.uvArray[5]=n.height/this.height,this.uvArray[6]=n.width/this.width,this.uvArray[7]=n.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var a=r,h=this.texturePool.pop();h||(h=new i.FilterTexture(this.gl,this.width,this.height)),h.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,h.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var u=0;u<e.filterPasses.length-1;u++){var c=e.filterPasses[u];t.bindFramebuffer(t.FRAMEBUFFER,h.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,a.texture),this.applyFilterPass(c,n,n.width,n.height);var l=a;a=h,h=l}t.enable(t.BLEND),r=a,this.texturePool.push(h)}var d=e.filterPasses[e.filterPasses.length-1];this.offsetX-=n.x,this.offsetY-=n.y;var p=this.width,f=this.height,m=0,g=0,y=this.buffer;if(0===this.filterStack.length)t.colorMask(!0,!0,!0,!0);else{var v=this.filterStack[this.filterStack.length-1];n=v._filterArea,p=n.width,f=n.height,m=n.x,g=n.y,y=v._glFilterTexture.frameBuffer}s.x=p/2,s.y=-f/2,o.x=m,o.y=g,n=e._filterArea;var _=n.x-m,b=n.y-g;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=_,this.vertexArray[1]=b+n.height,this.vertexArray[2]=_+n.width,this.vertexArray[3]=b+n.height,this.vertexArray[4]=_,this.vertexArray[5]=b,this.vertexArray[6]=_+n.width,this.vertexArray[7]=b,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=n.width/this.width,this.uvArray[5]=n.height/this.height,this.uvArray[6]=n.width/this.width,this.uvArray[7]=n.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,p,f),t.bindFramebuffer(t.FRAMEBUFFER,y),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r.texture),this.applyFilterPass(d,n,p,f),t.useProgram(this.defaultShader.program),t.uniform2f(this.defaultShader.projectionVector,p/2,-f/2),t.uniform2f(this.defaultShader.offsetVector,-m,-g),this.texturePool.push(r),e._glFilterTexture=null},i.WebGLFilterManager.prototype.applyFilterPass=function(t,e,n,r){var s=this.gl,o=t.shaders[s.id];o||(o=new i.PixiShader(s),o.fragmentSrc=t.fragmentSrc,o.uniforms=t.uniforms,o.init(),t.shaders[s.id]=o),s.useProgram(o.program),s.uniform2f(o.projectionVector,n/2,-r/2),s.uniform2f(o.offsetVector,0,0),t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]),o.syncUniforms(),s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffer),s.vertexAttribPointer(o.aVertexPosition,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this.uvBuffer),s.vertexAttribPointer(o.aTextureCoord,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this.colorBuffer),s.vertexAttribPointer(o.colorAttribute,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.indexBuffer),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),this.renderSession.drawCount++},i.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)},i.WebGLFilterManager.prototype.destroy=function(){var t=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var e=0;e<this.texturePool.length;e++)this.texturePool.destroy();this.texturePool=null,t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.uvBuffer),t.deleteBuffer(this.colorBuffer),t.deleteBuffer(this.indexBuffer)},i.FilterTexture=function(t,e,n,r){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),r=r||i.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r===i.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,r===i.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(e,n)},i.FilterTexture.prototype.clear=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},i.FilterTexture.prototype.resize=function(t,e){if(this.width!==t||this.height!==e){this.width=t,this.height=e;var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindRenderbuffer(i.RENDERBUFFER,this.renderBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e)}},i.FilterTexture.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},i.CanvasMaskManager=function(){},i.CanvasMaskManager.prototype.pushMask=function(t,e){e.save();
var n=t.alpha,r=t.worldTransform;e.setTransform(r.a,r.c,r.b,r.d,r.tx,r.ty),i.CanvasGraphics.renderGraphicsMask(t,e),e.clip(),t.worldAlpha=n},i.CanvasMaskManager.prototype.popMask=function(t){t.restore()},i.CanvasTinter=function(){},i.CanvasTinter.getTintedTexture=function(t,e){var n=t.texture;e=i.CanvasTinter.roundColor(e);var r="#"+("00000"+(0|e).toString(16)).substr(-6);if(n.tintCache=n.tintCache||{},n.tintCache[r])return n.tintCache[r];var s=i.CanvasTinter.canvas||document.createElement("canvas");if(i.CanvasTinter.tintMethod(n,e,s),i.CanvasTinter.convertTintToImage){var o=new Image;o.src=s.toDataURL(),n.tintCache[r]=o}else n.tintCache[r]=s,i.CanvasTinter.canvas=null;return s},i.CanvasTinter.tintWithMultiply=function(t,e,i){var n=i.getContext("2d"),r=t.frame;i.width=r.width,i.height=r.height,n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},i.CanvasTinter.tintWithOverlay=function(t,e,i){var n=i.getContext("2d"),r=t.frame;i.width=r.width,i.height=r.height,n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},i.CanvasTinter.tintWithPerPixel=function(t,e,n){var r=n.getContext("2d"),s=t.frame;n.width=s.width,n.height=s.height,r.globalCompositeOperation="copy",r.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height);for(var o=i.hex2rgb(e),a=o[0],h=o[1],u=o[2],c=r.getImageData(0,0,s.width,s.height),l=c.data,d=0;d<l.length;d+=4)l[d+0]*=a,l[d+1]*=h,l[d+2]*=u;r.putImageData(c,0,0)},i.CanvasTinter.roundColor=function(t){var e=i.CanvasTinter.cacheStepsPerColorChannel,n=i.hex2rgb(t);return n[0]=Math.min(255,n[0]/e*e),n[1]=Math.min(255,n[1]/e*e),n[2]=Math.min(255,n[2]/e*e),i.rgb2hex(n)},i.CanvasTinter.cacheStepsPerColorChannel=8,i.CanvasTinter.convertTintToImage=!1,i.CanvasTinter.canUseMultiply=i.canUseNewCanvasBlendModes(),i.CanvasTinter.tintMethod=i.CanvasTinter.canUseMultiply?i.CanvasTinter.tintWithMultiply:i.CanvasTinter.tintWithPerPixel,i.CanvasRenderer=function(t,e,n,r){i.defaultRenderer=i.defaultRenderer||this,this.type=i.CANVAS_RENDERER,this.clearBeforeRender=!0,this.roundPixels=!1,this.transparent=!!r,i.blendModesCanvas||(i.blendModesCanvas=[],i.canUseNewCanvasBlendModes()?(i.blendModesCanvas[i.blendModes.NORMAL]="source-over",i.blendModesCanvas[i.blendModes.ADD]="lighter",i.blendModesCanvas[i.blendModes.MULTIPLY]="multiply",i.blendModesCanvas[i.blendModes.SCREEN]="screen",i.blendModesCanvas[i.blendModes.OVERLAY]="overlay",i.blendModesCanvas[i.blendModes.DARKEN]="darken",i.blendModesCanvas[i.blendModes.LIGHTEN]="lighten",i.blendModesCanvas[i.blendModes.COLOR_DODGE]="color-dodge",i.blendModesCanvas[i.blendModes.COLOR_BURN]="color-burn",i.blendModesCanvas[i.blendModes.HARD_LIGHT]="hard-light",i.blendModesCanvas[i.blendModes.SOFT_LIGHT]="soft-light",i.blendModesCanvas[i.blendModes.DIFFERENCE]="difference",i.blendModesCanvas[i.blendModes.EXCLUSION]="exclusion",i.blendModesCanvas[i.blendModes.HUE]="hue",i.blendModesCanvas[i.blendModes.SATURATION]="saturation",i.blendModesCanvas[i.blendModes.COLOR]="color",i.blendModesCanvas[i.blendModes.LUMINOSITY]="luminosity"):(i.blendModesCanvas[i.blendModes.NORMAL]="source-over",i.blendModesCanvas[i.blendModes.ADD]="lighter",i.blendModesCanvas[i.blendModes.MULTIPLY]="source-over",i.blendModesCanvas[i.blendModes.SCREEN]="source-over",i.blendModesCanvas[i.blendModes.OVERLAY]="source-over",i.blendModesCanvas[i.blendModes.DARKEN]="source-over",i.blendModesCanvas[i.blendModes.LIGHTEN]="source-over",i.blendModesCanvas[i.blendModes.COLOR_DODGE]="source-over",i.blendModesCanvas[i.blendModes.COLOR_BURN]="source-over",i.blendModesCanvas[i.blendModes.HARD_LIGHT]="source-over",i.blendModesCanvas[i.blendModes.SOFT_LIGHT]="source-over",i.blendModesCanvas[i.blendModes.DIFFERENCE]="source-over",i.blendModesCanvas[i.blendModes.EXCLUSION]="source-over",i.blendModesCanvas[i.blendModes.HUE]="source-over",i.blendModesCanvas[i.blendModes.SATURATION]="source-over",i.blendModesCanvas[i.blendModes.COLOR]="source-over",i.blendModesCanvas[i.blendModes.LUMINOSITY]="source-over")),this.width=t||800,this.height=e||600,this.view=n||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width,this.view.height=this.height,this.count=0,this.maskManager=new i.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null},"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="oImageSmoothingEnabled")},i.CanvasRenderer.prototype.constructor=i.CanvasRenderer,i.CanvasRenderer.prototype.render=function(t){i.texturesToUpdate.length=0,i.texturesToDestroy.length=0,t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,!this.transparent&&this.clearBeforeRender?(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)):this.transparent&&this.clearBeforeRender&&this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),i.Texture.frameUpdates.length>0&&(i.Texture.frameUpdates.length=0)},i.CanvasRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e},i.CanvasRenderer.prototype.renderDisplayObject=function(t,e){this.renderSession.context=e||this.context,t._renderCanvas(this.renderSession)},i.CanvasRenderer.prototype.renderStripFlat=function(t){var e=this.context,i=t.verticies,n=i.length/2;this.count++,e.beginPath();for(var r=1;n-2>r;r++){var s=2*r,o=i[s],a=i[s+2],h=i[s+4],u=i[s+1],c=i[s+3],l=i[s+5];e.moveTo(o,u),e.lineTo(a,c),e.lineTo(h,l)}e.fillStyle="#FF0000",e.fill(),e.closePath()},i.CanvasRenderer.prototype.renderStrip=function(t){var e=this.context,i=t.verticies,n=t.uvs,r=i.length/2;this.count++;for(var s=1;r-2>s;s++){var o=2*s,a=i[o],h=i[o+2],u=i[o+4],c=i[o+1],l=i[o+3],d=i[o+5],p=n[o]*t.texture.width,f=n[o+2]*t.texture.width,m=n[o+4]*t.texture.width,g=n[o+1]*t.texture.height,y=n[o+3]*t.texture.height,v=n[o+5]*t.texture.height;e.save(),e.beginPath(),e.moveTo(a,c),e.lineTo(h,l),e.lineTo(u,d),e.closePath(),e.clip();var _=p*y+g*m+f*v-y*m-g*f-p*v,b=a*y+g*u+h*v-y*u-g*h-a*v,x=p*h+a*m+f*u-h*m-a*f-p*u,w=p*y*u+g*h*m+a*f*v-a*y*m-g*f*u-p*h*v,T=c*y+g*d+l*v-y*d-g*l-c*v,S=p*l+c*m+f*d-l*m-c*f-p*d,C=p*y*d+g*l*m+c*f*v-c*y*m-g*f*d-p*l*v;e.transform(b/_,T/_,x/_,S/_,w/_,C/_),e.drawImage(t.texture.baseTexture.source,0,0),e.restore()}},i.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},i.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},i.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},i.CanvasGraphics=function(){},i.CanvasGraphics.renderGraphics=function(t,e){for(var n=t.worldAlpha,r="",s=0;s<t.graphicsData.length;s++){var o=t.graphicsData[s],a=o.points;if(e.strokeStyle=r="#"+("00000"+(0|o.lineColor).toString(16)).substr(-6),e.lineWidth=o.lineWidth,o.type===i.Graphics.POLY){e.beginPath(),e.moveTo(a[0],a[1]);for(var h=1;h<a.length/2;h++)e.lineTo(a[2*h],a[2*h+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle=r="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.stroke())}else if(o.type===i.Graphics.RECT)(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle=r="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fillRect(a[0],a[1],a[2],a[3])),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.strokeRect(a[0],a[1],a[2],a[3]));else if(o.type===i.Graphics.CIRC)e.beginPath(),e.arc(a[0],a[1],a[2],0,2*Math.PI),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle=r="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.stroke());else if(o.type===i.Graphics.ELIP){var u=o.points,c=2*u[2],l=2*u[3],d=u[0]-c/2,p=u[1]-l/2;e.beginPath();var f=.5522848,m=c/2*f,g=l/2*f,y=d+c,v=p+l,_=d+c/2,b=p+l/2;e.moveTo(d,b),e.bezierCurveTo(d,b-g,_-m,p,_,p),e.bezierCurveTo(_+m,p,y,b-g,y,b),e.bezierCurveTo(y,b+g,_+m,v,_,v),e.bezierCurveTo(_-m,v,d,b+g,d,b),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle=r="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.stroke())}}},i.CanvasGraphics.renderGraphicsMask=function(t,e){var n=t.graphicsData.length;if(0!==n){n>1&&(n=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var r=0;1>r;r++){var s=t.graphicsData[r],o=s.points;if(s.type===i.Graphics.POLY){e.beginPath(),e.moveTo(o[0],o[1]);for(var a=1;a<o.length/2;a++)e.lineTo(o[2*a],o[2*a+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&e.closePath()}else if(s.type===i.Graphics.RECT)e.beginPath(),e.rect(o[0],o[1],o[2],o[3]),e.closePath();else if(s.type===i.Graphics.CIRC)e.beginPath(),e.arc(o[0],o[1],o[2],0,2*Math.PI),e.closePath();else if(s.type===i.Graphics.ELIP){var h=s.points,u=2*h[2],c=2*h[3],l=h[0]-u/2,d=h[1]-c/2;e.beginPath();var p=.5522848,f=u/2*p,m=c/2*p,g=l+u,y=d+c,v=l+u/2,_=d+c/2;e.moveTo(l,_),e.bezierCurveTo(l,_-m,v-f,d,v,d),e.bezierCurveTo(v+f,d,g,_-m,g,_),e.bezierCurveTo(g,_+m,v+f,y,v,y),e.bezierCurveTo(v-f,y,l,_+m,l,_),e.closePath()}}}},i.Graphics=function(){i.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=i.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10},i.Graphics.prototype=Object.create(i.DisplayObjectContainer.prototype),i.Graphics.prototype.constructor=i.Graphics,Object.defineProperty(i.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),i.Graphics.prototype.lineStyle=function(t,e,n){return this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=arguments.length<3?1:n,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:i.Graphics.POLY},this.graphicsData.push(this.currentPath),this},i.Graphics.prototype.moveTo=function(t,e){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:i.Graphics.POLY},this.currentPath.points.push(t,e),this.graphicsData.push(this.currentPath),this},i.Graphics.prototype.lineTo=function(t,e){return this.currentPath.points.push(t,e),this.dirty=!0,this},i.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=arguments.length<2?1:e,this},i.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},i.Graphics.prototype.drawRect=function(t,e,n,r){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,n,r],type:i.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0,this},i.Graphics.prototype.drawCircle=function(t,e,n){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,n,n],type:i.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},i.Graphics.prototype.drawEllipse=function(t,e,n,r){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,n,r],type:i.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0,this},i.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null,this},i.Graphics.prototype.generateTexture=function(){var t=this.getBounds(),e=new i.CanvasBuffer(t.width,t.height),n=i.Texture.fromCanvas(e.canvas);return e.context.translate(-t.x,-t.y),i.CanvasGraphics.renderGraphics(this,e.context),n},i.Graphics.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),i.updateWebGLTexture(this._cachedSprite.texture.baseTexture,t.gl),this.dirty=!1),this._cachedSprite.alpha=this.alpha,i.Sprite.prototype._renderWebGL.call(this._cachedSprite,t),void 0;if(t.spriteBatch.stop(),this._mask&&t.maskManager.pushMask(this.mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){t.spriteBatch.currentBlendMode=this.blendMode;var e=i.blendModesWebGL[t.spriteBatch.currentBlendMode];t.spriteBatch.gl.blendFunc(e[0],e[1])}if(i.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var n=0,r=this.children.length;r>n;n++)this.children[n]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),t.drawCount++,t.spriteBatch.start()}},i.Graphics.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){var e=t.context,n=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=i.blendModesCanvas[t.currentBlendMode]),e.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),i.CanvasGraphics.renderGraphics(this,e);for(var r=0,s=this.children.length;s>r;r++)this.children[r]._renderCanvas(t)}},i.Graphics.prototype.getBounds=function(t){this.bounds||this.updateBounds();var e=this.bounds.x,i=this.bounds.width+this.bounds.x,n=this.bounds.y,r=this.bounds.height+this.bounds.y,s=t||this.worldTransform,o=s.a,a=s.c,h=s.b,u=s.d,c=s.tx,l=s.ty,d=o*i+h*r+c,p=u*r+a*i+l,f=o*e+h*r+c,m=u*r+a*e+l,g=o*e+h*n+c,y=u*n+a*e+l,v=o*i+h*n+c,_=u*n+a*i+l,b=d,x=p,w=d,T=p;w=w>f?f:w,w=w>g?g:w,w=w>v?v:w,T=T>m?m:T,T=T>y?y:T,T=T>_?_:T,b=f>b?f:b,b=g>b?g:b,b=v>b?v:b,x=m>x?m:x,x=y>x?y:x,x=_>x?_:x;var S=this._bounds;return S.x=w,S.width=b-w,S.y=T,S.height=x-T,S},i.Graphics.prototype.updateBounds=function(){for(var t,e,n,r,s,o=1/0,a=-1/0,h=1/0,u=-1/0,c=0;c<this.graphicsData.length;c++){var l=this.graphicsData[c],d=l.type,p=l.lineWidth;if(t=l.points,d===i.Graphics.RECT)e=t[0]-p/2,n=t[1]-p/2,r=t[2]+p,s=t[3]+p,o=o>e?e:o,a=e+r>a?e+r:a,h=h>n?e:h,u=n+s>u?n+s:u;else if(d===i.Graphics.CIRC||d===i.Graphics.ELIP)e=t[0],n=t[1],r=t[2]+p/2,s=t[3]+p/2,o=o>e-r?e-r:o,a=e+r>a?e+r:a,h=h>n-s?n-s:h,u=n+s>u?n+s:u;else for(var f=0;f<t.length;f+=2)e=t[f],n=t[f+1],o=o>e-p?e-p:o,a=e+p>a?e+p:a,h=h>n-p?n-p:h,u=n+p>u?n+p:u}var m=this.boundsPadding;this.bounds=new i.Rectangle(o-m,h-m,a-o+2*m,u-h+2*m)},i.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var e=new i.CanvasBuffer(t.width,t.height),n=i.Texture.fromCanvas(e.canvas);this._cachedSprite=new i.Sprite(n),this._cachedSprite.buffer=e,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._cachedSprite.buffer.context.translate(-t.x,-t.y),i.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},i.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},i.Graphics.POLY=0,i.Graphics.RECT=1,i.Graphics.CIRC=2,i.Graphics.ELIP=3,i.TilingSprite=function(t,e,n){i.Sprite.call(this,t),this.width=e||100,this.height=n||100,this.tileScale=new i.Point(1,1),this.tileScaleOffset=new i.Point(1,1),this.tilePosition=new i.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=i.blendModes.NORMAL},i.TilingSprite.prototype=Object.create(i.Sprite.prototype),i.TilingSprite.prototype.constructor=i.TilingSprite,Object.defineProperty(i.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t}}),Object.defineProperty(i.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t}}),i.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},i.TilingSprite.prototype.setTexture=function(t){this.texture!==t&&(this.texture=t,this.refreshTexture=!0,this.cachedTint=16777215)},i.TilingSprite.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha){var e,n;for(this.mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this.filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(i.updateWebGLTexture(this.tilingTexture.baseTexture,t.gl),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this.filters&&t.filterManager.popFilter(),this.mask&&t.maskManager.popMask(t),t.spriteBatch.start()}},i.TilingSprite.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){var e=t.context;this._mask&&t.maskManager.pushMask(this._mask,e),e.globalAlpha=this.worldAlpha;var n=this.worldTransform;if(e.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=e.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=i.blendModesCanvas[t.currentBlendMode]),e.beginPath();var r=this.tilePosition,s=this.tileScale;r.x%=this.tilingTexture.baseTexture.width,r.y%=this.tilingTexture.baseTexture.height,e.scale(s.x,s.y),e.translate(r.x,r.y),e.fillStyle=this.__tilePattern,e.fillRect(-r.x+this.anchor.x*-this._width,-r.y+this.anchor.y*-this._height,this._width/s.x,this._height/s.y),e.scale(1/s.x,1/s.y),e.translate(-r.x,-r.y),e.closePath(),this._mask&&t.maskManager.popMask(t.context)}},i.TilingSprite.prototype.getBounds=function(){var t=this._width,e=this._height,i=t*(1-this.anchor.x),n=t*-this.anchor.x,r=e*(1-this.anchor.y),s=e*-this.anchor.y,o=this.worldTransform,a=o.a,h=o.c,u=o.b,c=o.d,l=o.tx,d=o.ty,p=a*n+u*s+l,f=c*s+h*n+d,m=a*i+u*s+l,g=c*s+h*i+d,y=a*i+u*r+l,v=c*r+h*i+d,_=a*n+u*r+l,b=c*r+h*n+d,x=-1/0,w=-1/0,T=1/0,S=1/0;T=T>p?p:T,T=T>m?m:T,T=T>y?y:T,T=T>_?_:T,S=S>f?f:S,S=S>g?g:S,S=S>v?v:S,S=S>b?b:S,x=p>x?p:x,x=m>x?m:x,x=y>x?y:x,x=_>x?_:x,w=f>w?f:w,w=g>w?g:w,w=v>w?v:w,w=b>w?b:w;var C=this._bounds;return C.x=T,C.width=x-T,C.y=S,C.height=w-S,this._currentBounds=C,C},i.TilingSprite.prototype.generateTilingTexture=function(t){var e=this.texture;if(e.baseTexture.hasLoaded){var n,r,s=e.baseTexture,o=e.frame,a=o.width!==s.width||o.height!==s.height,h=!1;if(t?(n=i.getNextPowerOfTwo(o.width),r=i.getNextPowerOfTwo(o.height),o.width!==n&&o.height!==r&&(h=!0)):a&&(n=o.width,r=o.height,h=!0),h){var u;this.tilingTexture&&this.tilingTexture.isTiling?(u=this.tilingTexture.canvasBuffer,u.resize(n,r),this.tilingTexture.baseTexture.width=n,this.tilingTexture.baseTexture.height=r,this.tilingTexture.needsUpdate=!0):(u=new i.CanvasBuffer(n,r),this.tilingTexture=i.Texture.fromCanvas(u.canvas),this.tilingTexture.canvasBuffer=u,this.tilingTexture.isTiling=!0),u.context.drawImage(e.baseTexture.source,o.x,o.y,o.width,o.height,0,0,n,r),this.tileScaleOffset.x=o.width/n,this.tileScaleOffset.y=o.height/r}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=e;this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}},i.BaseTextureCache={},i.texturesToUpdate=[],i.texturesToDestroy=[],i.BaseTextureCacheIdGenerator=0,i.BaseTexture=function(t,e){if(i.EventTarget.call(this),this.width=100,this.height=100,this.scaleMode=e||i.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this.id=i.BaseTextureCacheIdGenerator++,this._glTextures=[],t){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,i.texturesToUpdate.push(this);else{var n=this;this.source.onload=function(){n.hasLoaded=!0,n.width=n.source.width,n.height=n.source.height,i.texturesToUpdate.push(n),n.dispatchEvent({type:"loaded",content:n})}}this.imageUrl=null,this._powerOf2=!1}},i.BaseTexture.prototype.constructor=i.BaseTexture,i.BaseTexture.prototype.destroy=function(){this.imageUrl&&(delete i.BaseTextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null),this.source=null,i.texturesToDestroy.push(this)},i.BaseTexture.prototype.updateSourceImage=function(t){this.hasLoaded=!1,this.source.src=null,this.source.src=t},i.BaseTexture.fromImage=function(t,e,n){var r=i.BaseTextureCache[t];if(void 0===e&&-1===t.indexOf("data:")&&(e=!0),!r){var s=new Image;e&&(s.crossOrigin=""),s.src=t,r=new i.BaseTexture(s,n),r.imageUrl=t,i.BaseTextureCache[t]=r}return r},i.BaseTexture.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+i.TextureCacheIdGenerator++);var n=i.BaseTextureCache[t._pixiId];return n||(n=new i.BaseTexture(t,e),i.BaseTextureCache[t._pixiId]=n),n},i.TextureCache={},i.FrameCache={},i.TextureCacheIdGenerator=0,i.Texture=function(t,e){if(i.EventTarget.call(this),e||(this.noFrame=!0,e=new i.Rectangle(0,0,1,1)),t instanceof i.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.trim=null,this.scope=this,this._uvs=null,t.hasLoaded)this.noFrame&&(e=new i.Rectangle(0,0,t.width,t.height)),this.setFrame(e);else{var n=this;t.addEventListener("loaded",function(){n.onBaseTextureLoaded()})}},i.Texture.prototype.constructor=i.Texture,i.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new i.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.scope.dispatchEvent({type:"update",content:this})},i.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy()},i.Texture.prototype.setFrame=function(t){if(this.frame=t,this.width=t.width,this.height=t.height,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,i.Texture.frameUpdates.push(this)},i.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new i.TextureUvs);var t=this.frame,e=this.baseTexture.width,n=this.baseTexture.height;this._uvs.x0=t.x/e,this._uvs.y0=t.y/n,this._uvs.x1=(t.x+t.width)/e,this._uvs.y1=t.y/n,this._uvs.x2=(t.x+t.width)/e,this._uvs.y2=(t.y+t.height)/n,this._uvs.x3=t.x/e,this._uvs.y3=(t.y+t.height)/n},i.Texture.fromImage=function(t,e,n){var r=i.TextureCache[t];return r||(r=new i.Texture(i.BaseTexture.fromImage(t,e,n)),i.TextureCache[t]=r),r},i.Texture.fromFrame=function(t){var e=i.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return e},i.Texture.fromCanvas=function(t,e){var n=i.BaseTexture.fromCanvas(t,e);return new i.Texture(n)},i.Texture.addTextureToCache=function(t,e){i.TextureCache[e]=t},i.Texture.removeTextureFromCache=function(t){var e=i.TextureCache[t];return delete i.TextureCache[t],delete i.BaseTextureCache[t],e},i.Texture.frameUpdates=[],i.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y4=0},i.RenderTexture=function(t,e,n,r){if(i.EventTarget.call(this),this.width=t||100,this.height=e||100,this.frame=new i.Rectangle(0,0,this.width,this.height),this.baseTexture=new i.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTextures=[],this.baseTexture.scaleMode=r||i.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,this.renderer=n||i.defaultRenderer,this.renderer.type===i.WEBGL_RENDERER){var s=this.renderer.gl;this.textureBuffer=new i.FilterTexture(s,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[s.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new i.Point(this.width/2,-this.height/2)}else this.render=this.renderCanvas,this.textureBuffer=new i.CanvasBuffer(this.width,this.height),this.baseTexture.source=this.textureBuffer.canvas;i.Texture.frameUpdates.push(this)},i.RenderTexture.prototype=Object.create(i.Texture.prototype),i.RenderTexture.prototype.constructor=i.RenderTexture,i.RenderTexture.prototype.resize=function(t,e,n){(t!==this.width||e!==this.height)&&(this.width=t,this.height=e,this.frame.width=this.width,this.frame.height=this.height,n&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===i.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.textureBuffer.resize(this.width,this.height))},i.RenderTexture.prototype.clear=function(){this.renderer.type===i.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear()},i.RenderTexture.prototype.renderWebGL=function(t,e,n){var r=this.renderer.gl;r.colorMask(!0,!0,!0,!0),r.viewport(0,0,this.width,this.height),r.bindFramebuffer(r.FRAMEBUFFER,this.textureBuffer.frameBuffer),n&&this.textureBuffer.clear();var s=t.children,o=t.worldTransform;t.worldTransform=i.RenderTexture.tempMatrix,t.worldTransform.d=-1,t.worldTransform.ty=-2*this.projection.y,e&&(t.worldTransform.tx=e.x,t.worldTransform.ty-=e.y);for(var a=0,h=s.length;h>a;a++)s[a].updateTransform();i.WebGLRenderer.updateTextures(),this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),t.worldTransform=o},i.RenderTexture.prototype.renderCanvas=function(t,e,n){var r=t.children,s=t.worldTransform;t.worldTransform=i.RenderTexture.tempMatrix,e&&(t.worldTransform.tx=e.x,t.worldTransform.ty=e.y);for(var o=0,a=r.length;a>o;o++)r[o].updateTransform();n&&this.textureBuffer.clear();var h=this.textureBuffer.context;this.renderer.renderDisplayObject(t,h),h.setTransform(1,0,0,1,0,0),t.worldTransform=s},i.RenderTexture.tempMatrix=new i.Matrix,"undefined"!=typeof t?("undefined"!=typeof module&&module.exports&&(t=module.exports=i),t.PIXI=i):"undefined"!=typeof define&&define.amd?define("PIXI",function(){return e.PIXI=i}()):e.PIXI=i}).call(this),function(){var e=this,i=i||{VERSION:"2.0.5",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1}};if(PIXI.InteractionManager=PIXI.InteractionManager||function(){},i.Utils={transposeArray:function(t){for(var e=new Array(t[0].length),i=0;i<t[0].length;i++){e[i]=new Array(t.length-1);for(var n=t.length-1;n>-1;n--)e[i][n]=t[n][i]}return e},rotateArray:function(t,e){if("string"!=typeof e&&(e=(e%360+360)%360),90===e||-270===e||"rotateLeft"===e)t=i.Utils.transposeArray(t),t=t.reverse();else if(-90===e||270===e||"rotateRight"===e)t=t.reverse(),t=i.Utils.transposeArray(t);else if(180===Math.abs(e)||"rotate180"===e){for(var n=0;n<t.length;n++)t[n].reverse();t=t.reverse()}return t},parseDimension:function(t,e){var i=0,n=0;return"string"==typeof t?"%"===t.substr(-1)?(i=parseInt(t,10)/100,n=0===e?window.innerWidth*i:window.innerHeight*i):n=parseInt(t,10):n=t,n},shuffle:function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},pad:function(t,e,i,n){if("undefined"==typeof e)var e=0;if("undefined"==typeof i)var i=" ";if("undefined"==typeof n)var n=3;var r=0;if(e+1>=t.length)switch(n){case 1:t=new Array(e+1-t.length).join(i)+t;break;case 3:var s=Math.ceil((r=e-t.length)/2),o=r-s;t=new Array(o+1).join(i)+t+new Array(s+1).join(i);break;default:t+=new Array(e+1-t.length).join(i)}return t},isPlainObject:function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},extend:function(){var t,e,n,r,s,o,a=arguments[0]||{},h=1,u=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},h=2),u===h&&(a=this,--h);u>h;h++)if(null!=(t=arguments[h]))for(e in t)n=a[e],r=t[e],a!==r&&(c&&r&&(i.Utils.isPlainObject(r)||(s=Array.isArray(r)))?(s?(s=!1,o=n&&Array.isArray(n)?n:[]):o=n&&i.Utils.isPlainObject(n)?n:{},a[e]=i.Utils.extend(c,o,r)):void 0!==r&&(a[e]=r));return a}},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function i(){var s=r.concat(t.call(arguments));n.apply(this instanceof i?this:e,s)}var n=this,r=t.call(arguments,1);if("function"!=typeof n)throw new TypeError;return i.prototype=function s(t){return t&&(s.prototype=t),this instanceof s?void 0:new s}(n.prototype),i}}()),Array.isArray||(Array.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)}),Array.prototype.forEach||(Array.prototype.forEach=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)r in e&&t.call(n,e[r],r,e)}),"function"!=typeof window.Uint32Array){var n=function(t){var e=new Array;window[t]=function(t){if("number"==typeof t){Array.call(this,t),this.length=t;for(var e=0;e<this.length;e++)this[e]=0}else{Array.call(this,t.length),this.length=t.length;for(var e=0;e<this.length;e++)this[e]=t[e]}},window[t].prototype=e,window[t].constructor=window[t]};n("Uint32Array"),n("Int16Array")}window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){}),i.Circle=function(t,e,i){t=t||0,e=e||0,i=i||0,this.x=t,this.y=e,this._diameter=i,this._radius=i>0?.5*i:0},i.Circle.prototype={circumference:function(){return 2*Math.PI*this._radius},setTo:function(t,e,i){return this.x=t,this.y=e,this._diameter=i,this._radius=.5*i,this},copyFrom:function(t){return this.setTo(t.x,t.y,t.diameter)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.diameter=this._diameter,t},distance:function(t,e){return"undefined"==typeof e&&(e=!1),e?i.Math.distanceRounded(this.x,this.y,t.x,t.y):i.Math.distance(this.x,this.y,t.x,t.y)
},clone:function(t){return"undefined"==typeof t?t=new i.Circle(this.x,this.y,this.diameter):t.setTo(this.x,this.y,this.diameter),t},contains:function(t,e){return i.Circle.contains(this,t,e)},circumferencePoint:function(t,e,n){return i.Circle.circumferencePoint(this,t,e,n)},offset:function(t,e){return this.x+=t,this.y+=e,this},offsetPoint:function(t){return this.offset(t.x,t.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}},i.Circle.prototype.constructor=i.Circle,Object.defineProperty(i.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(t){t>0&&(this._diameter=t,this._radius=.5*t)}}),Object.defineProperty(i.Circle.prototype,"radius",{get:function(){return this._radius},set:function(t){t>0&&(this._radius=t,this._diameter=2*t)}}),Object.defineProperty(i.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(t){t>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-t}}),Object.defineProperty(i.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(t){t<this.x?(this._radius=0,this._diameter=0):this.radius=t-this.x}}),Object.defineProperty(i.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(t){t>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-t}}),Object.defineProperty(i.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(t){t<this.y?(this._radius=0,this._diameter=0):this.radius=t-this.y}}),Object.defineProperty(i.Circle.prototype,"area",{get:function(){return this._radius>0?Math.PI*this._radius*this._radius:0}}),Object.defineProperty(i.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(t){t===!0&&this.setTo(0,0,0)}}),i.Circle.contains=function(t,e,i){if(t.radius>0&&e>=t.left&&e<=t.right&&i>=t.top&&i<=t.bottom){var n=(t.x-e)*(t.x-e),r=(t.y-i)*(t.y-i);return n+r<=t.radius*t.radius}return!1},i.Circle.equals=function(t,e){return t.x==e.x&&t.y==e.y&&t.diameter==e.diameter},i.Circle.intersects=function(t,e){return i.Math.distance(t.x,t.y,e.x,e.y)<=t.radius+e.radius},i.Circle.circumferencePoint=function(t,e,n,r){return"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=new i.Point),n===!0&&(e=i.Math.degToRad(e)),r.x=t.x+t.radius*Math.cos(e),r.y=t.y+t.radius*Math.sin(e),r},i.Circle.intersectsRectangle=function(t,e){var i=Math.abs(t.x-e.x-e.halfWidth),n=e.halfWidth+t.radius;if(i>n)return!1;var r=Math.abs(t.y-e.y-e.halfHeight),s=e.halfHeight+t.radius;if(r>s)return!1;if(i<=e.halfWidth||r<=e.halfHeight)return!0;var o=i-e.halfWidth,a=r-e.halfHeight,h=o*o,u=a*a,c=t.radius*t.radius;return c>=h+u},PIXI.Circle=i.Circle,i.Point=function(t,e){t=t||0,e=e||0,this.x=t,this.y=e},i.Point.prototype={copyFrom:function(t){return this.setTo(t.x,t.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},set:function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},add:function(t,e){return this.x+=t,this.y+=e,this},subtract:function(t,e){return this.x-=t,this.y-=e,this},multiply:function(t,e){return this.x*=t,this.y*=e,this},divide:function(t,e){return this.x/=t,this.y/=e,this},clampX:function(t,e){return this.x=i.Math.clamp(this.x,t,e),this},clampY:function(t,e){return this.y=i.Math.clamp(this.y,t,e),this},clamp:function(t,e){return this.x=i.Math.clamp(this.x,t,e),this.y=i.Math.clamp(this.y,t,e),this},clone:function(t){return"undefined"==typeof t?t=new i.Point(this.x,this.y):t.setTo(this.x,this.y),t},copyTo:function(t){return t.x=this.x,t.y=this.y,t},distance:function(t,e){return i.Point.distance(this,t,e)},equals:function(t){return t.x===this.x&&t.y===this.y},angle:function(t,e){return"undefined"==typeof e&&(e=!1),e?i.Math.radToDeg(Math.atan2(t.y-this.y,t.x-this.x)):Math.atan2(t.y-this.y,t.x-this.x)},angleSq:function(t){return this.subtract(t).angle(t.subtract(this))},rotate:function(t,e,n,r,s){return i.Point.rotate(this,t,e,n,r,s)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(t){return this.normalize().multiply(t,t)},normalize:function(){if(!this.isZero()){var t=this.getMagnitude();this.x/=t,this.y/=t}return this},isZero:function(){return 0===this.x&&0===this.y},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}},i.Point.prototype.constructor=i.Point,i.Point.add=function(t,e,n){return"undefined"==typeof n&&(n=new i.Point),n.x=t.x+e.x,n.y=t.y+e.y,n},i.Point.subtract=function(t,e,n){return"undefined"==typeof n&&(n=new i.Point),n.x=t.x-e.x,n.y=t.y-e.y,n},i.Point.multiply=function(t,e,n){return"undefined"==typeof n&&(n=new i.Point),n.x=t.x*e.x,n.y=t.y*e.y,n},i.Point.divide=function(t,e,n){return"undefined"==typeof n&&(n=new i.Point),n.x=t.x/e.x,n.y=t.y/e.y,n},i.Point.equals=function(t,e){return t.x===e.x&&t.y===e.y},i.Point.angle=function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)},i.Point.angleSq=function(t,e){return t.subtract(e).angle(e.subtract(t))},i.Point.negative=function(t,e){return"undefined"==typeof e&&(e=new i.Point),e.setTo(-t.x,-t.y)},i.Point.multiplyAdd=function(t,e,n,r){return"undefined"==typeof r&&(r=new i.Point),r.setTo(t.x+e.x*n,t.y+e.y*n)},i.Point.interpolate=function(t,e,n,r){return"undefined"==typeof r&&(r=new i.Point),r.setTo(t.x+(e.x-t.x)*n,t.y+(e.y-t.y)*n)},i.Point.perp=function(t,e){return"undefined"==typeof e&&(e=new i.Point),e.setTo(-t.y,t.x)},i.Point.rperp=function(t,e){return"undefined"==typeof e&&(e=new i.Point),e.setTo(t.y,-t.x)},i.Point.distance=function(t,e,n){return"undefined"==typeof n&&(n=!1),n?i.Math.distanceRounded(t.x,t.y,e.x,e.y):i.Math.distance(t.x,t.y,e.x,e.y)},i.Point.project=function(t,e,n){"undefined"==typeof n&&(n=new i.Point);var r=t.dot(e)/e.getMagnitudeSq();return 0!==r&&n.setTo(r*e.x,r*e.y),n},i.Point.projectUnit=function(t,e,n){"undefined"==typeof n&&(n=new i.Point);var r=t.dot(e);return 0!==r&&n.setTo(r*e.x,r*e.y),n},i.Point.normalRightHand=function(t,e){return"undefined"==typeof e&&(e=new i.Point),e.setTo(-1*t.y,t.x)},i.Point.normalize=function(t,e){"undefined"==typeof e&&(e=new i.Point);var n=t.getMagnitude();return 0!==n&&e.setTo(t.x/n,t.y/n),e},i.Point.rotate=function(t,e,n,r,s,o){return s=s||!1,o=o||null,s&&(r=i.Math.degToRad(r)),null===o&&(o=Math.sqrt((e-t.x)*(e-t.x)+(n-t.y)*(n-t.y))),t.setTo(e+o*Math.cos(r),n+o*Math.sin(r))},i.Point.centroid=function(t,e){if("undefined"==typeof e&&(e=new i.Point),"[object Array]"!==Object.prototype.toString.call(t))throw new Error("Phaser.Point. Parameter 'points' must be an array");var n=t.length;if(1>n)throw new Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===n)return e.copyFrom(t[0]),e;for(var r=0;n>r;r++)i.Point.add(e,t[r],e);return e.divide(n,n),e},PIXI.Point=i.Point,i.Rectangle=function(t,e,i,n){t=t||0,e=e||0,i=i||0,n=n||0,this.x=t,this.y=e,this.width=i,this.height=n},i.Rectangle.prototype={offset:function(t,e){return this.x+=t,this.y+=e,this},offsetPoint:function(t){return this.offset(t.x,t.y)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},floor:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.floor(this.width),this.height=Math.floor(this.height)},copyFrom:function(t){return this.setTo(t.x,t.y,t.width,t.height)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},inflate:function(t,e){return i.Rectangle.inflate(this,t,e)},size:function(t){return i.Rectangle.size(this,t)},clone:function(t){return i.Rectangle.clone(this,t)},contains:function(t,e){return i.Rectangle.contains(this,t,e)},containsRect:function(t){return i.Rectangle.containsRect(this,t)},equals:function(t){return i.Rectangle.equals(this,t)},intersection:function(t,e){return i.Rectangle.intersection(this,t,e)},intersects:function(t,e){return i.Rectangle.intersects(this,t,e)},intersectsRaw:function(t,e,n,r,s){return i.Rectangle.intersectsRaw(this,t,e,n,r,s)},union:function(t,e){return i.Rectangle.union(this,t,e)},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}},Object.defineProperty(i.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(i.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),Object.defineProperty(i.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t<=this.y?0:this.y-t}}),Object.defineProperty(i.Rectangle.prototype,"bottomRight",{get:function(){return new i.Point(this.right,this.bottom)},set:function(t){this.right=t.x,this.bottom=t.y}}),Object.defineProperty(i.Rectangle.prototype,"left",{get:function(){return this.x},set:function(t){this.width=t>=this.right?0:this.right-t,this.x=t}}),Object.defineProperty(i.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t<=this.x?0:this.x+t}}),Object.defineProperty(i.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}}),Object.defineProperty(i.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}}),Object.defineProperty(i.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(t){this.x=t-this.halfWidth}}),Object.defineProperty(i.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(t){this.y=t-this.halfHeight}}),Object.defineProperty(i.Rectangle.prototype,"top",{get:function(){return this.y},set:function(t){t>=this.bottom?(this.height=0,this.y=t):this.height=this.bottom-t}}),Object.defineProperty(i.Rectangle.prototype,"topLeft",{get:function(){return new i.Point(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y}}),Object.defineProperty(i.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(t){t===!0&&this.setTo(0,0,0,0)}}),i.Rectangle.prototype.constructor=i.Rectangle,i.Rectangle.inflate=function(t,e,i){return t.x-=e,t.width+=2*e,t.y-=i,t.height+=2*i,t},i.Rectangle.inflatePoint=function(t,e){return i.Rectangle.inflate(t,e.x,e.y)},i.Rectangle.size=function(t,e){return"undefined"==typeof e?e=new i.Point(t.width,t.height):e.setTo(t.width,t.height),e},i.Rectangle.clone=function(t,e){return"undefined"==typeof e?e=new i.Rectangle(t.x,t.y,t.width,t.height):e.setTo(t.x,t.y,t.width,t.height),e},i.Rectangle.contains=function(t,e,i){return t.width<=0||t.height<=0?!1:e>=t.x&&e<=t.right&&i>=t.y&&i<=t.bottom},i.Rectangle.containsRaw=function(t,e,i,n,r,s){return r>=t&&t+i>=r&&s>=e&&e+n>=s},i.Rectangle.containsPoint=function(t,e){return i.Rectangle.contains(t,e.x,e.y)},i.Rectangle.containsRect=function(t,e){return t.volume>e.volume?!1:t.x>=e.x&&t.y>=e.y&&t.right<=e.right&&t.bottom<=e.bottom},i.Rectangle.equals=function(t,e){return t.x==e.x&&t.y==e.y&&t.width==e.width&&t.height==e.height},i.Rectangle.intersection=function(t,e,n){return"undefined"==typeof n&&(n=new i.Rectangle),i.Rectangle.intersects(t,e)&&(n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.width=Math.min(t.right,e.right)-n.x,n.height=Math.min(t.bottom,e.bottom)-n.y),n},i.Rectangle.intersects=function(t,e){return t.width<=0||t.height<=0||e.width<=0||e.height<=0?!1:!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)},i.Rectangle.intersectsRaw=function(t,e,i,n,r,s){return"undefined"==typeof s&&(s=0),!(e>t.right+s||i<t.left-s||n>t.bottom+s||r<t.top-s)},i.Rectangle.union=function(t,e,n){return"undefined"==typeof n&&(n=new i.Rectangle),n.setTo(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.right,e.right)-Math.min(t.left,e.left),Math.max(t.bottom,e.bottom)-Math.min(t.top,e.top))},PIXI.Rectangle=i.Rectangle,PIXI.EmptyRectangle=new i.Rectangle(0,0,0,0),i.Line=function(t,e,n,r){t=t||0,e=e||0,n=n||0,r=r||0,this.start=new i.Point(t,e),this.end=new i.Point(n,r)},i.Line.prototype={setTo:function(t,e,i,n){return this.start.setTo(t,e),this.end.setTo(i,n),this},fromSprite:function(t,e,i){return"undefined"==typeof i&&(i=!1),i?this.setTo(t.center.x,t.center.y,e.center.x,e.center.y):this.setTo(t.x,t.y,e.x,e.y)},intersects:function(t,e,n){return i.Line.intersectsPoints(this.start,this.end,t.start,t.end,e,n)},pointOnLine:function(t,e){return(t-this.start.x)*(this.end.y-this.start.y)===(this.end.x-this.start.x)*(e-this.start.y)},pointOnSegment:function(t,e){var i=Math.min(this.start.x,this.end.x),n=Math.max(this.start.x,this.end.x),r=Math.min(this.start.y,this.end.y),s=Math.max(this.start.y,this.end.y);return this.pointOnLine(t,e)&&t>=i&&n>=t&&e>=r&&s>=e},coordinatesOnLine:function(t,e){"undefined"==typeof t&&(t=1),"undefined"==typeof e&&(e=[]);var i=Math.round(this.start.x),n=Math.round(this.start.y),r=Math.round(this.end.x),s=Math.round(this.end.y),o=Math.abs(r-i),a=Math.abs(s-n),h=r>i?1:-1,u=s>n?1:-1,c=o-a;e.push([i,n]);for(var l=1;i!=r||n!=s;){var d=c<<1;d>-a&&(c-=a,i+=h),o>d&&(c+=o,n+=u),l%t===0&&e.push([i,n]),l++}return e}},Object.defineProperty(i.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}}),Object.defineProperty(i.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}}),Object.defineProperty(i.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}}),Object.defineProperty(i.Line.prototype,"perpSlope",{get:function(){return-((this.end.x-this.start.x)/(this.end.y-this.start.y))}}),Object.defineProperty(i.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(i.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(i.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(i.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}}),Object.defineProperty(i.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(i.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}}),Object.defineProperty(i.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}}),Object.defineProperty(i.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}}),i.Line.intersectsPoints=function(t,e,n,r,s,o){"undefined"==typeof s&&(s=!0),"undefined"==typeof o&&(o=new i.Point);var a=e.y-t.y,h=r.y-n.y,u=t.x-e.x,c=n.x-r.x,l=e.x*t.y-t.x*e.y,d=r.x*n.y-n.x*r.y,p=a*c-h*u;return 0===p?null:(o.x=(u*d-c*l)/p,o.y=(h*l-a*d)/p,s&&(o.x<Math.min(t.x,e.x)||o.x>Math.max(t.x,e.x)||o.y<Math.min(t.y,e.y)||o.y>Math.max(t.y,e.y)||o.x<Math.min(n.x,r.x)||o.x>Math.max(n.x,r.x)||o.y<Math.min(n.y,r.y)||o.y>Math.max(n.y,r.y))?null:o)},i.Line.intersects=function(t,e,n,r){return i.Line.intersectsPoints(t.start,t.end,e.start,e.end,n,r)},i.Ellipse=function(t,e,n,r){this.type=i.ELLIPSE,t=t||0,e=e||0,n=n||0,r=r||0,this.x=t,this.y=e,this.width=n,this.height=r},i.Ellipse.prototype={setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},copyFrom:function(t){return this.setTo(t.x,t.y,t.width,t.height)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},clone:function(t){return"undefined"==typeof t?t=new i.Ellipse(this.x,this.y,this.width,this.height):t.setTo(this.x,this.y,this.width,this.height),t},contains:function(t,e){return i.Ellipse.contains(this,t,e)},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}},i.Ellipse.prototype.constructor=i.Ellipse,Object.defineProperty(i.Ellipse.prototype,"left",{get:function(){return this.x},set:function(t){this.x=t}}),Object.defineProperty(i.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t<this.x?0:this.x+t}}),Object.defineProperty(i.Ellipse.prototype,"top",{get:function(){return this.y},set:function(t){this.y=t}}),Object.defineProperty(i.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t<this.y?0:this.y+t}}),Object.defineProperty(i.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(t){t===!0&&this.setTo(0,0,0,0)}}),i.Ellipse.contains=function(t,e,i){if(t.width<=0||t.height<=0)return!1;var n=(e-t.x)/t.width-.5,r=(i-t.y)/t.height-.5;return n*=n,r*=r,.25>n+r},i.Ellipse.prototype.getBounds=function(){return new i.Rectangle(this.x,this.y,this.width,this.height)},PIXI.Ellipse=i.Ellipse,i.Polygon=function(t){if(this.type=i.POLYGON,t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var e=[],n=0,r=t.length;r>n;n+=2)e.push(new i.Point(t[n],t[n+1]));t=e}this._points=t},i.Polygon.prototype={clone:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].clone());return new i.Polygon(t)},contains:function(t,e){for(var i=!1,n=0,r=this.points.length-1;n<this.points.length;r=n++){var s=this.points[n].x,o=this.points[n].y,a=this.points[r].x,h=this.points[r].y,u=o>e!=h>e&&(a-s)*(e-o)/(h-o)+s>t;u&&(i=!i)}return i}},i.Polygon.prototype.constructor=i.Polygon,Object.defineProperty(i.Polygon.prototype,"points",{get:function(){return this._points},set:function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var e=[],n=0,r=t.length;r>n;n+=2)e.push(new i.Point(t[n],t[n+1]));t=e}this._points=t}}),Object.defineProperty(i.Polygon.prototype,"area",{get:function(){var t,e,i,n,r,s=Number.MAX_VALUE,o=0;for(r=0;r<this.points.length;r++)this.points[r].y<s&&(s=this.points[r].y);for(r=0;r<this.points.length;r++)t=this.points[r],e=r===this.points.length-1?this.points[0]:this.points[r+1],i=(t.y-s+(e.y-s))/2,n=t.x-e.x,o+=i*n;return o}}),PIXI.Polygon=i.Polygon,i.Camera=function(t,e,n,r,s,o){this.game=t,this.world=t.world,this.id=0,this.view=new i.Rectangle(n,r,s,o),this.screenView=new i.Rectangle(n,r,s,o),this.bounds=new i.Rectangle(n,r,s,o),this.deadzone=null,this.visible=!0,this.atLimit={x:!1,y:!1},this.target=null,this._edge=0,this.displayObject=null,this.scale=null},i.Camera.FOLLOW_LOCKON=0,i.Camera.FOLLOW_PLATFORMER=1,i.Camera.FOLLOW_TOPDOWN=2,i.Camera.FOLLOW_TOPDOWN_TIGHT=3,i.Camera.prototype={follow:function(t,e){"undefined"==typeof e&&(e=i.Camera.FOLLOW_LOCKON),this.target=t;var n;switch(e){case i.Camera.FOLLOW_PLATFORMER:var r=this.width/8,s=this.height/3;this.deadzone=new i.Rectangle((this.width-r)/2,(this.height-s)/2-.25*s,r,s);break;case i.Camera.FOLLOW_TOPDOWN:n=Math.max(this.width,this.height)/4,this.deadzone=new i.Rectangle((this.width-n)/2,(this.height-n)/2,n,n);break;case i.Camera.FOLLOW_TOPDOWN_TIGHT:n=Math.max(this.width,this.height)/8,this.deadzone=new i.Rectangle((this.width-n)/2,(this.height-n)/2,n,n);break;case i.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(t){this.setPosition(Math.round(t.x-this.view.halfWidth),Math.round(t.y-this.view.halfHeight))},focusOnXY:function(t,e){this.setPosition(Math.round(t-this.view.halfWidth),Math.round(e-this.view.halfHeight))},update:function(){this.target&&this.updateTarget(),this.bounds&&this.checkBounds(),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},updateTarget:function(){this.deadzone?(this._edge=this.target.x-this.deadzone.x,this.view.x>this._edge&&(this.view.x=this._edge),this._edge=this.target.x+this.target.width-this.deadzone.x-this.deadzone.width,this.view.x<this._edge&&(this.view.x=this._edge),this._edge=this.target.y-this.deadzone.y,this.view.y>this._edge&&(this.view.y=this._edge),this._edge=this.target.y+this.target.height-this.deadzone.y-this.deadzone.height,this.view.y<this._edge&&(this.view.y=this._edge)):this.focusOnXY(this.target.x,this.target.y)},setBoundsToWorld:function(){this.bounds.setTo(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height)},checkBounds:function(){this.atLimit.x=!1,this.atLimit.y=!1,this.view.x<=this.bounds.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x),this.view.right>=this.bounds.right&&(this.atLimit.x=!0,this.view.x=this.bounds.right-this.width),this.view.y<=this.bounds.top&&(this.atLimit.y=!0,this.view.y=this.bounds.top),this.view.bottom>=this.bounds.bottom&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom-this.height),this.view.floor()},setPosition:function(t,e){this.view.x=t,this.view.y=e,this.bounds&&this.checkBounds()},setSize:function(t,e){this.view.width=t,this.view.height=e},reset:function(){this.target=null,this.view.x=0,this.view.y=0}},i.Camera.prototype.constructor=i.Camera,Object.defineProperty(i.Camera.prototype,"x",{get:function(){return this.view.x},set:function(t){this.view.x=t,this.bounds&&this.checkBounds()}}),Object.defineProperty(i.Camera.prototype,"y",{get:function(){return this.view.y},set:function(t){this.view.y=t,this.bounds&&this.checkBounds()}}),Object.defineProperty(i.Camera.prototype,"width",{get:function(){return this.view.width},set:function(t){this.view.width=t}}),Object.defineProperty(i.Camera.prototype,"height",{get:function(){return this.view.height},set:function(t){this.view.height=t}}),i.State=function(){this.game=null,this.add=null,this.make=null,this.camera=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.sound=null,this.scale=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.particles=null,this.physics=null,this.rnd=null},i.State.prototype={preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},render:function(){},paused:function(){},pauseUpdate:function(){},shutdown:function(){}},i.State.prototype.constructor=i.State,i.StateManager=function(t,e){this.game=t,this.states={},this._pendingState=null,"undefined"!=typeof e&&null!==e&&(this._pendingState=e),this._clearWorld=!1,this._clearCache=!1,this._created=!1,this._args=[],this.current="",this.onInitCallback=null,this.onPreloadCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPreRenderCallback=null,this.onLoadUpdateCallback=null,this.onLoadRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.onShutDownCallback=null},i.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this),this.game.onResume.add(this.resume,this),this.game.load.onLoadComplete.add(this.loadComplete,this),null!==this._pendingState&&("string"==typeof this._pendingState?this.start(this._pendingState,!1,!1):this.add("default",this._pendingState,!0))},add:function(t,e,n){"undefined"==typeof n&&(n=!1);var r;return e instanceof i.State?r=e:"object"==typeof e?(r=e,r.game=this.game):"function"==typeof e&&(r=new e(this.game)),this.states[t]=r,n&&(this.game.isBooted?this.start(t):this._pendingState=t),r},remove:function(t){this.current===t&&(this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null),delete this.states[t]},start:function(t,e,i){"undefined"==typeof e&&(e=!0),"undefined"==typeof i&&(i=!1),this.checkState(t)&&(this._pendingState=t,this._clearWorld=e,this._clearCache=i,arguments.length>3&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(t,e){"undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=!1),this._pendingState=this.current,this._clearWorld=t,this._clearCache=e,arguments.length>2&&(this._args=Array.prototype.splice.call(arguments,2))},dummy:function(){},preUpdate:function(){this._pendingState&&this.game.isBooted&&(this.current&&(this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this._clearWorld&&(this.game.world.shutdown(),this._clearCache===!0&&this.game.cache.destroy())),this.setCurrentState(this._pendingState),this.onPreloadCallback?(this.game.load.reset(),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()?this.loadComplete():this.game.load.start()):this.loadComplete(),this.current===this._pendingState&&(this._pendingState=null))},checkState:function(t){if(this.states[t]){var e=!1;return this.states[t].preload&&(e=!0),this.states[t].create&&(e=!0),this.states[t].update&&(e=!0),this.states[t].render&&(e=!0),e===!1?(console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render"),!1):!0}return console.warn("Phaser.StateManager - No state found with the key: "+t),!1},link:function(t){this.states[t].game=this.game,this.states[t].add=this.game.add,this.states[t].make=this.game.make,this.states[t].camera=this.game.camera,this.states[t].cache=this.game.cache,this.states[t].input=this.game.input,this.states[t].load=this.game.load,this.states[t].math=this.game.math,this.states[t].sound=this.game.sound,this.states[t].scale=this.game.scale,this.states[t].state=this,this.states[t].stage=this.game.stage,this.states[t].time=this.game.time,this.states[t].tweens=this.game.tweens,this.states[t].world=this.game.world,this.states[t].particles=this.game.particles,this.states[t].rnd=this.game.rnd,this.states[t].physics=this.game.physics},setCurrentState:function(t){this.callbackContext=this.states[t],this.link(t),this.onInitCallback=this.states[t].init||this.dummy,this.onPreloadCallback=this.states[t].preload||null,this.onLoadRenderCallback=this.states[t].loadRender||null,this.onLoadUpdateCallback=this.states[t].loadUpdate||null,this.onCreateCallback=this.states[t].create||null,this.onUpdateCallback=this.states[t].update||null,this.onPreRenderCallback=this.states[t].preRender||null,this.onRenderCallback=this.states[t].render||null,this.onPausedCallback=this.states[t].paused||null,this.onResumedCallback=this.states[t].resumed||null,this.onPauseUpdateCallback=this.states[t].pauseUpdate||null,this.onShutDownCallback=this.states[t].shutdown||this.dummy,this.current=t,this._created=!1,this.onInitCallback.apply(this.callbackContext,this._args),this._args=[]},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){this._created===!1&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created&&this.onUpdateCallback?this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created&&this.onPauseUpdateCallback?this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(){this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game)},render:function(){this._created&&this.onRenderCallback?(this.game.renderType===i.CANVAS&&(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0)),this.onRenderCallback.call(this.callbackContext,this.game),this.game.renderType===i.CANVAS&&this.game.context.restore()):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.game=null,this.states={},this._pendingState=null}},i.StateManager.prototype.constructor=i.StateManager,i.LinkedList=function(){this.next=null,this.prev=null,this.first=null,this.last=null,this.total=0},i.LinkedList.prototype={add:function(t){return 0===this.total&&null===this.first&&null===this.last?(this.first=t,this.last=t,this.next=t,t.prev=this,this.total++,t):(this.last.next=t,t.prev=this.last,this.last=t,this.total++,t)},reset:function(){this.first=null,this.last=null,this.next=null,this.prev=null,this.total=0},remove:function(t){return 1===this.total?(this.reset(),t.next=t.prev=null,void 0):(t===this.first?this.first=this.first.next:t===this.last&&(this.last=this.last.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.next=t.prev=null,null===this.first&&(this.last=null),this.total--,void 0)},callAll:function(t){if(this.first&&this.last){var e=this.first;do e&&e[t]&&e[t].call(e),e=e.next;while(e!=this.last.next)}}},i.LinkedList.prototype.constructor=i.LinkedList,i.ArrayList=function(){this.total=0,this.position=0,this.list=[]},i.ArrayList.prototype={add:function(t){return this.exists(t)||(this.list.push(t),this.total++),t},getIndex:function(t){return this.list.indexOf(t)},exists:function(t){return this.list.indexOf(t)>-1},reset:function(){this.list.length=0,this.total=0},remove:function(t){var e=this.list.indexOf(t);return e>-1?(this.list.splice(e,1),this.total--,t):void 0},callAll:function(t){for(var e=Array.prototype.splice.call(arguments,1),i=this.list.length;i--;)this.list[i]&&this.list[i][t]&&this.list[i][t].apply(this.list[i],e)}},Object.defineProperty(i.ArrayList.prototype,"first",{get:function(){return this.position=0,this.total>0?this.list[0]:null}}),Object.defineProperty(i.ArrayList.prototype,"next",{get:function(){return this.position<this.total?(this.position++,this.list[this.position]):null}}),i.ArrayList.prototype.constructor=i.ArrayList,i.Signal=function(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){i.Signal.prototype.dispatch.apply(t,arguments)}},i.Signal.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))},_registerListener:function(t,e,n,r){var s,o=this._indexOfListener(t,n);if(-1!==o){if(s=this._bindings[o],s.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else s=new i.SignalBinding(this,t,e,n,r),this._addBinding(s);return this.memorize&&this._prevParams&&s.execute(this._prevParams),s},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i._listener===t&&i.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){return this.validateListener(t,"add"),this._registerListener(t,!1,e,i)},addOnce:function(t,e,i){return this.validateListener(t,"addOnce"),this._registerListener(t,!0,e,i)},remove:function(t,e){this.validateListener(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();
this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=e),i){t=this._bindings.slice(),this._shouldPropagate=!0;do i--;while(t[i]&&this._shouldPropagate&&t[i].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},i.Signal.prototype.constructor=i.Signal,i.SignalBinding=function(t,e,i,n,r){this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this._priority=r||0},i.SignalBinding.prototype={active:!0,params:null,execute:function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},i.SignalBinding.prototype.constructor=i.SignalBinding,i.Filter=function(t,e,n){this.game=t,this.type=i.WEBGL_FILTER,this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms={time:{type:"1f",value:0},resolution:{type:"2f",value:{x:256,y:256}},mouse:{type:"2f",value:{x:0,y:0}}},this.fragmentSrc=n||[]},i.Filter.prototype={init:function(){},setResolution:function(t,e){this.uniforms.resolution.value.x=t,this.uniforms.resolution.value.y=e},update:function(t){"undefined"!=typeof t&&(t.x>0&&(this.uniforms.mouse.x=t.x.toFixed(2)),t.y>0&&(this.uniforms.mouse.y=t.y.toFixed(2))),this.uniforms.time.value=this.game.time.totalElapsedSeconds()},destroy:function(){this.game=null}},i.Filter.prototype.constructor=i.Filter,Object.defineProperty(i.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},set:function(t){this.uniforms.resolution.value.x=t}}),Object.defineProperty(i.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(t){this.uniforms.resolution.value.y=t}}),i.Plugin=function(t,e){"undefined"==typeof e&&(e=null),this.game=t,this.parent=e,this.active=!1,this.visible=!1,this.hasPreUpdate=!1,this.hasUpdate=!1,this.hasPostUpdate=!1,this.hasRender=!1,this.hasPostRender=!1},i.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.game=null,this.parent=null,this.active=!1,this.visible=!1}},i.Plugin.prototype.constructor=i.Plugin,i.PluginManager=function(t){this.game=t,this.plugins=[],this._len=0,this._i=0},i.PluginManager.prototype={add:function(t){var e=Array.prototype.splice.call(arguments,1),i=!1;return"function"==typeof t?t=new t(this.game,this):(t.game=this.game,t.parent=this),"function"==typeof t.preUpdate&&(t.hasPreUpdate=!0,i=!0),"function"==typeof t.update&&(t.hasUpdate=!0,i=!0),"function"==typeof t.postUpdate&&(t.hasPostUpdate=!0,i=!0),"function"==typeof t.render&&(t.hasRender=!0,i=!0),"function"==typeof t.postRender&&(t.hasPostRender=!0,i=!0),i?((t.hasPreUpdate||t.hasUpdate||t.hasPostUpdate)&&(t.active=!0),(t.hasRender||t.hasPostRender)&&(t.visible=!0),this._len=this.plugins.push(t),"function"==typeof t.init&&t.init.apply(t,e),t):null},remove:function(t){for(this._i=this._len;this._i--;)if(this.plugins[this._i]===t)return t.destroy(),this.plugins.splice(this._i,1),this._len--,void 0},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this.plugins.length=0,this._len=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll(),this.game=null}},i.PluginManager.prototype.constructor=i.PluginManager,i.Stage=function(t,e,n){this.game=t,this.offset=new i.Point,this.bounds=new i.Rectangle(0,0,e,n),PIXI.Stage.call(this,0,!1),this.name="_stage_root",this.interactive=!1,this.disableVisibilityChange=!1,this.checkOffsetInterval=2500,this.exists=!0,this.currentRenderOrderID=0,this._hiddenVar="hidden",this._nextOffsetCheck=0,this._backgroundColor=0,t.config?this.parseConfig(t.config):(this.game.canvas=i.Canvas.create(e,n),this.game.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%")},i.Stage.prototype=Object.create(PIXI.Stage.prototype),i.Stage.prototype.constructor=i.Stage,i.Stage.prototype.preUpdate=function(){this.currentRenderOrderID=0;for(var t=this.children.length,e=0;t>e;e++)this.children[e].preUpdate()},i.Stage.prototype.update=function(){for(var t=this.children.length;t--;)this.children[t].update()},i.Stage.prototype.postUpdate=function(){if(this.game.world.camera.target){this.game.world.camera.target.postUpdate(),this.game.world.camera.update();for(var t=this.children.length;t--;)this.children[t]!==this.game.world.camera.target&&this.children[t].postUpdate()}else{this.game.world.camera.update();for(var t=this.children.length;t--;)this.children[t].postUpdate()}this.checkOffsetInterval!==!1&&this.game.time.now>this._nextOffsetCheck&&(i.Canvas.getOffset(this.game.canvas,this.offset),this.bounds.x=this.offset.x,this.bounds.y=this.offset.y,this._nextOffsetCheck=this.game.time.now+this.checkOffsetInterval)},i.Stage.prototype.parseConfig=function(t){this.game.canvas=t.canvasID?i.Canvas.create(this.game.width,this.game.height,t.canvasID):i.Canvas.create(this.game.width,this.game.height),t.canvasStyle?this.game.canvas.stlye=t.canvasStyle:this.game.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%",t.checkOffsetInterval&&(this.checkOffsetInterval=t.checkOffsetInterval),t.disableVisibilityChange&&(this.disableVisibilityChange=t.disableVisibilityChange),t.fullScreenScaleMode&&(this.fullScreenScaleMode=t.fullScreenScaleMode),t.scaleMode&&(this.scaleMode=t.scaleMode),t.backgroundColor&&(this.backgroundColor=t.backgroundColor)},i.Stage.prototype.boot=function(){i.Canvas.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.game.width,this.game.height);var t=this;this._onChange=function(e){return t.visibilityChange(e)},i.Canvas.setUserSelect(this.game.canvas,"none"),i.Canvas.setTouchAction(this.game.canvas,"none"),this.checkVisibility()},i.Stage.prototype.checkVisibility=function(){this._hiddenVar=void 0!==document.webkitHidden?"webkitvisibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.hidden?"visibilitychange":null,this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1),window.onpagehide=this._onChange,window.onpageshow=this._onChange,window.onblur=this._onChange,window.onfocus=this._onChange},i.Stage.prototype.visibilityChange=function(t){return this.disableVisibilityChange?void 0:"pagehide"===t.type||"blur"===t.type||"pageshow"===t.type||"focus"===t.type?("pagehide"===t.type||"blur"===t.type?this.game.focusLoss(t):("pageshow"===t.type||"focus"===t.type)&&this.game.focusGain(t),void 0):(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden?this.game.gamePaused(t):this.game.gameResumed(t),void 0)},i.Stage.prototype.setBackgroundColor=function(t){if("string"==typeof t){var e=i.Color.hexToColor(t);this._backgroundColor=i.Color.getColor(e.r,e.g,e.b)}else{var e=i.Color.getRGB(t);this._backgroundColor=t}this.backgroundColorSplit=[e.r/255,e.g/255,e.b/255],this.backgroundColorString=i.Color.RGBtoString(e.r,e.g,e.b,255,"#")},Object.defineProperty(i.Stage.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this.game.transparent||this.setBackgroundColor(t)}}),Object.defineProperty(i.Stage.prototype,"smoothed",{get:function(){return!PIXI.scaleModes.LINEAR},set:function(t){PIXI.scaleModes.LINEAR=t?0:1}}),i.Group=function(t,e,n,r,s,o){"undefined"==typeof r&&(r=!1),"undefined"==typeof s&&(s=!1),"undefined"==typeof o&&(o=i.Physics.ARCADE),this.game=t,"undefined"==typeof e&&(e=t.world),this.name=n||"group",PIXI.DisplayObjectContainer.call(this),r?this.game.stage.addChild(this):e&&e.addChild(this),this.z=0,this.type=i.GROUP,this.alive=!0,this.exists=!0,this.classType=i.Sprite,this.scale=new i.Point(1,1),this.cursor=null,this.cameraOffset=new i.Point,this.enableBody=s,this.enableBodyDebug=!1,this.physicsBodyType=o,this._sortProperty="z",this._cache=[0,0,0,0,1,0,1,0,0,0]},i.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),i.Group.prototype.constructor=i.Group,i.Group.RETURN_NONE=0,i.Group.RETURN_TOTAL=1,i.Group.RETURN_CHILD=2,i.Group.SORT_ASCENDING=-1,i.Group.SORT_DESCENDING=1,i.Group.prototype.add=function(t){return t.parent!==this&&(this.enableBody&&this.game.physics.enable(t,this.physicsBodyType),this.addChild(t),t.z=this.children.length,t.events&&t.events.onAddedToGroup.dispatch(t,this),null===this.cursor&&(this.cursor=t)),t},i.Group.prototype.addAt=function(t,e){return t.parent!==this&&(this.enableBody&&this.game.physics.enable(t,this.physicsBodyType),this.addChildAt(t,e),this.updateZ(),t.events&&t.events.onAddedToGroup.dispatch(t,this),null===this.cursor&&(this.cursor=t)),t},i.Group.prototype.getAt=function(t){return 0>t||t>=this.children.length?-1:this.getChildAt(t)},i.Group.prototype.create=function(t,e,i,n,r){"undefined"==typeof r&&(r=!0);var s=new this.classType(this.game,t,e,i,n);return this.enableBody&&this.game.physics.enable(s,this.physicsBodyType),s.exists=r,s.visible=r,s.alive=r,this.addChild(s),s.z=this.children.length,s.events&&s.events.onAddedToGroup.dispatch(s,this),null===this.cursor&&(this.cursor=s),s},i.Group.prototype.createMultiple=function(t,e,i,n){"undefined"==typeof n&&(n=!1);for(var r=0;t>r;r++)this.create(0,0,e,i,n)},i.Group.prototype.updateZ=function(){for(var t=this.children.length;t--;)this.children[t].z=t},i.Group.prototype.resetCursor=function(t){return"undefined"==typeof t&&(t=0),t>this.children.length-1&&(t=0),this.cursor?(this._cache[8]=t,this.cursor=this.children[this._cache[8]],this.cursor):void 0},i.Group.prototype.next=function(){return this.cursor?(this._cache[8]>=this.children.length-1?this._cache[8]=0:this._cache[8]++,this.cursor=this.children[this._cache[8]],this.cursor):void 0},i.Group.prototype.previous=function(){return this.cursor?(0===this._cache[8]?this._cache[8]=this.children.length-1:this._cache[8]--,this.cursor=this.children[this._cache[8]],this.cursor):void 0},i.Group.prototype.swap=function(t,e){var i=this.swapChildren(t,e);return i&&this.updateZ(),i},i.Group.prototype.bringToTop=function(t){return t.parent===this&&this.getIndex(t)<this.children.length&&(this.remove(t),this.add(t)),t},i.Group.prototype.sendToBack=function(t){return t.parent===this&&this.getIndex(t)>0&&(this.remove(t),this.addAt(t,0)),t},i.Group.prototype.moveUp=function(t){if(t.parent===this&&this.getIndex(t)<this.children.length-1){var e=this.getIndex(t),i=this.getAt(e+1);i&&this.swap(t,i)}return t},i.Group.prototype.moveDown=function(t){if(t.parent===this&&this.getIndex(t)>0){var e=this.getIndex(t),i=this.getAt(e-1);i&&this.swap(t,i)}return t},i.Group.prototype.xy=function(t,e,i){return 0>t||t>this.children.length?-1:(this.getChildAt(t).x=e,this.getChildAt(t).y=i,void 0)},i.Group.prototype.reverse=function(){this.children.reverse(),this.updateZ()},i.Group.prototype.getIndex=function(t){return this.children.indexOf(t)},i.Group.prototype.replace=function(t,e){var n=this.getIndex(t);if(-1!==n){void 0!==e.parent&&(e.events.onRemovedFromGroup.dispatch(e,this),e.parent.removeChild(e),e.parent instanceof i.Group&&e.parent.updateZ());var r=t;return this.remove(r),this.addAt(e,n),r}},i.Group.prototype.hasProperty=function(t,e){var i=e.length;return 1===i&&e[0]in t?!0:2===i&&e[0]in t&&e[1]in t[e[0]]?!0:3===i&&e[0]in t&&e[1]in t[e[0]]&&e[2]in t[e[0]][e[1]]?!0:4===i&&e[0]in t&&e[1]in t[e[0]]&&e[2]in t[e[0]][e[1]]&&e[3]in t[e[0]][e[1]][e[2]]?!0:!1},i.Group.prototype.setProperty=function(t,e,i,n,r){if("undefined"==typeof r&&(r=!1),n=n||0,!this.hasProperty(t,e)&&(!r||n>0))return!1;var s=e.length;return 1===s?0===n?t[e[0]]=i:1==n?t[e[0]]+=i:2==n?t[e[0]]-=i:3==n?t[e[0]]*=i:4==n&&(t[e[0]]/=i):2===s?0===n?t[e[0]][e[1]]=i:1==n?t[e[0]][e[1]]+=i:2==n?t[e[0]][e[1]]-=i:3==n?t[e[0]][e[1]]*=i:4==n&&(t[e[0]][e[1]]/=i):3===s?0===n?t[e[0]][e[1]][e[2]]=i:1==n?t[e[0]][e[1]][e[2]]+=i:2==n?t[e[0]][e[1]][e[2]]-=i:3==n?t[e[0]][e[1]][e[2]]*=i:4==n&&(t[e[0]][e[1]][e[2]]/=i):4===s&&(0===n?t[e[0]][e[1]][e[2]][e[3]]=i:1==n?t[e[0]][e[1]][e[2]][e[3]]+=i:2==n?t[e[0]][e[1]][e[2]][e[3]]-=i:3==n?t[e[0]][e[1]][e[2]][e[3]]*=i:4==n&&(t[e[0]][e[1]][e[2]][e[3]]/=i)),!0},i.Group.prototype.set=function(t,e,i,n,r,s,o){return"undefined"==typeof o&&(o=!1),e=e.split("."),"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=!1),(n===!1||n&&t.alive)&&(r===!1||r&&t.visible)?this.setProperty(t,e,i,s,o):void 0},i.Group.prototype.setAll=function(t,e,i,n,r,s){"undefined"==typeof i&&(i=!1),"undefined"==typeof n&&(n=!1),"undefined"==typeof s&&(s=!1),t=t.split("."),r=r||0;for(var o=0,a=this.children.length;a>o;o++)(!i||i&&this.children[o].alive)&&(!n||n&&this.children[o].visible)&&this.setProperty(this.children[o],t,e,r,s)},i.Group.prototype.setAllChildren=function(t,e,n,r,s,o){"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=!1),"undefined"==typeof o&&(o=!1),s=s||0;for(var a=0,h=this.children.length;h>a;a++)(!n||n&&this.children[a].alive)&&(!r||r&&this.children[a].visible)&&(this.children[a]instanceof i.Group?this.children[a].setAllChildren(t,e,n,r,s,o):this.setProperty(this.children[a],t.split("."),e,s,o))},i.Group.prototype.addAll=function(t,e,i,n){this.setAll(t,e,i,n,1)},i.Group.prototype.subAll=function(t,e,i,n){this.setAll(t,e,i,n,2)},i.Group.prototype.multiplyAll=function(t,e,i,n){this.setAll(t,e,i,n,3)},i.Group.prototype.divideAll=function(t,e,i,n){this.setAll(t,e,i,n,4)},i.Group.prototype.callAllExists=function(t,e){for(var i=Array.prototype.splice.call(arguments,2),n=0,r=this.children.length;r>n;n++)this.children[n].exists===e&&this.children[n][t]&&this.children[n][t].apply(this.children[n],i)},i.Group.prototype.callbackFromArray=function(t,e,i){if(1==i){if(t[e[0]])return t[e[0]]}else if(2==i){if(t[e[0]][e[1]])return t[e[0]][e[1]]}else if(3==i){if(t[e[0]][e[1]][e[2]])return t[e[0]][e[1]][e[2]]}else if(4==i){if(t[e[0]][e[1]][e[2]][e[3]])return t[e[0]][e[1]][e[2]][e[3]]}else if(t[e])return t[e];return!1},i.Group.prototype.callAll=function(t,e){if("undefined"!=typeof t){t=t.split(".");var i=t.length;if("undefined"==typeof e||null===e||""===e)e=null;else if("string"==typeof e){e=e.split(".");var n=e.length}for(var r=Array.prototype.splice.call(arguments,2),s=null,o=null,a=0,h=this.children.length;h>a;a++)s=this.callbackFromArray(this.children[a],t,i),e&&s?(o=this.callbackFromArray(this.children[a],e,n),s&&s.apply(o,r)):s&&s.apply(this.children[a],r)}},i.Group.prototype.preUpdate=function(){if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;for(var t=this.children.length;t--;)this.children[t].preUpdate();return!0},i.Group.prototype.update=function(){for(var t=this.children.length;t--;)this.children[t].update()},i.Group.prototype.postUpdate=function(){1===this._cache[7]&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var t=this.children.length;t--;)this.children[t].postUpdate()},i.Group.prototype.forEach=function(t,e,i){"undefined"==typeof i&&(i=!1);var n=Array.prototype.splice.call(arguments,3);n.unshift(null);for(var r=0,s=this.children.length;s>r;r++)(!i||i&&this.children[r].exists)&&(n[0]=this.children[r],t.apply(e,n))},i.Group.prototype.forEachExists=function(t,e){var n=Array.prototype.splice.call(arguments,2);n.unshift(null),this.iterate("exists",!0,i.Group.RETURN_TOTAL,t,e,n)},i.Group.prototype.forEachAlive=function(t,e){var n=Array.prototype.splice.call(arguments,2);n.unshift(null),this.iterate("alive",!0,i.Group.RETURN_TOTAL,t,e,n)},i.Group.prototype.forEachDead=function(t,e){var n=Array.prototype.splice.call(arguments,2);n.unshift(null),this.iterate("alive",!1,i.Group.RETURN_TOTAL,t,e,n)},i.Group.prototype.sort=function(t,e){this.children.length<2||("undefined"==typeof t&&(t="z"),"undefined"==typeof e&&(e=i.Group.SORT_ASCENDING),this._sortProperty=t,e===i.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),this.updateZ())},i.Group.prototype.customSort=function(t,e){this.children.length<2||(this.children.sort(t.bind(e)),this.updateZ())},i.Group.prototype.ascendingSortHandler=function(t,e){return t[this._sortProperty]<e[this._sortProperty]?-1:t[this._sortProperty]>e[this._sortProperty]?1:t.z<e.z?-1:1},i.Group.prototype.descendingSortHandler=function(t,e){return t[this._sortProperty]<e[this._sortProperty]?1:t[this._sortProperty]>e[this._sortProperty]?-1:0},i.Group.prototype.iterate=function(t,e,n,r,s,o){if(n===i.Group.RETURN_TOTAL&&0===this.children.length)return 0;"undefined"==typeof r&&(r=!1);for(var a=0,h=0,u=this.children.length;u>h;h++)if(this.children[h][t]===e&&(a++,r&&(o[0]=this.children[h],r.apply(s,o)),n===i.Group.RETURN_CHILD))return this.children[h];return n===i.Group.RETURN_TOTAL?a:n===i.Group.RETURN_CHILD?null:void 0},i.Group.prototype.getFirstExists=function(t){return"boolean"!=typeof t&&(t=!0),this.iterate("exists",t,i.Group.RETURN_CHILD)},i.Group.prototype.getFirstAlive=function(){return this.iterate("alive",!0,i.Group.RETURN_CHILD)},i.Group.prototype.getFirstDead=function(){return this.iterate("alive",!1,i.Group.RETURN_CHILD)},i.Group.prototype.getTop=function(){return this.children.length>0?this.children[this.children.length-1]:void 0},i.Group.prototype.getBottom=function(){return this.children.length>0?this.children[0]:void 0},i.Group.prototype.countLiving=function(){return this.iterate("alive",!0,i.Group.RETURN_TOTAL)},i.Group.prototype.countDead=function(){return this.iterate("alive",!1,i.Group.RETURN_TOTAL)},i.Group.prototype.getRandom=function(t,e){return 0===this.children.length?null:(t=t||0,e=e||this.children.length,this.game.math.getRandom(this.children,t,e))},i.Group.prototype.remove=function(t,e){if("undefined"==typeof e&&(e=!1),0===this.children.length||-1===this.children.indexOf(t))return!1;t.events&&!t.destroyPhase&&t.events.onRemovedFromGroup.dispatch(t,this);var i=this.removeChild(t);return this.updateZ(),this.cursor===t&&this.next(),e&&i&&i.destroy(!0),!0},i.Group.prototype.removeAll=function(t){if("undefined"==typeof t&&(t=!1),0!==this.children.length){do{this.children[0].events&&this.children[0].events.onRemovedFromGroup.dispatch(this.children[0],this);var e=this.removeChild(this.children[0]);t&&e&&e.destroy(!0)}while(this.children.length>0);this.cursor=null}},i.Group.prototype.removeBetween=function(t,e,i){if("undefined"==typeof e&&(e=this.children.length),"undefined"==typeof i&&(i=!1),0!==this.children.length){if(t>e||0>t||e>this.children.length)return!1;for(var n=e;n>=t;){this.children[n].events&&this.children[n].events.onRemovedFromGroup.dispatch(this.children[n],this);var r=this.removeChild(this.children[n]);i&&r&&r.destroy(!0),this.cursor===this.children[n]&&(this.cursor=null),n--}this.updateZ()}},i.Group.prototype.destroy=function(t,e){null!==this.game&&("undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=!1),this.removeAll(t),this.cursor=null,e||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))},Object.defineProperty(i.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,i.Group.RETURN_TOTAL)}}),Object.defineProperty(i.Group.prototype,"length",{get:function(){return this.children.length}}),Object.defineProperty(i.Group.prototype,"angle",{get:function(){return i.Math.radToDeg(this.rotation)},set:function(t){this.rotation=i.Math.degToRad(t)}}),Object.defineProperty(i.Group.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(t){t?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}}),i.World=function(t){i.Group.call(this,t,null,"__world",!1),this.bounds=new i.Rectangle(0,0,t.width,t.height),this.camera=null},i.World.prototype=Object.create(i.Group.prototype),i.World.prototype.constructor=i.World,i.World.prototype.boot=function(){this.camera=new i.Camera(this.game,0,0,0,this.game.width,this.game.height),this.camera.displayObject=this,this.camera.scale=this.scale,this.game.camera=this.camera,this.game.stage.addChild(this)},i.World.prototype.setBounds=function(t,e,i,n){i<this.game.width&&(i=this.game.width),n<this.game.height&&(n=this.game.height),this.bounds.setTo(t,e,i,n),this.camera.bounds&&this.camera.bounds.setTo(t,e,i,n),this.game.physics.setBoundsToWorld()},i.World.prototype.shutdown=function(){this.destroy(!0,!0)},i.World.prototype.wrap=function(t,e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=!1),i?(t.getBounds(),t._currentBounds.right<this.bounds.x?t.x=this.bounds.right:t._currentBounds.x>this.bounds.right&&(t.x=this.bounds.left),t._currentBounds.bottom<this.bounds.top?t.y=this.bounds.bottom:t._currentBounds.top>this.bounds.bottom&&(t.y=this.bounds.top)):(t.x+e<this.bounds.x?t.x=this.bounds.right+e:t.x-e>this.bounds.right&&(t.x=this.bounds.left-e),t.y+e<this.bounds.top?t.y=this.bounds.bottom+e:t.y-e>this.bounds.bottom&&(t.y=this.bounds.top-e))},Object.defineProperty(i.World.prototype,"width",{get:function(){return this.bounds.width},set:function(t){this.bounds.width=t}}),Object.defineProperty(i.World.prototype,"height",{get:function(){return this.bounds.height},set:function(t){this.bounds.height=t}}),Object.defineProperty(i.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth}}),Object.defineProperty(i.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight}}),Object.defineProperty(i.World.prototype,"randomX",{get:function(){return this.bounds.x<0?this.game.rnd.integerInRange(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.integerInRange(this.bounds.x,this.bounds.width)}}),Object.defineProperty(i.World.prototype,"randomY",{get:function(){return this.bounds.y<0?this.game.rnd.integerInRange(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.integerInRange(this.bounds.y,this.bounds.height)}}),i.ScaleManager=function(t,e,n){this.game=t,this.width=e,this.height=n,this.minWidth=null,this.maxWidth=null,this.minHeight=null,this.maxHeight=null,this.forceLandscape=!1,this.forcePortrait=!1,this.incorrectOrientation=!1,this.pageAlignHorizontally=!1,this.pageAlignVertically=!1,this.maxIterations=5,this.orientationSprite=null,this.enterLandscape=new i.Signal,this.enterPortrait=new i.Signal,this.enterIncorrectOrientation=new i.Signal,this.leaveIncorrectOrientation=new i.Signal,this.hasResized=new i.Signal,this.fullScreenTarget=this.game.canvas,this.enterFullScreen=new i.Signal,this.leaveFullScreen=new i.Signal,this.orientation=0,window.orientation?this.orientation=window.orientation:window.outerWidth>window.outerHeight&&(this.orientation=90),this.scaleFactor=new i.Point(1,1),this.scaleFactorInversed=new i.Point(1,1),this.margin=new i.Point(0,0),this.bounds=new i.Rectangle(0,0,e,n),this.aspectRatio=0,this.sourceAspectRatio=e/n,this.event=null,this.scaleMode=i.ScaleManager.NO_SCALE,this.fullScreenScaleMode=i.ScaleManager.NO_SCALE,this._startHeight=0,this._width=0,this._height=0,this._check=null;var r=this;window.addEventListener("orientationchange",function(t){return r.checkOrientation(t)},!1),window.addEventListener("resize",function(t){return r.checkResize(t)},!1),document.addEventListener("webkitfullscreenchange",function(t){return r.fullScreenChange(t)},!1),document.addEventListener("mozfullscreenchange",function(t){return r.fullScreenChange(t)},!1),document.addEventListener("fullscreenchange",function(t){return r.fullScreenChange(t)},!1)},i.ScaleManager.EXACT_FIT=0,i.ScaleManager.NO_SCALE=1,i.ScaleManager.SHOW_ALL=2,i.ScaleManager.prototype={startFullScreen:function(t){!this.isFullScreen&&this.game.device.fullscreen&&("undefined"!=typeof t&&this.game.renderType===i.CANVAS&&(this.game.stage.smoothed=t),this._width=this.width,this._height=this.height,this.game.device.fullscreenKeyboard?this.fullScreenTarget[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT):this.fullScreenTarget[this.game.device.requestFullscreen]())},stopFullScreen:function(){this.fullScreenTarget[this.game.device.cancelFullscreen]()},fullScreenChange:function(t){this.event=t,this.isFullScreen?(this.fullScreenScaleMode===i.ScaleManager.EXACT_FIT?(this.fullScreenTarget.style.width="100%",this.fullScreenTarget.style.height="100%",this.width=window.outerWidth,this.height=window.outerHeight,this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.checkResize()):this.fullScreenScaleMode===i.ScaleManager.SHOW_ALL&&(this.setShowAll(),this.refresh()),this.enterFullScreen.dispatch(this.width,this.height)):(this.fullScreenTarget.style.width=this.game.width+"px",this.fullScreenTarget.style.height=this.game.height+"px",this.width=this._width,this.height=this._height,this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.leaveFullScreen.dispatch(this.width,this.height))},forceOrientation:function(t,e,n){"undefined"==typeof e&&(e=!1),this.forceLandscape=t,this.forcePortrait=e,"undefined"!=typeof n&&((null===n||this.game.cache.checkImageKey(n)===!1)&&(n="__default"),this.orientationSprite=new i.Image(this.game,this.game.width/2,this.game.height/2,PIXI.TextureCache[n]),this.orientationSprite.anchor.set(.5),this.checkOrientationState(),this.incorrectOrientation?(this.orientationSprite.visible=!0,this.game.world.visible=!1):(this.orientationSprite.visible=!1,this.game.world.visible=!0),this.game.stage.addChild(this.orientationSprite))},checkOrientationState:function(){this.incorrectOrientation?(this.forceLandscape&&window.innerWidth>window.innerHeight||this.forcePortrait&&window.innerHeight>window.innerWidth)&&(this.incorrectOrientation=!1,this.leaveIncorrectOrientation.dispatch(),this.orientationSprite&&(this.orientationSprite.visible=!1,this.game.world.visible=!0),this.scaleMode!==i.ScaleManager.NO_SCALE&&this.refresh()):(this.forceLandscape&&window.innerWidth<window.innerHeight||this.forcePortrait&&window.innerHeight<window.innerWidth)&&(this.incorrectOrientation=!0,this.enterIncorrectOrientation.dispatch(),this.orientationSprite&&this.orientationSprite.visible===!1&&(this.orientationSprite.visible=!0,this.game.world.visible=!1),this.scaleMode!==i.ScaleManager.NO_SCALE&&this.refresh())},checkOrientation:function(t){this.event=t,this.orientation=window.orientation,this.isLandscape?this.enterLandscape.dispatch(this.orientation,!0,!1):this.enterPortrait.dispatch(this.orientation,!1,!0),this.scaleMode!==i.ScaleManager.NO_SCALE&&this.refresh()},checkResize:function(t){this.event=t,this.orientation=window.outerWidth>window.outerHeight?90:0,this.isLandscape?this.enterLandscape.dispatch(this.orientation,!0,!1):this.enterPortrait.dispatch(this.orientation,!1,!0),this.scaleMode!==i.ScaleManager.NO_SCALE&&this.refresh(),this.checkOrientationState()},refresh:function(){if(this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(this.game.device.android&&!this.game.device.chrome?window.scrollTo(0,1):window.scrollTo(0,0)),null===this._check&&this.maxIterations>0){this._iterations=this.maxIterations;var t=this;this._check=window.setInterval(function(){return t.setScreenSize()},10),this.setScreenSize()}},setScreenSize:function(t){"undefined"==typeof t&&(t=!1),this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(this.game.device.android&&!this.game.device.chrome?window.scrollTo(0,1):window.scrollTo(0,0)),this._iterations--,(t||window.innerHeight>this._startHeight||this._iterations<0)&&(document.documentElement.style.minHeight=window.innerHeight+"px",this.incorrectOrientation?this.setMaximum():this.isFullScreen?this.fullScreenScaleMode===i.ScaleManager.EXACT_FIT?this.setExactFit():this.fullScreenScaleMode===i.ScaleManager.SHOW_ALL&&this.setShowAll():this.scaleMode===i.ScaleManager.EXACT_FIT?this.setExactFit():this.scaleMode===i.ScaleManager.SHOW_ALL&&this.setShowAll(),this.setSize(),clearInterval(this._check),this._check=null)},setSize:function(){this.incorrectOrientation||(this.maxWidth&&this.width>this.maxWidth&&(this.width=this.maxWidth),this.maxHeight&&this.height>this.maxHeight&&(this.height=this.maxHeight),this.minWidth&&this.width<this.minWidth&&(this.width=this.minWidth),this.minHeight&&this.height<this.minHeight&&(this.height=this.minHeight)),this.game.canvas.style.width=this.width+"px",this.game.canvas.style.height=this.height+"px",this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.pageAlignHorizontally&&(this.width<window.innerWidth&&!this.incorrectOrientation?(this.margin.x=Math.round((window.innerWidth-this.width)/2),this.game.canvas.style.marginLeft=this.margin.x+"px"):(this.margin.x=0,this.game.canvas.style.marginLeft="0px")),this.pageAlignVertically&&(this.height<window.innerHeight&&!this.incorrectOrientation?(this.margin.y=Math.round((window.innerHeight-this.height)/2),this.game.canvas.style.marginTop=this.margin.y+"px"):(this.margin.y=0,this.game.canvas.style.marginTop="0px")),i.Canvas.getOffset(this.game.canvas,this.game.stage.offset),this.bounds.setTo(this.game.stage.offset.x,this.game.stage.offset.y,this.width,this.height),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.scaleFactorInversed.x=this.width/this.game.width,this.scaleFactorInversed.y=this.height/this.game.height,this.hasResized.dispatch(this.width,this.height),this.checkOrientationState()},setMaximum:function(){this.width=window.innerWidth,this.height=window.innerHeight},setShowAll:function(){var t=Math.min(window.innerHeight/this.game.height,window.innerWidth/this.game.width);this.width=Math.round(this.game.width*t),this.height=Math.round(this.game.height*t)},setExactFit:function(){var t=window.innerWidth,e=window.innerHeight;this.width=this.maxWidth&&t>this.maxWidth?this.maxWidth:t,this.height=this.maxHeight&&e>this.maxHeight?this.maxHeight:e}},i.ScaleManager.prototype.constructor=i.ScaleManager,Object.defineProperty(i.ScaleManager.prototype,"isFullScreen",{get:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(i.ScaleManager.prototype,"isPortrait",{get:function(){return 0===this.orientation||180===this.orientation}}),Object.defineProperty(i.ScaleManager.prototype,"isLandscape",{get:function(){return 90===this.orientation||-90===this.orientation}}),i.Game=function(t,e,n,r,s,o,a,h){this.id=i.GAMES.push(this)-1,this.config=null,this.physicsConfig=h,this.parent="",this.width=800,this.height=600,this.transparent=!1,this.antialias=!0,this.renderer=null,this.renderType=i.AUTO,this.state=null,this.isBooted=!1,this.isRunning=!1,this.raf=null,this.add=null,this.make=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.net=null,this.scale=null,this.sound=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.physics=null,this.rnd=null,this.device=null,this.camera=null,this.canvas=null,this.context=null,this.debug=null,this.particles=null,this.stepping=!1,this.pendingStep=!1,this.stepCount=0,this.onPause=null,this.onResume=null,this.onBlur=null,this.onFocus=null,this._paused=!1,this._codePaused=!1,1===arguments.length&&"object"==typeof arguments[0]?this.parseConfig(arguments[0]):("undefined"!=typeof t&&(this.width=t),"undefined"!=typeof e&&(this.height=e),"undefined"!=typeof n&&(this.renderer=n,this.renderType=n),"undefined"!=typeof r&&(this.parent=r),"undefined"!=typeof o&&(this.transparent=o),"undefined"!=typeof a&&(this.antialias=a),this.rnd=new i.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new i.StateManager(this,s));
var u=this;return this._onBoot=function(){return u.boot()},"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(this._onBoot,0):(document.addEventListener("DOMContentLoaded",this._onBoot,!1),window.addEventListener("load",this._onBoot,!1)),this},i.Game.prototype={parseConfig:function(t){this.config=t,t.width&&(this.width=i.Utils.parseDimension(t.width,0)),t.height&&(this.height=i.Utils.parseDimension(t.height,1)),t.renderer&&(this.renderer=t.renderer,this.renderType=t.renderer),t.parent&&(this.parent=t.parent),t.transparent&&(this.transparent=t.transparent),t.antialias&&(this.antialias=t.antialias),t.physicsConfig&&(this.physicsConfig=t.physicsConfig);var e=[(Date.now()*Math.random()).toString()];t.seed&&(e=t.seed),this.rnd=new i.RandomDataGenerator(e);var n=null;t.state&&(n=t.state),this.state=new i.StateManager(this,n)},boot:function(){this.isBooted||(document.body?(document.removeEventListener("DOMContentLoaded",this._onBoot),window.removeEventListener("load",this._onBoot),this.onPause=new i.Signal,this.onResume=new i.Signal,this.onBlur=new i.Signal,this.onFocus=new i.Signal,this.isBooted=!0,this.device=new i.Device(this),this.math=i.Math,this.stage=new i.Stage(this,this.width,this.height),this.scale=new i.ScaleManager(this,this.width,this.height),this.setUpRenderer(),this.device.checkFullScreenSupport(),this.world=new i.World(this),this.add=new i.GameObjectFactory(this),this.make=new i.GameObjectCreator(this),this.cache=new i.Cache(this),this.load=new i.Loader(this),this.time=new i.Time(this),this.tweens=new i.TweenManager(this),this.input=new i.Input(this),this.sound=new i.SoundManager(this),this.physics=new i.Physics(this,this.physicsConfig),this.particles=new i.Particles(this),this.plugins=new i.PluginManager(this),this.net=new i.Net(this),this.debug=new i.Utils.Debug(this),this.scratch=new i.BitmapData(this,"__root",1024,1024),this.time.boot(),this.stage.boot(),this.world.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.debug.boot(),this.showDebugHeader(),this.isRunning=!0,this.raf=this.config&&this.config.forceSetTimeOut?new i.RequestAnimationFrame(this,this.config.forceSetTimeOut):new i.RequestAnimationFrame(this,!1),this.raf.start()):window.setTimeout(this._onBoot,20))},showDebugHeader:function(){var t=i.VERSION,e="Canvas",n="HTML Audio",r=1;if(this.renderType===i.WEBGL?(e="WebGL",r++):this.renderType==i.HEADLESS&&(e="Headless"),this.device.webAudio&&(n="WebAudio",r++),this.device.chrome){for(var s=["%c %c %c Phaser v"+t+" - "+e+" - "+n+"  %c %c  http://phaser.io  %c %c ♥%c♥%c♥ ","background: #0cf300","background: #00bc17","color: #ffffff; background: #00711f;","background: #00bc17","background: #0cf300","background: #00bc17"],o=0;3>o;o++)r>o?s.push("color: #ff2424; background: #fff"):s.push("color: #959595; background: #fff");console.log.apply(console,s)}else window.console&&console.log("Phaser v"+t+" - Renderer: "+e+" - Audio: "+n+" - http://phaser.io")},setUpRenderer:function(){if(this.device.trident&&(this.renderType=i.CANVAS),this.renderType===i.HEADLESS||this.renderType===i.CANVAS||this.renderType===i.AUTO&&this.device.webGL===!1){if(!this.device.canvas)throw new Error("Phaser.Game - cannot create Canvas or WebGL context, aborting.");this.renderType===i.AUTO&&(this.renderType=i.CANVAS),this.renderer=new PIXI.CanvasRenderer(this.width,this.height,this.canvas,this.transparent),this.context=this.renderer.context}else this.renderType=i.WEBGL,this.renderer=new PIXI.WebGLRenderer(this.width,this.height,this.canvas,this.transparent,this.antialias),this.context=null;this.renderType!==i.HEADLESS&&(this.stage.smoothed=this.antialias,i.Canvas.addToDOM(this.canvas,this.parent,!0),i.Canvas.setTouchAction(this.canvas))},update:function(t){this.time.update(t),this._paused||this.pendingStep?(this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.debug.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(),this.plugins.preUpdate(),this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate()),this.renderType!=i.HEADLESS&&(this.renderer.render(this.stage),this.plugins.render(),this.state.render(),this.plugins.postRender())},enableStep:function(){this.stepping=!0,this.pendingStep=!1,this.stepCount=0},disableStep:function(){this.stepping=!1,this.pendingStep=!1},step:function(){this.pendingStep=!1,this.stepCount++},destroy:function(){this.raf.stop(),this.input.destroy(),this.state.destroy(),this.physics.destroy(),this.state=null,this.cache=null,this.input=null,this.load=null,this.sound=null,this.stage=null,this.time=null,this.world=null,this.isBooted=!1},gamePaused:function(t){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.setMute(),this.onPause.dispatch(t))},gameResumed:function(t){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.unsetMute(),this.onResume.dispatch(t))},focusLoss:function(t){this.onBlur.dispatch(t),this.gamePaused(t)},focusGain:function(t){this.onFocus.dispatch(t),this.gameResumed(t)}},i.Game.prototype.constructor=i.Game,Object.defineProperty(i.Game.prototype,"paused",{get:function(){return this._paused},set:function(t){t===!0?this._paused===!1&&(this._paused=!0,this._codePaused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)):this._paused&&(this._paused=!1,this._codePaused=!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this))}}),i.Input=function(t){this.game=t,this.hitCanvas=null,this.hitContext=null,this.moveCallbacks=[],this.moveCallback=null,this.moveCallbackContext=this,this.pollRate=0,this.disabled=!1,this.multiInputOverride=i.Input.MOUSE_TOUCH_COMBINE,this.position=null,this.speed=null,this.circle=null,this.scale=null,this.maxPointers=10,this.currentPointers=0,this.tapRate=200,this.doubleTapRate=300,this.holdRate=2e3,this.justPressedRate=200,this.justReleasedRate=200,this.recordPointerHistory=!1,this.recordRate=100,this.recordLimit=100,this.pointer1=null,this.pointer2=null,this.pointer3=null,this.pointer4=null,this.pointer5=null,this.pointer6=null,this.pointer7=null,this.pointer8=null,this.pointer9=null,this.pointer10=null,this.activePointer=null,this.mousePointer=null,this.mouse=null,this.keyboard=null,this.touch=null,this.mspointer=null,this.gamepad=null,this.resetLocked=!1,this.onDown=null,this.onUp=null,this.onTap=null,this.onHold=null,this.minPriorityID=0,this.interactiveItems=new i.ArrayList,this._localPoint=new i.Point,this._pollCounter=0,this._oldPosition=null,this._x=0,this._y=0},i.Input.MOUSE_OVERRIDES_TOUCH=0,i.Input.TOUCH_OVERRIDES_MOUSE=1,i.Input.MOUSE_TOUCH_COMBINE=2,i.Input.prototype={boot:function(){this.mousePointer=new i.Pointer(this.game,0),this.pointer1=new i.Pointer(this.game,1),this.pointer2=new i.Pointer(this.game,2),this.mouse=new i.Mouse(this.game),this.keyboard=new i.Keyboard(this.game),this.touch=new i.Touch(this.game),this.mspointer=new i.MSPointer(this.game),this.gamepad=new i.Gamepad(this.game),this.onDown=new i.Signal,this.onUp=new i.Signal,this.onTap=new i.Signal,this.onHold=new i.Signal,this.scale=new i.Point(1,1),this.speed=new i.Point,this.position=new i.Point,this._oldPosition=new i.Point,this.circle=new i.Circle(0,0,44),this.activePointer=this.mousePointer,this.currentPointers=0,this.hitCanvas=document.createElement("canvas"),this.hitCanvas.width=1,this.hitCanvas.height=1,this.hitContext=this.hitCanvas.getContext("2d"),this.mouse.start(),this.keyboard.start(),this.touch.start(),this.mspointer.start(),this.mousePointer.active=!0},destroy:function(){this.mouse.stop(),this.keyboard.stop(),this.touch.stop(),this.mspointer.stop(),this.gamepad.stop(),this.moveCallbacks=[],this.moveCallback=null},setMoveCallback:function(t,e){this.moveCallback=t,this.moveCallbackContext=e},addMoveCallback:function(t,e){return this.moveCallbacks.push({callback:t,context:e})-1},deleteMoveCallback:function(t){this.moveCallbacks[t]&&this.moveCallbacks.splice(t,1)},addPointer:function(){for(var t=0,e=10;e>0;e--)null===this["pointer"+e]&&(t=e);return 0===t?(console.warn("You can only have 10 Pointer objects"),null):(this["pointer"+t]=new i.Pointer(this.game,t),this["pointer"+t])},update:function(){return this.keyboard.update(),this.pollRate>0&&this._pollCounter<this.pollRate?(this._pollCounter++,void 0):(this.speed.x=this.position.x-this._oldPosition.x,this.speed.y=this.position.y-this._oldPosition.y,this._oldPosition.copyFrom(this.position),this.mousePointer.update(),this.gamepad.active&&this.gamepad.update(),this.pointer1.update(),this.pointer2.update(),this.pointer3&&this.pointer3.update(),this.pointer4&&this.pointer4.update(),this.pointer5&&this.pointer5.update(),this.pointer6&&this.pointer6.update(),this.pointer7&&this.pointer7.update(),this.pointer8&&this.pointer8.update(),this.pointer9&&this.pointer9.update(),this.pointer10&&this.pointer10.update(),this._pollCounter=0,void 0)},reset:function(t){if(this.game.isBooted&&!this.resetLocked){"undefined"==typeof t&&(t=!1),this.keyboard.reset(t),this.mousePointer.reset(),this.gamepad.reset();for(var e=1;10>=e;e++)this["pointer"+e]&&this["pointer"+e].reset();this.currentPointers=0,"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit"),t&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new i.Signal,this.onUp=new i.Signal,this.onTap=new i.Signal,this.onHold=new i.Signal,this.moveCallbacks=[]),this._pollCounter=0}},resetSpeed:function(t,e){this._oldPosition.setTo(t,e),this.speed.setTo(0,0)},startPointer:function(t){if(this.maxPointers<10&&this.totalActivePointers==this.maxPointers)return null;if(this.pointer1.active===!1)return this.pointer1.start(t);if(this.pointer2.active===!1)return this.pointer2.start(t);for(var e=3;10>=e;e++)if(this["pointer"+e]&&this["pointer"+e].active===!1)return this["pointer"+e].start(t);return null},updatePointer:function(t){if(this.pointer1.active&&this.pointer1.identifier==t.identifier)return this.pointer1.move(t);if(this.pointer2.active&&this.pointer2.identifier==t.identifier)return this.pointer2.move(t);for(var e=3;10>=e;e++)if(this["pointer"+e]&&this["pointer"+e].active&&this["pointer"+e].identifier==t.identifier)return this["pointer"+e].move(t);return null},stopPointer:function(t){if(this.pointer1.active&&this.pointer1.identifier==t.identifier)return this.pointer1.stop(t);if(this.pointer2.active&&this.pointer2.identifier==t.identifier)return this.pointer2.stop(t);for(var e=3;10>=e;e++)if(this["pointer"+e]&&this["pointer"+e].active&&this["pointer"+e].identifier==t.identifier)return this["pointer"+e].stop(t);return null},getPointer:function(t){if(t=t||!1,this.pointer1.active==t)return this.pointer1;if(this.pointer2.active==t)return this.pointer2;for(var e=3;10>=e;e++)if(this["pointer"+e]&&this["pointer"+e].active==t)return this["pointer"+e];return null},getPointerFromIdentifier:function(t){if(this.pointer1.identifier===t)return this.pointer1;if(this.pointer2.identifier===t)return this.pointer2;for(var e=3;10>=e;e++)if(this["pointer"+e]&&this["pointer"+e].identifier===t)return this["pointer"+e];return null},getPointerFromId:function(t){if(this.pointer1.pointerId===t)return this.pointer1;if(this.pointer2.pointerId===t)return this.pointer2;for(var e=3;10>=e;e++)if(this["pointer"+e]&&this["pointer"+e].pointerId===t)return this["pointer"+e];return null},getLocalPosition:function(t,e,n){"undefined"==typeof n&&(n=new i.Point);var r=t.worldTransform,s=1/(r.a*r.d+r.b*-r.c);return n.setTo(r.d*s*e.x+-r.b*s*e.y+(r.ty*r.b-r.tx*r.d)*s,r.a*s*e.y+-r.c*s*e.x+(-r.ty*r.a+r.tx*r.c)*s)},hitTest:function(t,e,n){if(!t.worldVisible)return!1;if(this.getLocalPosition(t,e,this._localPoint),n.copyFrom(this._localPoint),t.hitArea&&t.hitArea.contains)return t.hitArea.contains(this._localPoint.x,this._localPoint.y)?!0:!1;if(t instanceof i.TileSprite){var r=t.width,s=t.height,o=-r*t.anchor.x;if(this._localPoint.x>o&&this._localPoint.x<o+r){var a=-s*t.anchor.y;if(this._localPoint.y>a&&this._localPoint.y<a+s)return!0}}else if(t instanceof PIXI.Sprite){var r=t.texture.frame.width,s=t.texture.frame.height,o=-r*t.anchor.x;if(this._localPoint.x>o&&this._localPoint.x<o+r){var a=-s*t.anchor.y;if(this._localPoint.y>a&&this._localPoint.y<a+s)return!0}}for(var h=0,u=t.children.length;u>h;h++)if(this.hitTest(t.children[h],e,n))return!0;return!1}},i.Input.prototype.constructor=i.Input,Object.defineProperty(i.Input.prototype,"x",{get:function(){return this._x},set:function(t){this._x=Math.floor(t)}}),Object.defineProperty(i.Input.prototype,"y",{get:function(){return this._y},set:function(t){this._y=Math.floor(t)}}),Object.defineProperty(i.Input.prototype,"pollLocked",{get:function(){return this.pollRate>0&&this._pollCounter<this.pollRate}}),Object.defineProperty(i.Input.prototype,"totalInactivePointers",{get:function(){return 10-this.currentPointers}}),Object.defineProperty(i.Input.prototype,"totalActivePointers",{get:function(){this.currentPointers=0;for(var t=1;10>=t;t++)this["pointer"+t]&&this["pointer"+t].active&&this.currentPointers++;return this.currentPointers}}),Object.defineProperty(i.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}}),Object.defineProperty(i.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}}),i.Key=function(t,e){this.game=t,this.enabled=!0,this.event=null,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.timeDown=0,this.duration=0,this.timeUp=-2500,this.repeats=0,this.keyCode=e,this.onDown=new i.Signal,this.onHoldCallback=null,this.onHoldContext=null,this.onUp=new i.Signal},i.Key.prototype={update:function(){this.enabled&&this.isDown&&(this.duration=this.game.time.now-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(t){this.enabled&&(this.event=t,this.isDown||(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.now,this.duration=0,this.repeats=0,this.onDown.dispatch(this)))},processKeyUp:function(t){this.enabled&&(this.event=t,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.now,this.duration=this.game.time.now-this.timeDown,this.onUp.dispatch(this)))},reset:function(t){"undefined"==typeof t&&(t=!0),this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.now,this.duration=this.game.time.now-this.timeDown,this.enabled=!0,t&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldCallback=null,this.onHoldContext=null)},justPressed:function(t){return"undefined"==typeof t&&(t=50),this.isDown&&this.duration<t},justReleased:function(t){return"undefined"==typeof t&&(t=50),!this.isDown&&this.game.time.now-this.timeUp<t}},i.Key.prototype.constructor=i.Key,i.Keyboard=function(t){this.game=t,this.disabled=!1,this.event=null,this.callbackContext=this,this.onDownCallback=null,this.onUpCallback=null,this._keys=[],this._capture=[],this._onKeyDown=null,this._onKeyUp=null,this._i=0},i.Keyboard.prototype={addCallbacks:function(t,e,i){this.callbackContext=t,this.onDownCallback=e,"undefined"!=typeof i&&(this.onUpCallback=i)},addKey:function(t){return this._keys[t]||(this._keys[t]=new i.Key(this.game,t),this.addKeyCapture(t)),this._keys[t]},removeKey:function(t){this._keys[t]&&(this._keys[t]=null,this.removeKeyCapture(t))},createCursorKeys:function(){return{up:this.addKey(i.Keyboard.UP),down:this.addKey(i.Keyboard.DOWN),left:this.addKey(i.Keyboard.LEFT),right:this.addKey(i.Keyboard.RIGHT)}},start:function(){if(null===this._onKeyDown){var t=this;this._onKeyDown=function(e){return t.processKeyDown(e)},this._onKeyUp=function(e){return t.processKeyUp(e)},window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1)}},stop:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this._onKeyDown=null,this._onKeyUp=null},destroy:function(){this.stop(),this.clearCaptures(),this._keys.length=0,this._i=0},addKeyCapture:function(t){if("object"==typeof t)for(var e in t)this._capture[t[e]]=!0;else this._capture[t]=!0},removeKeyCapture:function(t){delete this._capture[t]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&this._keys[this._i].update()},processKeyDown:function(t){this.event=t,this.game.input.disabled||this.disabled||(this._capture[t.keyCode]&&t.preventDefault(),this.onDownCallback&&this.onDownCallback.call(this.callbackContext,t),this._keys[t.keyCode]||(this._keys[t.keyCode]=new i.Key(this.game,t.keyCode)),this._keys[t.keyCode].processKeyDown(t))},processKeyUp:function(t){this.event=t,this.game.input.disabled||this.disabled||(this._capture[t.keyCode]&&t.preventDefault(),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,t),this._keys[t.keyCode]||(this._keys[t.keyCode]=new i.Key(this.game,t.keyCode)),this._keys[t.keyCode].processKeyUp(t))},reset:function(t){"undefined"==typeof t&&(t=!0),this.event=null;for(var e=this._keys.length;e--;)this._keys[e]&&this._keys[e].reset(t)},justPressed:function(t,e){return"undefined"==typeof e&&(e=50),this._keys[t]?this._keys[t].justPressed(e):!1},justReleased:function(t,e){return"undefined"==typeof e&&(e=50),this._keys[t]?this._keys[t].justReleased(e):!1},isDown:function(t){return this._keys[t]?this._keys[t].isDown:!1}},i.Keyboard.prototype.constructor=i.Keyboard,i.Keyboard.A="A".charCodeAt(0),i.Keyboard.B="B".charCodeAt(0),i.Keyboard.C="C".charCodeAt(0),i.Keyboard.D="D".charCodeAt(0),i.Keyboard.E="E".charCodeAt(0),i.Keyboard.F="F".charCodeAt(0),i.Keyboard.G="G".charCodeAt(0),i.Keyboard.H="H".charCodeAt(0),i.Keyboard.I="I".charCodeAt(0),i.Keyboard.J="J".charCodeAt(0),i.Keyboard.K="K".charCodeAt(0),i.Keyboard.L="L".charCodeAt(0),i.Keyboard.M="M".charCodeAt(0),i.Keyboard.N="N".charCodeAt(0),i.Keyboard.O="O".charCodeAt(0),i.Keyboard.P="P".charCodeAt(0),i.Keyboard.Q="Q".charCodeAt(0),i.Keyboard.R="R".charCodeAt(0),i.Keyboard.S="S".charCodeAt(0),i.Keyboard.T="T".charCodeAt(0),i.Keyboard.U="U".charCodeAt(0),i.Keyboard.V="V".charCodeAt(0),i.Keyboard.W="W".charCodeAt(0),i.Keyboard.X="X".charCodeAt(0),i.Keyboard.Y="Y".charCodeAt(0),i.Keyboard.Z="Z".charCodeAt(0),i.Keyboard.ZERO="0".charCodeAt(0),i.Keyboard.ONE="1".charCodeAt(0),i.Keyboard.TWO="2".charCodeAt(0),i.Keyboard.THREE="3".charCodeAt(0),i.Keyboard.FOUR="4".charCodeAt(0),i.Keyboard.FIVE="5".charCodeAt(0),i.Keyboard.SIX="6".charCodeAt(0),i.Keyboard.SEVEN="7".charCodeAt(0),i.Keyboard.EIGHT="8".charCodeAt(0),i.Keyboard.NINE="9".charCodeAt(0),i.Keyboard.NUMPAD_0=96,i.Keyboard.NUMPAD_1=97,i.Keyboard.NUMPAD_2=98,i.Keyboard.NUMPAD_3=99,i.Keyboard.NUMPAD_4=100,i.Keyboard.NUMPAD_5=101,i.Keyboard.NUMPAD_6=102,i.Keyboard.NUMPAD_7=103,i.Keyboard.NUMPAD_8=104,i.Keyboard.NUMPAD_9=105,i.Keyboard.NUMPAD_MULTIPLY=106,i.Keyboard.NUMPAD_ADD=107,i.Keyboard.NUMPAD_ENTER=108,i.Keyboard.NUMPAD_SUBTRACT=109,i.Keyboard.NUMPAD_DECIMAL=110,i.Keyboard.NUMPAD_DIVIDE=111,i.Keyboard.F1=112,i.Keyboard.F2=113,i.Keyboard.F3=114,i.Keyboard.F4=115,i.Keyboard.F5=116,i.Keyboard.F6=117,i.Keyboard.F7=118,i.Keyboard.F8=119,i.Keyboard.F9=120,i.Keyboard.F10=121,i.Keyboard.F11=122,i.Keyboard.F12=123,i.Keyboard.F13=124,i.Keyboard.F14=125,i.Keyboard.F15=126,i.Keyboard.COLON=186,i.Keyboard.EQUALS=187,i.Keyboard.UNDERSCORE=189,i.Keyboard.QUESTION_MARK=191,i.Keyboard.TILDE=192,i.Keyboard.OPEN_BRACKET=219,i.Keyboard.BACKWARD_SLASH=220,i.Keyboard.CLOSED_BRACKET=221,i.Keyboard.QUOTES=222,i.Keyboard.BACKSPACE=8,i.Keyboard.TAB=9,i.Keyboard.CLEAR=12,i.Keyboard.ENTER=13,i.Keyboard.SHIFT=16,i.Keyboard.CONTROL=17,i.Keyboard.ALT=18,i.Keyboard.CAPS_LOCK=20,i.Keyboard.ESC=27,i.Keyboard.SPACEBAR=32,i.Keyboard.PAGE_UP=33,i.Keyboard.PAGE_DOWN=34,i.Keyboard.END=35,i.Keyboard.HOME=36,i.Keyboard.LEFT=37,i.Keyboard.UP=38,i.Keyboard.RIGHT=39,i.Keyboard.DOWN=40,i.Keyboard.INSERT=45,i.Keyboard.DELETE=46,i.Keyboard.HELP=47,i.Keyboard.NUM_LOCK=144,i.Mouse=function(t){this.game=t,this.callbackContext=this.game,this.mouseDownCallback=null,this.mouseMoveCallback=null,this.mouseUpCallback=null,this.mouseOutCallback=null,this.mouseOverCallback=null,this.capture=!1,this.button=-1,this.disabled=!1,this.locked=!1,this.stopOnGameOut=!1,this.pointerLock=new i.Signal,this.event=null,this._onMouseDown=null,this._onMouseMove=null,this._onMouseUp=null,this._onMouseOut=null,this._onMouseOver=null},i.Mouse.NO_BUTTON=-1,i.Mouse.LEFT_BUTTON=0,i.Mouse.MIDDLE_BUTTON=1,i.Mouse.RIGHT_BUTTON=2,i.Mouse.prototype={start:function(){if((!this.game.device.android||this.game.device.chrome!==!1)&&null===this._onMouseDown){var t=this;this._onMouseDown=function(e){return t.onMouseDown(e)},this._onMouseMove=function(e){return t.onMouseMove(e)},this._onMouseUp=function(e){return t.onMouseUp(e)},this._onMouseOut=function(e){return t.onMouseOut(e)},this._onMouseOver=function(e){return t.onMouseOver(e)},this.game.canvas.addEventListener("mousedown",this._onMouseDown,!0),this.game.canvas.addEventListener("mousemove",this._onMouseMove,!0),this.game.canvas.addEventListener("mouseup",this._onMouseUp,!0),this.game.canvas.addEventListener("mouseover",this._onMouseOver,!0),this.game.canvas.addEventListener("mouseout",this._onMouseOut,!0)}},onMouseDown:function(t){this.event=t,this.capture&&t.preventDefault(),this.button=t.button,this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,t),this.game.input.disabled||this.disabled||(t.identifier=0,this.game.input.mousePointer.start(t))},onMouseMove:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,t),this.game.input.disabled||this.disabled||(t.identifier=0,this.game.input.mousePointer.move(t))},onMouseUp:function(t){this.event=t,this.capture&&t.preventDefault(),this.button=i.Mouse.NO_BUTTON,this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,t),this.game.input.disabled||this.disabled||(t.identifier=0,this.game.input.mousePointer.stop(t))},onMouseOut:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,t),this.game.input.disabled||this.disabled||(this.game.input.mousePointer.withinGame=!1,this.stopOnGameOut&&(t.identifier=0,this.game.input.mousePointer.stop(t)))},onMouseOver:function(t){this.event=t,this.capture&&t.preventDefault(),this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,t),this.game.input.disabled||this.disabled||(this.game.input.mousePointer.withinGame=!0)},requestPointerLock:function(){if(this.game.device.pointerLock){var t=this.game.canvas;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock();var e=this;this._pointerLockChange=function(t){return e.pointerLockChange(t)},document.addEventListener("pointerlockchange",this._pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},pointerLockChange:function(t){var e=this.game.canvas;document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e?(this.locked=!0,this.pointerLock.dispatch(!0,t)):(this.locked=!1,this.pointerLock.dispatch(!1,t))},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock(),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){this.game.canvas.removeEventListener("mousedown",this._onMouseDown,!0),this.game.canvas.removeEventListener("mousemove",this._onMouseMove,!0),this.game.canvas.removeEventListener("mouseup",this._onMouseUp,!0),this.game.canvas.removeEventListener("mouseover",this._onMouseOver,!0),this.game.canvas.removeEventListener("mouseout",this._onMouseOut,!0)}},i.Mouse.prototype.constructor=i.Mouse,i.MSPointer=function(t){this.game=t,this.callbackContext=this.game,this.disabled=!1,this._onMSPointerDown=null,this._onMSPointerMove=null,this._onMSPointerUp=null},i.MSPointer.prototype={start:function(){if(null===this._onMSPointerDown){var t=this;this.game.device.mspointer===!0&&(this._onMSPointerDown=function(e){return t.onPointerDown(e)},this._onMSPointerMove=function(e){return t.onPointerMove(e)},this._onMSPointerUp=function(e){return t.onPointerUp(e)},this.game.renderer.view.addEventListener("MSPointerDown",this._onMSPointerDown,!1),this.game.renderer.view.addEventListener("MSPointerMove",this._onMSPointerMove,!1),this.game.renderer.view.addEventListener("MSPointerUp",this._onMSPointerUp,!1),this.game.renderer.view.addEventListener("pointerDown",this._onMSPointerDown,!1),this.game.renderer.view.addEventListener("pointerMove",this._onMSPointerMove,!1),this.game.renderer.view.addEventListener("pointerUp",this._onMSPointerUp,!1),this.game.renderer.view.style["-ms-content-zooming"]="none",this.game.renderer.view.style["-ms-touch-action"]="none")}},onPointerDown:function(t){this.game.input.disabled||this.disabled||(t.preventDefault(),t.identifier=t.pointerId,this.game.input.startPointer(t))},onPointerMove:function(t){this.game.input.disabled||this.disabled||(t.preventDefault(),t.identifier=t.pointerId,this.game.input.updatePointer(t))},onPointerUp:function(t){this.game.input.disabled||this.disabled||(t.preventDefault(),t.identifier=t.pointerId,this.game.input.stopPointer(t))},stop:function(){this.game.canvas.removeEventListener("MSPointerDown",this._onMSPointerDown),this.game.canvas.removeEventListener("MSPointerMove",this._onMSPointerMove),this.game.canvas.removeEventListener("MSPointerUp",this._onMSPointerUp),this.game.canvas.removeEventListener("pointerDown",this._onMSPointerDown),this.game.canvas.removeEventListener("pointerMove",this._onMSPointerMove),this.game.canvas.removeEventListener("pointerUp",this._onMSPointerUp)}},i.MSPointer.prototype.constructor=i.MSPointer,i.Pointer=function(t,e){this.game=t,this.id=e,this.type=i.POINTER,this.exists=!0,this.identifier=0,this.pointerId=null,this.target=null,this.button=null,this._holdSent=!1,this._history=[],this._nextDrop=0,this._stateReset=!1,this.withinGame=!1,this.clientX=-1,this.clientY=-1,this.pageX=-1,this.pageY=-1,this.screenX=-1,this.screenY=-1,this.rawMovementX=0,this.rawMovementY=0,this.movementX=0,this.movementY=0,this.x=-1,this.y=-1,this.isMouse=!1,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.previousTapTime=0,this.totalTouches=0,this.msSinceLastClick=Number.MAX_VALUE,this.targetObject=null,this.active=!1,this.position=new i.Point,this.positionDown=new i.Point,this.positionUp=new i.Point,this.circle=new i.Circle(0,0,44),0===e&&(this.isMouse=!0)},i.Pointer.prototype={start:function(t){return t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,"undefined"!=typeof t.button&&(this.button=t.button),this._history=[],this.active=!0,this.withinGame=!0,this.isDown=!0,this.isUp=!1,this.msSinceLastClick=this.game.time.now-this.timeDown,this.timeDown=this.game.time.now,this._holdSent=!1,this.move(t,!0),this.positionDown.setTo(this.x,this.y),(this.game.input.multiInputOverride===i.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===i.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===i.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&(this.game.input.x=this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.x,this.y),this.game.input.onDown.dispatch(this,t),this.game.input.resetSpeed(this.x,this.y)),this._stateReset=!1,this.totalTouches++,this.isMouse||this.game.input.currentPointers++,null!==this.targetObject&&this.targetObject._touchedHandler(this),this},update:function(){this.active&&(this._holdSent===!1&&this.duration>=this.game.input.holdRate&&((this.game.input.multiInputOverride==i.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride==i.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride==i.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&this.game.input.onHold.dispatch(this),this._holdSent=!0),this.game.input.recordPointerHistory&&this.game.time.now>=this._nextDrop&&(this._nextDrop=this.game.time.now+this.game.input.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>this.game.input.recordLimit&&this._history.shift()))},move:function(t,e){if(!this.game.input.pollLocked){if("undefined"==typeof e&&(e=!1),"undefined"!=typeof t.button&&(this.button=t.button),this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY,this.screenX=t.screenX,this.screenY=t.screenY,this.isMouse&&this.game.input.mouse.locked&&!e&&(this.rawMovementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.rawMovementY=t.movementY||t.mozMovementY||t.webkitMovementY||0,this.movementX+=this.rawMovementX,this.movementY+=this.rawMovementY),this.x=(this.pageX-this.game.stage.offset.x)*this.game.input.scale.x,this.y=(this.pageY-this.game.stage.offset.y)*this.game.input.scale.y,this.position.setTo(this.x,this.y),this.circle.x=this.x,this.circle.y=this.y,(this.game.input.multiInputOverride===i.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===i.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===i.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&(this.game.input.activePointer=this,this.game.input.x=this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.game.input.x,this.game.input.y),this.game.input.circle.x=this.game.input.x,this.game.input.circle.y=this.game.input.y),this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY),this.game.paused)return this;this.game.input.moveCallback&&this.game.input.moveCallback.call(this.game.input.moveCallbackContext,this,this.x,this.y);for(var n=this.game.input.moveCallbacks.length;n--;)this.game.input.moveCallbacks[n].callback.call(this.game.input.moveCallbacks[n].context,this,this.x,this.y);if(null!==this.targetObject&&this.targetObject.isDragged===!0)return this.targetObject.update(this)===!1&&(this.targetObject=null),this;if(this._highestRenderOrderID=Number.MAX_SAFE_INTEGER,this._highestRenderObject=null,this._highestInputPriorityID=-1,this.game.input.interactiveItems.total>0){var r=this.game.input.interactiveItems.first;do r&&r.validForInput(this._highestInputPriorityID,this._highestRenderOrderID)&&(!e&&r.checkPointerOver(this)||e&&r.checkPointerDown(this))&&(this._highestRenderOrderID=r.sprite._cache[3],this._highestInputPriorityID=r.priorityID,this._highestRenderObject=r),r=this.game.input.interactiveItems.next;while(null!==r)}return null===this._highestRenderObject?this.targetObject&&(this.targetObject._pointerOutHandler(this),this.targetObject=null):null===this.targetObject?(this.targetObject=this._highestRenderObject,this._highestRenderObject._pointerOverHandler(this)):this.targetObject===this._highestRenderObject?this._highestRenderObject.update(this)===!1&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this),this.targetObject=this._highestRenderObject,this.targetObject._pointerOverHandler(this)),this}},leave:function(t){this.withinGame=!1,this.move(t,!1)},stop:function(t){return this._stateReset?(t.preventDefault(),void 0):(this.timeUp=this.game.time.now,(this.game.input.multiInputOverride===i.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===i.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===i.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.currentPointers)&&(this.game.input.onUp.dispatch(this,t),this.duration>=0&&this.duration<=this.game.input.tapRate&&(this.timeUp-this.previousTapTime<this.game.input.doubleTapRate?this.game.input.onTap.dispatch(this,!0):this.game.input.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp)),this.id>0&&(this.active=!1),this.withinGame=!1,this.isDown=!1,this.isUp=!0,this.pointerId=null,this.identifier=null,this.positionUp.setTo(this.x,this.y),this.isMouse===!1&&this.game.input.currentPointers--,this.game.input.interactiveItems.callAll("_releasedHandler",this),this.targetObject=null,this)
},justPressed:function(t){return t=t||this.game.input.justPressedRate,this.isDown===!0&&this.timeDown+t>this.game.time.now},justReleased:function(t){return t=t||this.game.input.justReleasedRate,this.isUp===!0&&this.timeUp+t>this.game.time.now},reset:function(){this.isMouse===!1&&(this.active=!1),this.pointerId=null,this.identifier=null,this.isDown=!1,this.isUp=!0,this.totalTouches=0,this._holdSent=!1,this._history.length=0,this._stateReset=!0,this.targetObject&&this.targetObject._releasedHandler(this),this.targetObject=null},resetMovement:function(){this.movementX=0,this.movementY=0}},i.Pointer.prototype.constructor=i.Pointer,Object.defineProperty(i.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.now-this.timeDown}}),Object.defineProperty(i.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}}),Object.defineProperty(i.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}}),i.Touch=function(t){this.game=t,this.disabled=!1,this.callbackContext=this.game,this.touchStartCallback=null,this.touchMoveCallback=null,this.touchEndCallback=null,this.touchEnterCallback=null,this.touchLeaveCallback=null,this.touchCancelCallback=null,this.preventDefault=!0,this.event=null,this._onTouchStart=null,this._onTouchMove=null,this._onTouchEnd=null,this._onTouchEnter=null,this._onTouchLeave=null,this._onTouchCancel=null,this._onTouchMove=null},i.Touch.prototype={start:function(){if(null===this._onTouchStart){var t=this;this.game.device.touch&&(this._onTouchStart=function(e){return t.onTouchStart(e)},this._onTouchMove=function(e){return t.onTouchMove(e)},this._onTouchEnd=function(e){return t.onTouchEnd(e)},this._onTouchEnter=function(e){return t.onTouchEnter(e)},this._onTouchLeave=function(e){return t.onTouchLeave(e)},this._onTouchCancel=function(e){return t.onTouchCancel(e)},this.game.canvas.addEventListener("touchstart",this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1))}},consumeDocumentTouches:function(){this._documentTouchMove=function(t){t.preventDefault()},document.addEventListener("touchmove",this._documentTouchMove,!1)},onTouchStart:function(t){if(this.event=t,this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,t),!this.game.input.disabled&&!this.disabled){this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.startPointer(t.changedTouches[e])}},onTouchCancel:function(t){if(this.event=t,this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,t),!this.game.input.disabled&&!this.disabled){this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.stopPointer(t.changedTouches[e])}},onTouchEnter:function(t){console.log("touch enter",t),this.event=t,this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,t),this.game.input.disabled||this.disabled||this.preventDefault&&t.preventDefault()},onTouchLeave:function(t){this.event=t,this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault()},onTouchMove:function(t){this.event=t,this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.updatePointer(t.changedTouches[e])},onTouchEnd:function(t){this.event=t,this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,t),this.preventDefault&&t.preventDefault();for(var e=0;e<t.changedTouches.length;e++)this.game.input.stopPointer(t.changedTouches[e])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel))}},i.Touch.prototype.constructor=i.Touch,i.Gamepad=function(t){this.game=t,this._gamepads=[new i.SinglePad(t,this),new i.SinglePad(t,this),new i.SinglePad(t,this),new i.SinglePad(t,this)],this._gamepadIndexMap={},this._rawPads=[],this._active=!1,this.disabled=!1,this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!=navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads,this._prevRawGamepadTypes=[],this._prevTimestamps=[],this.callbackContext=this,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this._ongamepadconnected=null,this._gamepaddisconnected=null},i.Gamepad.prototype={addCallbacks:function(t,e){"undefined"!=typeof e&&(this.onConnectCallback="function"==typeof e.onConnect?e.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof e.onDisconnect?e.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof e.onDown?e.onDown:this.onDownCallback,this.onUpCallback="function"==typeof e.onUp?e.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof e.onAxis?e.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof e.onFloat?e.onFloat:this.onFloatCallback)},start:function(){if(!this._active){this._active=!0;var t=this;this._ongamepadconnected=function(e){var i=e.gamepad;t._rawPads.push(i),t._gamepads[i.index].connect(i)},window.addEventListener("gamepadconnected",this._ongamepadconnected,!1),this._ongamepaddisconnected=function(e){var i=e.gamepad;for(var n in t._rawPads)t._rawPads[n].index===i.index&&t._rawPads.splice(n,1);t._gamepads[i.index].disconnect()},window.addEventListener("gamepaddisconnected",this._ongamepaddisconnected,!1)}},update:function(){this._pollGamepads();for(var t=0;t<this._gamepads.length;t++)this._gamepads[t]._connected&&this._gamepads[t].pollStatus()},_pollGamepads:function(){var t=navigator.getGamepads||navigator.webkitGetGamepads&&navigator.webkitGetGamepads()||navigator.webkitGamepads;if(t){this._rawPads=[];for(var e=!1,i=0;i<t.length&&(typeof t[i]!==this._prevRawGamepadTypes[i]&&(e=!0,this._prevRawGamepadTypes[i]=typeof t[i]),t[i]&&this._rawPads.push(t[i]),3!==i);i++);if(e){for(var n,r={rawIndices:{},padIndices:{}},s=0;s<this._gamepads.length;s++)if(n=this._gamepads[s],n.connected)for(var o=0;o<this._rawPads.length;o++)this._rawPads[o].index===n.index&&(r.rawIndices[n.index]=!0,r.padIndices[s]=!0);for(var a=0;a<this._gamepads.length;a++)if(n=this._gamepads[a],!r.padIndices[a]){this._rawPads.length<1&&n.disconnect();for(var h=0;h<this._rawPads.length&&!r.padIndices[a];h++){var u=this._rawPads[h];if(u){if(r.rawIndices[u.index]){n.disconnect();continue}n.connect(u),r.rawIndices[u.index]=!0,r.padIndices[a]=!0}else n.disconnect()}}}}},setDeadZones:function(t){for(var e=0;e<this._gamepads.length;e++)this._gamepads[e].deadZone=t},stop:function(){this._active=!1,window.removeEventListener("gamepadconnected",this._ongamepadconnected),window.removeEventListener("gamepaddisconnected",this._ongamepaddisconnected)},reset:function(){this.update();for(var t=0;t<this._gamepads.length;t++)this._gamepads[t].reset()},justPressed:function(t,e){for(var i=0;i<this._gamepads.length;i++)if(this._gamepads[i].justPressed(t,e)===!0)return!0;return!1},justReleased:function(t,e){for(var i=0;i<this._gamepads.length;i++)if(this._gamepads[i].justReleased(t,e)===!0)return!0;return!1},isDown:function(t){for(var e=0;e<this._gamepads.length;e++)if(this._gamepads[e].isDown(t)===!0)return!0;return!1}},i.Gamepad.prototype.constructor=i.Gamepad,Object.defineProperty(i.Gamepad.prototype,"active",{get:function(){return this._active}}),Object.defineProperty(i.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}}),Object.defineProperty(i.Gamepad.prototype,"padsConnected",{get:function(){return this._rawPads.length}}),Object.defineProperty(i.Gamepad.prototype,"pad1",{get:function(){return this._gamepads[0]}}),Object.defineProperty(i.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}}),Object.defineProperty(i.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}}),Object.defineProperty(i.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}}),i.Gamepad.BUTTON_0=0,i.Gamepad.BUTTON_1=1,i.Gamepad.BUTTON_2=2,i.Gamepad.BUTTON_3=3,i.Gamepad.BUTTON_4=4,i.Gamepad.BUTTON_5=5,i.Gamepad.BUTTON_6=6,i.Gamepad.BUTTON_7=7,i.Gamepad.BUTTON_8=8,i.Gamepad.BUTTON_9=9,i.Gamepad.BUTTON_10=10,i.Gamepad.BUTTON_11=11,i.Gamepad.BUTTON_12=12,i.Gamepad.BUTTON_13=13,i.Gamepad.BUTTON_14=14,i.Gamepad.BUTTON_15=15,i.Gamepad.AXIS_0=0,i.Gamepad.AXIS_1=1,i.Gamepad.AXIS_2=2,i.Gamepad.AXIS_3=3,i.Gamepad.AXIS_4=4,i.Gamepad.AXIS_5=5,i.Gamepad.AXIS_6=6,i.Gamepad.AXIS_7=7,i.Gamepad.AXIS_8=8,i.Gamepad.AXIS_9=9,i.Gamepad.XBOX360_A=0,i.Gamepad.XBOX360_B=1,i.Gamepad.XBOX360_X=2,i.Gamepad.XBOX360_Y=3,i.Gamepad.XBOX360_LEFT_BUMPER=4,i.Gamepad.XBOX360_RIGHT_BUMPER=5,i.Gamepad.XBOX360_LEFT_TRIGGER=6,i.Gamepad.XBOX360_RIGHT_TRIGGER=7,i.Gamepad.XBOX360_BACK=8,i.Gamepad.XBOX360_START=9,i.Gamepad.XBOX360_STICK_LEFT_BUTTON=10,i.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11,i.Gamepad.XBOX360_DPAD_LEFT=14,i.Gamepad.XBOX360_DPAD_RIGHT=15,i.Gamepad.XBOX360_DPAD_UP=12,i.Gamepad.XBOX360_DPAD_DOWN=13,i.Gamepad.XBOX360_STICK_LEFT_X=0,i.Gamepad.XBOX360_STICK_LEFT_Y=1,i.Gamepad.XBOX360_STICK_RIGHT_X=2,i.Gamepad.XBOX360_STICK_RIGHT_Y=3,i.SinglePad=function(t,e){this.game=t,this._padParent=e,this._index=null,this._rawPad=null,this._connected=!1,this._prevTimestamp=null,this._rawButtons=[],this._buttons=[],this._axes=[],this._hotkeys=[],this.callbackContext=this,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this.deadZone=.26},i.SinglePad.prototype={addCallbacks:function(t,e){"undefined"!=typeof e&&(this.onConnectCallback="function"==typeof e.onConnect?e.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof e.onDisconnect?e.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof e.onDown?e.onDown:this.onDownCallback,this.onUpCallback="function"==typeof e.onUp?e.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof e.onAxis?e.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof e.onFloat?e.onFloat:this.onFloatCallback)},addButton:function(t){return this._hotkeys[t]=new i.GamepadButton(this.game,t),this._hotkeys[t]},pollStatus:function(){if(!this._rawPad.timestamp||this._rawPad.timestamp!=this._prevTimestamp){for(var t=0;t<this._rawPad.buttons.length;t+=1){var e=this._rawPad.buttons[t];this._rawButtons[t]!==e&&(1===e?this.processButtonDown(t,e):0===e?this.processButtonUp(t,e):this.processButtonFloat(t,e),this._rawButtons[t]=e)}for(var i=this._rawPad.axes,n=0;n<i.length;n+=1){var r=i[n];r>0&&r>this.deadZone||0>r&&r<-this.deadZone?this.processAxisChange({axis:n,value:r}):this.processAxisChange({axis:n,value:0})}this._prevTimestamp=this._rawPad.timestamp}},connect:function(t){var e=!this._connected;this._index=t.index,this._connected=!0,this._rawPad=t,this._rawButtons=t.buttons,this._axes=t.axes,e&&this._padParent.onConnectCallback&&this._padParent.onConnectCallback.call(this._padParent.callbackContext,this._index),e&&this.onConnectCallback&&this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var t=this._connected;this._connected=!1,this._rawPad=void 0,this._rawButtons=[],this._buttons=[];var e=this._index;this._index=null,t&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,e),t&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},processAxisChange:function(t){this.game.input.disabled||this.game.input.gamepad.disabled||this._axes[t.axis]!==t.value&&(this._axes[t.axis]=t.value,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,t,this._index),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,t))},processButtonDown:function(t,e){this.game.input.disabled||this.game.input.gamepad.disabled||(this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,t,e,this._index),this.onDownCallback&&this.onDownCallback.call(this.callbackContext,t,e),this._buttons[t]&&this._buttons[t].isDown?this._buttons[t].duration=this.game.time.now-this._buttons[t].timeDown:this._buttons[t]?(this._buttons[t].isDown=!0,this._buttons[t].timeDown=this.game.time.now,this._buttons[t].duration=0,this._buttons[t].value=e):this._buttons[t]={isDown:!0,timeDown:this.game.time.now,timeUp:0,duration:0,value:e},this._hotkeys[t]&&this._hotkeys[t].processButtonDown(e))},processButtonUp:function(t,e){this.game.input.disabled||this.game.input.gamepad.disabled||(this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,t,e,this._index),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,t,e),this._hotkeys[t]&&this._hotkeys[t].processButtonUp(e),this._buttons[t]?(this._buttons[t].isDown=!1,this._buttons[t].timeUp=this.game.time.now,this._buttons[t].value=e):this._buttons[t]={isDown:!1,timeDown:this.game.time.now,timeUp:this.game.time.now,duration:0,value:e})},processButtonFloat:function(t,e){this.game.input.disabled||this.game.input.gamepad.disabled||(this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,t,e,this._index),this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,t,e),this._buttons[t]?this._buttons[t].value=e:this._buttons[t]={value:e},this._hotkeys[t]&&this._hotkeys[t].processButtonFloat(e))},axis:function(t){return this._axes[t]?this._axes[t]:!1},isDown:function(t){return this._buttons[t]?this._buttons[t].isDown:!1},justReleased:function(t,e){return"undefined"==typeof e&&(e=250),this._buttons[t]&&this._buttons[t].isDown===!1&&this.game.time.now-this._buttons[t].timeUp<e},justPressed:function(t,e){return"undefined"==typeof e&&(e=250),this._buttons[t]&&this._buttons[t].isDown&&this._buttons[t].duration<e},buttonValue:function(t){return this._buttons[t]?this._buttons[t].value:!1},reset:function(){for(var t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(var e=0;e<this._axes.length;e++)this._axes[e]=0}},i.SinglePad.prototype.constructor=i.SinglePad,Object.defineProperty(i.SinglePad.prototype,"connected",{get:function(){return this._connected}}),Object.defineProperty(i.SinglePad.prototype,"index",{get:function(){return this._index}}),i.GamepadButton=function(t,e){this.game=t,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this.value=0,this.buttonCode=e,this.onDown=new i.Signal,this.onUp=new i.Signal,this.onFloat=new i.Signal},i.GamepadButton.prototype={processButtonDown:function(t){this.isDown?(this.duration=this.game.time.now-this.timeDown,this.repeats++):(this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.now,this.duration=0,this.repeats=0,this.value=t,this.onDown.dispatch(this,t))},processButtonUp:function(t){this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.now,this.value=t,this.onUp.dispatch(this,t)},processButtonFloat:function(t){this.value=t,this.onFloat.dispatch(this,t)},justPressed:function(t){return"undefined"==typeof t&&(t=250),this.isDown&&this.duration<t},justReleased:function(t){return"undefined"==typeof t&&(t=250),this.isDown===!1&&this.game.time.now-this.timeUp<t}},i.GamepadButton.prototype.constructor=i.GamepadButton,i.InputHandler=function(t){this.sprite=t,this.game=t.game,this.enabled=!1,this.priorityID=0,this.useHandCursor=!1,this._setHandCursor=!1,this.isDragged=!1,this.allowHorizontalDrag=!0,this.allowVerticalDrag=!0,this.bringToTop=!1,this.snapOffset=null,this.snapOnDrag=!1,this.snapOnRelease=!1,this.snapX=0,this.snapY=0,this.snapOffsetX=0,this.snapOffsetY=0,this.pixelPerfectOver=!1,this.pixelPerfectClick=!1,this.pixelPerfectAlpha=255,this.draggable=!1,this.boundsRect=null,this.boundsSprite=null,this.consumePointerEvent=!1,this._dragPhase=!1,this._wasEnabled=!1,this._tempPoint=new i.Point,this._pointerData=[],this._pointerData.push({id:0,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})},i.InputHandler.prototype={start:function(t,e){if(t=t||0,"undefined"==typeof e&&(e=!1),this.enabled===!1){this.game.input.interactiveItems.add(this),this.useHandCursor=e,this.priorityID=t;for(var n=0;10>n;n++)this._pointerData[n]={id:n,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new i.Point,this.enabled=!0,this._wasEnabled=!0,this.sprite.events&&null===this.sprite.events.onInputOver&&(this.sprite.events.onInputOver=new i.Signal,this.sprite.events.onInputOut=new i.Signal,this.sprite.events.onInputDown=new i.Signal,this.sprite.events.onInputUp=new i.Signal,this.sprite.events.onDragStart=new i.Signal,this.sprite.events.onDragStop=new i.Signal)}return this.sprite.events.onAddedToGroup.add(this.addedToGroup,this),this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this),this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.enabled=!1;for(var t=0;10>t;t++)this._pointerData[t]={id:t,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){this.enabled!==!1&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.boundsRect=null,this.boundsSprite=null,this.sprite=null)},validForInput:function(t,e){return 0===this.sprite.scale.x||0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID?!1:this.pixelPerfectClick||this.pixelPerfectOver?!0:this.priorityID>t||this.priorityID===t&&this.sprite._cache[3]<e?!0:!1},pointerX:function(t){return t=t||0,this._pointerData[t].x},pointerY:function(t){return t=t||0,this._pointerData[t].y},pointerDown:function(t){return t=t||0,this._pointerData[t].isDown},pointerUp:function(t){return t=t||0,this._pointerData[t].isUp},pointerTimeDown:function(t){return t=t||0,this._pointerData[t].timeDown},pointerTimeUp:function(t){return t=t||0,this._pointerData[t].timeUp},pointerOver:function(t){if(this.enabled){if("undefined"!=typeof t)return this._pointerData[t].isOver;for(var e=0;10>e;e++)if(this._pointerData[e].isOver)return!0}return!1},pointerOut:function(t){if(this.enabled){if("undefined"!=typeof t)return this._pointerData[t].isOut;for(var e=0;10>e;e++)if(this._pointerData[e].isOut)return!0}return!1},pointerTimeOver:function(t){return t=t||0,this._pointerData[t].timeOver},pointerTimeOut:function(t){return t=t||0,this._pointerData[t].timeOut},pointerDragged:function(t){return t=t||0,this._pointerData[t].isDragged},checkPointerDown:function(t){return this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible?this.game.input.hitTest(this.sprite,t,this._tempPoint)?this.pixelPerfectClick?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0:!1:!1},checkPointerOver:function(t){return this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible?this.game.input.hitTest(this.sprite,t,this._tempPoint)?this.pixelPerfectOver?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0:!1:!1},checkPixel:function(t,e,i){if(this.sprite.texture.baseTexture.source){if(this.game.input.hitContext.clearRect(0,0,1,1),null===t&&null===e){this.game.input.getLocalPosition(this.sprite,i,this._tempPoint);var t=this._tempPoint.x,e=this._tempPoint.y}0!==this.sprite.anchor.x&&(t-=-this.sprite.texture.frame.width*this.sprite.anchor.x),0!==this.sprite.anchor.y&&(e-=-this.sprite.texture.frame.height*this.sprite.anchor.y),t+=this.sprite.texture.frame.x,e+=this.sprite.texture.frame.y,this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,t,e,1,1,0,0,1,1);var n=this.game.input.hitContext.getImageData(0,0,1,1);if(n.data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(t){return null!==this.sprite&&void 0!==this.sprite.parent?this.enabled&&this.sprite.visible&&this.sprite.parent.visible?this.draggable&&this._draggedPointerID==t.id?this.updateDrag(t):this._pointerData[t.id].isOver===!0?this.checkPointerOver(t)?(this._pointerData[t.id].x=t.x-this.sprite.x,this._pointerData[t.id].y=t.y-this.sprite.y,!0):(this._pointerOutHandler(t),!1):void 0:(this._pointerOutHandler(t),!1):void 0},_pointerOverHandler:function(t){null!==this.sprite&&this._pointerData[t.id].isOver===!1&&(this._pointerData[t.id].isOver=!0,this._pointerData[t.id].isOut=!1,this._pointerData[t.id].timeOver=this.game.time.now,this._pointerData[t.id].x=t.x-this.sprite.x,this._pointerData[t.id].y=t.y-this.sprite.y,this.useHandCursor&&this._pointerData[t.id].isDragged===!1&&(this.game.canvas.style.cursor="pointer",this._setHandCursor=!0),this.sprite&&this.sprite.events&&this.sprite.events.onInputOver.dispatch(this.sprite,t))},_pointerOutHandler:function(t){null!==this.sprite&&(this._pointerData[t.id].isOver=!1,this._pointerData[t.id].isOut=!0,this._pointerData[t.id].timeOut=this.game.time.now,this.useHandCursor&&this._pointerData[t.id].isDragged===!1&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.sprite&&this.sprite.events&&this.sprite.events.onInputOut.dispatch(this.sprite,t))},_touchedHandler:function(t){if(null!==this.sprite){if(this._pointerData[t.id].isDown===!1&&this._pointerData[t.id].isOver===!0){if(this.pixelPerfectClick&&!this.checkPixel(null,null,t))return;this._pointerData[t.id].isDown=!0,this._pointerData[t.id].isUp=!1,this._pointerData[t.id].timeDown=this.game.time.now,this.sprite&&this.sprite.events&&this.sprite.events.onInputDown.dispatch(this.sprite,t),this.draggable&&this.isDragged===!1&&this.startDrag(t),this.bringToTop&&this.sprite.bringToTop()}return this.consumePointerEvent}},_releasedHandler:function(t){null!==this.sprite&&this._pointerData[t.id].isDown&&t.isUp&&(this._pointerData[t.id].isDown=!1,this._pointerData[t.id].isUp=!0,this._pointerData[t.id].timeUp=this.game.time.now,this._pointerData[t.id].downDuration=this._pointerData[t.id].timeUp-this._pointerData[t.id].timeDown,this.checkPointerOver(t)?this.sprite&&this.sprite.events&&this.sprite.events.onInputUp.dispatch(this.sprite,t,!0):(this.sprite&&this.sprite.events&&this.sprite.events.onInputUp.dispatch(this.sprite,t,!1),this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1)),this.draggable&&this.isDragged&&this._draggedPointerID===t.id&&this.stopDrag(t))},updateDrag:function(t){return t.isUp?(this.stopDrag(t),!1):(this.sprite.fixedToCamera?(this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=t.x+this._dragPoint.x+this.dragOffset.x),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=t.y+this._dragPoint.y+this.dragOffset.y),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)):(this.allowHorizontalDrag&&(this.sprite.x=t.x+this._dragPoint.x+this.dragOffset.x),this.allowVerticalDrag&&(this.sprite.y=t.y+this._dragPoint.y+this.dragOffset.y),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)),!0)},justOver:function(t,e){return t=t||0,e=e||500,this._pointerData[t].isOver&&this.overDuration(t)<e},justOut:function(t,e){return t=t||0,e=e||500,this._pointerData[t].isOut&&this.game.time.now-this._pointerData[t].timeOut<e},justPressed:function(t,e){return t=t||0,e=e||500,this._pointerData[t].isDown&&this.downDuration(t)<e},justReleased:function(t,e){return t=t||0,e=e||500,this._pointerData[t].isUp&&this.game.time.now-this._pointerData[t].timeUp<e},overDuration:function(t){return t=t||0,this._pointerData[t].isOver?this.game.time.now-this._pointerData[t].timeOver:-1},downDuration:function(t){return t=t||0,this._pointerData[t].isDown?this.game.time.now-this._pointerData[t].timeDown:-1},enableDrag:function(t,e,n,r,s,o){"undefined"==typeof t&&(t=!1),"undefined"==typeof e&&(e=!1),"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=255),"undefined"==typeof s&&(s=null),"undefined"==typeof o&&(o=null),this._dragPoint=new i.Point,this.draggable=!0,this.bringToTop=e,this.dragOffset=new i.Point,this.dragFromCenter=t,this.pixelPerfect=n,this.pixelPerfectAlpha=r,s&&(this.boundsRect=s),o&&(this.boundsSprite=o)},disableDrag:function(){if(this._pointerData)for(var t=0;10>t;t++)this._pointerData[t].isDragged=!1;this.draggable=!1,this.isDragged=!1,this._draggedPointerID=-1},startDrag:function(t){if(this.isDragged=!0,this._draggedPointerID=t.id,this._pointerData[t.id].isDragged=!0,this.sprite.fixedToCamera)this.dragFromCenter?(this.sprite.centerOn(t.x,t.y),this._dragPoint.setTo(this.sprite.cameraOffset.x-t.x,this.sprite.cameraOffset.y-t.y)):this._dragPoint.setTo(this.sprite.cameraOffset.x-t.x,this.sprite.cameraOffset.y-t.y);else if(this.dragFromCenter){var e=this.sprite.getBounds();this.sprite.x=t.x+(this.sprite.x-e.centerX),this.sprite.y=t.y+(this.sprite.y-e.centerY),this._dragPoint.setTo(this.sprite.x-t.x,this.sprite.y-t.y)}else this._dragPoint.setTo(this.sprite.x-t.x,this.sprite.y-t.y);this.updateDrag(t),this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop()),this.sprite.events.onDragStart.dispatch(this.sprite,t)},stopDrag:function(t){this.isDragged=!1,this._draggedPointerID=-1,this._pointerData[t.id].isDragged=!1,this._dragPhase=!1,this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)),this.sprite.events.onDragStop.dispatch(this.sprite,t),this.checkPointerOver(t)===!1&&this._pointerOutHandler(t)},setDragLock:function(t,e){"undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=!0),this.allowHorizontalDrag=t,this.allowVerticalDrag=e},enableSnap:function(t,e,i,n,r,s){"undefined"==typeof i&&(i=!0),"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=0),"undefined"==typeof s&&(s=0),this.snapX=t,this.snapY=e,this.snapOffsetX=r,this.snapOffsetY=s,this.snapOnDrag=i,this.snapOnRelease=n},disableSnap:function(){this.snapOnDrag=!1,this.snapOnRelease=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=this.boundsRect.cameraOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.x<this.boundsRect.left?this.sprite.x=this.boundsRect.x:this.sprite.x+this.sprite.width>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-this.sprite.width),this.sprite.y<this.boundsRect.top?this.sprite.y=this.boundsRect.top:this.sprite.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-this.sprite.height))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.camerOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.camerOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.camerOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.camerOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.camerOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.camerOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.camerOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.camerOffset.y+this.boundsSprite.height-this.sprite.height)):(this.sprite.x<this.boundsSprite.x?this.sprite.x=this.boundsSprite.x:this.sprite.x+this.sprite.width>this.boundsSprite.x+this.boundsSprite.width&&(this.sprite.x=this.boundsSprite.x+this.boundsSprite.width-this.sprite.width),this.sprite.y<this.boundsSprite.y?this.sprite.y=this.boundsSprite.y:this.sprite.y+this.sprite.height>this.boundsSprite.y+this.boundsSprite.height&&(this.sprite.y=this.boundsSprite.y+this.boundsSprite.height-this.sprite.height))}},i.InputHandler.prototype.constructor=i.InputHandler,i.Events=function(t){this.parent=t,this.onAddedToGroup=new i.Signal,this.onRemovedFromGroup=new i.Signal,this.onKilled=new i.Signal,this.onRevived=new i.Signal,this.onOutOfBounds=new i.Signal,this.onEnterBounds=new i.Signal,this.onInputOver=null,this.onInputOut=null,this.onInputDown=null,this.onInputUp=null,this.onDragStart=null,this.onDragStop=null,this.onAnimationStart=null,this.onAnimationComplete=null,this.onAnimationLoop=null},i.Events.prototype={destroy:function(){this.parent=null,this.onAddedToGroup.dispose(),this.onRemovedFromGroup.dispose(),this.onKilled.dispose(),this.onRevived.dispose(),this.onOutOfBounds.dispose(),this.onInputOver&&(this.onInputOver.dispose(),this.onInputOut.dispose(),this.onInputDown.dispose(),this.onInputUp.dispose(),this.onDragStart.dispose(),this.onDragStop.dispose()),this.onAnimationStart&&(this.onAnimationStart.dispose(),this.onAnimationComplete.dispose(),this.onAnimationLoop.dispose())}},i.Events.prototype.constructor=i.Events,i.GameObjectFactory=function(t){this.game=t,this.world=this.game.world},i.GameObjectFactory.prototype={existing:function(t){return this.world.add(t)},image:function(t,e,n,r,s){return"undefined"==typeof s&&(s=this.world),s.add(new i.Image(this.game,t,e,n,r))},sprite:function(t,e,i,n,r){return"undefined"==typeof r&&(r=this.world),r.create(t,e,i,n)},tween:function(t){return this.game.tweens.create(t)},group:function(t,e,n,r,s){return new i.Group(this.game,t,e,n,r,s)},physicsGroup:function(t,e,n,r){return new i.Group(this.game,e,n,r,!0,t)},spriteBatch:function(t,e,n){return"undefined"==typeof e&&(e="group"),"undefined"==typeof n&&(n=!1),new i.SpriteBatch(this.game,t,e,n)},audio:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},sound:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},tileSprite:function(t,e,n,r,s,o,a){return"undefined"==typeof a&&(a=this.world),a.add(new i.TileSprite(this.game,t,e,n,r,s,o))},text:function(t,e,n,r,s){return"undefined"==typeof s&&(s=this.world),s.add(new i.Text(this.game,t,e,n,r))},button:function(t,e,n,r,s,o,a,h,u,c){return"undefined"==typeof c&&(c=this.world),c.add(new i.Button(this.game,t,e,n,r,s,o,a,h,u))
},graphics:function(t,e,n){return"undefined"==typeof n&&(n=this.world),n.add(new i.Graphics(this.game,t,e))},emitter:function(t,e,n){return this.game.particles.add(new i.Particles.Arcade.Emitter(this.game,t,e,n))},retroFont:function(t,e,n,r,s,o,a,h,u){return new i.RetroFont(this.game,t,e,n,r,s,o,a,h,u)},bitmapText:function(t,e,n,r,s,o){return"undefined"==typeof o&&(o=this.world),o.add(new i.BitmapText(this.game,t,e,n,r,s))},tilemap:function(t,e,n,r,s){return new i.Tilemap(this.game,t,e,n,r,s)},renderTexture:function(t,e,n,r){("undefined"==typeof n||""===n)&&(n=this.game.rnd.uuid()),"undefined"==typeof r&&(r=!1);var s=new i.RenderTexture(this.game,t,e,n);return r&&this.game.cache.addRenderTexture(n,s),s},bitmapData:function(t,e,n,r){"undefined"==typeof r&&(r=!1),("undefined"==typeof n||""===n)&&(n=this.game.rnd.uuid());var s=new i.BitmapData(this.game,n,t,e);return r&&this.game.cache.addBitmapData(n,s),s},filter:function(t){var e=Array.prototype.splice.call(arguments,1),t=new i.Filter[t](this.game);return t.init.apply(t,e),t}},i.GameObjectFactory.prototype.constructor=i.GameObjectFactory,i.GameObjectCreator=function(t){this.game=t,this.world=this.game.world},i.GameObjectCreator.prototype={image:function(t,e,n,r){return new i.Image(this.game,t,e,n,r)},sprite:function(t,e,n,r){return new i.Sprite(this.game,t,e,n,r)},tween:function(t){return new i.Tween(t,this.game)},group:function(t,e,n,r,s){return new i.Group(this.game,null,e,n,r,s)},spriteBatch:function(t,e,n){return"undefined"==typeof e&&(e="group"),"undefined"==typeof n&&(n=!1),new i.SpriteBatch(this.game,t,e,n)},audio:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},sound:function(t,e,i,n){return this.game.sound.add(t,e,i,n)},tileSprite:function(t,e,n,r,s,o){return new i.TileSprite(this.game,t,e,n,r,s,o)},text:function(t,e,n,r){return new i.Text(this.game,t,e,n,r)},button:function(t,e,n,r,s,o,a,h,u){return new i.Button(this.game,t,e,n,r,s,o,a,h,u)},graphics:function(t,e){return new i.Graphics(this.game,t,e)},emitter:function(t,e,n){return new i.Particles.Arcade.Emitter(this.game,t,e,n)},retroFont:function(t,e,n,r,s,o,a,h,u){return new i.RetroFont(this.game,t,e,n,r,s,o,a,h,u)},bitmapText:function(t,e,n,r,s){return new i.BitmapText(this.game,t,e,n,r,s)},tilemap:function(t,e,n,r,s){return new i.Tilemap(this.game,t,e,n,r,s)},renderTexture:function(t,e,n,r){("undefined"==typeof n||""===n)&&(n=this.game.rnd.uuid()),"undefined"==typeof r&&(r=!1);var s=new i.RenderTexture(this.game,t,e,n);return r&&this.game.cache.addRenderTexture(n,s),s},bitmapData:function(t,e,n,r){"undefined"==typeof r&&(r=!1),("undefined"==typeof n||""===n)&&(n=this.game.rnd.uuid());var s=new i.BitmapData(this.game,n,t,e);return r&&this.game.cache.addBitmapData(n,s),s},filter:function(t){var e=Array.prototype.splice.call(arguments,1),t=new i.Filter[t](this.game);return t.init.apply(t,e),t}},i.GameObjectCreator.prototype.constructor=i.GameObjectCreator,i.BitmapData=function(t,e,n,r){"undefined"==typeof n&&(n=100),"undefined"==typeof r&&(r=100),this.game=t,this.key=e,this.width=n,this.height=r,this.canvas=i.Canvas.create(n,r,"",!0),this.context=this.canvas.getContext("2d"),this.ctx=this.context,this.imageData=this.context.getImageData(0,0,n,r),this.data=this.imageData.data,this.pixels=null,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.baseTexture=new PIXI.BaseTexture(this.canvas),this.texture=new PIXI.Texture(this.baseTexture),this.textureFrame=new i.Frame(0,0,0,n,r,"bitmapData",t.rnd.uuid()),this.type=i.BITMAPDATA,this.disableTextureUpload=!1,this.dirty=!1,this.cls=this.clear,this.update=this.refreshBuffer,this._tempR=0,this._tempG=0,this._tempB=0},i.BitmapData.prototype={add:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].loadTexture&&t[e].loadTexture(this);else t.loadTexture(this)},clear:function(){this.context.clearRect(0,0,this.width,this.height),this.dirty=!0},fill:function(t,e,i,n){"undefined"==typeof n&&(n=1),this.context.fillStyle="rgba("+t+","+e+","+i+","+n+")",this.context.fillRect(0,0,this.width,this.height),this.dirty=!0},resize:function(t,e){(t!==this.width||e!==this.height)&&(this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e,this.textureFrame.width=t,this.textureFrame.height=e,this.refreshBuffer()),this.dirty=!0},refreshBuffer:function(t,e,i,n){"undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=this.width),"undefined"==typeof n&&(n=this.height),this.imageData=this.context.getImageData(t,e,i,n),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data},processPixelRGB:function(t,e,n,r,s,o){"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=0),"undefined"==typeof s&&(s=this.width),"undefined"==typeof o&&(o=this.height);for(var a=n+s,h=r+o,u=i.Color.createColor(),c={r:0,g:0,b:0,a:0},l=!1,d=r;h>d;d++)for(var p=n;a>p;p++)i.Color.unpackPixel(this.getPixel32(p,d),u),c=t.call(e,u,p,d),c!==!1&&null!==c&&void 0!==c&&(this.setPixel32(p,d,c.r,c.g,c.b,c.a,!1),l=!0);l&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0)},processPixel:function(t,e,i,n,r,s){"undefined"==typeof i&&(i=0),"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=this.width),"undefined"==typeof s&&(s=this.height);for(var o=i+r,a=n+s,h=0,u=0,c=!1,l=n;a>l;l++)for(var d=i;o>d;d++)h=this.getPixel32(d,l),u=t.call(e,h,d,l),u!==h&&(this.pixels[l*this.width+d]=u,c=!0);c&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0)},replaceRGB:function(t,e,n,r,s,o,a,h,u){var c=0,l=0,d=this.width,p=this.height,f=i.Color.packPixel(t,e,n,r);void 0!==u&&u instanceof i.Rectangle&&(c=u.x,l=u.y,d=u.width,p=u.height);for(var m=0;p>m;m++)for(var g=0;d>g;g++)this.getPixel32(c+g,l+m)===f&&this.setPixel32(c+g,l+m,s,o,a,h,!1);this.context.putImageData(this.imageData,0,0),this.dirty=!0},setHSL:function(t,e,n,r){if(("undefined"==typeof t||null===t)&&(t=!1),("undefined"==typeof e||null===e)&&(e=!1),("undefined"==typeof n||null===n)&&(n=!1),t||e||n){"undefined"==typeof r&&(r=new i.Rectangle(0,0,this.width,this.height));for(var s=i.Color.createColor(),o=r.y;o<r.bottom;o++)for(var a=r.x;a<r.right;a++)i.Color.unpackPixel(this.getPixel32(a,o),s,!0),t&&(s.h=t),e&&(s.s=e),n&&(s.l=n),i.Color.HSLtoRGB(s.h,s.s,s.l,s),this.setPixel32(a,o,s.r,s.g,s.b,s.a,!1);this.context.putImageData(this.imageData,0,0),this.dirty=!0}},shiftHSL:function(t,e,n,r){if(("undefined"==typeof t||null===t)&&(t=!1),("undefined"==typeof e||null===e)&&(e=!1),("undefined"==typeof n||null===n)&&(n=!1),t||e||n){"undefined"==typeof r&&(r=new i.Rectangle(0,0,this.width,this.height));for(var s=i.Color.createColor(),o=r.y;o<r.bottom;o++)for(var a=r.x;a<r.right;a++)i.Color.unpackPixel(this.getPixel32(a,o),s,!0),t&&(s.h=this.game.math.wrap(s.h+t,0,1)),e&&(s.s=this.game.math.limitValue(s.s+e,0,1)),n&&(s.l=this.game.math.limitValue(s.l+n,0,1)),i.Color.HSLtoRGB(s.h,s.s,s.l,s),this.setPixel32(a,o,s.r,s.g,s.b,s.a,!1);this.context.putImageData(this.imageData,0,0),this.dirty=!0}},setPixel32:function(t,e,n,r,s,o,a){"undefined"==typeof a&&(a=!0),t>=0&&t<=this.width&&e>=0&&e<=this.height&&(this.pixels[e*this.width+t]=i.Device.LITTLE_ENDIAN?o<<24|s<<16|r<<8|n:n<<24|r<<16|s<<8|o,a&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0))},setPixel:function(t,e,i,n,r,s){this.setPixel32(t,e,i,n,r,255,s)},getPixel:function(t,e,n){n||(n=i.Color.createColor());var r=~~(t+e*this.width);return r*=4,this.data[r]&&(n.r=this.data[r],n.g=this.data[++r],n.b=this.data[++r],n.a=this.data[++r]),n},getPixel32:function(t,e){return t>=0&&t<=this.width&&e>=0&&e<=this.height?this.pixels[e*this.width+t]:void 0},getPixelRGB:function(t,e,n,r,s){return i.Color.unpackPixel(this.getPixel32(t,e),n,r,s)},getPixels:function(t){return this.context.getImageData(t.x,t.y,t.width,t.height)},copyPixels:function(t,e,i,n){"string"==typeof t&&(t=this.game.cache.getImage(t)),t&&this.context.drawImage(t,e.x,e.y,e.width,e.height,i,n,e.width,e.height),this.dirty=!0},draw:function(t,e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=0),"string"==typeof t&&(t=this.game.cache.getImage(t)),t&&this.context.drawImage(t,0,0,t.width,t.height,e,i,t.width,t.height),this.dirty=!0},drawSprite:function(t,e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=0);var n=t.texture.frame;this.context.drawImage(t.texture.baseTexture.source,n.x,n.y,n.width,n.height,e,i,n.width,n.height),this.dirty=!0},alphaMask:function(t,e){var i=this.context.globalCompositeOperation;"string"==typeof e&&(e=this.game.cache.getImage(e)),e&&this.context.drawImage(e,0,0),this.context.globalCompositeOperation="source-atop","string"==typeof t&&(t=this.game.cache.getImage(t)),t&&this.context.drawImage(t,0,0),this.context.globalCompositeOperation=i,this.dirty=!0},extract:function(t,e,i,n,r){return"undefined"==typeof r&&(r=255),this.processPixelRGB(function(s,o,a){return s.r===e&&s.g===i&&s.b===n&&t.setPixel32(o,a,e,i,n,r,!1),!1},this),t.context.putImageData(t.imageData,0,0),t.dirty=!0,t},rect:function(t,e,i,n,r){"undefined"!=typeof r&&(this.context.fillStyle=r),this.context.fillRect(t,e,i,n),this.context.fill()},circle:function(t,e,i,n){"undefined"!=typeof n&&(this.context.fillStyle=n),this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI,!1),this.context.closePath(),this.context.fill()},render:function(){!this.disableTextureUpload&&this.game.renderType===i.WEBGL&&this.dirty&&(PIXI.updateWebGLTexture(this.baseTexture,this.game.renderer.gl),this.dirty=!1)}},i.BitmapData.prototype.constructor=i.BitmapData,i.Sprite=function(t,e,n,r,s){e=e||0,n=n||0,r=r||null,s=s||null,this.game=t,this.name="",this.type=i.SPRITE,this.z=0,this.events=new i.Events(this),this.animations=new i.AnimationManager(this),this.key=r,this._frame=0,this._frameName="",PIXI.Sprite.call(this,PIXI.TextureCache.__default),this.loadTexture(r,s),this.position.set(e,n),this.world=new i.Point(e,n),this.autoCull=!1,this.input=null,this.body=null,this.health=1,this.lifespan=0,this.checkWorldBounds=!1,this.outOfBoundsKill=!1,this.debug=!1,this.cameraOffset=new i.Point,this._cache=[0,0,0,0,1,0,1,0,0],this._bounds=new i.Rectangle},i.Sprite.prototype=Object.create(PIXI.Sprite.prototype),i.Sprite.prototype.constructor=i.Sprite,i.Sprite.prototype.preUpdate=function(){if(1===this._cache[4]&&this.exists)return this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.body&&this.body.preUpdate(),this._cache[4]=0,!1;if(this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this._cache[3]=-1,!1;if(this.lifespan>0&&(this.lifespan-=this.game.time.elapsed,this.lifespan<=0))return this.kill(),!1;if((this.autoCull||this.checkWorldBounds)&&this._bounds.copyFrom(this.getBounds()),this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this._bounds)),this.checkWorldBounds)if(1===this._cache[5]&&this.game.world.bounds.intersects(this._bounds))this._cache[5]=0,this.events.onEnterBounds.dispatch(this);else if(0===this._cache[5]&&!this.game.world.bounds.intersects(this._bounds)&&(this._cache[5]=1,this.events.onOutOfBounds.dispatch(this),this.outOfBoundsKill))return this.kill(),!1;this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++),this.animations.update(),this.body&&this.body.preUpdate();for(var t=0,e=this.children.length;e>t;t++)this.children[t].preUpdate();return!0},i.Sprite.prototype.update=function(){},i.Sprite.prototype.postUpdate=function(){this.key instanceof i.BitmapData&&this.key.render(),this.exists&&this.body&&this.body.postUpdate(),1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y);for(var t=0,e=this.children.length;e>t;t++)this.children[t].postUpdate()},i.Sprite.prototype.loadTexture=function(t,e){return e=e||0,t instanceof i.RenderTexture?(this.key=t.key,this.setTexture(t),void 0):t instanceof i.BitmapData?(this.key=t,this.setTexture(t.texture),void 0):t instanceof PIXI.Texture?(this.key=t,this.setTexture(t),void 0):null===t||"undefined"==typeof t?(this.key="__default",this.setTexture(PIXI.TextureCache[this.key]),void 0):"string"!=typeof t||this.game.cache.checkImageKey(t)?this.game.cache.isSpriteSheet(t)?(this.key=t,this.animations.loadFrameData(this.game.cache.getFrameData(t)),"string"==typeof e?this.frameName=e:this.frame=e,void 0):(this.key=t,this.setTexture(PIXI.TextureCache[t]),void 0):(this.key="__missing",this.setTexture(PIXI.TextureCache[this.key]),void 0)},i.Sprite.prototype.crop=function(t){if("undefined"==typeof t||null===t)this.texture.hasOwnProperty("sourceWidth")&&this.texture.setFrame(new i.Rectangle(0,0,this.texture.sourceWidth,this.texture.sourceHeight));else if(this.texture instanceof PIXI.Texture){var e={};i.Utils.extend(!0,e,this.texture),e.sourceWidth=e.width,e.sourceHeight=e.height,e.frame=t,e.width=t.width,e.height=t.height,this.texture=e,this.texture.updateFrame=!0,PIXI.Texture.frameUpdates.push(this.texture)}else this.texture.setFrame(t)},i.Sprite.prototype.revive=function(t){return"undefined"==typeof t&&(t=1),this.alive=!0,this.exists=!0,this.visible=!0,this.health=t,this.events&&this.events.onRevived.dispatch(this),this},i.Sprite.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled.dispatch(this),this},i.Sprite.prototype.destroy=function(t){if(null!==this.game&&1!==this._cache[8]){"undefined"==typeof t&&(t=!0),this._cache[8]=1,this.parent&&(this.parent instanceof i.Group?this.parent.remove(this):this.parent.removeChild(this)),this.input&&this.input.destroy(),this.animations&&this.animations.destroy(),this.body&&this.body.destroy(),this.events&&this.events.destroy();var e=this.children.length;if(t)for(;e--;)this.children[e].destroy(t);else for(;e--;)this.removeChild(this.children[e]);this.alive=!1,this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this._cache[8]=0}},i.Sprite.prototype.damage=function(t){return this.alive&&(this.health-=t,this.health<=0&&this.kill()),this},i.Sprite.prototype.reset=function(t,e,i){return"undefined"==typeof i&&(i=1),this.world.setTo(t,e),this.position.x=t,this.position.y=e,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.health=i,this.body&&this.body.reset(t,e,!1,!1),this._cache[4]=1,this},i.Sprite.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this},i.Sprite.prototype.play=function(t,e,i,n){return this.animations?this.animations.play(t,e,i,n):void 0},i.Sprite.prototype.overlap=function(t){return i.Rectangle.intersects(this.getBounds(),t.getBounds())},Object.defineProperty(i.Sprite.prototype,"angle",{get:function(){return i.Math.wrapAngle(i.Math.radToDeg(this.rotation))},set:function(t){this.rotation=i.Math.degToRad(i.Math.wrapAngle(t))}}),Object.defineProperty(i.Sprite.prototype,"deltaX",{get:function(){return this.world.x-this._cache[0]}}),Object.defineProperty(i.Sprite.prototype,"deltaY",{get:function(){return this.world.y-this._cache[1]}}),Object.defineProperty(i.Sprite.prototype,"deltaZ",{get:function(){return this.rotation-this._cache[2]}}),Object.defineProperty(i.Sprite.prototype,"inWorld",{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}),Object.defineProperty(i.Sprite.prototype,"inCamera",{get:function(){return this.game.world.camera.screenView.intersects(this.getBounds())}}),Object.defineProperty(i.Sprite.prototype,"frame",{get:function(){return this.animations.frame},set:function(t){this.animations.frame=t}}),Object.defineProperty(i.Sprite.prototype,"frameName",{get:function(){return this.animations.frameName},set:function(t){this.animations.frameName=t}}),Object.defineProperty(i.Sprite.prototype,"renderOrderID",{get:function(){return this._cache[3]}}),Object.defineProperty(i.Sprite.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input=new i.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}),Object.defineProperty(i.Sprite.prototype,"exists",{get:function(){return!!this._cache[6]},set:function(t){t?(this._cache[6]=1,this.body&&this.body.type===i.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._cache[6]=0,this.body&&this.body.type===i.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}}),Object.defineProperty(i.Sprite.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(t){t?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}}),Object.defineProperty(i.Sprite.prototype,"smoothed",{get:function(){return!this.texture.baseTexture.scaleMode},set:function(t){t?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}),Object.defineProperty(i.Sprite.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t,this.body&&this.body.type===i.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}}),Object.defineProperty(i.Sprite.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t,this.body&&this.body.type===i.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}}),Object.defineProperty(i.Sprite.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}}),i.Image=function(t,e,n,r,s){e=e||0,n=n||0,r=r||null,s=s||null,this.game=t,this.exists=!0,this.name="",this.type=i.IMAGE,this.z=0,this.events=new i.Events(this),this.key=r,this._frame=0,this._frameName="",PIXI.Sprite.call(this,PIXI.TextureCache.__default),this.loadTexture(r,s),this.position.set(e,n),this.world=new i.Point(e,n),this.autoCull=!1,this.input=null,this.cameraOffset=new i.Point,this._cache=[0,0,0,0,1,0,1,0,0]},i.Image.prototype=Object.create(PIXI.Sprite.prototype),i.Image.prototype.constructor=i.Image,i.Image.prototype.preUpdate=function(){if(this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this._cache[3]=-1,!1;this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this.getBounds())),this.world.setTo(this.game.camera.x+this.worldTransform[2],this.game.camera.y+this.worldTransform[5]),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++);for(var t=0,e=this.children.length;e>t;t++)this.children[t].preUpdate();return!0},i.Image.prototype.update=function(){},i.Image.prototype.postUpdate=function(){this.key instanceof i.BitmapData&&this.key.render(),1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y);for(var t=0,e=this.children.length;e>t;t++)this.children[t].postUpdate()},i.Image.prototype.loadTexture=function(t,e){if(e=e||0,t instanceof i.RenderTexture)return this.key=t.key,this.setTexture(t),void 0;if(t instanceof i.BitmapData)return this.key=t,this.setTexture(t.texture),void 0;if(t instanceof PIXI.Texture)return this.key=t,this.setTexture(t),void 0;if(null===t||"undefined"==typeof t)return this.key="__default",this.setTexture(PIXI.TextureCache[this.key]),void 0;if("string"==typeof t&&!this.game.cache.checkImageKey(t))return this.key="__missing",this.setTexture(PIXI.TextureCache[this.key]),void 0;if(this.game.cache.isSpriteSheet(t)){this.key=t;var n=this.game.cache.getFrameData(t);return"string"==typeof e?(this._frame=0,this._frameName=e,this.setTexture(PIXI.TextureCache[n.getFrameByName(e).uuid]),void 0):(this._frame=e,this._frameName="",this.setTexture(PIXI.TextureCache[n.getFrame(e).uuid]),void 0)}return this.key=t,this.setTexture(PIXI.TextureCache[t]),void 0},i.Image.prototype.crop=function(t){if("undefined"==typeof t||null===t)this.texture.hasOwnProperty("sourceWidth")&&this.texture.setFrame(new i.Rectangle(0,0,this.texture.sourceWidth,this.texture.sourceHeight));else if(this.texture instanceof PIXI.Texture){var e={};i.Utils.extend(!0,e,this.texture),e.sourceWidth=e.width,e.sourceHeight=e.height,e.frame=t,e.width=t.width,e.height=t.height,this.texture=e,this.texture.updateFrame=!0,PIXI.Texture.frameUpdates.push(this.texture)}else this.texture.setFrame(t)},i.Image.prototype.revive=function(){return this.alive=!0,this.exists=!0,this.visible=!0,this.events&&this.events.onRevived.dispatch(this),this},i.Image.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled.dispatch(this),this},i.Image.prototype.destroy=function(t){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof t&&(t=!0),this._cache[8]=1,this.parent&&(this.parent instanceof i.Group?this.parent.remove(this):this.parent.removeChild(this)),this.events&&this.events.destroy(),this.input&&this.input.destroy();var e=this.children.length;if(t)for(;e--;)this.children[e].destroy(t);else for(;e--;)this.removeChild(this.children[e]);this.alive=!1,this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this._cache[8]=0}},i.Image.prototype.reset=function(t,e){return this.world.setTo(t,e),this.position.x=t,this.position.y=e,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this},i.Image.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this},Object.defineProperty(i.Image.prototype,"angle",{get:function(){return i.Math.wrapAngle(i.Math.radToDeg(this.rotation))},set:function(t){this.rotation=i.Math.degToRad(i.Math.wrapAngle(t))}}),Object.defineProperty(i.Image.prototype,"deltaX",{get:function(){return this.world.x-this._cache[0]}}),Object.defineProperty(i.Image.prototype,"deltaY",{get:function(){return this.world.y-this._cache[1]}}),Object.defineProperty(i.Image.prototype,"deltaZ",{get:function(){return this.rotation-this._cache[2]}}),Object.defineProperty(i.Image.prototype,"inWorld",{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}),Object.defineProperty(i.Image.prototype,"inCamera",{get:function(){return this.game.world.camera.screenView.intersects(this.getBounds())}}),Object.defineProperty(i.Image.prototype,"frame",{get:function(){return this._frame},set:function(t){if(t!==this.frame&&this.game.cache.isSpriteSheet(this.key)){var e=this.game.cache.getFrameData(this.key);e&&t<e.total&&e.getFrame(t)&&(this.setTexture(PIXI.TextureCache[e.getFrame(t).uuid]),this._frame=t)}}}),Object.defineProperty(i.Image.prototype,"frameName",{get:function(){return this._frameName},set:function(t){if(t!==this.frameName&&this.game.cache.isSpriteSheet(this.key)){var e=this.game.cache.getFrameData(this.key);e&&e.getFrameByName(t)&&(this.setTexture(PIXI.TextureCache[e.getFrameByName(t).uuid]),this._frameName=t)}}}),Object.defineProperty(i.Image.prototype,"renderOrderID",{get:function(){return this._cache[3]}}),Object.defineProperty(i.Image.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input=new i.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}),Object.defineProperty(i.Image.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(t){t?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}}),Object.defineProperty(i.Image.prototype,"smoothed",{get:function(){return!this.texture.baseTexture.scaleMode},set:function(t){t?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}),Object.defineProperty(i.Image.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}}),i.TileSprite=function(t,e,n,r,s,o,a){e=e||0,n=n||0,r=r||256,s=s||256,o=o||null,a=a||null,this.game=t,this.name="",this.type=i.TILESPRITE,this.z=0,this.events=new i.Events(this),this.animations=new i.AnimationManager(this),this.key=o,this._frame=0,this._frameName="",this._scroll=new i.Point,PIXI.TilingSprite.call(this,PIXI.TextureCache.__default,r,s),this.loadTexture(o,a),this.position.set(e,n),this.input=null,this.world=new i.Point(e,n),this.autoCull=!1,this.checkWorldBounds=!1,this.cameraOffset=new i.Point,this.body=null,this._cache=[0,0,0,0,1,0,1,0,0]},i.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype),i.TileSprite.prototype.constructor=i.TileSprite,i.TileSprite.prototype.preUpdate=function(){if(1===this._cache[4]&&this.exists)return this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.body&&this.body.preUpdate(),this._cache[4]=0,!1;if(this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this._cache[3]=-1,!1;(this.autoCull||this.checkWorldBounds)&&this._bounds.copyFrom(this.getBounds()),this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this._bounds)),this.checkWorldBounds&&(1===this._cache[5]&&this.game.world.bounds.intersects(this._bounds)?(this._cache[5]=0,this.events.onEnterBounds.dispatch(this)):0!==this._cache[5]||this.game.world.bounds.intersects(this._bounds)||(this._cache[5]=1,this.events.onOutOfBounds.dispatch(this))),this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++),this.animations.update(),0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed),0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed),this.body&&this.body.preUpdate();for(var t=0,e=this.children.length;e>t;t++)this.children[t].preUpdate();return!0},i.TileSprite.prototype.update=function(){},i.TileSprite.prototype.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate(),1===this._cache[7]&&(this.position.x=this.game.camera.view.x+this.cameraOffset.x,this.position.y=this.game.camera.view.y+this.cameraOffset.y);for(var t=0,e=this.children.length;e>t;t++)this.children[t].postUpdate()},i.TileSprite.prototype.autoScroll=function(t,e){this._scroll.set(t,e)},i.TileSprite.prototype.stopScroll=function(){this._scroll.set(0,0)},i.TileSprite.prototype.loadTexture=function(t,e){return e=e||0,t instanceof i.RenderTexture?(this.key=t.key,this.setTexture(t),void 0):t instanceof i.BitmapData?(this.key=t,this.setTexture(t.texture),void 0):t instanceof PIXI.Texture?(this.key=t,this.setTexture(t),void 0):null===t||"undefined"==typeof t?(this.key="__default",this.setTexture(PIXI.TextureCache[this.key]),void 0):"string"!=typeof t||this.game.cache.checkImageKey(t)?this.game.cache.isSpriteSheet(t)?(this.key=t,this.animations.loadFrameData(this.game.cache.getFrameData(t)),"string"==typeof e?this.frameName=e:this.frame=e,void 0):(this.key=t,this.setTexture(PIXI.TextureCache[t]),void 0):(this.key="__missing",this.setTexture(PIXI.TextureCache[this.key]),void 0)},i.TileSprite.prototype.destroy=function(t){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof t&&(t=!0),this._cache[8]=1,this.filters&&(this.filters=null),this.parent&&(this.parent instanceof i.Group?this.parent.remove(this):this.parent.removeChild(this)),this.animations.destroy(),this.events.destroy();var e=this.children.length;if(t)for(;e--;)this.children[e].destroy(t);else for(;e--;)this.removeChild(this.children[e]);this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this._cache[8]=0}},i.TileSprite.prototype.play=function(t,e,i,n){return this.animations.play(t,e,i,n)},i.TileSprite.prototype.reset=function(t,e){return this.world.setTo(t,e),this.position.x=t,this.position.y=e,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.tilePosition.x=0,this.tilePosition.y=0,this.body&&this.body.reset(t,e,!1,!1),this._cache[4]=1,this},Object.defineProperty(i.TileSprite.prototype,"angle",{get:function(){return i.Math.wrapAngle(i.Math.radToDeg(this.rotation))},set:function(t){this.rotation=i.Math.degToRad(i.Math.wrapAngle(t))}}),Object.defineProperty(i.TileSprite.prototype,"frame",{get:function(){return this.animations.frame},set:function(t){t!==this.animations.frame&&(this.animations.frame=t)}}),Object.defineProperty(i.TileSprite.prototype,"frameName",{get:function(){return this.animations.frameName},set:function(t){t!==this.animations.frameName&&(this.animations.frameName=t)}}),Object.defineProperty(i.TileSprite.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(t){t?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}}),Object.defineProperty(i.TileSprite.prototype,"exists",{get:function(){return!!this._cache[6]},set:function(t){t?(this._cache[6]=1,this.body&&this.body.type===i.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._cache[6]=0,this.body&&this.body.type===i.Physics.P2JS&&(this.body.safeRemove=!0),this.visible=!1)}}),Object.defineProperty(i.TileSprite.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input=new i.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}),Object.defineProperty(i.TileSprite.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t,this.body&&this.body.type===i.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}}),Object.defineProperty(i.TileSprite.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t,this.body&&this.body.type===i.Physics.ARCADE&&2===this.body.phase&&(this.body._reset=1)}}),Object.defineProperty(i.TileSprite.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}}),i.Text=function(t,e,n,r,s){e=e||0,n=n||0,r=r||" ",s=s||{},r=0===r.length?" ":r.toString(),this.game=t,this.exists=!0,this.name="",this.type=i.TEXT,this.z=0,this.world=new i.Point(e,n),this._text=r,this._font="",this._fontSize=32,this._fontWeight="normal",this._lineSpacing=0,this.events=new i.Events(this),this.input=null,this.cameraOffset=new i.Point,this.setStyle(s),PIXI.Text.call(this,r,this.style),this.position.set(e,n),this._cache=[0,0,0,0,1,0,1,0,0]},i.Text.prototype=Object.create(PIXI.Text.prototype),i.Text.prototype.constructor=i.Text,i.Text.prototype.preUpdate=function(){if(this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this.getBounds())),this.world.setTo(this.game.camera.x+this.worldTransform[2],this.game.camera.y+this.worldTransform[5]),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++);for(var t=0,e=this.children.length;e>t;t++)this.children[t].preUpdate();return!0},i.Text.prototype.update=function(){},i.Text.prototype.postUpdate=function(){1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y);for(var t=0,e=this.children.length;e>t;t++)this.children[t].postUpdate()
},i.Text.prototype.destroy=function(t){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof t&&(t=!0),this._cache[8]=1,this.parent&&(this.parent instanceof i.Group?this.parent.remove(this):this.parent.removeChild(this)),this.texture.destroy(),this.canvas.parentNode?this.canvas.parentNode.removeChild(this.canvas):(this.canvas=null,this.context=null);var e=this.children.length;if(t)for(;e--;)this.children[e].destroy(t);else for(;e--;)this.removeChild(this.children[e]);this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this._cache[8]=0}},i.Text.prototype.setShadow=function(t,e,i,n){this.style.shadowOffsetX=t||0,this.style.shadowOffsetY=e||0,this.style.shadowColor=i||"rgba(0,0,0,0)",this.style.shadowBlur=n||0,this.dirty=!0},i.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.shadowOffsetX=t.shadowOffsetX||0,t.shadowOffsetY=t.shadowOffsetY||0,t.shadowColor=t.shadowColor||"rgba(0,0,0,0)",t.shadowBlur=t.shadowBlur||0,this.style=t,this.dirty=!0},i.Text.prototype.updateText=function(){this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.runWordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),i=[],n=0,r=0;r<e.length;r++){var s=this.context.measureText(e[r]).width;i[r]=s,n=Math.max(n,s)}this.canvas.width=n+this.style.strokeThickness;var o=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness+this._lineSpacing+this.style.shadowOffsetY;for(this.canvas.height=o*e.length,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.shadowOffsetX=this.style.shadowOffsetX,this.context.shadowOffsetY=this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur,this.context.textBaseline="top",this.context.lineCap="round",this.context.lineJoin="round",r=0;r<e.length;r++){var a=new PIXI.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+r*o);"right"===this.style.align?a.x+=n-i[r]:"center"===this.style.align&&(a.x+=(n-i[r])/2),a.y+=this._lineSpacing,this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[r],a.x,a.y),this.style.fill&&this.context.fillText(e[r],a.x,a.y)}this.updateTexture()},i.Text.prototype.runWordWrap=function(t){for(var e="",i=t.split("\n"),n=0;n<i.length;n++){for(var r=this.style.wordWrapWidth,s=i[n].split(" "),o=0;o<s.length;o++){var a=this.context.measureText(s[o]).width,h=a+this.context.measureText(" ").width;h>r?(o>0&&(e+="\n"),e+=s[o]+" ",r=this.style.wordWrapWidth-a):(r-=h,e+=s[o]+" ")}n<i.length-1&&(e+="\n")}return e},Object.defineProperty(i.Text.prototype,"angle",{get:function(){return i.Math.radToDeg(this.rotation)},set:function(t){this.rotation=i.Math.degToRad(t)}}),Object.defineProperty(i.Text.prototype,"text",{get:function(){return this._text},set:function(t){t!==this._text&&(this._text=t.toString()||" ",this.dirty=!0,this.updateTransform())}}),Object.defineProperty(i.Text.prototype,"font",{get:function(){return this._font},set:function(t){t!==this._font&&(this._font=t.trim(),this.style.font=this._fontWeight+" "+this._fontSize+"px '"+this._font+"'",this.dirty=!0,this.updateTransform())}}),Object.defineProperty(i.Text.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){t=parseInt(t,10),t!==this._fontSize&&(this._fontSize=t,this.style.font=this._fontWeight+" "+this._fontSize+"px '"+this._font+"'",this.dirty=!0,this.updateTransform())}}),Object.defineProperty(i.Text.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){t!==this._fontWeight&&(this._fontWeight=t,this.style.font=this._fontWeight+" "+this._fontSize+"px '"+this._font+"'",this.dirty=!0,this.updateTransform())}}),Object.defineProperty(i.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(t){t!==this.style.fill&&(this.style.fill=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"align",{get:function(){return this.style.align},set:function(t){t!==this.style.align&&(this.style.align=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(t){t!==this.style.stroke&&(this.style.stroke=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(t){t!==this.style.strokeThickness&&(this.style.strokeThickness=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(t){t!==this.style.wordWrap&&(this.style.wordWrap=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(t){t!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(t){t!==this._lineSpacing&&(this._lineSpacing=parseFloat(t),this.dirty=!0,this.updateTransform())}}),Object.defineProperty(i.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(t){t!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(t){t!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(t){t!==this.style.shadowColor&&(this.style.shadowColor=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(t){t!==this.style.shadowBlur&&(this.style.shadowBlur=t,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input=new i.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}),Object.defineProperty(i.Text.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(t){t?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}}),Object.defineProperty(i.Text.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}}),i.BitmapText=function(t,e,n,r,s,o){e=e||0,n=n||0,r=r||"",s=s||"",o=o||32,this.game=t,this.exists=!0,this.name="",this.type=i.BITMAPTEXT,this.z=0,this.world=new i.Point(e,n),this._text=s,this._font=r,this._fontSize=o,this._align="left",this._tint=16777215,this.events=new i.Events(this),this.input=null,this.cameraOffset=new i.Point,PIXI.BitmapText.call(this,s),this.position.set(e,n),this._cache=[0,0,0,0,1,0,1,0,0]},i.BitmapText.prototype=Object.create(PIXI.BitmapText.prototype),i.BitmapText.prototype.constructor=i.BitmapText,i.BitmapText.prototype.setStyle=function(){this.style={align:this._align},this.fontName=this._font,this.fontSize=this._fontSize,this.dirty=!0},i.BitmapText.prototype.preUpdate=function(){return this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.exists&&this.parent.exists?(this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this.getBounds())),this.world.setTo(this.game.camera.x+this.worldTransform[2],this.game.camera.y+this.worldTransform[5]),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++),!0):(this.renderOrderID=-1,!1)},i.BitmapText.prototype.update=function(){},i.BitmapText.prototype.postUpdate=function(){1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)},i.BitmapText.prototype.destroy=function(t){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof t&&(t=!0),this._cache[8]=1,this.parent&&(this.parent instanceof i.Group?this.parent.remove(this):this.parent.removeChild(this));var e=this.children.length;if(t)for(;e--;)this.children[e].destroy?this.children[e].destroy(t):this.removeChild(this.children[e]);else for(;e--;)this.removeChild(this.children[e]);this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this._cache[8]=0}},Object.defineProperty(i.BitmapText.prototype,"align",{get:function(){return this._align},set:function(t){t!==this._align&&(this._align=t,this.setStyle())}}),Object.defineProperty(i.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this.dirty=!0)}}),Object.defineProperty(i.BitmapText.prototype,"angle",{get:function(){return i.Math.radToDeg(this.rotation)},set:function(t){this.rotation=i.Math.degToRad(t)}}),Object.defineProperty(i.BitmapText.prototype,"font",{get:function(){return this._font},set:function(t){t!==this._font&&(this._font=t.trim(),this.style.font=this._fontSize+"px '"+this._font+"'",this.dirty=!0)}}),Object.defineProperty(i.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){t=parseInt(t,10),t!==this._fontSize&&(this._fontSize=t,this.style.font=this._fontSize+"px '"+this._font+"'",this.dirty=!0)}}),Object.defineProperty(i.BitmapText.prototype,"text",{get:function(){return this._text},set:function(t){t!==this._text&&(this._text=t.toString()||" ",this.dirty=!0)}}),Object.defineProperty(i.BitmapText.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input=new i.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}),Object.defineProperty(i.BitmapText.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(t){t?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}}),Object.defineProperty(i.BitmapText.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}}),i.Button=function(t,e,n,r,s,o,a,h,u,c){e=e||0,n=n||0,r=r||null,s=s||null,o=o||this,i.Image.call(this,t,e,n,r,h),this.type=i.BUTTON,this._onOverFrameName=null,this._onOutFrameName=null,this._onDownFrameName=null,this._onUpFrameName=null,this._onOverFrameID=null,this._onOutFrameID=null,this._onDownFrameID=null,this._onUpFrameID=null,this.onOverMouseOnly=!1,this.onOverSound=null,this.onOutSound=null,this.onDownSound=null,this.onUpSound=null,this.onOverSoundMarker="",this.onOutSoundMarker="",this.onDownSoundMarker="",this.onUpSoundMarker="",this.onInputOver=new i.Signal,this.onInputOut=new i.Signal,this.onInputDown=new i.Signal,this.onInputUp=new i.Signal,this.freezeFrames=!1,this.forceOut=!1,this.inputEnabled=!0,this.input.start(0,!0),this.setFrames(a,h,u,c),null!==s&&this.onInputUp.add(s,o),this.events.onInputOver.add(this.onInputOverHandler,this),this.events.onInputOut.add(this.onInputOutHandler,this),this.events.onInputDown.add(this.onInputDownHandler,this),this.events.onInputUp.add(this.onInputUpHandler,this)},i.Button.prototype=Object.create(i.Image.prototype),i.Button.prototype.constructor=i.Button,i.Button.prototype.clearFrames=function(){this._onOverFrameName=null,this._onOverFrameID=null,this._onOutFrameName=null,this._onOutFrameID=null,this._onDownFrameName=null,this._onDownFrameID=null,this._onUpFrameName=null,this._onUpFrameID=null},i.Button.prototype.setFrames=function(t,e,i,n){this.clearFrames(),null!==t&&("string"==typeof t?(this._onOverFrameName=t,this.input.pointerOver()&&(this.frameName=t)):(this._onOverFrameID=t,this.input.pointerOver()&&(this.frame=t))),null!==e&&("string"==typeof e?(this._onOutFrameName=e,this.input.pointerOver()===!1&&(this.frameName=e)):(this._onOutFrameID=e,this.input.pointerOver()===!1&&(this.frame=e))),null!==i&&("string"==typeof i?(this._onDownFrameName=i,this.input.pointerDown()&&(this.frameName=i)):(this._onDownFrameID=i,this.input.pointerDown()&&(this.frame=i))),null!==n&&("string"==typeof n?(this._onUpFrameName=n,this.input.pointerUp()&&(this.frameName=n)):(this._onUpFrameID=n,this.input.pointerUp()&&(this.frame=n)))},i.Button.prototype.setSounds=function(t,e,i,n,r,s,o,a){this.setOverSound(t,e),this.setOutSound(r,s),this.setDownSound(i,n),this.setUpSound(o,a)},i.Button.prototype.setOverSound=function(t,e){this.onOverSound=null,this.onOverSoundMarker="",t instanceof i.Sound&&(this.onOverSound=t),"string"==typeof e&&(this.onOverSoundMarker=e)},i.Button.prototype.setOutSound=function(t,e){this.onOutSound=null,this.onOutSoundMarker="",t instanceof i.Sound&&(this.onOutSound=t),"string"==typeof e&&(this.onOutSoundMarker=e)},i.Button.prototype.setDownSound=function(t,e){this.onDownSound=null,this.onDownSoundMarker="",t instanceof i.Sound&&(this.onDownSound=t),"string"==typeof e&&(this.onDownSoundMarker=e)},i.Button.prototype.setUpSound=function(t,e){this.onUpSound=null,this.onUpSoundMarker="",t instanceof i.Sound&&(this.onUpSound=t),"string"==typeof e&&(this.onUpSoundMarker=e)},i.Button.prototype.onInputOverHandler=function(t,e){this.freezeFrames===!1&&this.setState(1),(!this.onOverMouseOnly||e.isMouse)&&(this.onOverSound&&this.onOverSound.play(this.onOverSoundMarker),this.onInputOver&&this.onInputOver.dispatch(this,e))},i.Button.prototype.onInputOutHandler=function(t,e){this.freezeFrames===!1&&this.setState(2),this.onOutSound&&this.onOutSound.play(this.onOutSoundMarker),this.onInputOut&&this.onInputOut.dispatch(this,e)},i.Button.prototype.onInputDownHandler=function(t,e){this.freezeFrames===!1&&this.setState(3),this.onDownSound&&this.onDownSound.play(this.onDownSoundMarker),this.onInputDown&&this.onInputDown.dispatch(this,e)},i.Button.prototype.onInputUpHandler=function(t,e,i){this.onUpSound&&this.onUpSound.play(this.onUpSoundMarker),this.onInputUp&&this.onInputUp.dispatch(this,e,i),this.freezeFrames||(this.forceOut?this.setState(2):null!==this._onUpFrameName||null!==this._onUpFrameID?this.setState(4):i?this.setState(1):this.setState(2))},i.Button.prototype.setState=function(t){1===t?null!=this._onOverFrameName?this.frameName=this._onOverFrameName:null!=this._onOverFrameID&&(this.frame=this._onOverFrameID):2===t?null!=this._onOutFrameName?this.frameName=this._onOutFrameName:null!=this._onOutFrameID&&(this.frame=this._onOutFrameID):3===t?null!=this._onDownFrameName?this.frameName=this._onDownFrameName:null!=this._onDownFrameID&&(this.frame=this._onDownFrameID):4===t&&(null!=this._onUpFrameName?this.frameName=this._onUpFrameName:null!=this._onUpFrameID&&(this.frame=this._onUpFrameID))},i.Graphics=function(t,e,n){e=e||0,n=n||0,this.game=t,this.exists=!0,this.name="",this.type=i.GRAPHICS,this.z=0,this.world=new i.Point(e,n),this.cameraOffset=new i.Point,PIXI.Graphics.call(this),this.position.set(e,n),this._cache=[0,0,0,0,1,0,1,0,0]},i.Graphics.prototype=Object.create(PIXI.Graphics.prototype),i.Graphics.prototype.constructor=i.Graphics,i.Graphics.prototype.preUpdate=function(){return this._cache[0]=this.world.x,this._cache[1]=this.world.y,this._cache[2]=this.rotation,this.exists&&this.parent.exists?(this.autoCull&&(this.renderable=this.game.world.camera.screenView.intersects(this.getBounds())),this.world.setTo(this.game.camera.x+this.worldTransform[2],this.game.camera.y+this.worldTransform[5]),this.visible&&(this._cache[3]=this.game.stage.currentRenderOrderID++),!0):(this.renderOrderID=-1,!1)},i.Graphics.prototype.update=function(){},i.Graphics.prototype.postUpdate=function(){1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)},i.Graphics.prototype.destroy=function(t){if(null!==this.game&&!this.destroyPhase){"undefined"==typeof t&&(t=!0),this._cache[8]=1,this.clear(),this.parent&&(this.parent instanceof i.Group?this.parent.remove(this):this.parent.removeChild(this));var e=this.children.length;if(t)for(;e--;)this.children[e].destroy(t);else for(;e--;)this.removeChild(this.children[e]);this.exists=!1,this.visible=!1,this.game=null,this._cache[8]=0}},i.Graphics.prototype.drawPolygon=function(t){this.moveTo(t.points[0].x,t.points[0].y);for(var e=1;e<t.points.length;e+=1)this.lineTo(t.points[e].x,t.points[e].y);this.lineTo(t.points[0].x,t.points[0].y)},i.Graphics.prototype.drawTriangle=function(t,e){"undefined"==typeof e&&(e=!1);var n=new i.Polygon(t);if(e){var r=new i.Point(this.game.camera.x-t[0].x,this.game.camera.y-t[0].y),s=new i.Point(t[1].x-t[0].x,t[1].y-t[0].y),o=new i.Point(t[1].x-t[2].x,t[1].y-t[2].y),a=o.cross(s);r.dot(a)>0&&this.drawPolygon(n)}else this.drawPolygon(n)},i.Graphics.prototype.drawTriangles=function(t,e,n){"undefined"==typeof n&&(n=!1);var r,s=new i.Point,o=new i.Point,a=new i.Point,h=[];if(e)if(t[0]instanceof i.Point)for(r=0;r<e.length/3;r++)h.push(t[e[3*r]]),h.push(t[e[3*r+1]]),h.push(t[e[3*r+2]]),3===h.length&&(this.drawTriangle(h,n),h=[]);else for(r=0;r<e.length;r++)s.x=t[2*e[r]],s.y=t[2*e[r]+1],h.push(s.copyTo({})),3===h.length&&(this.drawTriangle(h,n),h=[]);else if(t[0]instanceof i.Point)for(r=0;r<t.length/3;r++)this.drawTriangle([t[3*r],t[3*r+1],t[3*r+2]],n);else for(r=0;r<t.length/6;r++)s.x=t[6*r+0],s.y=t[6*r+1],o.x=t[6*r+2],o.y=t[6*r+3],a.x=t[6*r+4],a.y=t[6*r+5],this.drawTriangle([s,o,a],n)},Object.defineProperty(i.Graphics.prototype,"angle",{get:function(){return i.Math.radToDeg(this.rotation)},set:function(t){this.rotation=i.Math.degToRad(t)}}),Object.defineProperty(i.Graphics.prototype,"fixedToCamera",{get:function(){return!!this._cache[7]},set:function(t){t?(this._cache[7]=1,this.cameraOffset.set(this.x,this.y)):this._cache[7]=0}}),Object.defineProperty(i.Graphics.prototype,"destroyPhase",{get:function(){return!!this._cache[8]}}),i.RenderTexture=function(t,e,n,r,s){"undefined"==typeof r&&(r=""),"undefined"==typeof s&&(s=i.scaleModes.DEFAULT),this.game=t,this.key=r,this.type=i.RENDERTEXTURE,this._temp=new i.Point,PIXI.RenderTexture.call(this,e,n,s)},i.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype),i.RenderTexture.prototype.constructor=i.RenderTexture,i.RenderTexture.prototype.renderXY=function(t,e,i,n){this._temp.set(e,i),this.render(t,this._temp,n)},i.SpriteBatch=function(t,e,n,r){PIXI.SpriteBatch.call(this),i.Group.call(this,t,e,n,r),this.type=i.SPRITEBATCH},i.SpriteBatch.prototype=i.Utils.extend(!0,i.SpriteBatch.prototype,i.Group.prototype,PIXI.SpriteBatch.prototype),i.SpriteBatch.prototype.constructor=i.SpriteBatch,i.RetroFont=function(t,e,n,r,s,o,a,h,u,c){this.characterWidth=n,this.characterHeight=r,this.characterSpacingX=a||0,this.characterSpacingY=h||0,this.characterPerRow=o,this.offsetX=u||0,this.offsetY=c||0,this.align="left",this.multiLine=!1,this.autoUpperCase=!0,this.customSpacingX=0,this.customSpacingY=0,this.fixedWidth=0,this.fontSet=t.cache.getImage(e),this._text="",this.grabData=[];for(var l=this.offsetX,d=this.offsetY,p=0,f=new i.FrameData,m=0;m<s.length;m++){var g=t.rnd.uuid(),y=f.addFrame(new i.Frame(m,l,d,this.characterWidth,this.characterHeight,"",g));this.grabData[s.charCodeAt(m)]=y.index,PIXI.TextureCache[g]=new PIXI.Texture(PIXI.BaseTextureCache[e],{x:l,y:d,width:this.characterWidth,height:this.characterHeight}),p++,p==this.characterPerRow?(p=0,l=this.offsetX,d+=this.characterHeight+this.characterSpacingY):l+=this.characterWidth+this.characterSpacingX}t.cache.updateFrameData(e,f),this.stamp=new i.Image(t,0,0,e,0),i.RenderTexture.call(this,t),this.type=i.RETROFONT},i.RetroFont.prototype=Object.create(i.RenderTexture.prototype),i.RetroFont.prototype.constructor=i.RetroFont,i.RetroFont.ALIGN_LEFT="left",i.RetroFont.ALIGN_RIGHT="right",i.RetroFont.ALIGN_CENTER="center",i.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",i.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",i.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",i.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",i.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",i.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",i.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",i.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",i.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",i.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789",i.RetroFont.prototype.setFixedWidth=function(t,e){"undefined"==typeof e&&(e="left"),this.fixedWidth=t,this.align=e},i.RetroFont.prototype.setText=function(t,e,i,n,r,s){this.multiLine=e||!1,this.customSpacingX=i||0,this.customSpacingY=n||0,this.align=r||"left",this.autoUpperCase=s?!1:!0,t.length>0&&(this.text=t)},i.RetroFont.prototype.buildRetroFontText=function(){var t=0,e=0;if(this.clear(),this.multiLine){var n=this._text.split("\n");this.fixedWidth>0?this.resize(this.fixedWidth,n.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),n.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var r=0;r<n.length;r++){switch(this.align){case i.RetroFont.ALIGN_LEFT:t=0;break;case i.RetroFont.ALIGN_RIGHT:t=this.width-n[r].length*(this.characterWidth+this.customSpacingX);break;case i.RetroFont.ALIGN_CENTER:t=this.width/2-n[r].length*(this.characterWidth+this.customSpacingX)/2,t+=this.customSpacingX/2}0>t&&(t=0),this.pasteLine(n[r],t,e,this.customSpacingX),e+=this.characterHeight+this.customSpacingY}}else{switch(this.fixedWidth>0?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),this.align){case i.RetroFont.ALIGN_LEFT:t=0;break;case i.RetroFont.ALIGN_RIGHT:t=this.width-this._text.length*(this.characterWidth+this.customSpacingX);break;case i.RetroFont.ALIGN_CENTER:t=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,t+=this.customSpacingX/2}this.textureBuffer.clear(),this.pasteLine(this._text,t,0,this.customSpacingX)}},i.RetroFont.prototype.pasteLine=function(t,e,n,r){for(var s=new i.Point,o=0;o<t.length;o++)if(" "==t.charAt(o))e+=this.characterWidth+r;else if(this.grabData[t.charCodeAt(o)]>=0&&(this.stamp.frame=this.grabData[t.charCodeAt(o)],s.set(e,n),this.render(this.stamp,s,!1),e+=this.characterWidth+r,e>this.width))break},i.RetroFont.prototype.getLongestLine=function(){var t=0;if(this._text.length>0)for(var e=this._text.split("\n"),i=0;i<e.length;i++)e[i].length>t&&(t=e[i].length);return t},i.RetroFont.prototype.removeUnsupportedCharacters=function(t){for(var e="",i=0;i<this._text.length;i++){var n=this._text[i],r=n.charCodeAt(0);(this.grabData[r]>=0||!t&&"\n"===n)&&(e=e.concat(n))}return e},Object.defineProperty(i.RetroFont.prototype,"text",{get:function(){return this._text},set:function(t){var e;e=this.autoUpperCase?t.toUpperCase():t,e!==this._text&&(this._text=e,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}}),i.Particle=function(t,e,n,r,s){i.Sprite.call(this,t,e,n,r,s),this.autoScale=!1,this.scaleData=null,this._s=0,this.autoAlpha=!1,this.alphaData=null,this._a=0},i.Particle.prototype=Object.create(i.Sprite.prototype),i.Particle.prototype.constructor=i.Particle,i.Particle.prototype.update=function(){this.autoScale&&(this._s--,this._s?this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y):this.autoScale=!1),this.autoAlpha&&(this._a--,this._a?this.alpha=this.alphaData[this._a].v:this.autoAlpha=!1)},i.Particle.prototype.onEmit=function(){},i.Particle.prototype.setAlphaData=function(t){this.alphaData=t,this._a=t.length-1,this.alpha=this.alphaData[this._a].v,this.autoAlpha=!0},i.Particle.prototype.setScaleData=function(t){this.scaleData=t,this._s=t.length-1,this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y),this.autoScale=!0},i.Particle.prototype.reset=function(t,e,i){return"undefined"==typeof i&&(i=1),this.world.setTo(t,e),this.position.x=t,this.position.y=e,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.health=i,this.body&&this.body.reset(t,e,!1,!1),this._cache[4]=1,this.alpha=1,this.scale.set(1),this.autoScale=!1,this.autoAlpha=!1,this},i.Canvas={create:function(t,e,i,n){if("undefined"==typeof n&&(n=!1),t=t||256,e=e||256,n)var r=document.createElement("canvas");else var r=document.createElement(navigator.isCocoonJS?"screencanvas":"canvas");return"string"==typeof i&&""!==i&&(r.id=i),r.width=t,r.height=e,r.style.display="block",r},getOffset:function(t,e){e=e||new i.Point;var n=t.getBoundingClientRect(),r=t.clientTop||document.body.clientTop||0,s=t.clientLeft||document.body.clientLeft||0,o=0,a=0;return"CSS1Compat"===document.compatMode?(o=window.pageYOffset||document.documentElement.scrollTop||t.scrollTop||0,a=window.pageXOffset||document.documentElement.scrollLeft||t.scrollLeft||0):(o=window.pageYOffset||document.body.scrollTop||t.scrollTop||0,a=window.pageXOffset||document.body.scrollLeft||t.scrollLeft||0),e.x=n.left+a-s,e.y=n.top+o-r,e},getAspectRatio:function(t){return t.width/t.height},setBackgroundColor:function(t,e){return e=e||"rgb(0,0,0)",t.style.backgroundColor=e,t},setTouchAction:function(t,e){return e=e||"none",t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t},setUserSelect:function(t,e){return e=e||"none",t.style["-webkit-touch-callout"]=e,t.style["-webkit-user-select"]=e,t.style["-khtml-user-select"]=e,t.style["-moz-user-select"]=e,t.style["-ms-user-select"]=e,t.style["user-select"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t},addToDOM:function(t,e,i){var n;return"undefined"==typeof i&&(i=!0),e&&("string"==typeof e?n=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(n=e)),n||(n=document.body),i&&n.style&&(n.style.overflow="hidden"),n.appendChild(t),t},setTransform:function(t,e,i,n,r,s,o){return t.setTransform(n,s,o,r,e,i),t},setSmoothingEnabled:function(t,e){return t.imageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.oImageSmoothingEnabled=e,t.webkitImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e,t},setImageRenderingCrisp:function(t){return t.style["image-rendering"]="optimizeSpeed",t.style["image-rendering"]="crisp-edges",t.style["image-rendering"]="-moz-crisp-edges",t.style["image-rendering"]="-webkit-optimize-contrast",t.style["image-rendering"]="optimize-contrast",t.style.msInterpolationMode="nearest-neighbor",t},setImageRenderingBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}},i.Device=function(t){this.game=t,this.desktop=!1,this.iOS=!1,this.cocoonJS=!1,this.ejecta=!1,this.crosswalk=!1,this.android=!1,this.chromeOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.canvas=!1,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.webGL=!1,this.worker=!1,this.touch=!1,this.mspointer=!1,this.css3D=!1,this.pointerLock=!1,this.typedArray=!1,this.vibration=!1,this.getUserMedia=!1,this.quirksMode=!1,this.arora=!1,this.chrome=!1,this.epiphany=!1,this.firefox=!1,this.ie=!1,this.ieVersion=0,this.trident=!1,this.tridentVersion=0,this.mobileSafari=!1,this.midori=!1,this.opera=!1,this.safari=!1,this.webApp=!1,this.silk=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this.littleEndian=!1,this.support32bit=!1,this.fullscreen=!1,this.requestFullscreen="",this.cancelFullscreen="",this.fullscreenKeyboard=!1,this._checkAudio(),this._checkBrowser(),this._checkCSS3D(),this._checkDevice(),this._checkFeatures(),this._checkOS()},i.Device.LITTLE_ENDIAN=!1,i.Device.prototype={_checkOS:function(){var t=navigator.userAgent;/Android/.test(t)?this.android=!0:/CrOS/.test(t)?this.chromeOS=!0:/iP[ao]d|iPhone/i.test(t)?this.iOS=!0:/Linux/.test(t)?this.linux=!0:/Mac OS/.test(t)?this.macOS=!0:/Windows/.test(t)&&(this.windows=!0,/Windows Phone/i.test(t)&&(this.windowsPhone=!0)),(this.windows||this.macOS||this.linux&&this.silk===!1)&&(this.desktop=!0),(this.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(this.desktop=!1)},_checkFeatures:function(){this.canvas=!!window.CanvasRenderingContext2D||this.cocoonJS;try{this.localStorage=!!localStorage.getItem}catch(t){this.localStorage=!1}this.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),this.fileSystem=!!window.requestFileSystem,this.webGL=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),this.webGL=null===this.webGL||this.webGL===!1?!1:!0,this.worker=!!window.Worker,("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>1)&&(this.touch=!0),(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&(this.mspointer=!0),this.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,this.quirksMode="CSS1Compat"===document.compatMode?!1:!0,this.getUserMedia=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)},checkFullScreenSupport:function(){for(var t=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],e=0;e<t.length;e++)this.game.canvas[t[e]]&&(this.fullscreen=!0,this.requestFullscreen=t[e]);var i=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(this.fullscreen)for(var e=0;e<i.length;e++)this.game.canvas[i[e]]&&(this.cancelFullscreen=i[e]);window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(this.fullscreenKeyboard=!0)},_checkBrowser:function(){var t=navigator.userAgent;/Arora/.test(t)?this.arora=!0:/Chrome/.test(t)?this.chrome=!0:/Epiphany/.test(t)?this.epiphany=!0:/Firefox/.test(t)?this.firefox=!0:/Mobile Safari/.test(t)?this.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(t)?(this.ie=!0,this.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(t)?this.midori=!0:/Opera/.test(t)?this.opera=!0:/Safari/.test(t)?this.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(this.ie=!0,this.trident=!0,this.tridentVersion=parseInt(RegExp.$1,10),this.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(this.silk=!0),navigator.standalone&&(this.webApp=!0),navigator.isCocoonJS&&(this.cocoonJS=!0),"undefined"!=typeof window.ejecta&&(this.ejecta=!0),/Crosswalk/.test(t)&&(this.crosswalk=!0)},_checkAudio:function(){this.audioData=!!window.Audio,this.webAudio=!(!window.webkitAudioContext&&!window.AudioContext);var t=document.createElement("audio"),e=!1;try{(e=!!t.canPlayType)&&(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.ogg=!0),t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")&&(this.opus=!0),t.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.mp3=!0),t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.wav=!0),(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;").replace(/^no$/,""))&&(this.m4a=!0),t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(this.webm=!0))}catch(i){}},_checkDevice:function(){this.pixelRatio=window.devicePixelRatio||1,this.iPhone=-1!=navigator.userAgent.toLowerCase().indexOf("iphone"),this.iPhone4=2==this.pixelRatio&&this.iPhone,this.iPad=-1!=navigator.userAgent.toLowerCase().indexOf("ipad"),this.typedArray="undefined"!=typeof Int8Array?!0:!1,"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(this.littleEndian=this._checkIsLittleEndian(),i.Device.LITTLE_ENDIAN=this.littleEndian),this.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==this.littleEndian&&this._checkIsUint8ClampedImageData(),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(this.vibration=!0)
},_checkIsLittleEndian:function(){var t=new ArrayBuffer(4),e=new Uint8Array(t),i=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041==i[0]?!0:2712847316==i[0]?!1:null},_checkIsUint8ClampedImageData:function(){if("undefined"==typeof Uint8ClampedArray)return!1;var t=document.createElement("canvas"),e=t.getContext("2d");if(!e)return!1;var i=e.createImageData(1,1);return i.data instanceof Uint8ClampedArray},_checkCSS3D:function(){var t,e=document.createElement("p"),i={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(e,null);for(var n in i)void 0!==e.style[n]&&(e.style[n]="translate3d(1px,1px,1px)",t=window.getComputedStyle(e).getPropertyValue(i[n]));document.body.removeChild(e),this.css3D=void 0!==t&&t.length>0&&"none"!==t},canPlayAudio:function(t){return"mp3"==t&&this.mp3?!0:"ogg"==t&&(this.ogg||this.opus)?!0:"m4a"==t&&this.m4a?!0:"wav"==t&&this.wav?!0:"webm"==t&&this.webm?!0:!1},isConsoleOpen:function(){return window.console&&window.console.firebug?!0:window.console&&(console.profile(),console.profileEnd(),console.clear&&console.clear(),console.profiles)?console.profiles.length>0:!1}},i.Device.prototype.constructor=i.Device,i.RequestAnimationFrame=function(t,e){"undefined"==typeof e&&(e=!1),this.game=t,this.isRunning=!1,this.forceSetTimeOut=e;for(var i=["ms","moz","webkit","o"],n=0;n<i.length&&!window.requestAnimationFrame;n++)window.requestAnimationFrame=window[i[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[n]+"CancelAnimationFrame"];this._isSetTimeOut=!1,this._onLoop=null,this._timeOutID=null},i.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var t=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return t.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(e){return t.updateRAF(e)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(){this.game.update(Date.now()),this._timeOutID=window.requestAnimationFrame(this._onLoop)},updateSetTimeout:function(){this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall)},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID),this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return this._isSetTimeOut===!1}},i.RequestAnimationFrame.prototype.constructor=i.RequestAnimationFrame,i.Math={PI2:2*Math.PI,fuzzyEqual:function(t,e,i){return"undefined"==typeof i&&(i=1e-4),Math.abs(t-e)<i},fuzzyLessThan:function(t,e,i){return"undefined"==typeof i&&(i=1e-4),e+i>t},fuzzyGreaterThan:function(t,e,i){return"undefined"==typeof i&&(i=1e-4),t>e-i},fuzzyCeil:function(t,e){return"undefined"==typeof e&&(e=1e-4),Math.ceil(t-e)},fuzzyFloor:function(t,e){return"undefined"==typeof e&&(e=1e-4),Math.floor(t+e)},average:function(){for(var t=[],e=0;e<arguments.length-0;e++)t[e]=arguments[e+0];for(var i=0,n=0;n<t.length;n++)i+=t[n];return i/t.length},truncate:function(t){return t>0?Math.floor(t):Math.ceil(t)},shear:function(t){return t%1},snapTo:function(t,e,i){return"undefined"==typeof i&&(i=0),0===e?t:(t-=i,t=e*Math.round(t/e),i+t)},snapToFloor:function(t,e,i){return"undefined"==typeof i&&(i=0),0===e?t:(t-=i,t=e*Math.floor(t/e),i+t)},snapToCeil:function(t,e,i){return"undefined"==typeof i&&(i=0),0===e?t:(t-=i,t=e*Math.ceil(t/e),i+t)},snapToInArray:function(t,e,i){if("undefined"==typeof i&&(i=!0),i&&e.sort(),t<e[0])return e[0];for(var n=1;e[n]<t;)n++;var r=e[n-1],s=n<e.length?e[n]:Number.POSITIVE_INFINITY;return t-r>=s-t?s:r},roundTo:function(t,e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=10);var n=Math.pow(i,-e);return Math.round(t*n)/n},floorTo:function(t,e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=10);var n=Math.pow(i,-e);return Math.floor(t*n)/n},ceilTo:function(t,e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=10);var n=Math.pow(i,-e);return Math.ceil(t*n)/n},interpolateFloat:function(t,e,i){return(e-t)*i+t},angleBetween:function(t,e,i,n){return Math.atan2(n-e,i-t)},angleBetweenPoints:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},reverseAngle:function(t){return this.normalizeAngle(t+Math.PI,!0)},normalizeAngle:function(t){return t%=2*Math.PI,t>=0?t:t+2*Math.PI},normalizeLatitude:function(t){return Math.max(-90,Math.min(90,t))},normalizeLongitude:function(t){return t%360==180?180:(t%=360,-180>t?t+360:t>180?t-360:t)},chanceRoll:function(t){return"undefined"==typeof t&&(t=50),0>=t?!1:t>=100?!0:100*Math.random()>=t?!1:!0},numberArray:function(t,e){for(var i=[],n=t;e>=n;n++)i.push(n);return i},maxAdd:function(t,e,i){return t+=e,t>i&&(t=i),t},minSub:function(t,e,i){return t-=e,i>t&&(t=i),t},wrap:function(t,e,i){var n=i-e;if(0>=n)return 0;var r=(t-e)%n;return 0>r&&(r+=n),r+e},wrapValue:function(t,e,i){var n;return t=Math.abs(t),e=Math.abs(e),i=Math.abs(i),n=(t+e)%i},limitValue:function(t,e,i){return e>t?e:t>i?i:t},randomSign:function(){return Math.random()>.5?1:-1},isOdd:function(t){return 1&t},isEven:function(t){return 1&t?!1:!0},min:function(){if(1===arguments.length&&"object"==typeof arguments[0])var t=arguments[0];else var t=arguments;for(var e=1,i=0,n=t.length;n>e;e++)t[e]<t[i]&&(i=e);return t[i]},max:function(){if(1===arguments.length&&"object"==typeof arguments[0])var t=arguments[0];else var t=arguments;for(var e=1,i=0,n=t.length;n>e;e++)t[e]>t[i]&&(i=e);return t[i]},minProperty:function(t){if(2===arguments.length&&"object"==typeof arguments[1])var e=arguments[1];else var e=arguments.slice(1);for(var i=1,n=0,r=e.length;r>i;i++)e[i][t]<e[n][t]&&(n=i);return e[n][t]},maxProperty:function(t){if(2===arguments.length&&"object"==typeof arguments[1])var e=arguments[1];else var e=arguments.slice(1);for(var i=1,n=0,r=e.length;r>i;i++)e[i][t]>e[n][t]&&(n=i);return e[n][t]},wrapAngle:function(t,e){var i=e?Math.PI/180:1;return this.wrap(t,-180*i,180*i)},angleLimit:function(t,e,i){var n=t;return t>i?n=i:e>t&&(n=e),n},linearInterpolation:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n);return 0>e?this.linear(t[0],t[1],n):e>1?this.linear(t[i],t[i-1],i-n):this.linear(t[r],t[r+1>i?i:r+1],n-r)},bezierInterpolation:function(t,e){for(var i=0,n=t.length-1,r=0;n>=r;r++)i+=Math.pow(1-e,n-r)*Math.pow(e,r)*t[r]*this.bernstein(n,r);return i},catmullRomInterpolation:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n);return t[0]===t[i]?(0>e&&(r=Math.floor(n=i*(1+e))),this.catmullRom(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):0>e?t[0]-(this.catmullRom(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(this.catmullRom(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):this.catmullRom(t[r?r-1:0],t[r],t[r+1>i?i:r+1],t[r+2>i?i:r+2],n-r)},linear:function(t,e,i){return(e-t)*i+t},bernstein:function(t,e){return this.factorial(t)/this.factorial(e)/this.factorial(t-e)},catmullRom:function(t,e,i,n,r){var s=.5*(i-t),o=.5*(n-e),a=r*r,h=r*a;return(2*e-2*i+s+o)*h+(-3*e+3*i-2*s-o)*a+s*r+e},difference:function(t,e){return Math.abs(t-e)},getRandom:function(t,e,i){if("undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=0),null!=t){var n=i;if((0===n||n>t.length-e)&&(n=t.length-e),n>0)return t[e+Math.floor(Math.random()*n)]}return null},removeRandom:function(t,e,i){if("undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=0),null!=t){var n=i;if((0===n||n>t.length-e)&&(n=t.length-e),n>0){var r=e+Math.floor(Math.random()*n),s=t.splice(r,1);return s[0]}}return null},floor:function(t){var e=0|t;return t>0?e:e!=t?e-1:e},ceil:function(t){var e=0|t;return t>0?e!=t?e+1:e:e},sinCosGenerator:function(t,e,i,n){"undefined"==typeof e&&(e=1),"undefined"==typeof i&&(i=1),"undefined"==typeof n&&(n=1);for(var r=e,s=i,o=n*Math.PI/t,a=[],h=[],u=0;t>u;u++)s-=r*o,r+=s*o,a[u]=s,h[u]=r;return{sin:h,cos:a,length:t}},shift:function(t){var e=t.shift();return t.push(e),e},shuffleArray:function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},distance:function(t,e,i,n){var r=t-i,s=e-n;return Math.sqrt(r*r+s*s)},distancePow:function(t,e,i,n,r){return"undefined"==typeof r&&(r=2),Math.sqrt(Math.pow(i-t,r)+Math.pow(n-e,r))},distanceRounded:function(t,e,n,r){return Math.round(i.Math.distance(t,e,n,r))},clamp:function(t,e,i){return e>t?e:t>i?i:t},clampBottom:function(t,e){return e>t?e:t},within:function(t,e,i){return Math.abs(t-e)<=i},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},smoothstep:function(t,e,i){return t=Math.max(0,Math.min(1,(t-e)/(i-e))),t*t*(3-2*t)},smootherstep:function(t,e,i){return t=Math.max(0,Math.min(1,(t-e)/(i-e))),t*t*t*(t*(6*t-15)+10)},sign:function(t){return 0>t?-1:t>0?1:0},percent:function(t,e,i){return"undefined"==typeof i&&(i=0),t>e||i>e?1:i>t||i>t?0:(t-i)/e},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}()},i.RandomDataGenerator=function(t){"undefined"==typeof t&&(t=[]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.sow(t)},i.RandomDataGenerator.prototype={rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},sow:function(t){"undefined"==typeof t&&(t=[]),this.s0=this.hash(" "),this.s1=this.hash(this.s0),this.s2=this.hash(this.s1),this.c=1;for(var e,i=0;e=t[i++];)this.s0-=this.hash(e),this.s0+=~~(this.s0<0),this.s1-=this.hash(e),this.s1+=~~(this.s1<0),this.s2-=this.hash(e),this.s2+=~~(this.s2<0)},hash:function(t){var e,i,n;for(n=4022871197,t=t.toString(),i=0;i<t.length;i++)n+=t.charCodeAt(i),e=.02519603282416938*n,n=e>>>0,e-=n,e*=n,n=e>>>0,e-=n,n+=4294967296*e;return 2.3283064365386963e-10*(n>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+1.1102230246251565e-16*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1))]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)}},i.RandomDataGenerator.prototype.constructor=i.RandomDataGenerator,i.QuadTree=function(t,e,i,n,r,s,o){this.maxObjects=10,this.maxLevels=4,this.level=0,this.bounds={},this.objects=[],this.nodes=[],this._empty=[],this.reset(t,e,i,n,r,s,o)},i.QuadTree.prototype={reset:function(t,e,i,n,r,s,o){this.maxObjects=r||10,this.maxLevels=s||4,this.level=o||0,this.bounds={x:Math.round(t),y:Math.round(e),width:i,height:n,subWidth:Math.floor(i/2),subHeight:Math.floor(n/2),right:Math.round(t)+Math.floor(i/2),bottom:Math.round(e)+Math.floor(n/2)},this.objects.length=0,this.nodes.length=0},populate:function(t){t.forEach(this.populateHandler,this,!0)},populateHandler:function(t){t.body&&t.exists&&this.insert(t.body)},split:function(){this.level++,this.nodes[0]=new i.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level),this.nodes[1]=new i.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level),this.nodes[2]=new i.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level),this.nodes[3]=new i.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level)},insert:function(t){var e,i=0;if(null!=this.nodes[0]&&(e=this.getIndex(t),-1!==e))return this.nodes[e].insert(t),void 0;if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();i<this.objects.length;)e=this.getIndex(this.objects[i]),-1!==e?this.nodes[e].insert(this.objects.splice(i,1)[0]):i++},getIndex:function(t){var e=-1;return t.x<this.bounds.right&&t.right<this.bounds.right?t.y<this.bounds.bottom&&t.bottom<this.bounds.bottom?e=1:t.y>this.bounds.bottom&&(e=2):t.x>this.bounds.right&&(t.y<this.bounds.bottom&&t.bottom<this.bounds.bottom?e=0:t.y>this.bounds.bottom&&(e=3)),e},retrieve:function(t){if(t instanceof i.Rectangle)var e=this.objects,n=this.getIndex(t);else{if(!t.body)return this._empty;var e=this.objects,n=this.getIndex(t.body)}return this.nodes[0]&&(-1!==n?e=e.concat(this.nodes[n].retrieve(t)):(e=e.concat(this.nodes[0].retrieve(t)),e=e.concat(this.nodes[1].retrieve(t)),e=e.concat(this.nodes[2].retrieve(t)),e=e.concat(this.nodes[3].retrieve(t)))),e},clear:function(){this.objects.length=0;for(var t=this.nodes.length;t--;)this.nodes[t].clear(),this.nodes.splice(t,1);this.nodes.length=0}},i.QuadTree.prototype.constructor=i.QuadTree,i.Net=function(t){this.game=t},i.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(t){return-1!==window.location.hostname.indexOf(t)},updateQueryString:function(t,e,i,n){"undefined"==typeof i&&(i=!1),("undefined"==typeof n||""===n)&&(n=window.location.href);var r="",s=new RegExp("([?|&])"+t+"=.*?(&|#|$)(.*)","gi");if(s.test(n))r="undefined"!=typeof e&&null!==e?n.replace(s,"$1"+t+"="+e+"$2$3"):n.replace(s,"$1$3").replace(/(&|\?)$/,"");else if("undefined"!=typeof e&&null!==e){var o=-1!==n.indexOf("?")?"&":"?",a=n.split("#");n=a[0]+o+t+"="+e,a[1]&&(n+="#"+a[1]),r=n}else r=n;return i?(window.location.href=r,void 0):r},getQueryString:function(t){"undefined"==typeof t&&(t="");var e={},i=location.search.substring(1).split("&");for(var n in i){var r=i[n].split("=");if(r.length>1){if(t&&t==this.decodeURI(r[0]))return this.decodeURI(r[1]);e[this.decodeURI(r[0])]=this.decodeURI(r[1])}}return e},decodeURI:function(t){return decodeURIComponent(t.replace(/\+/g," "))}},i.Net.prototype.constructor=i.Net,i.TweenManager=function(t){this.game=t,this._tweens=[],this._add=[],this.game.onPause.add(this._pauseAll,this),this.game.onResume.add(this._resumeAll,this)},i.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var t=0;t<this._tweens.length;t++)this._tweens[t].pendingDelete=!0;this._add=[]},add:function(t){t._manager=this,this._add.push(t)},create:function(t){return new i.Tween(t,this.game,this)},remove:function(t){var e=this._tweens.indexOf(t);-1!==e&&(this._tweens[e].pendingDelete=!0)},update:function(){if(0===this._tweens.length&&0===this._add.length)return!1;for(var t=0,e=this._tweens.length;e>t;)this._tweens[t].update(this.game.time.now)?t++:(this._tweens.splice(t,1),e--);return this._add.length>0&&(this._tweens=this._tweens.concat(this._add),this._add.length=0),!0},isTweening:function(t){return this._tweens.some(function(e){return e._object===t})},_pauseAll:function(){for(var t=this._tweens.length-1;t>=0;t--)this._tweens[t]._pause()},_resumeAll:function(){for(var t=this._tweens.length-1;t>=0;t--)this._tweens[t]._resume()},pauseAll:function(){for(var t=this._tweens.length-1;t>=0;t--)this._tweens[t].pause()},resumeAll:function(){for(var t=this._tweens.length-1;t>=0;t--)this._tweens[t].resume(!0)}},i.TweenManager.prototype.constructor=i.TweenManager,i.Tween=function(t,e,n){this._object=t,this.game=e,this._manager=n,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._yoyo=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=i.Easing.Linear.None,this._interpolationFunction=i.Math.linearInterpolation,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,this._paused=!1,this._pausedTime=0,this._codePaused=!1,this.pendingDelete=!1,this.onStart=new i.Signal,this.onLoop=new i.Signal,this.onComplete=new i.Signal,this.isRunning=!1},i.Tween.prototype={to:function(t,e,i,n,r,s,o){e=e||1e3,i=i||null,n=n||!1,r=r||0,s=s||0,o=o||!1,o&&0===s&&(s=1);var a;return this._parent?(a=this._manager.create(this._object),this._lastChild.chain(a),this._lastChild=a):(a=this,this._parent=this,this._lastChild=this),a._repeat=s,a._duration=e,a._valuesEnd=t,null!==i&&(a._easingFunction=i),r>0&&(a._delayTime=r),a._yoyo=o,n?this.start():this},from:function(t,e,i,n,r,s,o){var a={};for(var h in t)t.hasOwnProperty(h)&&(a[h]=this._object[h],this._object[h]=t[h]);this.to(a,e,i,n,r,s,o)},start:function(){if(null!==this.game&&null!==this._object){this._manager.add(this),this.isRunning=!0,this._onStartCallbackFired=!1,this._startTime=this.game.time.now+this._delayTime;for(var t in this._valuesEnd){if(Array.isArray(this._valuesEnd[t])){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this._object[t]].concat(this._valuesEnd[t])}this._valuesStart[t]=this._object[t],Array.isArray(this._valuesStart[t])||(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0}return this}},generateData:function(t,e){if(null===this.game||null===this._object)return null;this._startTime=0;for(var i in this._valuesEnd){if(Array.isArray(this._valuesEnd[i])){if(0===this._valuesEnd[i].length)continue;this._valuesEnd[i]=[this._object[i]].concat(this._valuesEnd[i])}this._valuesStart[i]=this._object[i],Array.isArray(this._valuesStart[i])||(this._valuesStart[i]*=1),this._valuesStartRepeat[i]=this._valuesStart[i]||0}for(var n=0,r=Math.floor(t*(this._duration/1e3)),s=this._duration/r,o=[];r--;){var i,a=(n-this._startTime)/this._duration;a=a>1?1:a;var h=this._easingFunction(a),u={};for(i in this._valuesEnd){var c=this._valuesStart[i]||0,l=this._valuesEnd[i];l instanceof Array?u[i]=this._interpolationFunction(l,h):("string"==typeof l&&(l=c+parseFloat(l,10)),"number"==typeof l&&(u[i]=c+(l-c)*h))}o.push(u),n+=s}if(this._yoyo){var d=o.slice();d.reverse(),o=o.concat(d)}return"undefined"!=typeof e?e=e.concat(o):o},stop:function(){return this.isRunning=!1,this._onUpdateCallback=null,this._manager.remove(this),this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},yoyo:function(t){return this._yoyo=t,t&&0===this._repeat&&(this._repeat=1),this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},loop:function(){return this._lastChild.chain(this),this},onUpdateCallback:function(t,e){return this._onUpdateCallback=t,this._onUpdateCallbackContext=e,this},pause:function(){this._codePaused=!0,this._paused=!0,this._pausedTime=this.game.time.now},_pause:function(){this._codePaused||(this._paused=!0,this._pausedTime=this.game.time.now)},resume:function(){this._paused&&(this._paused=!1,this._codePaused=!1,this._startTime+=this.game.time.now-this._pausedTime)},_resume:function(){this._codePaused||(this._startTime+=this.game.time.pauseDuration,this._paused=!1)},update:function(t){if(this.pendingDelete)return!1;if(this._paused||t<this._startTime)return!0;var e;if(t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this.onStart.dispatch(this._object),this._onStartCallbackFired=!0);var i=(t-this._startTime)/this._duration;i=i>1?1:i;var n=this._easingFunction(i);for(e in this._valuesEnd){var r=this._valuesStart[e]||0,s=this._valuesEnd[e];s instanceof Array?this._object[e]=this._interpolationFunction(s,n):("string"==typeof s&&(s=r+parseFloat(s,10)),"number"==typeof s&&(this._object[e]=r+(s-r)*n))}if(null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._onUpdateCallbackContext,this,n),1==i){if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e],10)),this._yoyo){var o=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=o}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),this._startTime=t+this._delayTime,this.onLoop.dispatch(this._object),!0}this.isRunning=!1,this.onComplete.dispatch(this._object);for(var a=0,h=this._chainedTweens.length;h>a;a++)this._chainedTweens[a].start(t);return!1}return!0}},i.Tween.prototype.constructor=i.Tween,i.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)))},Out:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/n)+1)},InOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n):i*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-i.Easing.Bounce.Out(1-t)},Out:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*i.Easing.Bounce.In(2*t):.5*i.Easing.Bounce.Out(2*t-1)+.5}}},i.Time=function(t){this.game=t,this.time=0,this.now=0,this.elapsed=0,this.pausedTime=0,this.advancedTiming=!1,this.fps=0,this.fpsMin=1e3,this.fpsMax=0,this.msMin=1e3,this.msMax=0,this.physicsElapsed=0,this.deltaCap=0,this.timeCap=1e3,this.frames=0,this.pauseDuration=0,this.timeToCall=0,this.lastTime=0,this.events=new i.Timer(this.game,!1),this._started=0,this._timeLastSecond=0,this._pauseStarted=0,this._justResumed=!1,this._timers=[],this._len=0,this._i=0},i.Time.prototype={boot:function(){this._started=Date.now(),this.events.start()},create:function(t){"undefined"==typeof t&&(t=!0);var e=new i.Timer(this.game,t);return this._timers.push(e),e},removeAll:function(){for(var t=0;t<this._timers.length;t++)this._timers[t].destroy();this._timers=[],this.events.removeAll()},update:function(t){if(this.now=t,this.timeToCall=this.game.math.max(0,16-(t-this.lastTime)),this.elapsed=this.now-this.time,this.elapsed>this.timeCap&&(this.elapsed=1/60),this.physicsElapsed=this.elapsed/1e3||1/60,this.deltaCap>0&&this.physicsElapsed>this.deltaCap&&(this.physicsElapsed=this.deltaCap),this.advancedTiming&&(this.msMin=this.game.math.min(this.msMin,this.elapsed),this.msMax=this.game.math.max(this.msMax,this.elapsed),this.frames++,this.now>this._timeLastSecond+1e3&&(this.fps=Math.round(1e3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=this.game.math.min(this.fpsMin,this.fps),this.fpsMax=this.game.math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)),this.time=this.now,this.lastTime=t+this.timeToCall,!this.game.paused)for(this.events.update(this.now),this._i=0,this._len=this._timers.length;this._i<this._len;)this._timers[this._i].update(this.now)?this._i++:(this._timers.splice(this._i,1),this._len--)},gamePaused:function(){this._pauseStarted=this.now,this.events.pause();for(var t=this._timers.length;t--;)this._timers[t]._pause()},gameResumed:function(){this.time=this.now=Date.now(),this.pauseDuration=this.time-this._pauseStarted,this.events.resume();for(var t=this._timers.length;t--;)this._timers[t]._resume()},totalElapsedSeconds:function(){return.001*(this.now-this._started)},elapsedSince:function(t){return this.now-t},elapsedSecondsSince:function(t){return.001*(this.now-t)},reset:function(){this._started=this.now,this.removeAll()}},i.Time.prototype.constructor=i.Time,i.Timer=function(t,e){"undefined"==typeof e&&(e=!0),this.game=t,this.running=!1,this.autoDestroy=e,this.expired=!1,this.elapsed=0,this.events=[],this.onComplete=new i.Signal,this.nextTick=0,this.timeCap=1e3,this.paused=!1,this._codePaused=!1,this._started=0,this._pauseStarted=0,this._pauseTotal=0,this._now=Date.now(),this._len=0,this._marked=0,this._i=0,this._diff=0,this._newTick=0},i.Timer.MINUTE=6e4,i.Timer.SECOND=1e3,i.Timer.HALF=500,i.Timer.QUARTER=250,i.Timer.prototype={create:function(t,e,n,r,s,o){var a=t;a+=0===this._now?this.game.time.now:this._now;var h=new i.TimerEvent(this,t,a,n,e,r,s,o);return this.events.push(h),this.order(),this.expired=!1,h},add:function(t,e,i){return this.create(t,!1,0,e,i,Array.prototype.splice.call(arguments,3))},repeat:function(t,e,i,n){return this.create(t,!1,e,i,n,Array.prototype.splice.call(arguments,4))},loop:function(t,e,i){return this.create(t,!0,0,e,i,Array.prototype.splice.call(arguments,3))},start:function(t){if(!this.running){this._started=this.game.time.now+(t||0),this.running=!0;for(var e=0;e<this.events.length;e++)this.events[e].tick=this.events[e].delay+this._started}},stop:function(t){this.running=!1,"undefined"==typeof t&&(t=!0),t&&(this.events.length=0)},remove:function(t){for(var e=0;e<this.events.length;e++)if(this.events[e]===t)return this.events[e].pendingDelete=!0,!0;return!1},order:function(){this.events.length>0&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(t,e){return t.tick<e.tick?-1:t.tick>e.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length,this._i=0},update:function(t){if(this.paused)return!0;if(this.elapsed=t-this._now,this._now=t,this.elapsed>this.timeCap&&this.adjustEvents(t-this.elapsed),this._marked=0,this.clearPendingEvents(),this.running&&this._now>=this.nextTick&&this._len>0){for(;this._i<this._len&&this.running&&this._now>=this.events[this._i].tick;)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),this._newTick<0&&(this._newTick=this._now+this.events[this._i].delay),this.events[this._i].loop===!0?(this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)):this.events[this._i].repeatCount>0?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)):(this._marked++,this.events[this._i].pendingDelete=!0,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)),this._i++;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return this.expired&&this.autoDestroy?!1:!0},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.now,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.now,this.paused=!0)},adjustEvents:function(t){for(var e=0;e<this.events.length;e++)if(!this.events[e].pendingDelete){var i=this.events[e].tick-t;0>i&&(i=0),this.events[e].tick=this._now+i}var n=this.nextTick-t;this.nextTick=0>n?this._now:this._now+n},resume:function(){if(this.paused){var t=this.game.time.now;this._pauseTotal+=t-this._now,this._now=t,this.adjustEvents(this._pauseStarted),this.paused=!1,this._codePaused=!1}},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll(),this.events.length=0,this._len=0,this._i=0},destroy:function(){this.onComplete.removeAll(),this.running=!1,this.events=[],this._len=0,this._i=0}},Object.defineProperty(i.Timer.prototype,"next",{get:function(){return this.nextTick}}),Object.defineProperty(i.Timer.prototype,"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}}),Object.defineProperty(i.Timer.prototype,"length",{get:function(){return this.events.length}}),Object.defineProperty(i.Timer.prototype,"ms",{get:function(){return this._now-this._started-this._pauseTotal}}),Object.defineProperty(i.Timer.prototype,"seconds",{get:function(){return.001*this.ms}}),i.Timer.prototype.constructor=i.Timer,i.TimerEvent=function(t,e,i,n,r,s,o,a){this.timer=t,this.delay=e,this.tick=i,this.repeatCount=n-1,this.loop=r,this.callback=s,this.callbackContext=o,this.args=a,this.pendingDelete=!1},i.TimerEvent.prototype.constructor=i.TimerEvent,i.AnimationManager=function(t){this.sprite=t,this.game=t.game,this.currentFrame=null,this.currentAnim=null,this.updateIfVisible=!0,this.isLoaded=!1,this._frameData=null,this._anims={},this._outputFrames=[]},i.AnimationManager.prototype={loadFrameData:function(t){this._frameData=t,this.frame=0,this.isLoaded=!0},add:function(t,e,n,r,s){return null===this._frameData?(console.warn("No FrameData available for Phaser.Animation "+t),void 0):(e=e||[],n=n||60,"undefined"==typeof r&&(r=!1),"undefined"==typeof s&&(s=e&&"number"==typeof e[0]?!0:!1),null===this.sprite.events.onAnimationStart&&(this.sprite.events.onAnimationStart=new i.Signal,this.sprite.events.onAnimationComplete=new i.Signal,this.sprite.events.onAnimationLoop=new i.Signal),this._outputFrames.length=0,this._frameData.getFrameIndexes(e,s,this._outputFrames),this._anims[t]=new i.Animation(this.game,this.sprite,t,this._frameData,this._outputFrames,n,r),this.currentAnim=this._anims[t],this.currentFrame=this.currentAnim.currentFrame,this.sprite.setTexture(PIXI.TextureCache[this.currentFrame.uuid]),this.sprite.__tilePattern&&(this.__tilePattern=!1,this.tilingTexture=!1),this._anims[t])},validateFrames:function(t,e){"undefined"==typeof e&&(e=!0);for(var i=0;i<t.length;i++)if(e===!0){if(t[i]>this._frameData.total)return!1}else if(this._frameData.checkFrameName(t[i])===!1)return!1;return!0},play:function(t,e,i,n){if(this._anims[t]){if(this.currentAnim!==this._anims[t])return this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop(),this.currentAnim=this._anims[t],this.currentAnim.paused=!1,this.currentAnim.play(e,i,n);if(this.currentAnim.isPlaying===!1)return this.currentAnim.paused=!1,this.currentAnim.play(e,i,n)}},stop:function(t,e){"undefined"==typeof e&&(e=!1),"string"==typeof t?this._anims[t]&&(this.currentAnim=this._anims[t],this.currentAnim.stop(e)):this.currentAnim&&this.currentAnim.stop(e)},update:function(){return this.updateIfVisible&&!this.sprite.visible?!1:this.currentAnim&&this.currentAnim.update()===!0?(this.currentFrame=this.currentAnim.currentFrame,!0):!1},getAnimation:function(t){return"string"==typeof t&&this._anims[t]?this._anims[t]:null},refreshFrame:function(){this.sprite.setTexture(PIXI.TextureCache[this.currentFrame.uuid]),this.sprite.__tilePattern&&(this.__tilePattern=!1,this.tilingTexture=!1)},destroy:function(){var t=null;for(var t in this._anims)this._anims.hasOwnProperty(t)&&this._anims[t].destroy();
this._anims={},this._frameData=null,this._frameIndex=0,this.currentAnim=null,this.currentFrame=null}},i.AnimationManager.prototype.constructor=i.AnimationManager,Object.defineProperty(i.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}}),Object.defineProperty(i.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData?this._frameData.total:-1}}),Object.defineProperty(i.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(t){this.currentAnim.paused=t}}),Object.defineProperty(i.AnimationManager.prototype,"frame",{get:function(){return this.currentFrame?this._frameIndex:void 0},set:function(t){"number"==typeof t&&this._frameData&&null!==this._frameData.getFrame(t)&&(this.currentFrame=this._frameData.getFrame(t),this.currentFrame&&(this._frameIndex=t,this.sprite.setTexture(PIXI.TextureCache[this.currentFrame.uuid]),this.sprite.__tilePattern&&(this.__tilePattern=!1,this.tilingTexture=!1)))}}),Object.defineProperty(i.AnimationManager.prototype,"frameName",{get:function(){return this.currentFrame?this.currentFrame.name:void 0},set:function(t){"string"==typeof t&&this._frameData&&null!==this._frameData.getFrameByName(t)?(this.currentFrame=this._frameData.getFrameByName(t),this.currentFrame&&(this._frameIndex=this.currentFrame.index,this.sprite.setTexture(PIXI.TextureCache[this.currentFrame.uuid]),this.sprite.__tilePattern&&(this.__tilePattern=!1,this.tilingTexture=!1))):console.warn("Cannot set frameName: "+t)}}),i.Animation=function(t,e,n,r,s,o,a){this.game=t,this._parent=e,this._frameData=r,this.name=n,this._frames=[],this._frames=this._frames.concat(s),this.delay=1e3/o,this.loop=a,this.loopCount=0,this.killOnComplete=!1,this.isFinished=!1,this.isPlaying=!1,this.isPaused=!1,this._pauseStartTime=0,this._frameIndex=0,this._frameDiff=0,this._frameSkip=1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.onStart=new i.Signal,this.onComplete=new i.Signal,this.onLoop=new i.Signal,this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},i.Animation.prototype={play:function(t,e,i){return"number"==typeof t&&(this.delay=1e3/t),"boolean"==typeof e&&(this.loop=e),"undefined"!=typeof i&&(this.killOnComplete=i),this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.now,this._timeNextFrame=this.game.time.now+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setTexture(PIXI.TextureCache[this.currentFrame.uuid]),this._parent.__tilePattern&&(this._parent.__tilePattern=!1,this._parent.tilingTexture=!1),this._parent.events.onAnimationStart.dispatch(this._parent,this),this.onStart.dispatch(this._parent,this),this},restart:function(){this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.now,this._timeNextFrame=this.game.time.now+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.onStart.dispatch(this._parent,this)},setFrame:function(t,e){var i;if("undefined"==typeof e&&(e=!1),"string"==typeof t)for(var n=0;n<this._frames.length;n++)this._frameData.getFrame(this._frames[n]).name===t&&(i=n);else if("number"==typeof t)if(e)i=t;else for(var n=0;n<this._frames.length;n++)this.frames[n]===i&&(i=n);i&&(this._frameIndex=i-1,this._timeNextFrame=this.game.time.now,this.update())},stop:function(t,e){"undefined"==typeof t&&(t=!1),"undefined"==typeof e&&(e=!1),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,t&&(this.currentFrame=this._frameData.getFrame(this._frames[0])),e&&(this._parent.events.onAnimationComplete.dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.now)},onResume:function(){this.isPlaying&&(this._timeNextFrame=this.game.time.now+this._frameDiff)},update:function(){return this.isPaused?!1:this.isPlaying===!0&&this.game.time.now>=this._timeNextFrame?(this._frameSkip=1,this._frameDiff=this.game.time.now-this._timeNextFrame,this._timeLastFrame=this.game.time.now,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.now+(this.delay-this._frameDiff),this._frameIndex+=this._frameSkip,this._frameIndex>=this._frames.length?this.loop?(this._frameIndex%=this._frames.length,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(this._parent.setTexture(PIXI.TextureCache[this.currentFrame.uuid]),this._parent.__tilePattern&&(this._parent.__tilePattern=!1,this._parent.tilingTexture=!1)),this.loopCount++,this._parent.events.onAnimationLoop.dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this)):this.complete():(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(this._parent.setTexture(PIXI.TextureCache[this.currentFrame.uuid]),this._parent.__tilePattern&&(this._parent.__tilePattern=!1,this._parent.tilingTexture=!1))),!0):!1},destroy:function(){this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.game=null,this._parent=null,this._frames=null,this._frameData=null,this.currentFrame=null,this.isPlaying=!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose()},complete:function(){this.isPlaying=!1,this.isFinished=!0,this.paused=!1,this._parent.events.onAnimationComplete.dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this),this.killOnComplete&&this._parent.kill()}},i.Animation.prototype.constructor=i.Animation,Object.defineProperty(i.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(t){this.isPaused=t,t?this._pauseStartTime=this.game.time.now:this.isPlaying&&(this._timeNextFrame=this.game.time.now+this.delay)}}),Object.defineProperty(i.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}}),Object.defineProperty(i.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(t){this.currentFrame=this._frameData.getFrame(this._frames[t]),null!==this.currentFrame&&(this._frameIndex=t,this._parent.setTexture(PIXI.TextureCache[this.currentFrame.uuid]))}}),Object.defineProperty(i.Animation.prototype,"speed",{get:function(){return Math.round(1e3/this.delay)},set:function(t){t>=1&&(this.delay=1e3/t)}}),i.Animation.generateFrameNames=function(t,e,n,r,s){"undefined"==typeof r&&(r="");var o=[],a="";if(n>e)for(var h=e;n>=h;h++)a="number"==typeof s?i.Utils.pad(h.toString(),s,"0",1):h.toString(),a=t+a+r,o.push(a);else for(var h=e;h>=n;h--)a="number"==typeof s?i.Utils.pad(h.toString(),s,"0",1):h.toString(),a=t+a+r,o.push(a);return o},i.Frame=function(t,e,n,r,s,o,a){this.index=t,this.x=e,this.y=n,this.width=r,this.height=s,this.name=o,this.uuid=a,this.centerX=Math.floor(r/2),this.centerY=Math.floor(s/2),this.distance=i.Math.distance(0,0,r,s),this.rotated=!1,this.rotationDirection="cw",this.trimmed=!1,this.sourceSizeW=r,this.sourceSizeH=s,this.spriteSourceSizeX=0,this.spriteSourceSizeY=0,this.spriteSourceSizeW=0,this.spriteSourceSizeH=0},i.Frame.prototype={setTrim:function(t,e,i,n,r,s,o){this.trimmed=t,t&&(this.width=e,this.height=i,this.sourceSizeW=e,this.sourceSizeH=i,this.centerX=Math.floor(e/2),this.centerY=Math.floor(i/2),this.spriteSourceSizeX=n,this.spriteSourceSizeY=r,this.spriteSourceSizeW=s,this.spriteSourceSizeH=o)},getRect:function(t){return"undefined"==typeof t?t=new i.Rectangle(this.x,this.y,this.width,this.height):t.setTo(this.x,this.y,this.width,this.height),t}},i.Frame.prototype.constructor=i.Frame,i.FrameData=function(){this._frames=[],this._frameNames=[]},i.FrameData.prototype={addFrame:function(t){return t.index=this._frames.length,this._frames.push(t),""!==t.name&&(this._frameNames[t.name]=t.index),t},getFrame:function(t){return t>this._frames.length&&(t=0),this._frames[t]},getFrameByName:function(t){return"number"==typeof this._frameNames[t]?this._frames[this._frameNames[t]]:null},checkFrameName:function(t){return null==this._frameNames[t]?!1:!0},getFrameRange:function(t,e,i){"undefined"==typeof i&&(i=[]);for(var n=t;e>=n;n++)i.push(this._frames[n]);return i},getFrames:function(t,e,i){if("undefined"==typeof e&&(e=!0),"undefined"==typeof i&&(i=[]),"undefined"==typeof t||0===t.length)for(var n=0;n<this._frames.length;n++)i.push(this._frames[n]);else for(var n=0,r=t.length;r>n;n++)e?i.push(this.getFrame(t[n])):i.push(this.getFrameByName(t[n]));return i},getFrameIndexes:function(t,e,i){if("undefined"==typeof e&&(e=!0),"undefined"==typeof i&&(i=[]),"undefined"==typeof t||0===t.length)for(var n=0,r=this._frames.length;r>n;n++)i.push(this._frames[n].index);else for(var n=0,r=t.length;r>n;n++)e?i.push(t[n]):this.getFrameByName(t[n])&&i.push(this.getFrameByName(t[n]).index);return i}},i.FrameData.prototype.constructor=i.FrameData,Object.defineProperty(i.FrameData.prototype,"total",{get:function(){return this._frames.length}}),i.AnimationParser={spriteSheet:function(t,e,n,r,s,o,a){var h=t.cache.getImage(e);if(null==h)return null;var u=h.width,c=h.height;0>=n&&(n=Math.floor(-u/Math.min(-1,n))),0>=r&&(r=Math.floor(-c/Math.min(-1,r)));var l=Math.floor((u-o)/(n+a)),d=Math.floor((c-o)/(r+a)),p=l*d;if(-1!==s&&(p=s),0===u||0===c||n>u||r>c||0===p)return console.warn("Phaser.AnimationParser.spriteSheet: width/height zero or width/height < given frameWidth/frameHeight"),null;for(var f=new i.FrameData,m=o,g=o,y=0;p>y;y++){var v=t.rnd.uuid();f.addFrame(new i.Frame(y,m,g,n,r,"",v)),PIXI.TextureCache[v]=new PIXI.Texture(PIXI.BaseTextureCache[e],{x:m,y:g,width:n,height:r}),m+=n+a,m+n>u&&(m=o,g+=r+a)}return f},JSONData:function(t,e,n){if(!e.frames)return console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array"),console.log(e),void 0;for(var r,s=new i.FrameData,o=e.frames,a=0;a<o.length;a++){var h=t.rnd.uuid();r=s.addFrame(new i.Frame(a,o[a].frame.x,o[a].frame.y,o[a].frame.w,o[a].frame.h,o[a].filename,h)),PIXI.TextureCache[h]=new PIXI.Texture(PIXI.BaseTextureCache[n],{x:o[a].frame.x,y:o[a].frame.y,width:o[a].frame.w,height:o[a].frame.h}),o[a].trimmed&&(r.setTrim(o[a].trimmed,o[a].sourceSize.w,o[a].sourceSize.h,o[a].spriteSourceSize.x,o[a].spriteSourceSize.y,o[a].spriteSourceSize.w,o[a].spriteSourceSize.h),PIXI.TextureCache[h].trim=new i.Rectangle(o[a].spriteSourceSize.x,o[a].spriteSourceSize.y,o[a].sourceSize.w,o[a].sourceSize.h))}return s},JSONDataHash:function(t,e,n){if(!e.frames)return console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"),console.log(e),void 0;var r,s=new i.FrameData,o=e.frames,a=0;for(var h in o){var u=t.rnd.uuid();r=s.addFrame(new i.Frame(a,o[h].frame.x,o[h].frame.y,o[h].frame.w,o[h].frame.h,h,u)),PIXI.TextureCache[u]=new PIXI.Texture(PIXI.BaseTextureCache[n],{x:o[h].frame.x,y:o[h].frame.y,width:o[h].frame.w,height:o[h].frame.h}),o[h].trimmed&&(r.setTrim(o[h].trimmed,o[h].sourceSize.w,o[h].sourceSize.h,o[h].spriteSourceSize.x,o[h].spriteSourceSize.y,o[h].spriteSourceSize.w,o[h].spriteSourceSize.h),PIXI.TextureCache[u].trim=new i.Rectangle(o[h].spriteSourceSize.x,o[h].spriteSourceSize.y,o[h].sourceSize.w,o[h].sourceSize.h)),a++}return s},XMLData:function(t,e,n){if(!e.getElementsByTagName("TextureAtlas"))return console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag"),void 0;for(var r,s,o,a,h,u,c,l,d,p,f,m,g=new i.FrameData,y=e.getElementsByTagName("SubTexture"),v=0;v<y.length;v++)s=t.rnd.uuid(),a=y[v].attributes,o=a.name.nodeValue,h=parseInt(a.x.nodeValue,10),u=parseInt(a.y.nodeValue,10),c=parseInt(a.width.nodeValue,10),l=parseInt(a.height.nodeValue,10),d=null,p=null,a.frameX&&(d=Math.abs(parseInt(a.frameX.nodeValue,10)),p=Math.abs(parseInt(a.frameY.nodeValue,10)),f=parseInt(a.frameWidth.nodeValue,10),m=parseInt(a.frameHeight.nodeValue,10)),r=g.addFrame(new i.Frame(v,h,u,c,l,o,s)),PIXI.TextureCache[s]=new PIXI.Texture(PIXI.BaseTextureCache[n],{x:h,y:u,width:c,height:l}),(null!==d||null!==p)&&(r.setTrim(!0,c,l,d,p,f,m),PIXI.TextureCache[s].trim=new i.Rectangle(d,p,c,l));return g}},i.Cache=function(t){this.game=t,this._canvases={},this._images={},this._textures={},this._sounds={},this._text={},this._json={},this._physics={},this._tilemaps={},this._binary={},this._bitmapDatas={},this._bitmapFont={},this.addDefaultImage(),this.addMissingImage(),this.onSoundUnlock=new i.Signal,this._cacheMap=[],this._cacheMap[i.Cache.CANVAS]=this._canvases,this._cacheMap[i.Cache.IMAGE]=this._images,this._cacheMap[i.Cache.TEXTURE]=this._textures,this._cacheMap[i.Cache.SOUND]=this._sounds,this._cacheMap[i.Cache.TEXT]=this._text,this._cacheMap[i.Cache.PHYSICS]=this._physics,this._cacheMap[i.Cache.TILEMAP]=this._tilemaps,this._cacheMap[i.Cache.BINARY]=this._binary,this._cacheMap[i.Cache.BITMAPDATA]=this._bitmapDatas,this._cacheMap[i.Cache.BITMAPFONT]=this._bitmapFont,this._cacheMap[i.Cache.JSON]=this._json},i.Cache.CANVAS=1,i.Cache.IMAGE=2,i.Cache.TEXTURE=3,i.Cache.SOUND=4,i.Cache.TEXT=5,i.Cache.PHYSICS=6,i.Cache.TILEMAP=7,i.Cache.BINARY=8,i.Cache.BITMAPDATA=9,i.Cache.BITMAPFONT=10,i.Cache.JSON=11,i.Cache.prototype={addCanvas:function(t,e,i){this._canvases[t]={canvas:e,context:i}},addBinary:function(t,e){this._binary[t]=e},addBitmapData:function(t,e){return this._bitmapDatas[t]=e,e},addRenderTexture:function(t,e){var n=new i.Frame(0,0,0,e.width,e.height,"","");this._textures[t]={texture:e,frame:n}},addSpriteSheet:function(t,e,n,r,s,o,a,h){this._images[t]={url:e,data:n,spriteSheet:!0,frameWidth:r,frameHeight:s,margin:a,spacing:h},PIXI.BaseTextureCache[t]=new PIXI.BaseTexture(n),PIXI.TextureCache[t]=new PIXI.Texture(PIXI.BaseTextureCache[t]),this._images[t].frameData=i.AnimationParser.spriteSheet(this.game,t,r,s,o,a,h)},addTilemap:function(t,e,i,n){this._tilemaps[t]={url:e,data:i,format:n}},addTextureAtlas:function(t,e,n,r,s){this._images[t]={url:e,data:n,spriteSheet:!0},PIXI.BaseTextureCache[t]=new PIXI.BaseTexture(n),PIXI.TextureCache[t]=new PIXI.Texture(PIXI.BaseTextureCache[t]),s==i.Loader.TEXTURE_ATLAS_JSON_ARRAY?this._images[t].frameData=i.AnimationParser.JSONData(this.game,r,t):s==i.Loader.TEXTURE_ATLAS_JSON_HASH?this._images[t].frameData=i.AnimationParser.JSONDataHash(this.game,r,t):s==i.Loader.TEXTURE_ATLAS_XML_STARLING&&(this._images[t].frameData=i.AnimationParser.XMLData(this.game,r,t))},addBitmapFont:function(t,e,n,r,s,o){this._images[t]={url:e,data:n,spriteSheet:!0},PIXI.BaseTextureCache[t]=new PIXI.BaseTexture(n),PIXI.TextureCache[t]=new PIXI.Texture(PIXI.BaseTextureCache[t]),i.LoaderParser.bitmapFont(this.game,r,t,s,o)},addPhysicsData:function(t,e,i,n){this._physics[t]={url:e,data:i,format:n}},addDefaultImage:function(){var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==",this._images.__default={url:null,data:t,spriteSheet:!1},this._images.__default.frame=new i.Frame(0,0,0,32,32,"",""),PIXI.BaseTextureCache.__default=new PIXI.BaseTexture(t),PIXI.TextureCache.__default=new PIXI.Texture(PIXI.BaseTextureCache.__default)},addMissingImage:function(){var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==",this._images.__missing={url:null,data:t,spriteSheet:!1},this._images.__missing.frame=new i.Frame(0,0,0,32,32,"",""),PIXI.BaseTextureCache.__missing=new PIXI.BaseTexture(t),PIXI.TextureCache.__missing=new PIXI.Texture(PIXI.BaseTextureCache.__missing)},addText:function(t,e,i){this._text[t]={url:e,data:i}},addJSON:function(t,e,i){this._json[t]={url:e,data:i}},addImage:function(t,e,n){this._images[t]={url:e,data:n,spriteSheet:!1},this._images[t].frame=new i.Frame(0,0,0,n.width,n.height,t,this.game.rnd.uuid()),PIXI.BaseTextureCache[t]=new PIXI.BaseTexture(n),PIXI.TextureCache[t]=new PIXI.Texture(PIXI.BaseTextureCache[t])},addSound:function(t,e,i,n,r){n=n||!0,r=r||!1;var s=!1;r&&(s=!0),this._sounds[t]={url:e,data:i,isDecoding:!1,decoded:s,webAudio:n,audioTag:r,locked:this.game.sound.touchLocked}},reloadSound:function(t){var e=this;this._sounds[t]&&(this._sounds[t].data.src=this._sounds[t].url,this._sounds[t].data.addEventListener("canplaythrough",function(){return e.reloadSoundComplete(t)},!1),this._sounds[t].data.load())},reloadSoundComplete:function(t){this._sounds[t]&&(this._sounds[t].locked=!1,this.onSoundUnlock.dispatch(t))},updateSound:function(t,e,i){this._sounds[t]&&(this._sounds[t][e]=i)},decodedSound:function(t,e){this._sounds[t].data=e,this._sounds[t].decoded=!0,this._sounds[t].isDecoding=!1},getCanvas:function(t){return this._canvases[t]?this._canvases[t].canvas:(console.warn('Phaser.Cache.getCanvas: Invalid key: "'+t+'"'),void 0)},getBitmapData:function(t){return this._bitmapDatas[t]?this._bitmapDatas[t]:(console.warn('Phaser.Cache.getBitmapData: Invalid key: "'+t+'"'),void 0)},getBitmapFont:function(t){return this._bitmapFont[t]?this._bitmapFont[t]:(console.warn('Phaser.Cache.getBitmapFont: Invalid key: "'+t+'"'),void 0)},getPhysicsData:function(t,e,i){if("undefined"==typeof e||null===e){if(this._physics[t])return this._physics[t].data;console.warn('Phaser.Cache.getPhysicsData: Invalid key: "'+t+'"')}else if(this._physics[t]&&this._physics[t].data[e]){var n=this._physics[t].data[e];if(!n||!i)return n;for(var r in n)if(r=n[r],r.fixtureKey===i)return r;console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "'+i+" in "+t+'"')}else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "'+t+" / "+e+'"');return null},checkKey:function(t,e){return this._cacheMap[t][e]?!0:!1},checkCanvasKey:function(t){return this.checkKey(i.Cache.CANVAS,t)},checkImageKey:function(t){return this.checkKey(i.Cache.IMAGE,t)},checkTextureKey:function(t){return this.checkKey(i.Cache.TEXTURE,t)},checkSoundKey:function(t){return this.checkKey(i.Cache.SOUND,t)},checkTextKey:function(t){return this.checkKey(i.Cache.TEXT,t)},checkPhysicsKey:function(t){return this.checkKey(i.Cache.PHYSICS,t)},checkTilemapKey:function(t){return this.checkKey(i.Cache.TILEMAP,t)},checkBinaryKey:function(t){return this.checkKey(i.Cache.BINARY,t)},checkBitmapDataKey:function(t){return this.checkKey(i.Cache.BITMAPDATA,t)},checkBitmapFontKey:function(t){return this.checkKey(i.Cache.BITMAPFONT,t)},checkJSONKey:function(t){return this.checkKey(i.Cache.JSON,t)},getImage:function(t){return this._images[t]?this._images[t].data:(console.warn('Phaser.Cache.getImage: Invalid key: "'+t+'"'),void 0)},getTilemapData:function(t){return this._tilemaps[t]?this._tilemaps[t]:(console.warn('Phaser.Cache.getTilemapData: Invalid key: "'+t+'"'),void 0)},getFrameData:function(t){return this._images[t]&&this._images[t].frameData?this._images[t].frameData:null},updateFrameData:function(t,e){this._images[t]&&(this._images[t].spriteSheet=!0,this._images[t].frameData=e)},getFrameByIndex:function(t,e){return this._images[t]&&this._images[t].frameData?this._images[t].frameData.getFrame(e):null},getFrameByName:function(t,e){return this._images[t]&&this._images[t].frameData?this._images[t].frameData.getFrameByName(e):null},getFrame:function(t){return this._images[t]&&this._images[t].spriteSheet===!1?this._images[t].frame:null},getTextureFrame:function(t){return this._textures[t]?this._textures[t].frame:null},getTexture:function(t){return this._textures[t]?this._textures[t]:(console.warn('Phaser.Cache.getTexture: Invalid key: "'+t+'"'),void 0)},getSound:function(t){return this._sounds[t]?this._sounds[t]:(console.warn('Phaser.Cache.getSound: Invalid key: "'+t+'"'),void 0)},getSoundData:function(t){return this._sounds[t]?this._sounds[t].data:(console.warn('Phaser.Cache.getSoundData: Invalid key: "'+t+'"'),void 0)},isSoundDecoded:function(t){return this._sounds[t]?this._sounds[t].decoded:void 0},isSoundReady:function(t){return this._sounds[t]&&this._sounds[t].decoded&&this.game.sound.touchLocked===!1},isSpriteSheet:function(t){return this._images[t]?this._images[t].spriteSheet:!1},getText:function(t){return this._text[t]?this._text[t].data:(console.warn('Phaser.Cache.getText: Invalid key: "'+t+'"'),void 0)},getJSON:function(t){return this._json[t]?this._json[t].data:(console.warn('Phaser.Cache.getJSON: Invalid key: "'+t+'"'),void 0)},getBinary:function(t){return this._binary[t]?this._binary[t]:(console.warn('Phaser.Cache.getBinary: Invalid key: "'+t+'"'),void 0)},getKeys:function(t){var e=null;switch(t){case i.Cache.CANVAS:e=this._canvases;break;case i.Cache.IMAGE:e=this._images;break;case i.Cache.TEXTURE:e=this._textures;break;case i.Cache.SOUND:e=this._sounds;break;case i.Cache.TEXT:e=this._text;break;case i.Cache.PHYSICS:e=this._physics;break;case i.Cache.TILEMAP:e=this._tilemaps;break;case i.Cache.BINARY:e=this._binary;break;case i.Cache.BITMAPDATA:e=this._bitmapDatas;break;case i.Cache.BITMAPFONT:e=this._bitmapFont;break;case i.Cache.JSON:e=this._json}if(e){var n=[];for(var r in e)"__default"!==r&&"__missing"!==r&&n.push(r);return n}},removeCanvas:function(t){delete this._canvases[t]},removeImage:function(t){delete this._images[t]},removeSound:function(t){delete this._sounds[t]},removeText:function(t){delete this._text[t]},removeJSON:function(t){delete this._json[t]},removePhysics:function(t){delete this._physics[t]},removeTilemap:function(t){delete this._tilemaps[t]},removeBinary:function(t){delete this._binary[t]},removeBitmapData:function(t){delete this._bitmapDatas[t]},removeBitmapFont:function(t){delete this._bitmapFont[t]},destroy:function(){for(var t in this._canvases)delete this._canvases[t];for(var t in this._images)"__default"!==t&&"__missing"!==t&&delete this._images[t];for(var t in this._sounds)delete this._sounds[t];for(var t in this._text)delete this._text[t];for(var t in this._json)delete this._json[t];for(var t in this._textures)delete this._textures[t];for(var t in this._physics)delete this._physics[t];for(var t in this._tilemaps)delete this._tilemaps[t];for(var t in this._binary)delete this._binary[t];for(var t in this._bitmapDatas)delete this._bitmapDatas[t];for(var t in this._bitmapFont)delete this._bitmapFont[t]}},i.Cache.prototype.constructor=i.Cache,i.Loader=function(t){this.game=t,this._fileList=[],this._fileIndex=0,this._progressChunk=0,this._xhr=new XMLHttpRequest,this._ajax=null,this.isLoading=!1,this.hasLoaded=!1,this.progress=0,this.progressFloat=0,this.preloadSprite=null,this.crossOrigin=!1,this.baseURL="",this.onLoadStart=new i.Signal,this.onFileStart=new i.Signal,this.onFileComplete=new i.Signal,this.onFileError=new i.Signal,this.onLoadComplete=new i.Signal},i.Loader.TEXTURE_ATLAS_JSON_ARRAY=0,i.Loader.TEXTURE_ATLAS_JSON_HASH=1,i.Loader.TEXTURE_ATLAS_XML_STARLING=2,i.Loader.PHYSICS_LIME_CORONA_JSON=3,i.Loader.PHYSICS_PHASER_JSON=4,i.Loader.prototype={setPreloadSprite:function(t,e){e=e||0,this.preloadSprite={sprite:t,direction:e,width:t.width,height:t.height,rect:null},this.preloadSprite.rect=0===e?new i.Rectangle(0,0,1,t.height):new i.Rectangle(0,0,t.width,1),t.crop(this.preloadSprite.rect),t.visible=!0},checkKeyExists:function(t,e){if(this._fileList.length>0)for(var i=0;i<this._fileList.length;i++)if(this._fileList[i].type===t&&this._fileList[i].key===e)return!0;return!1},getAssetIndex:function(t,e){if(this._fileList.length>0)for(var i=0;i<this._fileList.length;i++)if(this._fileList[i].type===t&&this._fileList[i].key===e)return i;return-1},getAsset:function(t,e){if(this._fileList.length>0)for(var i=0;i<this._fileList.length;i++)if(this._fileList[i].type===t&&this._fileList[i].key===e)return{index:i,file:this._fileList[i]};return!1},reset:function(){this.preloadSprite=null,this.isLoading=!1,this._fileList.length=0,this._fileIndex=0},addToFileList:function(t,e,i,n){var r={type:t,key:e,url:i,data:null,error:!1,loaded:!1};if("undefined"!=typeof n)for(var s in n)r[s]=n[s];this.checkKeyExists(t,e)===!1&&this._fileList.push(r)},replaceInFileList:function(t,e,i,n){var r={type:t,key:e,url:i,data:null,error:!1,loaded:!1};if("undefined"!=typeof n)for(var s in n)r[s]=n[s];var o=this.getAssetIndex(t,e);-1===o?this._fileList.push(r):this._fileList[o]=r},image:function(t,e,i){return"undefined"==typeof i&&(i=!1),i?this.replaceInFileList("image",t,e):this.addToFileList("image",t,e),this},text:function(t,e,i){return"undefined"==typeof i&&(i=!1),i?this.replaceInFileList("text",t,e):this.addToFileList("text",t,e),this},json:function(t,e,i){return"undefined"==typeof i&&(i=!1),i?this.replaceInFileList("json",t,e):this.addToFileList("json",t,e),this},script:function(t,e,i,n){return"undefined"==typeof i&&(i=!1),i!==!1&&"undefined"==typeof n&&(n=i),this.addToFileList("script",t,e,{callback:i,callbackContext:n}),this},binary:function(t,e,i,n){return"undefined"==typeof i&&(i=!1),i!==!1&&"undefined"==typeof n&&(n=i),this.addToFileList("binary",t,e,{callback:i,callbackContext:n}),this},spritesheet:function(t,e,i,n,r,s,o){return"undefined"==typeof r&&(r=-1),"undefined"==typeof s&&(s=0),"undefined"==typeof o&&(o=0),this.addToFileList("spritesheet",t,e,{frameWidth:i,frameHeight:n,frameMax:r,margin:s,spacing:o}),this},audio:function(t,e,i){return"undefined"==typeof i&&(i=!0),this.addToFileList("audio",t,e,{buffer:null,autoDecode:i}),this},tilemap:function(t,e,n,r){if("undefined"==typeof e&&(e=null),"undefined"==typeof n&&(n=null),"undefined"==typeof r&&(r=i.Tilemap.CSV),null==e&&null==n)return console.warn("Phaser.Loader.tilemap - Both mapDataURL and mapData are null. One must be set."),this;if(n){switch(r){case i.Tilemap.CSV:break;case i.Tilemap.TILED_JSON:"string"==typeof n&&(n=JSON.parse(n))}this.game.cache.addTilemap(t,null,n,r)}else this.addToFileList("tilemap",t,e,{format:r});return this},physics:function(t,e,n,r){return"undefined"==typeof e&&(e=null),"undefined"==typeof n&&(n=null),"undefined"==typeof r&&(r=i.Physics.LIME_CORONA_JSON),null==e&&null==n?(console.warn("Phaser.Loader.physics - Both dataURL and jsonData are null. One must be set."),this):(n?("string"==typeof n&&(n=JSON.parse(n)),this.game.cache.addPhysicsData(t,null,n,r)):this.addToFileList("physics",t,e,{format:r}),this)},bitmapFont:function(t,e,i,n,r,s){if("undefined"==typeof i&&(i=null),"undefined"==typeof n&&(n=null),"undefined"==typeof r&&(r=0),"undefined"==typeof s&&(s=0),i)this.addToFileList("bitmapfont",t,e,{xmlURL:i,xSpacing:r,ySpacing:s});else if("string"==typeof n){var o;try{if(window.DOMParser){var a=new DOMParser;o=a.parseFromString(n,"text/xml")}else o=new ActiveXObject("Microsoft.XMLDOM"),o.async="false",o.loadXML(n)}catch(h){o=void 0}if(!o||!o.documentElement||o.getElementsByTagName("parsererror").length)throw new Error("Phaser.Loader. Invalid Bitmap Font XML given");this.addToFileList("bitmapfont",t,e,{xmlURL:null,xmlData:o,xSpacing:r,ySpacing:s})}return this},atlasJSONArray:function(t,e,n,r){return this.atlas(t,e,n,r,i.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(t,e,n,r){return this.atlas(t,e,n,r,i.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(t,e,n,r){return this.atlas(t,e,n,r,i.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(t,e,n,r,s){if("undefined"==typeof n&&(n=null),"undefined"==typeof r&&(r=null),"undefined"==typeof s&&(s=i.Loader.TEXTURE_ATLAS_JSON_ARRAY),n)this.addToFileList("textureatlas",t,e,{atlasURL:n,format:s});else{switch(s){case i.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"==typeof r&&(r=JSON.parse(r));break;case i.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"==typeof r){var o;try{if(window.DOMParser){var a=new DOMParser;o=a.parseFromString(r,"text/xml")}else o=new ActiveXObject("Microsoft.XMLDOM"),o.async="false",o.loadXML(r)}catch(h){o=void 0}if(!o||!o.documentElement||o.getElementsByTagName("parsererror").length)throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");r=o}}this.addToFileList("textureatlas",t,e,{atlasURL:null,atlasData:r,format:s})}return this},removeFile:function(t,e){var i=this.getAsset(t,e);i!==!1&&this._fileList.splice(i.index,1)},removeAll:function(){this._fileList.length=0},start:function(){this.isLoading||(this.progress=0,this.progressFloat=0,this.hasLoaded=!1,this.isLoading=!0,this.onLoadStart.dispatch(this._fileList.length),this._fileList.length>0?(this._fileIndex=0,this._progressChunk=100/this._fileList.length,this.loadFile()):(this.progress=100,this.progressFloat=100,this.hasLoaded=!0,this.onLoadComplete.dispatch()))},loadFile:function(){if(!this._fileList[this._fileIndex])return console.warn("Phaser.Loader loadFile invalid index "+this._fileIndex),void 0;var t=this._fileList[this._fileIndex],e=this;switch(this.onFileStart.dispatch(this.progress,t.key),t.type){case"image":case"spritesheet":case"textureatlas":case"bitmapfont":t.data=new Image,t.data.name=t.key,t.data.onload=function(){return e.fileComplete(e._fileIndex)},t.data.onerror=function(){return e.fileError(e._fileIndex)},this.crossOrigin&&(t.data.crossOrigin=this.crossOrigin),t.data.src=this.baseURL+t.url;break;case"audio":t.url=this.getAudioURL(t.url),null!==t.url?this.game.sound.usingWebAudio?(this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="arraybuffer",this._xhr.onload=function(){return e.fileComplete(e._fileIndex)},this._xhr.onerror=function(){return e.fileError(e._fileIndex)},this._xhr.send()):this.game.sound.usingAudioTag&&(this.game.sound.touchLocked?(t.data=new Audio,t.data.name=t.key,t.data.preload="auto",t.data.src=this.baseURL+t.url,this.fileComplete(this._fileIndex)):(t.data=new Audio,t.data.name=t.key,t.data.onerror=function(){return e.fileError(e._fileIndex)},t.data.preload="auto",t.data.src=this.baseURL+t.url,t.data.addEventListener("canplaythrough",i.GAMES[this.game.id].load.fileComplete(this._fileIndex),!1),t.data.load())):this.fileError(this._fileIndex);break;case"json":window.XDomainRequest?(this._ajax=new window.XDomainRequest,this._ajax.timeout=3e3,this._ajax.onerror=function(){return e.dataLoadError(e._fileIndex)},this._ajax.ontimeout=function(){return e.dataLoadError(e._fileIndex)},this._ajax.onprogress=function(){},this._ajax.onload=function(){return e.jsonLoadComplete(e._fileIndex)},this._ajax.open("GET",this.baseURL+t.url,!0),this._ajax.send()):(this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="text",this._xhr.onload=function(){return e.jsonLoadComplete(e._fileIndex)},this._xhr.onerror=function(){return e.dataLoadError(e._fileIndex)},this._xhr.send());break;case"tilemap":if(this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="text",t.format===i.Tilemap.TILED_JSON)this._xhr.onload=function(){return e.jsonLoadComplete(e._fileIndex)};else{if(t.format!==i.Tilemap.CSV)throw new Error("Phaser.Loader. Invalid Tilemap format: "+t.format);this._xhr.onload=function(){return e.csvLoadComplete(e._fileIndex)}}this._xhr.onerror=function(){return e.dataLoadError(e._fileIndex)},this._xhr.send();break;case"text":case"script":case"physics":this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="text",this._xhr.onload=function(){return e.fileComplete(e._fileIndex)},this._xhr.onerror=function(){return e.fileError(e._fileIndex)},this._xhr.send();break;case"binary":this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="arraybuffer",this._xhr.onload=function(){return e.fileComplete(e._fileIndex)},this._xhr.onerror=function(){return e.fileError(e._fileIndex)},this._xhr.send()}},getAudioURL:function(t){var e;"string"==typeof t&&(t=[t]);for(var i=0;i<t.length;i++)if(e=t[i].toLowerCase(),e=e.substr((Math.max(0,e.lastIndexOf("."))||1/0)+1),this.game.device.canPlayAudio(e))return t[i];return null},fileError:function(t){this._fileList[t].loaded=!0,this._fileList[t].error=!0,this.onFileError.dispatch(this._fileList[t].key,this._fileList[t]),console.warn("Phaser.Loader error loading file: "+this._fileList[t].key+" from URL "+this._fileList[t].url),this.nextFile(t,!1)
},fileComplete:function(t){if(!this._fileList[t])return console.warn("Phaser.Loader fileComplete invalid index "+t),void 0;var e=this._fileList[t];e.loaded=!0;var n=!0,r=this;switch(e.type){case"image":this.game.cache.addImage(e.key,e.url,e.data);break;case"spritesheet":this.game.cache.addSpriteSheet(e.key,e.url,e.data,e.frameWidth,e.frameHeight,e.frameMax,e.margin,e.spacing);break;case"textureatlas":if(null==e.atlasURL)this.game.cache.addTextureAtlas(e.key,e.url,e.data,e.atlasData,e.format);else{if(n=!1,this._xhr.open("GET",this.baseURL+e.atlasURL,!0),this._xhr.responseType="text",e.format==i.Loader.TEXTURE_ATLAS_JSON_ARRAY||e.format==i.Loader.TEXTURE_ATLAS_JSON_HASH)this._xhr.onload=function(){return r.jsonLoadComplete(t)};else{if(e.format!=i.Loader.TEXTURE_ATLAS_XML_STARLING)throw new Error("Phaser.Loader. Invalid Texture Atlas format: "+e.format);this._xhr.onload=function(){return r.xmlLoadComplete(t)}}this._xhr.onerror=function(){return r.dataLoadError(t)},this._xhr.send()}break;case"bitmapfont":null==e.xmlURL?this.game.cache.addBitmapFont(e.key,e.url,e.data,e.xmlData,e.xSpacing,e.ySpacing):(n=!1,this._xhr.open("GET",this.baseURL+e.xmlURL,!0),this._xhr.responseType="text",this._xhr.onload=function(){return r.xmlLoadComplete(t)},this._xhr.onerror=function(){return r.dataLoadError(t)},this._xhr.send());break;case"audio":if(this.game.sound.usingWebAudio){if(e.data=this._xhr.response,this.game.cache.addSound(e.key,e.url,e.data,!0,!1),e.autoDecode){var s=this,o=e.key;this.game.cache.updateSound(o,"isDecoding",!0),this.game.sound.context.decodeAudioData(e.data,function(t){t&&(s.game.cache.decodedSound(o,t),s.game.sound.onSoundDecode.dispatch(o,s.game.cache.getSound(o)))})}}else e.data.removeEventListener("canplaythrough",i.GAMES[this.game.id].load.fileComplete),this.game.cache.addSound(e.key,e.url,e.data,!1,!0);break;case"text":e.data=this._xhr.responseText,this.game.cache.addText(e.key,e.url,e.data);break;case"physics":var a=JSON.parse(this._xhr.responseText);this.game.cache.addPhysicsData(e.key,e.url,a,e.format);break;case"script":e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=this._xhr.responseText,document.head.appendChild(e.data),e.callback&&(e.data=e.callback.call(e.callbackContext,e.key,this._xhr.responseText));break;case"binary":e.data=e.callback?e.callback.call(e.callbackContext,e.key,this._xhr.response):this._xhr.response,this.game.cache.addBinary(e.key,e.data)}n&&this.nextFile(t,!0)},jsonLoadComplete:function(t){if(!this._fileList[t])return console.warn("Phaser.Loader jsonLoadComplete invalid index "+t),void 0;var e=this._fileList[t],i=JSON.parse(this._xhr.responseText);e.loaded=!0,"tilemap"===e.type?this.game.cache.addTilemap(e.key,e.url,i,e.format):"json"===e.type?this.game.cache.addJSON(e.key,e.url,i):this.game.cache.addTextureAtlas(e.key,e.url,e.data,i,e.format),this.nextFile(t,!0)},csvLoadComplete:function(t){if(!this._fileList[t])return console.warn("Phaser.Loader csvLoadComplete invalid index "+t),void 0;var e=this._fileList[t],i=this._xhr.responseText;e.loaded=!0,this.game.cache.addTilemap(e.key,e.url,i,e.format),this.nextFile(t,!0)},dataLoadError:function(t){var e=this._fileList[t];e.loaded=!0,e.error=!0,console.warn("Phaser.Loader dataLoadError: "+e.key),this.nextFile(t,!0)},xmlLoadComplete:function(t){var e,i=this._xhr.responseText;try{if(window.DOMParser){var n=new DOMParser;e=n.parseFromString(i,"text/xml")}else e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(i)}catch(r){e=void 0}if(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)throw new Error("Phaser.Loader. Invalid XML given");var s=this._fileList[t];s.loaded=!0,"bitmapfont"==s.type?this.game.cache.addBitmapFont(s.key,s.url,s.data,e,s.xSpacing,s.ySpacing):"textureatlas"==s.type&&this.game.cache.addTextureAtlas(s.key,s.url,s.data,e,s.format),this.nextFile(t,!0)},nextFile:function(t,e){this.progressFloat+=this._progressChunk,this.progress=Math.round(this.progressFloat),this.progress>100&&(this.progress=100),null!==this.preloadSprite&&(0===this.preloadSprite.direction?(this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress),this.preloadSprite.sprite.crop(this.preloadSprite.rect)):(this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite.crop(this.preloadSprite.rect))),this.onFileComplete.dispatch(this.progress,this._fileList[t].key,e,this.totalLoadedFiles(),this._fileList.length),this.totalQueuedFiles()>0?(this._fileIndex++,this.loadFile()):(this.hasLoaded=!0,this.isLoading=!1,this.removeAll(),this.onLoadComplete.dispatch())},totalLoadedFiles:function(){for(var t=0,e=0;e<this._fileList.length;e++)this._fileList[e].loaded&&t++;return t},totalQueuedFiles:function(){for(var t=0,e=0;e<this._fileList.length;e++)this._fileList[e].loaded===!1&&t++;return t}},i.Loader.prototype.constructor=i.Loader,i.LoaderParser={bitmapFont:function(t,e,i,n,r){var s={},o=e.getElementsByTagName("info")[0],a=e.getElementsByTagName("common")[0];s.font=o.getAttribute("face"),s.size=parseInt(o.getAttribute("size"),10),s.lineHeight=parseInt(a.getAttribute("lineHeight"),10)+r,s.chars={};for(var h=e.getElementsByTagName("char"),u=PIXI.TextureCache[i],c=0;c<h.length;c++){var l=parseInt(h[c].getAttribute("id"),10),d=new PIXI.Rectangle(parseInt(h[c].getAttribute("x"),10),parseInt(h[c].getAttribute("y"),10),parseInt(h[c].getAttribute("width"),10),parseInt(h[c].getAttribute("height"),10));s.chars[l]={xOffset:parseInt(h[c].getAttribute("xoffset"),10),yOffset:parseInt(h[c].getAttribute("yoffset"),10),xAdvance:parseInt(h[c].getAttribute("xadvance"),10)+n,kerning:{},texture:PIXI.TextureCache[i]=new PIXI.Texture(u,d)}}var p=e.getElementsByTagName("kerning");for(c=0;c<p.length;c++){var f=parseInt(p[c].getAttribute("first"),10),m=parseInt(p[c].getAttribute("second"),10),g=parseInt(p[c].getAttribute("amount"),10);s.chars[m].kerning[f]=g}PIXI.BitmapText.fonts[i]=s}},i.Sound=function(t,e,n,r,s){"undefined"==typeof n&&(n=1),"undefined"==typeof r&&(r=!1),"undefined"==typeof s&&(s=t.sound.connectToMaster),this.game=t,this.name=e,this.key=e,this.loop=r,this.volume=n,this.markers={},this.context=null,this.autoplay=!1,this.totalDuration=0,this.startTime=0,this.currentTime=0,this.duration=0,this.durationMS=0,this.position=0,this.stopTime=0,this.paused=!1,this.pausedPosition=0,this.pausedTime=0,this.isPlaying=!1,this.currentMarker="",this.pendingPlayback=!1,this.override=!1,this.usingWebAudio=this.game.sound.usingWebAudio,this.usingAudioTag=this.game.sound.usingAudioTag,this.externalNode=null,this.masterGainNode=null,this.gainNode=null,this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,this.gainNode="undefined"==typeof this.context.createGain?this.context.createGainNode():this.context.createGain(),this.gainNode.gain.value=n*this.game.sound.volume,s&&this.gainNode.connect(this.masterGainNode)):this.game.cache.getSound(e)&&this.game.cache.isSoundReady(e)?(this._sound=this.game.cache.getSoundData(e),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this),this.onDecoded=new i.Signal,this.onPlay=new i.Signal,this.onPause=new i.Signal,this.onResume=new i.Signal,this.onLoop=new i.Signal,this.onStop=new i.Signal,this.onMute=new i.Signal,this.onMarkerComplete=new i.Signal,this._volume=n,this._buffer=null,this._muted=!1,this._tempMarker=0,this._tempPosition=0,this._tempVolume=0,this._tempLoop=0,this._paused=!1},i.Sound.prototype={soundHasUnlocked:function(t){t==this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(t,e,i,n,r){"undefined"==typeof n&&(n=1),"undefined"==typeof r&&(r=!1),this.markers[t]={name:t,start:e,stop:e+i,volume:n,duration:i,durationMS:1e3*i,loop:r}},removeMarker:function(t){delete this.markers[t]},update:function(){this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),this.isPlaying&&(this.currentTime=this.game.time.now-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.now):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):this.stop():this.loop?(this.onLoop.dispatch(this),this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))},play:function(t,e,i,n,r){if("undefined"==typeof t&&(t=""),"undefined"==typeof r&&(r=!0),this.isPlaying===!0&&r===!1&&this.override===!1)return this;if(this.isPlaying&&this.override&&(this.usingWebAudio?"undefined"==typeof this._sound.stop?this._sound.noteOff(0):this._sound.stop(0):this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0)),this.currentMarker=t,""!==t){if(!this.markers[t])return console.warn("Phaser.Sound.play: audio marker "+t+" doesn't exist"),this;this.position=this.markers[t].start,this.volume=this.markers[t].volume,this.loop=this.markers[t].loop,this.duration=this.markers[t].duration,this.durationMS=this.markers[t].durationMS,"undefined"!=typeof i&&(this.volume=i),"undefined"!=typeof n&&(this.loop=n),this._tempMarker=t,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop}else e=e||0,"undefined"==typeof i&&(i=this._volume),"undefined"==typeof n&&(n=this.loop),this.position=e,this.volume=i,this.loop=n,this.duration=0,this.durationMS=0,this._tempMarker=t,this._tempPosition=e,this._tempVolume=i,this._tempLoop=n;return this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(null==this._buffer&&(this._buffer=this.game.cache.getSoundData(this.key)),this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this.externalNode?this._sound.connect(this.externalNode.input):this._sound.connect(this.gainNode),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1e3*this.totalDuration),this.loop&&""===t&&(this._sound.loop=!0),"undefined"==typeof this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.now,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).isDecoding===!1&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?(this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1e3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._sound.volume=this._muted?0:this._volume,this.isPlaying=!0,this.startTime=this.game.time.now,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0,this},restart:function(t,e,i,n){t=t||"",e=e||0,i=i||1,"undefined"==typeof n&&(n=!1),this.play(t,e,i,n,!0)},pause:function(){this.isPlaying&&this._sound&&(this.stop(),this.isPlaying=!1,this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.now,this.onPause.dispatch(this))},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var t=this.position+this.pausedPosition/1e3;this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this.externalNode?this._sound.connect(this.externalNode.input):this._sound.connect(this.gainNode),this.loop&&(this._sound.loop=!0),"undefined"==typeof this._sound.start?this._sound.noteGrainOn(0,t,this.duration):this._sound.start(0,t,this.duration)}else this._sound.play();this.isPlaying=!0,this.paused=!1,this.startTime+=this.game.time.now-this.pausedTime,this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio)if("undefined"==typeof this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(t){}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=!1;var e=this.currentMarker;""!==this.currentMarker&&this.onMarkerComplete.dispatch(this.currentMarker,this),this.currentMarker="",this.onStop.dispatch(this,e)},destroy:function(t){"undefined"==typeof t&&(t=!0),this.stop(),t&&this.game.sound.remove(this),this.markers={},this.context=null,this._buffer=null,this.externalNode=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose()}},i.Sound.prototype.constructor=i.Sound,Object.defineProperty(i.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}}),Object.defineProperty(i.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}}),Object.defineProperty(i.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(t){t=t||null,t?(this._muted=!0,this.usingWebAudio?(this._muteVolume=this.gainNode.gain.value,this.gainNode.gain.value=0):this.usingAudioTag&&this._sound&&(this._muteVolume=this._sound.volume,this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this)}}),Object.defineProperty(i.Sound.prototype,"volume",{get:function(){return this._volume},set:function(t){this.usingWebAudio?(this._volume=t,this.gainNode.gain.value=t):this.usingAudioTag&&this._sound&&t>=0&&1>=t&&(this._volume=t,this._sound.volume=t)}}),i.SoundManager=function(t){this.game=t,this.onSoundDecode=new i.Signal,this._codeMuted=!1,this._muted=!1,this._unlockSource=null,this._volume=1,this._sounds=[],this.context=null,this.usingWebAudio=!0,this.usingAudioTag=!1,this.noAudio=!1,this.connectToMaster=!0,this.touchLocked=!1,this.channels=32},i.SoundManager.prototype={boot:function(){if(this.game.device.iOS&&this.game.device.webAudio===!1&&(this.channels=1),this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?(this.game.input.touch.callbackContext=this,this.game.input.touch.touchStartCallback=this.unlock,this.game.input.mouse.callbackContext=this,this.game.input.mouse.mouseDownCallback=this.unlock,this.touchLocked=!0):this.touchLocked=!1,window.PhaserGlobal){if(window.PhaserGlobal.disableAudio===!0)return this.usingWebAudio=!1,this.noAudio=!0,void 0;if(window.PhaserGlobal.disableWebAudio===!0)return this.usingWebAudio=!1,this.usingAudioTag=!0,this.noAudio=!1,void 0}if(window.AudioContext)try{this.context=new window.AudioContext}catch(t){this.context=null,this.usingWebAudio=!1,this.noAudio=!0}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(t){this.context=null,this.usingWebAudio=!1,this.noAudio=!0}window.Audio&&null===this.context&&(this.usingWebAudio=!1,this.usingAudioTag=!0,this.noAudio=!1),null!==this.context&&(this.masterGain="undefined"==typeof this.context.createGain?this.context.createGainNode():this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination))},unlock:function(){if(this.touchLocked!==!1)if(this.game.device.webAudio===!1||window.PhaserGlobal&&window.PhaserGlobal.disableWebAudio===!0)this.touchLocked=!1,this._unlockSource=null,this.game.input.touch.callbackContext=null,this.game.input.touch.touchStartCallback=null,this.game.input.mouse.callbackContext=null,this.game.input.mouse.mouseDownCallback=null;else{var t=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource(),this._unlockSource.buffer=t,this._unlockSource.connect(this.context.destination),this._unlockSource.noteOn(0)}},stopAll:function(){for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].stop()},pauseAll:function(){for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].pause()},resumeAll:function(){for(var t=0;t<this._sounds.length;t++)this._sounds[t]&&this._sounds[t].resume()},decode:function(t,e){e=e||null;var i=this.game.cache.getSoundData(t);if(i&&this.game.cache.isSoundDecoded(t)===!1){this.game.cache.updateSound(t,"isDecoding",!0);var n=this;this.context.decodeAudioData(i,function(i){n.game.cache.decodedSound(t,i),e&&n.onSoundDecode.dispatch(t,e)})}},update:function(){this.touchLocked&&this.game.device.webAudio&&null!==this._unlockSource&&(this._unlockSource.playbackState===this._unlockSource.PLAYING_STATE||this._unlockSource.playbackState===this._unlockSource.FINISHED_STATE)&&(this.touchLocked=!1,this._unlockSource=null,this.game.input.touch.callbackContext=null,this.game.input.touch.touchStartCallback=null);for(var t=0;t<this._sounds.length;t++)this._sounds[t].update()},add:function(t,e,n,r){"undefined"==typeof e&&(e=1),"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=this.connectToMaster);var s=new i.Sound(this.game,t,e,n,r);return this._sounds.push(s),s},remove:function(t){for(var e=this._sounds.length;e--;)if(this._sounds[e]===t)return this._sounds[e].destroy(!1),this._sounds.splice(e,1),!0;return!1},removeByKey:function(t){for(var e=this._sounds.length,i=0;e--;)this._sounds[e].key===t&&(this._sounds[e].destroy(!1),this._sounds.splice(e,1),i++);return i},play:function(t,e,i){var n=this.add(t,e,i);return n.play(),n},setMute:function(){if(!this._muted){this._muted=!0,this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!0)}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1,this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!1)}}},i.SoundManager.prototype.constructor=i.SoundManager,Object.defineProperty(i.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(t){if(t=t||null){if(this._muted)return;this._codeMuted=!0,this.setMute()}else{if(!this._muted)return;this._codeMuted=!1,this.unsetMute()}}}),Object.defineProperty(i.SoundManager.prototype,"volume",{get:function(){return this.usingWebAudio?this.masterGain.gain.value:this._volume},set:function(t){if(this._volume=t,this.usingWebAudio)this.masterGain.gain.value=t;else for(var e=0;e<this._sounds.length;e++)this._sounds[e].usingAudioTag&&(this._sounds[e].volume=this._sounds[e].volume*t)}}),i.Utils.Debug=function(t){this.game=t,this.sprite=null,this.canvas=null,this.baseTexture=null,this.texture=null,this.textureFrame=null,this.context=null,this.font="14px Courier",this.columnWidth=100,this.lineHeight=16,this.renderShadow=!0,this.currentX=0,this.currentY=0,this.currentAlpha=1,this.dirty=!1},i.Utils.Debug.prototype={boot:function(){this.game.renderType===i.CANVAS?this.context=this.game.context:(this.canvas=i.Canvas.create(this.game.width,this.game.height,"",!0),this.context=this.canvas.getContext("2d"),this.baseTexture=new PIXI.BaseTexture(this.canvas),this.texture=new PIXI.Texture(this.baseTexture),this.textureFrame=new i.Frame(0,0,0,this.game.width,this.game.height,"debug",this.game.rnd.uuid()),this.sprite=this.game.make.image(0,0,this.texture,this.textureFrame),this.game.stage.addChild(this.sprite))},preUpdate:function(){this.dirty&&this.sprite&&(this.context.clearRect(0,0,this.game.width,this.game.height),this.dirty=!1)},start:function(t,e,i,n){"number"!=typeof t&&(t=0),"number"!=typeof e&&(e=0),i=i||"rgb(255,255,255)","undefined"==typeof n&&(n=0),this.currentX=t,this.currentY=e,this.currentColor=i,this.currentAlpha=this.context.globalAlpha,this.columnWidth=n,this.sprite&&(this.dirty=!0),this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.strokeStyle=i,this.context.fillStyle=i,this.context.font=this.font,this.context.globalAlpha=1},stop:function(){this.context.restore(),this.context.globalAlpha=this.currentAlpha,this.sprite&&PIXI.updateWebGLTexture(this.baseTexture,this.game.renderer.gl)},line:function(){for(var t=this.currentX,e=0;e<arguments.length;e++)this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[e],t+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[e],t,this.currentY),t+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sound: "+t.key+" Locked: "+t.game.sound.touchLocked),this.line("Is Ready?: "+this.game.cache.isSoundReady(t.key)+" Pending Playback: "+t.pendingPlayback),this.line("Decoded: "+t.isDecoded+" Decoding: "+t.isDecoding),this.line("Total Duration: "+t.totalDuration+" Playing: "+t.isPlaying),this.line("Time: "+t.currentTime),this.line("Volume: "+t.volume+" Muted: "+t.mute),this.line("WebAudio: "+t.usingWebAudio+" Audio: "+t.usingAudioTag),""!==t.currentMarker&&(this.line("Marker: "+t.currentMarker+" Duration: "+t.duration+" (ms: "+t.durationMS+")"),this.line("Start: "+t.markers[t.currentMarker].start+" Stop: "+t.markers[t.currentMarker].stop),this.line("Position: "+t.position)),this.stop()},cameraInfo:function(t,e,i,n){this.start(e,i,n),this.line("Camera ("+t.width+" x "+t.height+")"),this.line("X: "+t.x+" Y: "+t.y),this.line("Bounds x: "+t.bounds.x+" Y: "+t.bounds.y+" w: "+t.bounds.width+" h: "+t.bounds.height),this.line("View x: "+t.view.x+" Y: "+t.view.y+" w: "+t.view.width+" h: "+t.view.height),this.stop()},timer:function(t,e,i,n){this.start(e,i,n),this.line("Timer (running: "+t.running+" expired: "+t.expired+")"),this.line("Next Tick: "+t.next+" Duration: "+t.duration),this.line("Paused: "+t.paused+" Length: "+t.length),this.stop()},pointer:function(t,e,i,n,r){null!=t&&("undefined"==typeof e&&(e=!1),i=i||"rgba(0,255,0,0.5)",n=n||"rgba(255,0,0,0.5)",(e!==!0||t.isUp!==!0)&&(this.start(t.x,t.y-100,r),this.context.beginPath(),this.context.arc(t.x,t.y,t.circle.radius,0,2*Math.PI),this.context.fillStyle=t.active?i:n,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(t.positionDown.x,t.positionDown.y),this.context.lineTo(t.position.x,t.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+t.id+" Active: "+t.active),this.line("World X: "+t.worldX+" World Y: "+t.worldY),this.line("Screen X: "+t.x+" Screen Y: "+t.y),this.line("Duration: "+t.duration+" ms"),this.line("is Down: "+t.isDown+" is Up: "+t.isUp),this.stop()))},spriteInputInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sprite Input: ("+t.width+" x "+t.height+")"),this.line("x: "+t.input.pointerX().toFixed(1)+" y: "+t.input.pointerY().toFixed(1)),this.line("over: "+t.input.pointerOver()+" duration: "+t.input.overDuration().toFixed(0)),this.line("down: "+t.input.pointerDown()+" duration: "+t.input.downDuration().toFixed(0)),this.line("just over: "+t.input.justOver()+" just out: "+t.input.justOut()),this.stop()},key:function(t,e,i,n){this.start(e,i,n,150),this.line("Key:",t.keyCode,"isDown:",t.isDown),this.line("justPressed:",t.justPressed(),"justReleased:",t.justReleased()),this.line("Time Down:",t.timeDown.toFixed(0),"duration:",t.duration.toFixed(0)),this.stop()},inputInfo:function(t,e,i){this.start(t,e,i),this.line("Input"),this.line("X: "+this.game.input.x+" Y: "+this.game.input.y),this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY),this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+" Scale Y: "+this.game.input.scale.x.toFixed(1)),this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY),this.stop()},spriteBounds:function(t,e,i){var n=t.getBounds();n.x+=this.game.camera.x,n.y+=this.game.camera.y,this.rectangle(n,e,i)},spriteInfo:function(t,e,i,n){this.start(e,i,n),this.line("Sprite:  ("+t.width+" x "+t.height+") anchor: "+t.anchor.x+" x "+t.anchor.y),this.line("x: "+t.x.toFixed(1)+" y: "+t.y.toFixed(1)),this.line("angle: "+t.angle.toFixed(1)+" rotation: "+t.rotation.toFixed(1)),this.line("visible: "+t.visible+" in camera: "+t.inCamera),this.stop()},spriteCoords:function(t,e,i,n){this.start(e,i,n,100),t.name&&this.line(t.name),this.line("x:",t.x.toFixed(2),"y:",t.y.toFixed(2)),this.line("pos x:",t.position.x.toFixed(2),"pos y:",t.position.y.toFixed(2)),this.line("world x:",t.world.x.toFixed(2),"world y:",t.world.y.toFixed(2)),this.stop()},lineInfo:function(t,e,i,n){this.start(e,i,n,80),this.line("start.x:",t.start.x.toFixed(2),"start.y:",t.start.y.toFixed(2)),this.line("end.x:",t.end.x.toFixed(2),"end.y:",t.end.y.toFixed(2)),this.line("length:",t.length.toFixed(2),"angle:",t.angle),this.stop()},pixel:function(t,e,i,n){n=n||2,this.start(),this.context.fillStyle=i,this.context.fillRect(t,e,n,n),this.stop()},geom:function(t,e,n,r){"undefined"==typeof n&&(n=!0),"undefined"==typeof r&&(r=0),e=e||"rgba(0,255,0,0.4)",this.start(),this.context.fillStyle=e,this.context.strokeStyle=e,t instanceof i.Rectangle||1===r?n?this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height):this.context.strokeRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height):t instanceof i.Circle||2===r?(this.context.beginPath(),this.context.arc(t.x-this.game.camera.x,t.y-this.game.camera.y,t.radius,0,2*Math.PI,!1),this.context.closePath(),n?this.context.fill():this.context.stroke()):t instanceof i.Point||3===r?this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,4,4):(t instanceof i.Line||4===r)&&(this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(t.start.x+.5-this.game.camera.x,t.start.y+.5-this.game.camera.y),this.context.lineTo(t.end.x+.5-this.game.camera.x,t.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke()),this.stop()},rectangle:function(t,e,i){"undefined"==typeof i&&(i=!0),e=e||"rgba(0, 255, 0, 0.4)",this.start(),i?(this.context.fillStyle=e,this.context.fillRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height)):(this.context.strokeStyle=e,this.context.strokeRect(t.x-this.game.camera.x,t.y-this.game.camera.y,t.width,t.height)),this.stop()},text:function(t,e,i,n,r){n=n||"rgb(255,255,255)",r=r||"16px Courier",this.start(),this.context.font=r,this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(t,e+1,i+1)),this.context.fillStyle=n,this.context.fillText(t,e,i),this.stop()},quadTree:function(t,e){e=e||"rgba(255,0,0,0.3)",this.start();var i=t.bounds;if(0===t.nodes.length){this.context.strokeStyle=e,this.context.strokeRect(i.x,i.y,i.width,i.height),this.text("size: "+t.objects.length,i.x+4,i.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)";for(var n=0;n<t.objects.length;n++)this.context.strokeRect(t.objects[n].x,t.objects[n].y,t.objects[n].width,t.objects[n].height)}else for(var n=0;n<t.nodes.length;n++)this.quadTree(t.nodes[n]);this.stop()},body:function(t,e,n){t.body&&t.body.type===i.Physics.ARCADE&&(this.start(),i.Physics.Arcade.Body.render(this.context,t.body,e,n),this.stop())},bodyInfo:function(t,e,n,r){t.body&&t.body.type===i.Physics.ARCADE&&(this.start(e,n,r,210),i.Physics.Arcade.Body.renderBodyInfo(this,t.body),this.stop())}},i.Utils.Debug.prototype.constructor=i.Utils.Debug,i.Color={packPixel:function(t,e,n,r){return i.Device.LITTLE_ENDIAN?r<<24|n<<16|e<<8|t:t<<24|e<<16|n<<8|r},unpackPixel:function(t,e,n,r){return("undefined"==typeof e||null===e)&&(e=i.Color.createColor()),("undefined"==typeof n||null===n)&&(n=!1),("undefined"==typeof r||null===r)&&(r=!1),i.Device.LITTLE_ENDIAN?(e.a=(4278190080&t)>>>24,e.b=(16711680&t)>>>16,e.g=(65280&t)>>>8,e.r=255&t):(e.r=(4278190080&t)>>>24,e.g=(16711680&t)>>>16,e.b=(65280&t)>>>8,e.a=255&t),e.color=t,e.rgba="rgba("+e.r+","+e.g+","+e.b+","+e.a/255+")",n&&i.Color.RGBtoHSL(e.r,e.g,e.b,e),r&&i.Color.RGBtoHSV(e.r,e.g,e.b,e),e},fromRGBA:function(t,e){return e||(e=i.Color.createColor()),e.r=(4278190080&t)>>>24,e.g=(16711680&t)>>>16,e.b=(65280&t)>>>8,e.a=255&t,e.rgba="rgba("+e.r+","+e.g+","+e.b+","+e.a+")",e},toRGBA:function(t,e,i,n){return t<<24|e<<16|i<<8|n},RGBtoHSL:function(t,e,n,r){r||(r=i.Color.createColor(t,e,n,1)),t/=255,e/=255,n/=255;var s=Math.min(t,e,n),o=Math.max(t,e,n);if(r.h=0,r.s=0,r.l=(o+s)/2,o!==s){var a=o-s;r.s=r.l>.5?a/(2-o-s):a/(o+s),o===t?r.h=(e-n)/a+(n>e?6:0):o===e?r.h=(n-t)/a+2:o===n&&(r.h=(t-e)/a+4),r.h/=6}return r},HSLtoRGB:function(t,e,n,r){if(r?(r.r=n,r.g=n,r.b=n):r=i.Color.createColor(n,n,n),0!==e){var s=.5>n?n*(1+e):n+e-n*e,o=2*n-s;r.r=i.Color.hueToColor(o,s,t+1/3),r.g=i.Color.hueToColor(o,s,t),r.b=i.Color.hueToColor(o,s,t-1/3)}return r.r=Math.floor(255*r.r|0),r.g=Math.floor(255*r.g|0),r.b=Math.floor(255*r.b|0),i.Color.updateColor(r),r},RGBtoHSV:function(t,e,n,r){r||(r=i.Color.createColor(t,e,n,255)),t/=255,e/=255,n/=255;var s=Math.min(t,e,n),o=Math.max(t,e,n),a=o-s;return r.h=0,r.s=0===o?0:a/o,r.v=o,o!==s&&(o===t?r.h=(e-n)/a+(n>e?6:0):o===e?r.h=(n-t)/a+2:o===n&&(r.h=(t-e)/a+4),r.h/=6),r},HSVtoRGB:function(t,e,n,r){"undefined"==typeof r&&(r=i.Color.createColor(0,0,0,1,t,e,0,n));var s,o,a,h=Math.floor(6*t),u=6*t-h,c=n*(1-e),l=n*(1-u*e),d=n*(1-(1-u)*e);switch(h%6){case 0:s=n,o=d,a=c;break;case 1:s=l,o=n,a=c;break;case 2:s=c,o=n,a=d;break;case 3:s=c,o=l,a=n;break;case 4:s=d,o=c,a=n;break;case 5:s=n,o=c,a=l}return r.r=Math.floor(255*s),r.g=Math.floor(255*o),r.b=Math.floor(255*a),i.Color.updateColor(r),r},hueToColor:function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t},createColor:function(t,e,i,n,r,s,o,a){var h={r:t||0,g:e||0,b:i||0,a:n||1,h:r||0,s:s||0,l:o||0,v:a||0,color:0};return h.rgba="rgba("+h.r+","+h.g+","+h.b+","+h.a+")",h},updateColor:function(t){return t.rgba="rgba("+t.r+","+t.g+","+t.b+","+t.a+")",t},getColor32:function(t,e,i,n){return t<<24|e<<16|i<<8|n},getColor:function(t,e,i){return t<<16|e<<8|i},RGBtoString:function(t,e,n,r,s){return"undefined"==typeof r&&(r=255),"undefined"==typeof s&&(s="#"),"#"===s?"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1):"0x"+i.Color.componentToHex(r)+i.Color.componentToHex(t)+i.Color.componentToHex(e)+i.Color.componentToHex(n)},hexToRGB:function(t){var e=i.Color.hexToColor(t);return e?i.Color.getColor32(e.a,e.r,e.g,e.b):void 0},hexToColor:function(t,e){e||(e=i.Color.createColor());var n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,function(t,e,i,n){return e+e+i+i+n+n});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return r&&(e.r=parseInt(r[1],16),e.g=parseInt(r[2],16),e.b=parseInt(r[3],16)),e},componentToHex:function(t){var e=t.toString(16);return 1==e.length?"0"+e:e},HSVColorWheel:function(t,e){"undefined"==typeof t&&(t=1),"undefined"==typeof e&&(e=1);for(var n=[],r=0;359>=r;r++)n.push(i.Color.HSVtoRGB(r/359,t,e));return n},HSLColorWheel:function(t,e){"undefined"==typeof t&&(t=.5),"undefined"==typeof e&&(e=.5);for(var n=[],r=0;359>=r;r++)n.push(i.Color.HSLtoRGB(r/359,t,e));return n},interpolateColor:function(t,e,n,r,s){"undefined"==typeof s&&(s=255);var o=i.Color.getRGB(t),a=i.Color.getRGB(e),h=(a.red-o.red)*r/n+o.red,u=(a.green-o.green)*r/n+o.green,c=(a.blue-o.blue)*r/n+o.blue;return i.Color.getColor32(s,h,u,c)},interpolateColorWithRGB:function(t,e,n,r,s,o){var a=i.Color.getRGB(t),h=(e-a.red)*o/s+a.red,u=(n-a.green)*o/s+a.green,c=(r-a.blue)*o/s+a.blue;return i.Color.getColor(h,u,c)},interpolateRGB:function(t,e,n,r,s,o,a,h){var u=(r-t)*h/a+t,c=(s-e)*h/a+e,l=(o-n)*h/a+n;return i.Color.getColor(u,c,l)},getRandomColor:function(t,e,n){if("undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=255),"undefined"==typeof n&&(n=255),e>255||t>e)return i.Color.getColor(255,255,255);var r=t+Math.round(Math.random()*(e-t)),s=t+Math.round(Math.random()*(e-t)),o=t+Math.round(Math.random()*(e-t));return i.Color.getColor32(n,r,s,o)
},getRGB:function(t){return t>16777215?{alpha:t>>>24,red:t>>16&255,green:t>>8&255,blue:255&t,a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{alpha:255,red:t>>16&255,green:t>>8&255,blue:255&t,a:255,r:t>>16&255,g:t>>8&255,b:255&t}},getWebRGB:function(t){var e=i.Color.getRGB(t);return"rgba("+e.r.toString()+","+e.g.toString()+","+e.b.toString()+","+e.a.toString()+")"},getAlpha:function(t){return t>>>24},getAlphaFloat:function(t){return(t>>>24)/255},getRed:function(t){return t>>16&255},getGreen:function(t){return t>>8&255},getBlue:function(t){return 255&t},getColorInfo:function(t){var e=i.Color.getRGB(t),n=i.Color.RGBtoHexstring(t)+"\n";return n=n.concat("Alpha: "+e.alpha+" Red: "+e.red+" Green: "+e.green+" Blue: "+e.blue)+"\n"},RGBtoHexstring:function(t){var e=i.Color.getRGB(t);return"0x"+i.Color.colorToHexstring(e.alpha)+i.Color.colorToHexstring(e.red)+i.Color.colorToHexstring(e.green)+i.Color.colorToHexstring(e.blue)},RGBtoWebstring:function(t){var e=i.Color.getRGB(t);return"#"+i.Color.colorToHexstring(e.red)+i.Color.colorToHexstring(e.green)+i.Color.colorToHexstring(e.blue)},colorToHexstring:function(t){var e="0123456789ABCDEF",i=t%16,n=(t-i)/16,r=e.charAt(n)+e.charAt(i);return r}},i.Physics=function(t,e){e=e||{},this.game=t,this.config=e,this.arcade=null,this.p2=null,this.ninja=null,this.box2d=null,this.chipmunk=null,this.parseConfig()},i.Physics.ARCADE=0,i.Physics.P2JS=1,i.Physics.NINJA=2,i.Physics.BOX2D=3,i.Physics.CHIPMUNK=5,i.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&this.config.arcade!==!0||!i.Physics.hasOwnProperty("Arcade")||(this.arcade=new i.Physics.Arcade(this.game),this.game.time.deltaCap=.2),this.config.hasOwnProperty("ninja")&&this.config.ninja===!0&&i.Physics.hasOwnProperty("Ninja")&&(this.ninja=new i.Physics.Ninja(this.game)),this.config.hasOwnProperty("p2")&&this.config.p2===!0&&i.Physics.hasOwnProperty("P2")&&(this.p2=new i.Physics.P2(this.game,this.config))},startSystem:function(t){if(t===i.Physics.ARCADE?this.arcade=new i.Physics.Arcade(this.game):t===i.Physics.P2JS&&(this.p2=new i.Physics.P2(this.game,this.config)),t===i.Physics.NINJA)this.ninja=new i.Physics.Ninja(this.game);else{if(t===i.Physics.BOX2D&&null===this.box2d)throw new Error("The Box2D physics system has not been implemented yet.");if(t===i.Physics.CHIPMUNK&&null===this.chipmunk)throw new Error("The Chipmunk physics system has not been implemented yet.")}},enable:function(t,e,n){"undefined"==typeof e&&(e=i.Physics.ARCADE),"undefined"==typeof n&&(n=!1),e===i.Physics.ARCADE?this.arcade.enable(t):e===i.Physics.P2JS&&this.p2?this.p2.enable(t,n):e===i.Physics.NINJA&&this.ninja&&this.ninja.enableAABB(t)},preUpdate:function(){this.p2&&this.p2.preUpdate()},update:function(){this.p2&&this.p2.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld(),this.ninja&&this.ninja.setBoundsToWorld(),this.p2&&this.p2.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear()},destroy:function(){this.p2&&this.p2.destroy(),this.arcade=null,this.ninja=null,this.p2=null}},i.Physics.prototype.constructor=i.Physics,i.Physics.Arcade=function(t){this.game=t,this.gravity=new i.Point,this.bounds=new i.Rectangle(0,0,t.world.width,t.world.height),this.checkCollision={up:!0,down:!0,left:!0,right:!0},this.maxObjects=10,this.maxLevels=4,this.OVERLAP_BIAS=4,this.TILE_BIAS=16,this.forceX=!1,this.quadTree=new i.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this._overlap=0,this._maxOverlap=0,this._velocity1=0,this._velocity2=0,this._newVelocity1=0,this._newVelocity2=0,this._average=0,this._mapData=[],this._result=!1,this._total=0,this._angle=0,this._dx=0,this._dy=0},i.Physics.Arcade.prototype.constructor=i.Physics.Arcade,i.Physics.Arcade.prototype={setBounds:function(t,e,i,n){this.bounds.setTo(t,e,i,n)},setBoundsToWorld:function(){this.bounds.setTo(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height)},enable:function(t,e){"undefined"==typeof e&&(e=!0);var n=1;if(Array.isArray(t))for(n=t.length;n--;)t[n]instanceof i.Group?this.enable(t[n].children,e):(this.enableBody(t[n]),e&&t[n].hasOwnProperty("children")&&t[n].children.length>0&&this.enable(t[n],!0));else t instanceof i.Group?this.enable(t.children,e):(this.enableBody(t),e&&t.hasOwnProperty("children")&&t.children.length>0&&this.enable(t.children,!0))},enableBody:function(t){t.hasOwnProperty("body")&&null===t.body&&(t.body=new i.Physics.Arcade.Body(t))},updateMotion:function(t){this._velocityDelta=this.computeVelocity(0,t,t.angularVelocity,t.angularAcceleration,t.angularDrag,t.maxAngular)-t.angularVelocity,t.angularVelocity+=this._velocityDelta,t.rotation+=t.angularVelocity*this.game.time.physicsElapsed,t.velocity.x=this.computeVelocity(1,t,t.velocity.x,t.acceleration.x,t.drag.x,t.maxVelocity.x),t.velocity.y=this.computeVelocity(2,t,t.velocity.y,t.acceleration.y,t.drag.y,t.maxVelocity.y)},computeVelocity:function(t,e,i,n,r,s){return s=s||1e4,1==t&&e.allowGravity?i+=(this.gravity.x+e.gravity.x)*this.game.time.physicsElapsed:2==t&&e.allowGravity&&(i+=(this.gravity.y+e.gravity.y)*this.game.time.physicsElapsed),n?i+=n*this.game.time.physicsElapsed:r&&(this._drag=r*this.game.time.physicsElapsed,i-this._drag>0?i-=this._drag:i+this._drag<0?i+=this._drag:i=0),i>s?i=s:-s>i&&(i=-s),i},overlap:function(t,e,i,n,r){if(i=i||null,n=n||null,r=r||i,this._result=!1,this._total=0,Array.isArray(e))for(var s=0,o=e.length;o>s;s++)this.collideHandler(t,e[s],i,n,r,!0);else this.collideHandler(t,e,i,n,r,!0);return this._total>0},collide:function(t,e,i,n,r){if(i=i||null,n=n||null,r=r||i,this._result=!1,this._total=0,Array.isArray(e))for(var s=0,o=e.length;o>s;s++)this.collideHandler(t,e[s],i,n,r,!1);else this.collideHandler(t,e,i,n,r,!1);return this._total>0},collideHandler:function(t,e,n,r,s,o){return"undefined"!=typeof e||t.type!==i.GROUP&&t.type!==i.EMITTER?(t&&e&&t.exists&&e.exists&&(t.type==i.SPRITE||t.type==i.TILESPRITE?e.type==i.SPRITE||e.type==i.TILESPRITE?this.collideSpriteVsSprite(t,e,n,r,s,o):e.type==i.GROUP||e.type==i.EMITTER?this.collideSpriteVsGroup(t,e,n,r,s,o):e.type==i.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(t,e,n,r,s):t.type==i.GROUP?e.type==i.SPRITE||e.type==i.TILESPRITE?this.collideSpriteVsGroup(e,t,n,r,s,o):e.type==i.GROUP||e.type==i.EMITTER?this.collideGroupVsGroup(t,e,n,r,s,o):e.type==i.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(t,e,n,r,s):t.type==i.TILEMAPLAYER?e.type==i.SPRITE||e.type==i.TILESPRITE?this.collideSpriteVsTilemapLayer(e,t,n,r,s):(e.type==i.GROUP||e.type==i.EMITTER)&&this.collideGroupVsTilemapLayer(e,t,n,r,s):t.type==i.EMITTER&&(e.type==i.SPRITE||e.type==i.TILESPRITE?this.collideSpriteVsGroup(e,t,n,r,s,o):e.type==i.GROUP||e.type==i.EMITTER?this.collideGroupVsGroup(t,e,n,r,s,o):e.type==i.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(t,e,n,r,s))),void 0):(this.collideGroupVsSelf(t,n,r,s,o),void 0)},collideSpriteVsSprite:function(t,e,i,n,r,s){return t.body&&e.body?(this.separate(t.body,e.body,n,r,s)&&(i&&i.call(r,t,e),this._total++),!0):!1},collideSpriteVsGroup:function(t,e,i,n,r,s){if(0!==e.length&&t.body){this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(e),this._potentials=this.quadTree.retrieve(t);for(var o=0,a=this._potentials.length;a>o;o++)this.separate(t.body,this._potentials[o],n,r,s)&&(i&&i.call(r,t,this._potentials[o].sprite),this._total++)}},collideGroupVsSelf:function(t,e,i,n,r){if(0!==t.length)for(var s=t.children.length,o=0;s>o;o++)for(var a=o+1;s>=a;a++)t.children[o]&&t.children[a]&&t.children[o].exists&&t.children[a].exists&&this.collideSpriteVsSprite(t.children[o],t.children[a],e,i,n,r)},collideGroupVsGroup:function(t,e,i,n,r,s){if(0!==t.length&&0!==e.length)for(var o=0,a=t.children.length;a>o;o++)t.children[o].exists&&this.collideSpriteVsGroup(t.children[o],e,i,n,r,s)},collideSpriteVsTilemapLayer:function(t,e,i,n,r){if(t.body&&(this._mapData=e.getTiles(t.body.position.x-t.body.tilePadding.x,t.body.position.y-t.body.tilePadding.y,t.body.width+t.body.tilePadding.x,t.body.height+t.body.tilePadding.y,!1,!1),0!==this._mapData.length))for(var s=0;s<this._mapData.length;s++)this.separateTile(s,t.body,this._mapData[s])&&(n?n.call(r,t,this._mapData[s])&&(this._total++,i&&i.call(r,t,this._mapData[s])):(this._total++,i&&i.call(r,t,this._mapData[s])))},collideGroupVsTilemapLayer:function(t,e,i,n,r){if(0!==t.length)for(var s=0,o=t.children.length;o>s;s++)t.children[s].exists&&this.collideSpriteVsTilemapLayer(t.children[s],e,i,n,r)},separate:function(t,e,i,n,r){return this.intersects(t,e)?i&&i.call(n,t.sprite,e.sprite)===!1?!1:r?!0:(this._result=this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?this.separateX(t,e,r)||this.separateY(t,e,r):this.separateY(t,e,r)||this.separateX(t,e,r),this._result):!1},intersects:function(t,e){return t.right<=e.position.x?!1:t.bottom<=e.position.y?!1:t.position.x>=e.right?!1:t.position.y>=e.bottom?!1:!0},separateX:function(t,e,i){return t.immovable&&e.immovable?!1:(this._overlap=0,this.intersects(t,e)&&(this._maxOverlap=t.deltaAbsX()+e.deltaAbsX()+this.OVERLAP_BIAS,0===t.deltaX()&&0===e.deltaX()?(t.embedded=!0,e.embedded=!0):t.deltaX()>e.deltaX()?(this._overlap=t.right-e.x,this._overlap>this._maxOverlap||t.checkCollision.right===!1||e.checkCollision.left===!1?this._overlap=0:(t.touching.none=!1,t.touching.right=!0,e.touching.none=!1,e.touching.left=!0)):t.deltaX()<e.deltaX()&&(this._overlap=t.x-e.width-e.x,-this._overlap>this._maxOverlap||t.checkCollision.left===!1||e.checkCollision.right===!1?this._overlap=0:(t.touching.none=!1,t.touching.left=!0,e.touching.none=!1,e.touching.right=!0)),0!==this._overlap)?(t.overlapX=this._overlap,e.overlapX=this._overlap,i||t.customSeparateX||e.customSeparateX?!0:(this._velocity1=t.velocity.x,this._velocity2=e.velocity.x,t.immovable||e.immovable?t.immovable?e.immovable||(e.x+=this._overlap,e.velocity.x=this._velocity1-this._velocity2*e.bounce.x):(t.x=t.x-this._overlap,t.velocity.x=this._velocity2-this._velocity1*t.bounce.x):(this._overlap*=.5,t.x=t.x-this._overlap,e.x+=this._overlap,this._newVelocity1=Math.sqrt(this._velocity2*this._velocity2*e.mass/t.mass)*(this._velocity2>0?1:-1),this._newVelocity2=Math.sqrt(this._velocity1*this._velocity1*t.mass/e.mass)*(this._velocity1>0?1:-1),this._average=.5*(this._newVelocity1+this._newVelocity2),this._newVelocity1-=this._average,this._newVelocity2-=this._average,t.velocity.x=this._average+this._newVelocity1*t.bounce.x,e.velocity.x=this._average+this._newVelocity2*e.bounce.x),!0)):!1)},separateY:function(t,e,i){return t.immovable&&e.immovable?!1:(this._overlap=0,this.intersects(t,e)&&(this._maxOverlap=t.deltaAbsY()+e.deltaAbsY()+this.OVERLAP_BIAS,0===t.deltaY()&&0===e.deltaY()?(t.embedded=!0,e.embedded=!0):t.deltaY()>e.deltaY()?(this._overlap=t.bottom-e.y,this._overlap>this._maxOverlap||t.checkCollision.down===!1||e.checkCollision.up===!1?this._overlap=0:(t.touching.none=!1,t.touching.down=!0,e.touching.none=!1,e.touching.up=!0)):t.deltaY()<e.deltaY()&&(this._overlap=t.y-e.bottom,-this._overlap>this._maxOverlap||t.checkCollision.up===!1||e.checkCollision.down===!1?this._overlap=0:(t.touching.none=!1,t.touching.up=!0,e.touching.none=!1,e.touching.down=!0)),0!==this._overlap)?(t.overlapY=this._overlap,e.overlapY=this._overlap,i||t.customSeparateY||e.customSeparateY?!0:(this._velocity1=t.velocity.y,this._velocity2=e.velocity.y,t.immovable||e.immovable?t.immovable?e.immovable||(e.y+=this._overlap,e.velocity.y=this._velocity1-this._velocity2*e.bounce.y,t.moves&&(e.x+=t.x-t.prev.x)):(t.y=t.y-this._overlap,t.velocity.y=this._velocity2-this._velocity1*t.bounce.y,e.moves&&(t.x+=e.x-e.prev.x)):(this._overlap*=.5,t.y=t.y-this._overlap,e.y+=this._overlap,this._newVelocity1=Math.sqrt(this._velocity2*this._velocity2*e.mass/t.mass)*(this._velocity2>0?1:-1),this._newVelocity2=Math.sqrt(this._velocity1*this._velocity1*t.mass/e.mass)*(this._velocity1>0?1:-1),this._average=.5*(this._newVelocity1+this._newVelocity2),this._newVelocity1-=this._average,this._newVelocity2-=this._average,t.velocity.y=this._average+this._newVelocity1*t.bounce.y,e.velocity.y=this._average+this._newVelocity2*e.bounce.y),!0)):!1)},separateTile:function(t,e,i){if(!i.intersects(e.position.x,e.position.y,e.right,e.bottom))return!1;if(i.collisionCallback&&!i.collisionCallback.call(i.collisionCallbackContext,e.sprite,i))return!1;if(i.layer.callbacks[i.index]&&!i.layer.callbacks[i.index].callback.call(i.layer.callbacks[i.index].callbackContext,e.sprite,i))return!1;if(!(i.faceLeft||i.faceRight||i.faceTop||i.faceBottom))return!1;var n=0,r=0,s=0,o=1;if(e.deltaAbsX()>e.deltaAbsY()?s=-1:e.deltaAbsX()<e.deltaAbsY()&&(o=-1),0!==e.deltaX()&&0!==e.deltaY()&&(i.faceLeft||i.faceRight)&&(i.faceTop||i.faceBottom)&&(s=Math.min(Math.abs(e.position.x-i.right),Math.abs(e.right-i.left)),o=Math.min(Math.abs(e.position.y-i.bottom),Math.abs(e.bottom-i.top))),o>s){if((i.faceLeft||i.faceRight)&&(n=this.tileCheckX(e,i),0!==n&&!i.intersects(e.position.x,e.position.y,e.right,e.bottom)))return!0;(i.faceTop||i.faceBottom)&&(r=this.tileCheckY(e,i))}else{if((i.faceTop||i.faceBottom)&&(r=this.tileCheckY(e,i),0!==r&&!i.intersects(e.position.x,e.position.y,e.right,e.bottom)))return!0;(i.faceLeft||i.faceRight)&&(n=this.tileCheckX(e,i))}return 0!==n||0!==r},tileCheckX:function(t,e){var i=0;return t.deltaX()<0&&!t.blocked.left&&e.collideRight&&t.checkCollision.left?e.faceRight&&t.x<e.right&&(i=t.x-e.right,i<-this.TILE_BIAS&&(i=0)):t.deltaX()>0&&!t.blocked.right&&e.collideLeft&&t.checkCollision.right&&e.faceLeft&&t.right>e.left&&(i=t.right-e.left,i>this.TILE_BIAS&&(i=0)),0!==i&&this.processTileSeparationX(t,i),i},tileCheckY:function(t,e){var i=0;return t.deltaY()<0&&!t.blocked.up&&e.collideDown&&t.checkCollision.up?e.faceBottom&&t.y<e.bottom&&(i=t.y-e.bottom,i<-this.TILE_BIAS&&(i=0)):t.deltaY()>0&&!t.blocked.down&&e.collideUp&&t.checkCollision.down&&e.faceTop&&t.bottom>e.top&&(i=t.bottom-e.top,i>this.TILE_BIAS&&(i=0)),0!==i&&this.processTileSeparationY(t,i),i},processTileSeparationX:function(t,e){0>e?t.blocked.left=!0:e>0&&(t.blocked.right=!0),t.position.x-=e,t.velocity.x=0===t.bounce.x?0:-t.velocity.x*t.bounce.x},processTileSeparationY:function(t,e){0>e?t.blocked.up=!0:e>0&&(t.blocked.down=!0),t.position.y-=e,t.velocity.y=0===t.bounce.y?0:-t.velocity.y*t.bounce.y},getObjectsUnderPointer:function(t,e,n,r){if(0!==e.length&&t.exists){this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(e);var s=new i.Rectangle(t.x,t.y,1,1),o=[];this._potentials=this.quadTree.retrieve(s);for(var a=0,h=this._potentials.length;h>a;a++)this._potentials[a].hitTest(t.x,t.y)&&(n&&n.call(r,t,this._potentials[a].sprite),o.push(this._potentials[a].sprite));return o}},moveToObject:function(t,e,i,n){return"undefined"==typeof i&&(i=60),"undefined"==typeof n&&(n=0),this._angle=Math.atan2(e.y-t.y,e.x-t.x),n>0&&(i=this.distanceBetween(t,e)/(n/1e3)),t.body.velocity.x=Math.cos(this._angle)*i,t.body.velocity.y=Math.sin(this._angle)*i,this._angle},moveToPointer:function(t,e,i,n){return"undefined"==typeof e&&(e=60),i=i||this.game.input.activePointer,"undefined"==typeof n&&(n=0),this._angle=this.angleToPointer(t,i),n>0&&(e=this.distanceToPointer(t,i)/(n/1e3)),t.body.velocity.x=Math.cos(this._angle)*e,t.body.velocity.y=Math.sin(this._angle)*e,this._angle},moveToXY:function(t,e,i,n,r){return"undefined"==typeof n&&(n=60),"undefined"==typeof r&&(r=0),this._angle=Math.atan2(i-t.y,e-t.x),r>0&&(n=this.distanceToXY(t,e,i)/(r/1e3)),t.body.velocity.x=Math.cos(this._angle)*n,t.body.velocity.y=Math.sin(this._angle)*n,this._angle},velocityFromAngle:function(t,e,n){return"undefined"==typeof e&&(e=60),n=n||new i.Point,n.setTo(Math.cos(this.game.math.degToRad(t))*e,Math.sin(this.game.math.degToRad(t))*e)},velocityFromRotation:function(t,e,n){return"undefined"==typeof e&&(e=60),n=n||new i.Point,n.setTo(Math.cos(t)*e,Math.sin(t)*e)},accelerationFromRotation:function(t,e,n){return"undefined"==typeof e&&(e=60),n=n||new i.Point,n.setTo(Math.cos(t)*e,Math.sin(t)*e)},accelerateToObject:function(t,e,i,n,r){return"undefined"==typeof i&&(i=60),"undefined"==typeof n&&(n=1e3),"undefined"==typeof r&&(r=1e3),this._angle=this.angleBetween(t,e),t.body.acceleration.setTo(Math.cos(this._angle)*i,Math.sin(this._angle)*i),t.body.maxVelocity.setTo(n,r),this._angle},accelerateToPointer:function(t,e,i,n,r){return"undefined"==typeof i&&(i=60),"undefined"==typeof e&&(e=this.game.input.activePointer),"undefined"==typeof n&&(n=1e3),"undefined"==typeof r&&(r=1e3),this._angle=this.angleToPointer(t,e),t.body.acceleration.setTo(Math.cos(this._angle)*i,Math.sin(this._angle)*i),t.body.maxVelocity.setTo(n,r),this._angle},accelerateToXY:function(t,e,i,n,r,s){return"undefined"==typeof n&&(n=60),"undefined"==typeof r&&(r=1e3),"undefined"==typeof s&&(s=1e3),this._angle=this.angleToXY(t,e,i),t.body.acceleration.setTo(Math.cos(this._angle)*n,Math.sin(this._angle)*n),t.body.maxVelocity.setTo(r,s),this._angle},distanceBetween:function(t,e){return this._dx=t.x-e.x,this._dy=t.y-e.y,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},distanceToXY:function(t,e,i){return this._dx=t.x-e,this._dy=t.y-i,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},distanceToPointer:function(t,e){return e=e||this.game.input.activePointer,this._dx=t.x-e.x,this._dy=t.y-e.y,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},angleBetween:function(t,e){return this._dx=e.x-t.x,this._dy=e.y-t.y,Math.atan2(this._dy,this._dx)},angleToXY:function(t,e,i){return this._dx=e-t.x,this._dy=i-t.y,Math.atan2(this._dy,this._dx)},angleToPointer:function(t,e){return e=e||this.game.input.activePointer,this._dx=e.worldX-t.x,this._dy=e.worldY-t.y,Math.atan2(this._dy,this._dx)}},i.Physics.Arcade.Body=function(t){this.sprite=t,this.game=t.game,this.type=i.Physics.ARCADE,this.offset=new i.Point,this.position=new i.Point(t.x,t.y),this.prev=new i.Point(this.position.x,this.position.y),this.allowRotation=!0,this.rotation=t.rotation,this.preRotation=t.rotation,this.sourceWidth=t.texture.frame.width,this.sourceHeight=t.texture.frame.height,this.width=t.width,this.height=t.height,this.halfWidth=Math.abs(t.width/2),this.halfHeight=Math.abs(t.height/2),this.center=new i.Point(t.x+this.halfWidth,t.y+this.halfHeight),this.velocity=new i.Point,this.newVelocity=new i.Point(0,0),this.deltaMax=new i.Point(0,0),this.acceleration=new i.Point,this.drag=new i.Point,this.allowGravity=!0,this.gravity=new i.Point(0,0),this.bounce=new i.Point,this.maxVelocity=new i.Point(1e4,1e4),this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=i.NONE,this.immovable=!1,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={up:!1,down:!1,left:!1,right:!1},this.tilePadding=new i.Point,this.phase=0,this._reset=!0,this._sx=t.scale.x,this._sy=t.scale.y,this._dx=0,this._dy=0},i.Physics.Arcade.Body.prototype={updateBounds:function(){var t=Math.abs(this.sprite.scale.x),e=Math.abs(this.sprite.scale.y);(t!==this._sx||e!==this._sy)&&(this.width=this.sourceWidth*t,this.height=this.sourceHeight*e,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this._sx=t,this._sy=e,this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this._reset=!0)},preUpdate:function(){this.phase=1,this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.embedded=!1,this.updateBounds(),this.position.x=this.sprite.world.x-this.sprite.anchor.x*this.width+this.offset.x,this.position.y=this.sprite.world.y-this.sprite.anchor.y*this.height+this.offset.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,(this._reset||1===this.sprite._cache[4])&&(this.prev.x=this.position.x,this.prev.y=this.position.y),this.moves&&(this.game.physics.arcade.updateMotion(this),this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed),this.position.x+=this.newVelocity.x,this.position.y+=this.newVelocity.y,(this.position.x!==this.prev.x||this.position.y!==this.prev.y)&&(this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.angle=Math.atan2(this.velocity.y,this.velocity.x)),this.collideWorldBounds&&this.checkWorldBounds()),this._dx=this.deltaX(),this._dy=this.deltaY(),this._reset=!1},postUpdate:function(){2!==this.phase&&(this.phase=2,this.deltaX()<0?this.facing=i.LEFT:this.deltaX()>0&&(this.facing=i.RIGHT),this.deltaY()<0?this.facing=i.UP:this.deltaY()>0&&(this.facing=i.DOWN),this.moves&&(this._dx=this.deltaX(),this._dy=this.deltaY(),0!==this.deltaMax.x&&0!==this._dx&&(this._dx<0&&this._dx<-this.deltaMax.x?this._dx=-this.deltaMax.x:this._dx>0&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x)),0!==this.deltaMax.y&&0!==this._dy&&(this._dy<0&&this._dy<-this.deltaMax.y?this._dy=-this.deltaMax.y:this._dy>0&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y)),this.sprite.x+=this._dx,this.sprite.y+=this._dy),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prev.x=this.position.x,this.prev.y=this.position.y)},destroy:function(){this.sprite=null},checkWorldBounds:function(){this.position.x<this.game.physics.arcade.bounds.x&&this.game.physics.arcade.checkCollision.left?(this.position.x=this.game.physics.arcade.bounds.x,this.velocity.x*=-this.bounce.x,this.blocked.left=!0):this.right>this.game.physics.arcade.bounds.right&&this.game.physics.arcade.checkCollision.right&&(this.position.x=this.game.physics.arcade.bounds.right-this.width,this.velocity.x*=-this.bounce.x,this.blocked.right=!0),this.position.y<this.game.physics.arcade.bounds.y&&this.game.physics.arcade.checkCollision.up?(this.position.y=this.game.physics.arcade.bounds.y,this.velocity.y*=-this.bounce.y,this.blocked.up=!0):this.bottom>this.game.physics.arcade.bounds.bottom&&this.game.physics.arcade.checkCollision.down&&(this.position.y=this.game.physics.arcade.bounds.bottom-this.height,this.velocity.y*=-this.bounce.y,this.blocked.down=!0)},setSize:function(t,e,i,n){i=i||this.offset.x,n=n||this.offset.y,this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(i,n),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(t,e){this.velocity.set(0),this.acceleration.set(0),this.angularVelocity=0,this.angularAcceleration=0,this.position.x=t-this.sprite.anchor.x*this.width+this.offset.x,this.position.y=e-this.sprite.anchor.y*this.height+this.offset.y,this.prev.x=this.position.x,this.prev.y=this.position.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,this._sx=this.sprite.scale.x,this._sy=this.sprite.scale.y,this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},hitTest:function(t,e){return i.Rectangle.contains(this,t,e)},onFloor:function(){return this.blocked.down},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this.deltaX()>0?this.deltaX():-this.deltaX()},deltaAbsY:function(){return this.deltaY()>0?this.deltaY():-this.deltaY()},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation}},Object.defineProperty(i.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+this.height}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),i.Physics.Arcade.Body.render=function(t,e,i,n){"undefined"==typeof i&&(i=!0),n=n||"rgba(0,255,0,0.4)",i?(t.fillStyle=n,t.fillRect(e.position.x-e.game.camera.x,e.position.y-e.game.camera.y,e.width,e.height)):(t.strokeStyle=n,t.strokeRect(e.position.x-e.game.camera.x,e.position.y-e.game.camera.y,e.width,e.height))},i.Physics.Arcade.Body.renderBodyInfo=function(t,e){t.line("x: "+e.x.toFixed(2),"y: "+e.y.toFixed(2),"width: "+e.width,"height: "+e.height),t.line("velocity x: "+e.velocity.x.toFixed(2),"y: "+e.velocity.y.toFixed(2),"deltaX: "+e._dx.toFixed(2),"deltaY: "+e._dy.toFixed(2)),t.line("acceleration x: "+e.acceleration.x.toFixed(2),"y: "+e.acceleration.y.toFixed(2),"speed: "+e.speed.toFixed(2),"angle: "+e.angle.toFixed(2)),t.line("gravity x: "+e.gravity.x,"y: "+e.gravity.y,"bounce x: "+e.bounce.x.toFixed(2),"y: "+e.bounce.y.toFixed(2)),t.line("touching left: "+e.touching.left,"right: "+e.touching.right,"up: "+e.touching.up,"down: "+e.touching.down),t.line("blocked left: "+e.blocked.left,"right: "+e.blocked.right,"up: "+e.blocked.up,"down: "+e.blocked.down)},i.Physics.Arcade.Body.prototype.constructor=i.Physics.Arcade.Body,i.Particles=function(t){this.game=t,this.emitters={},this.ID=0},i.Particles.prototype={add:function(t){return this.emitters[t.name]=t,t},remove:function(t){delete this.emitters[t.name]},update:function(){for(var t in this.emitters)this.emitters[t].exists&&this.emitters[t].update()}},i.Particles.prototype.constructor=i.Particles,i.Particles.Arcade={},i.Particles.Arcade.Emitter=function(t,e,n,r){this.maxParticles=r||50,i.Group.call(this,t),this.name="emitter"+this.game.particles.ID++,this.type=i.EMITTER,this.width=1,this.height=1,this.minParticleSpeed=new i.Point(-100,-100),this.maxParticleSpeed=new i.Point(100,100),this.minParticleScale=1,this.maxParticleScale=1,this.scaleData=null,this.minRotation=-360,this.maxRotation=360,this.minParticleAlpha=1,this.maxParticleAlpha=1,this.alphaData=null,this.gravity=100,this.particleClass=i.Particle,this.particleDrag=new i.Point,this.angularDrag=0,this.frequency=100,this.lifespan=2e3,this.bounce=new i.Point,this.on=!1,this.particleAnchor=new i.Point(.5,.5),this.blendMode=i.blendModes.NORMAL,this.emitX=e,this.emitY=n,this.autoScale=!1,this.autoAlpha=!1,this.particleBringToTop=!1,this.particleSendToBack=!1,this._minParticleScale=new i.Point(1,1),this._maxParticleScale=new i.Point(1,1),this._quantity=0,this._timer=0,this._counter=0,this._explode=!0,this._frames=null},i.Particles.Arcade.Emitter.prototype=Object.create(i.Group.prototype),i.Particles.Arcade.Emitter.prototype.constructor=i.Particles.Arcade.Emitter,i.Particles.Arcade.Emitter.prototype.update=function(){if(this.on)if(this._explode){this._counter=0;do this.emitParticle(),this._counter++;while(this._counter<this._quantity);this.on=!1}else this.game.time.now>=this._timer&&(this.emitParticle(),this._counter++,this._quantity>0&&this._counter>=this._quantity&&(this.on=!1),this._timer=this.game.time.now+this.frequency);for(var t=this.children.length;t--;)this.children[t].exists&&this.children[t].update()},i.Particles.Arcade.Emitter.prototype.makeParticles=function(t,e,i,n,r){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=this.maxParticles),"undefined"==typeof n&&(n=!1),"undefined"==typeof r&&(r=!1);var s,o=0,a=t,h=e;for(this._frames=e;i>o;)Array.isArray(t)&&(a=this.game.rnd.pick(t)),Array.isArray(e)&&(h=this.game.rnd.pick(e)),s=new this.particleClass(this.game,0,0,a,h),this.game.physics.arcade.enable(s,!1),n?(s.body.checkCollision.any=!0,s.body.checkCollision.none=!1):s.body.checkCollision.none=!0,s.body.collideWorldBounds=r,s.exists=!1,s.visible=!1,s.anchor.copyFrom(this.particleAnchor),this.add(s),o++;return this},i.Particles.Arcade.Emitter.prototype.kill=function(){this.on=!1,this.alive=!1,this.exists=!1},i.Particles.Arcade.Emitter.prototype.revive=function(){this.alive=!0,this.exists=!0},i.Particles.Arcade.Emitter.prototype.start=function(t,e,i,n){"undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=0),("undefined"==typeof i||null===i)&&(i=250),"undefined"==typeof n&&(n=0),this.revive(),this.visible=!0,this.on=!0,this._explode=t,this.lifespan=e,this.frequency=i,t?this._quantity=n:this._quantity+=n,this._counter=0,this._timer=this.game.time.now+i},i.Particles.Arcade.Emitter.prototype.emitParticle=function(){var t=this.getFirstExists(!1);null!==t&&(this.width>1||this.height>1?t.reset(this.game.rnd.integerInRange(this.left,this.right),this.game.rnd.integerInRange(this.top,this.bottom)):t.reset(this.emitX,this.emitY),t.angle=0,t.lifespan=this.lifespan,this.particleBringToTop?this.bringToTop(t):this.particleSendToBack&&this.sendToBack(t),this.autoScale?t.setScaleData(this.scaleData):1!==this.minParticleScale||1!==this.maxParticleScale?t.scale.set(this.game.rnd.realInRange(this.minParticleScale,this.maxParticleScale)):(this._minParticleScale.x!==this._maxParticleScale.x||this._minParticleScale.y!==this._maxParticleScale.y)&&t.scale.set(this.game.rnd.realInRange(this._minParticleScale.x,this._maxParticleScale.x),this.game.rnd.realInRange(this._minParticleScale.y,this._maxParticleScale.y)),t.frame=Array.isArray("object"===this._frames)?this.game.rnd.pick(this._frames):this._frames,this.autoAlpha?t.setAlphaData(this.alphaData):t.alpha=this.game.rnd.realInRange(this.minParticleAlpha,this.maxParticleAlpha),t.blendMode=this.blendMode,t.body.updateBounds(),t.body.bounce.setTo(this.bounce.x,this.bounce.y),t.body.velocity.x=this.game.rnd.integerInRange(this.minParticleSpeed.x,this.maxParticleSpeed.x),t.body.velocity.y=this.game.rnd.integerInRange(this.minParticleSpeed.y,this.maxParticleSpeed.y),t.body.angularVelocity=this.game.rnd.integerInRange(this.minRotation,this.maxRotation),t.body.gravity.y=this.gravity,t.body.drag.x=this.particleDrag.x,t.body.drag.y=this.particleDrag.y,t.body.angularDrag=this.angularDrag,t.onEmit())},i.Particles.Arcade.Emitter.prototype.setSize=function(t,e){this.width=t,this.height=e},i.Particles.Arcade.Emitter.prototype.setXSpeed=function(t,e){t=t||0,e=e||0,this.minParticleSpeed.x=t,this.maxParticleSpeed.x=e},i.Particles.Arcade.Emitter.prototype.setYSpeed=function(t,e){t=t||0,e=e||0,this.minParticleSpeed.y=t,this.maxParticleSpeed.y=e},i.Particles.Arcade.Emitter.prototype.setRotation=function(t,e){t=t||0,e=e||0,this.minRotation=t,this.maxRotation=e},i.Particles.Arcade.Emitter.prototype.setAlpha=function(t,e,n,r,s){if("undefined"==typeof t&&(t=1),"undefined"==typeof e&&(e=1),"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=i.Easing.Linear.None),"undefined"==typeof s&&(s=!1),this.minParticleAlpha=t,this.maxParticleAlpha=e,this.autoAlpha=!1,n>0&&t!==e){var o={v:t},a=this.game.make.tween(o).to({v:e},n,r);a.yoyo(s),this.alphaData=a.generateData(60),this.alphaData.reverse(),this.autoAlpha=!0}},i.Particles.Arcade.Emitter.prototype.setScale=function(t,e,n,r,s,o,a){if("undefined"==typeof t&&(t=1),"undefined"==typeof e&&(e=1),"undefined"==typeof n&&(n=1),"undefined"==typeof r&&(r=1),"undefined"==typeof s&&(s=0),"undefined"==typeof o&&(o=i.Easing.Linear.None),"undefined"==typeof a&&(a=!1),this.minParticleScale=1,this.maxParticleScale=1,this._minParticleScale.set(t,n),this._maxParticleScale.set(e,r),this.autoScale=!1,s>0&&t!==e||n!==r){var h={x:t,y:n},u=this.game.make.tween(h).to({x:e,y:r},s,o);
u.yoyo(a),this.scaleData=u.generateData(60),this.scaleData.reverse(),this.autoScale=!0}},i.Particles.Arcade.Emitter.prototype.at=function(t){t.center?(this.emitX=t.center.x,this.emitY=t.center.y):(this.emitX=t.world.x+t.anchor.x*t.width,this.emitY=t.world.y+t.anchor.y*t.height)},Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"x",{get:function(){return this.emitX},set:function(t){this.emitX=t}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"y",{get:function(){return this.emitY},set:function(t){this.emitY=t}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"left",{get:function(){return Math.floor(this.x-this.width/2)}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"right",{get:function(){return Math.floor(this.x+this.width/2)}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"top",{get:function(){return Math.floor(this.y-this.height/2)}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"bottom",{get:function(){return Math.floor(this.y+this.height/2)}}),i.Tile=function(t,e,i,n,r,s){this.layer=t,this.index=e,this.x=i,this.y=n,this.worldX=i*r,this.worldY=n*s,this.width=r,this.height=s,this.centerX=Math.abs(r/2),this.centerY=Math.abs(s/2),this.alpha=1,this.properties={},this.scanned=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.collisionCallback=null,this.collisionCallbackContext=this},i.Tile.prototype={containsPoint:function(t,e){return!(t<this.worldX||e<this.worldY||t>this.right||e>this.bottom)},intersects:function(t,e,i,n){return i<=this.worldX?!1:n<=this.worldY?!1:t>=this.worldX+this.width?!1:e>=this.worldY+this.height?!1:!0},setCollisionCallback:function(t,e){this.collisionCallback=t,this.collisionCallbackContext=e},destroy:function(){this.collisionCallback=null,this.collisionCallbackContext=null,this.properties=null},setCollision:function(t,e,i,n){this.collideLeft=t,this.collideRight=e,this.collideUp=i,this.collideDown=n},resetCollision:function(){this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1},isInteresting:function(t,e){return t&&e?this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.faceTop||this.faceBottom||this.faceLeft||this.faceRight||this.collisionCallback:t?this.collideLeft||this.collideRight||this.collideUp||this.collideDown:e?this.faceTop||this.faceBottom||this.faceLeft||this.faceRight:!1},copy:function(t){this.index=t.index,this.alpha=t.alpha,this.properties=t.properties,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext}},i.Tile.prototype.constructor=i.Tile,Object.defineProperty(i.Tile.prototype,"collides",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}}),Object.defineProperty(i.Tile.prototype,"canCollide",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}}),Object.defineProperty(i.Tile.prototype,"left",{get:function(){return this.worldX}}),Object.defineProperty(i.Tile.prototype,"right",{get:function(){return this.worldX+this.width}}),Object.defineProperty(i.Tile.prototype,"top",{get:function(){return this.worldY}}),Object.defineProperty(i.Tile.prototype,"bottom",{get:function(){return this.worldY+this.height}}),i.Tilemap=function(t,e,n,r,s,o){this.game=t,this.key=e;var a=i.TilemapParser.parse(this.game,e,n,r,s,o);null!==a&&(this.width=a.width,this.height=a.height,this.tileWidth=a.tileWidth,this.tileHeight=a.tileHeight,this.orientation=a.orientation,this.format=a.format,this.version=a.version,this.properties=a.properties,this.widthInPixels=a.widthInPixels,this.heightInPixels=a.heightInPixels,this.layers=a.layers,this.tilesets=a.tilesets,this.tiles=a.tiles,this.objects=a.objects,this.collideIndexes=[],this.collision=a.collision,this.images=a.images,this.currentLayer=0,this.debugMap=[],this._results=[],this._tempA=0,this._tempB=0)},i.Tilemap.CSV=0,i.Tilemap.TILED_JSON=1,i.Tilemap.NORTH=0,i.Tilemap.EAST=1,i.Tilemap.SOUTH=2,i.Tilemap.WEST=3,i.Tilemap.prototype={create:function(t,e,i,n,r,s){return"undefined"==typeof s&&(s=this.game.world),this.width=e,this.height=i,this.setTileSize(n,r),this.layers.length=0,this.createBlankLayer(t,e,i,n,r,s)},setTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e},addTilesetImage:function(t,e,n,r,s,o,a){if("undefined"==typeof n&&(n=this.tileWidth),"undefined"==typeof r&&(r=this.tileHeight),"undefined"==typeof s&&(s=0),"undefined"==typeof o&&(o=0),"undefined"==typeof a&&(a=0),0===n&&(n=32),0===r&&(r=32),"undefined"==typeof e){if("string"!=typeof t)return null;if(e=t,!this.game.cache.checkImageKey(e))return console.warn('Phaser.Tilemap.addTilesetImage: Invalid image key given: "'+e+'"'),null}if("string"==typeof t&&(t=this.getTilesetIndex(t),null===t&&this.format===i.Tilemap.TILED_JSON))return console.warn('Phaser.Tilemap.addTilesetImage: No data found in the JSON matching the tileset name: "'+e+'"'),null;if(this.tilesets[t])return this.tilesets[t].setImage(this.game.cache.getImage(e)),this.tilesets[t];var h=new i.Tileset(e,a,n,r,s,o,{});h.setImage(this.game.cache.getImage(e)),this.tilesets.push(h);for(var u=this.tilesets.length-1,c=s,l=s,d=0,p=0,f=0,m=a;m<a+h.total&&(this.tiles[m]=[c,l,u],c+=n+o,d++,d!==h.total)&&(p++,p!==h.columns||(c=s,l+=r+o,p=0,f++,f!==h.rows));m++);return h},createFromObjects:function(t,e,n,r,s,o,a,h,u){if("undefined"==typeof s&&(s=!0),"undefined"==typeof o&&(o=!1),"undefined"==typeof a&&(a=this.game.world),"undefined"==typeof h&&(h=i.Sprite),"undefined"==typeof u&&(u=!0),!this.objects[t])return console.warn("Tilemap.createFromObjects: Invalid objectgroup name given: "+t),void 0;for(var c,l=0,d=this.objects[t].length;d>l;l++)if(this.objects[t][l].gid===e){c=new h(this.game,this.objects[t][l].x,this.objects[t][l].y,n,r),c.name=this.objects[t][l].name,c.visible=this.objects[t][l].visible,c.autoCull=o,c.exists=s,u&&(c.y-=c.height),a.add(c);for(var p in this.objects[t][l].properties)a.set(c,p,this.objects[t][l].properties[p],!1,!1,0,!0)}},createLayer:function(t,e,n,r){"undefined"==typeof e&&(e=this.game.width),"undefined"==typeof n&&(n=this.game.height),"undefined"==typeof r&&(r=this.game.world);var s=t;return"string"==typeof t&&(s=this.getLayerIndex(t)),null===s||s>this.layers.length?(console.warn("Tilemap.createLayer: Invalid layer ID given: "+s),void 0):r.add(new i.TilemapLayer(this.game,this,s,e,n))},createBlankLayer:function(t,e,n,r,s,o){if("undefined"==typeof o&&(o=this.game.world),null!==this.getLayerIndex(t))return console.warn("Tilemap.createBlankLayer: Layer with matching name already exists"),void 0;for(var a,h={name:t,x:0,y:0,width:e,height:n,widthInPixels:e*r,heightInPixels:n*s,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:null},u=[],c=0;n>c;c++){a=[];for(var l=0;e>l;l++)a.push(new i.Tile(h,-1,l,c,r,s));u.push(a)}h.data=u,this.layers.push(h),this.currentLayer=this.layers.length-1;var d=h.widthInPixels,p=h.heightInPixels;d>this.game.width&&(d=this.game.width),p>this.game.height&&(p=this.game.height);var u=new i.TilemapLayer(this.game,this,this.layers.length-1,d,p);return u.name=t,o.add(u)},getIndex:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return i;return null},getLayerIndex:function(t){return this.getIndex(this.layers,t)},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},getImageIndex:function(t){return this.getIndex(this.images,t)},getObjectIndex:function(t){return this.getIndex(this.objects,t)},setTileIndexCallback:function(t,e,i,n){if(n=this.getLayer(n),"number"==typeof t)this.layers[n].callbacks[t]={callback:e,callbackContext:i};else for(var r=0,s=t.length;s>r;r++)this.layers[n].callbacks[t[r]]={callback:e,callbackContext:i}},setTileLocationCallback:function(t,e,i,n,r,s,o){if(o=this.getLayer(o),this.copy(t,e,i,n,o),!(this._results.length<2))for(var a=1;a<this._results.length;a++)this._results[a].setCollisionCallback(r,s)},setCollision:function(t,e,i,n){if("undefined"==typeof e&&(e=!0),"undefined"==typeof n&&(n=!0),i=this.getLayer(i),"number"==typeof t)return this.setCollisionByIndex(t,e,i,!0);for(var r=0,s=t.length;s>r;r++)this.setCollisionByIndex(t[r],e,i,!1);n&&this.calculateFaces(i)},setCollisionBetween:function(t,e,i,n,r){if("undefined"==typeof i&&(i=!0),"undefined"==typeof r&&(r=!0),n=this.getLayer(n),!(t>e)){for(var s=t;e>=s;s++)this.setCollisionByIndex(s,i,n,!1);r&&this.calculateFaces(n)}},setCollisionByExclusion:function(t,e,i,n){"undefined"==typeof e&&(e=!0),"undefined"==typeof n&&(n=!0),i=this.getLayer(i);for(var r=0,s=this.tiles.length;s>r;r++)-1===t.indexOf(r)&&this.setCollisionByIndex(r,e,i,!1);n&&this.calculateFaces(i)},setCollisionByIndex:function(t,e,i,n){if("undefined"==typeof e&&(e=!0),"undefined"==typeof i&&(i=this.currentLayer),"undefined"==typeof n&&(n=!0),e)this.collideIndexes.push(t);else{var r=this.collideIndexes.indexOf(t);r>-1&&this.collideIndexes.splice(r,1)}for(var s=0;s<this.layers[i].height;s++)for(var o=0;o<this.layers[i].width;o++){var a=this.layers[i].data[s][o];a&&a.index===t&&(e?a.setCollision(!0,!0,!0,!0):a.resetCollision(),a.faceTop=e,a.faceBottom=e,a.faceLeft=e,a.faceRight=e)}return n&&this.calculateFaces(i),i},getLayer:function(t){return"undefined"==typeof t?t=this.currentLayer:"string"==typeof t?t=this.getLayerIndex(t):t instanceof i.TilemapLayer&&(t=t.index),t},calculateFaces:function(t){for(var e=null,i=null,n=null,r=null,s=0,o=this.layers[t].height;o>s;s++)for(var a=0,h=this.layers[t].width;h>a;a++){var u=this.layers[t].data[s][a];u&&(e=this.getTileAbove(t,a,s),i=this.getTileBelow(t,a,s),n=this.getTileLeft(t,a,s),r=this.getTileRight(t,a,s),u.collides&&(u.faceTop=!0,u.faceBottom=!0,u.faceLeft=!0,u.faceRight=!0),e&&e.collides&&(u.faceTop=!1),i&&i.collides&&(u.faceBottom=!1),n&&n.collides&&(u.faceLeft=!1),r&&r.collides&&(u.faceRight=!1))}},getTileAbove:function(t,e,i){return i>0?this.layers[t].data[i-1][e]:null},getTileBelow:function(t,e,i){return i<this.layers[t].height-1?this.layers[t].data[i+1][e]:null},getTileLeft:function(t,e,i){return e>0?this.layers[t].data[i][e-1]:null},getTileRight:function(t,e,i){return e<this.layers[t].width-1?this.layers[t].data[i][e+1]:null},setLayer:function(t){t=this.getLayer(t),this.layers[t]&&(this.currentLayer=t)},hasTile:function(t,e,i){return i=this.getLayer(i),null!==this.layers[i].data[e]&&null!==this.layers[i].data[e][t]},removeTile:function(t,e,i){if(i=this.getLayer(i),t>=0&&t<this.layers[i].width&&e>=0&&e<this.layers[i].height&&this.hasTile(t,e,i)){var n=this.layers[i].data[e][t];return this.layers[i].data[e][t]=null,this.layers[i].dirty=!0,this.calculateFaces(i),n}},removeTileWorldXY:function(t,e,i,n,r){return r=this.getLayer(r),t=this.game.math.snapToFloor(t,i)/i,e=this.game.math.snapToFloor(e,n)/n,this.removeTile(t,e,r)},putTile:function(t,e,n,r){if(null===t)return this.removeTile(e,n,r);if(r=this.getLayer(r),e>=0&&e<this.layers[r].width&&n>=0&&n<this.layers[r].height){var s;return t instanceof i.Tile?(s=t.index,this.hasTile(e,n,r)?this.layers[r].data[n][e].copy(t):this.layers[r].data[n][e]=new i.Tile(r,s,e,n,t.width,t.height)):(s=t,this.hasTile(e,n,r)?this.layers[r].data[n][e].index=s:this.layers[r].data[n][e]=new i.Tile(this.layers[r],s,e,n,this.tileWidth,this.tileHeight)),this.collideIndexes.indexOf(s)>-1?this.layers[r].data[n][e].setCollision(!0,!0,!0,!0):this.layers[r].data[n][e].resetCollision(),this.layers[r].dirty=!0,this.calculateFaces(r),this.layers[r].data[n][e]}return null},putTileWorldXY:function(t,e,i,n,r,s){return s=this.getLayer(s),e=this.game.math.snapToFloor(e,n)/n,i=this.game.math.snapToFloor(i,r)/r,this.putTile(t,e,i,s)},searchTileIndex:function(t,e,i,n){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=!1),n=this.getLayer(n);var r=0;if(i){for(var s=this.layers[n].height-1;s>=0;s--)for(var o=this.layers[n].width-1;o>=0;o--)if(this.layers[n].data[s][o].index===t){if(r===e)return this.layers[n].data[s][o];r++}}else for(var s=0;s<this.layers[n].height;s++)for(var o=0;o<this.layers[n].width;o++)if(this.layers[n].data[s][o].index===t){if(r===e)return this.layers[n].data[s][o];r++}return null},getTile:function(t,e,i,n){return"undefined"==typeof n&&(n=!1),i=this.getLayer(i),t>=0&&t<this.layers[i].width&&e>=0&&e<this.layers[i].height?-1===this.layers[i].data[e][t].index?n?this.layers[i].data[e][t]:null:this.layers[i].data[e][t]:null},getTileWorldXY:function(t,e,i,n,r){return"undefined"==typeof i&&(i=this.tileWidth),"undefined"==typeof n&&(n=this.tileHeight),r=this.getLayer(r),t=this.game.math.snapToFloor(t,i)/i,e=this.game.math.snapToFloor(e,n)/n,this.getTile(t,e,r)},copy:function(t,e,i,n,r){if(r=this.getLayer(r),!this.layers[r])return this._results.length=0,void 0;"undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=this.layers[r].width),"undefined"==typeof n&&(n=this.layers[r].height),0>t&&(t=0),0>e&&(e=0),i>this.layers[r].width&&(i=this.layers[r].width),n>this.layers[r].height&&(n=this.layers[r].height),this._results.length=0,this._results.push({x:t,y:e,width:i,height:n,layer:r});for(var s=e;e+n>s;s++)for(var o=t;t+i>o;o++)this._results.push(this.layers[r].data[s][o]);return this._results},paste:function(t,e,i,n){if("undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=0),n=this.getLayer(n),i&&!(i.length<2)){for(var r=i[1].x-t,s=i[1].y-e,o=1;o<i.length;o++)this.layers[n].data[s+i[o].y][r+i[o].x].copy(i[o]);this.layers[n].dirty=!0,this.calculateFaces(n)}},swap:function(t,e,i,n,r,s,o){o=this.getLayer(o),this.copy(i,n,r,s,o),this._results.length<2||(this._tempA=t,this._tempB=e,this._results.forEach(this.swapHandler,this),this.paste(i,n,this._results,o))},swapHandler:function(t,e){t.index===this._tempA&&(this._results[e].index=this._tempB),t.index===this._tempB&&(this._results[e].index=this._tempA)},forEach:function(t,e,i,n,r,s,o){o=this.getLayer(o),this.copy(i,n,r,s,o),this._results.length<2||(this._results.forEach(t,e),this.paste(i,n,this._results,o))},replace:function(t,e,i,n,r,s,o){if(o=this.getLayer(o),this.copy(i,n,r,s,o),!(this._results.length<2)){for(var a=1;a<this._results.length;a++)this._results[a].index===t&&(this._results[a].index=e);this.paste(i,n,this._results,o)}},random:function(t,e,i,n,r){if(r=this.getLayer(r),this.copy(t,e,i,n,r),!(this._results.length<2)){for(var s=[],o=1;o<this._results.length;o++)if(this._results[o].index){var a=this._results[o].index;-1===s.indexOf(a)&&s.push(a)}for(var h=1;h<this._results.length;h++)this._results[h].index=this.game.rnd.pick(s);this.paste(t,e,this._results,r)}},shuffle:function(t,e,n,r,s){if(s=this.getLayer(s),this.copy(t,e,n,r,s),!(this._results.length<2)){for(var o=[],a=1;a<this._results.length;a++)this._results[a].index&&o.push(this._results[a].index);i.Utils.shuffle(o);for(var h=1;h<this._results.length;h++)this._results[h].index=o[h-1];this.paste(t,e,this._results,s)}},fill:function(t,e,i,n,r,s){if(s=this.getLayer(s),this.copy(e,i,n,r,s),!(this._results.length<2)){for(var o=1;o<this._results.length;o++)this._results[o].index=t;this.paste(e,i,this._results,s)}},removeAllLayers:function(){this.layers.length=0,this.currentLayer=0},dump:function(){for(var t="",e=[""],i=0;i<this.layers[this.currentLayer].height;i++){for(var n=0;n<this.layers[this.currentLayer].width;n++)t+="%c  ",this.layers[this.currentLayer].data[i][n]>1?this.debugMap[this.layers[this.currentLayer].data[i][n]]?e.push("background: "+this.debugMap[this.layers[this.currentLayer].data[i][n]]):e.push("background: #ffffff"):e.push("background: rgb(0, 0, 0)");t+="\n"}e[0]=t,console.log.apply(console,e)},destroy:function(){this.removeAllLayers(),this.data=[],this.game=null}},i.Tilemap.prototype.constructor=i.Tilemap,Object.defineProperty(i.Tilemap.prototype,"layer",{get:function(){return this.layers[this.currentLayer]},set:function(t){t!==this.currentLayer&&this.setLayer(t)}}),i.TilemapLayer=function(t,e,n,r,s){this.game=t,this.map=e,this.index=n,this.layer=e.layers[n],this.canvas=i.Canvas.create(r,s,"",!0),this.context=this.canvas.getContext("2d"),this.baseTexture=new PIXI.BaseTexture(this.canvas),this.texture=new PIXI.Texture(this.baseTexture),this.textureFrame=new i.Frame(0,0,0,r,s,"tilemapLayer",t.rnd.uuid()),i.Image.call(this,this.game,0,0,this.texture,this.textureFrame),this.name="",this.type=i.TILEMAPLAYER,this.fixedToCamera=!0,this.cameraOffset=new i.Point(0,0),this.tileColor="rgb(255, 255, 255)",this.debug=!1,this.debugAlpha=.5,this.debugColor="rgba(0, 255, 0, 1)",this.debugFill=!1,this.debugFillColor="rgba(0, 255, 0, 0.2)",this.debugCallbackColor="rgba(255, 0, 0, 1)",this.scrollFactorX=1,this.scrollFactorY=1,this.dirty=!0,this.rayStepRate=4,this._mc={cw:e.tileWidth,ch:e.tileHeight,ga:1,dx:0,dy:0,dw:0,dh:0,tx:0,ty:0,tw:0,th:0,tl:0,maxX:0,maxY:0,startX:0,startY:0,x:0,y:0,prevX:0,prevY:0},this._results=[],this.updateMax()},i.TilemapLayer.prototype=Object.create(i.Image.prototype),i.TilemapLayer.prototype.constructor=i.TilemapLayer,i.TilemapLayer.prototype.postUpdate=function(){i.Image.prototype.postUpdate.call(this),this.scrollX=this.game.camera.x*this.scrollFactorX,this.scrollY=this.game.camera.y*this.scrollFactorY,this.render(),1===this._cache[7]&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)},i.TilemapLayer.prototype.resizeWorld=function(){this.game.world.setBounds(0,0,this.layer.widthInPixels,this.layer.heightInPixels)},i.TilemapLayer.prototype._fixX=function(t){return 0>t&&(t=0),1===this.scrollFactorX?t:this._mc.x+(t-this._mc.x/this.scrollFactorX)},i.TilemapLayer.prototype._unfixX=function(t){return 1===this.scrollFactorX?t:this._mc.x/this.scrollFactorX+(t-this._mc.x)},i.TilemapLayer.prototype._fixY=function(t){return 0>t&&(t=0),1===this.scrollFactorY?t:this._mc.y+(t-this._mc.y/this.scrollFactorY)},i.TilemapLayer.prototype._unfixY=function(t){return 1===this.scrollFactorY?t:this._mc.y/this.scrollFactorY+(t-this._mc.y)},i.TilemapLayer.prototype.getTileX=function(t){return this.game.math.snapToFloor(this._fixX(t),this.map.tileWidth)/this.map.tileWidth},i.TilemapLayer.prototype.getTileY=function(t){return this.game.math.snapToFloor(this._fixY(t),this.map.tileHeight)/this.map.tileHeight},i.TilemapLayer.prototype.getTileXY=function(t,e,i){return i.x=this.getTileX(t),i.y=this.getTileY(e),i},i.TilemapLayer.prototype.getRayCastTiles=function(t,e,i,n){("undefined"==typeof e||null===e)&&(e=this.rayStepRate),"undefined"==typeof i&&(i=!1),"undefined"==typeof n&&(n=!1);var r=this.getTiles(t.x,t.y,t.width,t.height,i,n);if(0===r.length)return[];for(var s=t.coordinatesOnLine(e),o=s.length,a=[],h=0;h<r.length;h++)for(var u=0;o>u;u++)if(r[h].containsPoint(s[u][0],s[u][1])){a.push(r[h]);break}return a},i.TilemapLayer.prototype.getTiles=function(t,e,i,n,r,s){"undefined"==typeof r&&(r=!1),"undefined"==typeof s&&(s=!1),t=this._fixX(t),e=this._fixY(e),i>this.layer.widthInPixels&&(i=this.layer.widthInPixels),n>this.layer.heightInPixels&&(n=this.layer.heightInPixels),this._mc.tx=this.game.math.snapToFloor(t,this._mc.cw)/this._mc.cw,this._mc.ty=this.game.math.snapToFloor(e,this._mc.ch)/this._mc.ch,this._mc.tw=(this.game.math.snapToCeil(i,this._mc.cw)+this._mc.cw)/this._mc.cw,this._mc.th=(this.game.math.snapToCeil(n,this._mc.ch)+this._mc.ch)/this._mc.ch,this._results.length=0;for(var o=this._mc.ty;o<this._mc.ty+this._mc.th;o++)for(var a=this._mc.tx;a<this._mc.tx+this._mc.tw;a++)this.layer.data[o]&&this.layer.data[o][a]&&(!r&&!s||this.layer.data[o][a].isInteresting(r,s))&&this._results.push(this.layer.data[o][a]);return this._results},i.TilemapLayer.prototype.updateMax=function(){this._mc.maxX=this.game.math.ceil(this.canvas.width/this.map.tileWidth)+1,this._mc.maxY=this.game.math.ceil(this.canvas.height/this.map.tileHeight)+1,this.layer&&(this._mc.maxX>this.layer.width&&(this._mc.maxX=this.layer.width),this._mc.maxY>this.layer.height&&(this._mc.maxY=this.layer.height)),this.dirty=!0},i.TilemapLayer.prototype.render=function(){if(this.layer.dirty&&(this.dirty=!0),this.dirty&&this.visible){this._mc.prevX=this._mc.dx,this._mc.prevY=this._mc.dy,this._mc.dx=-(this._mc.x-this._mc.startX*this.map.tileWidth),this._mc.dy=-(this._mc.y-this._mc.startY*this.map.tileHeight),this._mc.tx=this._mc.dx,this._mc.ty=this._mc.dy,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=this.tileColor;var t,e;this.debug&&(this.context.globalAlpha=this.debugAlpha);for(var n=this._mc.startY,r=this._mc.startY+this._mc.maxY;r>n;n++){this._column=this.layer.data[n];for(var s=this._mc.startX,o=this._mc.startX+this._mc.maxX;o>s;s++)this._column[s]&&(t=this._column[s],t.index>-1&&(e=this.map.tilesets[this.map.tiles[t.index][2]],this.debug===!1&&t.alpha!==this.context.globalAlpha&&(this.context.globalAlpha=t.alpha),e.draw(this.context,Math.floor(this._mc.tx),Math.floor(this._mc.ty),t.index),t.debug&&(this.context.fillStyle="rgba(0, 255, 0, 0.4)",this.context.fillRect(Math.floor(this._mc.tx),Math.floor(this._mc.ty),this.map.tileWidth,this.map.tileHeight)))),this._mc.tx+=this.map.tileWidth;this._mc.tx=this._mc.dx,this._mc.ty+=this.map.tileHeight}return this.debug&&(this.context.globalAlpha=1,this.renderDebug()),this.game.renderType===i.WEBGL&&PIXI.updateWebGLTexture(this.baseTexture,this.game.renderer.gl),this.dirty=!1,this.layer.dirty=!1,!0}},i.TilemapLayer.prototype.renderDebug=function(){this._mc.tx=this._mc.dx,this._mc.ty=this._mc.dy,this.context.strokeStyle=this.debugColor,this.context.fillStyle=this.debugFillColor;for(var t=this._mc.startY,e=this._mc.startY+this._mc.maxY;e>t;t++){this._column=this.layer.data[t];for(var i=this._mc.startX,n=this._mc.startX+this._mc.maxX;n>i;i++){var r=this._column[i];r&&(r.faceTop||r.faceBottom||r.faceLeft||r.faceRight)&&(this._mc.tx=Math.floor(this._mc.tx),this.debugFill&&this.context.fillRect(this._mc.tx,this._mc.ty,this._mc.cw,this._mc.ch),this.context.beginPath(),r.faceTop&&(this.context.moveTo(this._mc.tx,this._mc.ty),this.context.lineTo(this._mc.tx+this._mc.cw,this._mc.ty)),r.faceBottom&&(this.context.moveTo(this._mc.tx,this._mc.ty+this._mc.ch),this.context.lineTo(this._mc.tx+this._mc.cw,this._mc.ty+this._mc.ch)),r.faceLeft&&(this.context.moveTo(this._mc.tx,this._mc.ty),this.context.lineTo(this._mc.tx,this._mc.ty+this._mc.ch)),r.faceRight&&(this.context.moveTo(this._mc.tx+this._mc.cw,this._mc.ty),this.context.lineTo(this._mc.tx+this._mc.cw,this._mc.ty+this._mc.ch)),this.context.stroke()),this._mc.tx+=this.map.tileWidth}this._mc.tx=this._mc.dx,this._mc.ty+=this.map.tileHeight}},Object.defineProperty(i.TilemapLayer.prototype,"scrollX",{get:function(){return this._mc.x},set:function(t){t!==this._mc.x&&t>=0&&this.layer.widthInPixels>this.width&&(this._mc.x=t,this._mc.x>this.layer.widthInPixels-this.width&&(this._mc.x=this.layer.widthInPixels-this.width),this._mc.startX=this.game.math.floor(this._mc.x/this.map.tileWidth),this._mc.startX<0&&(this._mc.startX=0),this._mc.startX+this._mc.maxX>this.layer.width&&(this._mc.startX=this.layer.width-this._mc.maxX),this.dirty=!0)}}),Object.defineProperty(i.TilemapLayer.prototype,"scrollY",{get:function(){return this._mc.y},set:function(t){t!==this._mc.y&&t>=0&&this.layer.heightInPixels>this.height&&(this._mc.y=t,this._mc.y>this.layer.heightInPixels-this.height&&(this._mc.y=this.layer.heightInPixels-this.height),this._mc.startY=this.game.math.floor(this._mc.y/this.map.tileHeight),this._mc.startY<0&&(this._mc.startY=0),this._mc.startY+this._mc.maxY>this.layer.height&&(this._mc.startY=this.layer.height-this._mc.maxY),this.dirty=!0)}}),Object.defineProperty(i.TilemapLayer.prototype,"collisionWidth",{get:function(){return this._mc.cw},set:function(t){this._mc.cw=t,this.dirty=!0}}),Object.defineProperty(i.TilemapLayer.prototype,"collisionHeight",{get:function(){return this._mc.ch},set:function(t){this._mc.ch=t,this.dirty=!0}}),i.TilemapParser={parse:function(t,e,n,r,s,o){if("undefined"==typeof n&&(n=32),"undefined"==typeof r&&(r=32),"undefined"==typeof s&&(s=10),"undefined"==typeof o&&(o=10),"undefined"==typeof e)return this.getEmptyData();if(null===e)return this.getEmptyData(n,r,s,o);var a=t.cache.getTilemapData(e);if(a){if(a.format===i.Tilemap.CSV)return this.parseCSV(e,a.data,n,r);if(!a.format||a.format===i.Tilemap.TILED_JSON)return this.parseTiledJSON(a.data)}else console.warn("Phaser.TilemapParser.parse - No map data found for key "+e)},parseCSV:function(t,e,n,r){var s=this.getEmptyData();e=e.trim();for(var o=[],a=e.split("\n"),h=a.length,u=0,c=0;c<a.length;c++){o[c]=[];for(var l=a[c].split(","),d=0;d<l.length;d++)o[c][d]=new i.Tile(s.layers[0],parseInt(l[d],10),d,c,n,r);0===u&&(u=l.length)}return s.format=i.Tilemap.CSV,s.name=t,s.width=u,s.height=h,s.tileWidth=n,s.tileHeight=r,s.widthInPixels=u*n,s.heightInPixels=h*r,s.layers[0].width=u,s.layers[0].height=h,s.layers[0].widthInPixels=s.widthInPixels,s.layers[0].heightInPixels=s.heightInPixels,s.layers[0].data=o,s},getEmptyData:function(t,e,i,n){var r={};r.width=0,r.height=0,r.tileWidth=0,r.tileHeight=0,"undefined"!=typeof t&&null!==t&&(r.tileWidth=t),"undefined"!=typeof e&&null!==e&&(r.tileHeight=e),"undefined"!=typeof i&&null!==i&&(r.width=i),"undefined"!=typeof n&&null!==n&&(r.height=n),r.orientation="orthogonal",r.version="1",r.properties={},r.widthInPixels=0,r.heightInPixels=0;var s=[],o={name:"layer",x:0,y:0,width:0,height:0,widthInPixels:0,heightInPixels:0,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],data:[]};return s.push(o),r.layers=s,r.images=[],r.objects={},r.collision={},r.tilesets=[],r.tiles=[],r},parseTiledJSON:function(t){function e(t,e){var i={};for(var n in e){var r=e[n];i[r]=t[r]}return i}if("orthogonal"!==t.orientation)return console.warn("TilemapParser.parseTiledJSON: Only orthogonal map types are supported in this version of Phaser"),null;var n={};n.width=t.width,n.height=t.height,n.tileWidth=t.tilewidth,n.tileHeight=t.tileheight,n.orientation=t.orientation,n.format=i.Tilemap.TILED_JSON,n.version=t.version,n.properties=t.properties,n.widthInPixels=n.width*n.tileWidth,n.heightInPixels=n.height*n.tileHeight;for(var r=[],s=0;s<t.layers.length;s++)if("tilelayer"===t.layers[s].type){var o={name:t.layers[s].name,x:t.layers[s].x,y:t.layers[s].y,width:t.layers[s].width,height:t.layers[s].height,widthInPixels:t.layers[s].width*t.tilewidth,heightInPixels:t.layers[s].height*t.tileheight,alpha:t.layers[s].opacity,visible:t.layers[s].visible,properties:{},indexes:[],callbacks:[],bodies:[]};t.layers[s].properties&&(o.properties=t.layers[s].properties);for(var a=0,h=[],u=[],c=0,l=t.layers[s].data.length;l>c;c++)t.layers[s].data[c]>0?h.push(new i.Tile(o,t.layers[s].data[c],a,u.length,t.tilewidth,t.tileheight)):h.push(new i.Tile(o,-1,a,u.length,t.tilewidth,t.tileheight)),a++,a===t.layers[s].width&&(u.push(h),a=0,h=[]);o.data=u,r.push(o)}n.layers=r;for(var d=[],s=0;s<t.layers.length;s++)if("imagelayer"===t.layers[s].type){var p={name:t.layers[s].name,image:t.layers[s].image,x:t.layers[s].x,y:t.layers[s].y,alpha:t.layers[s].opacity,visible:t.layers[s].visible,properties:{}};t.layers[s].properties&&(p.properties=t.layers[s].properties),d.push(p)}n.images=d;for(var f=[],s=0;s<t.tilesets.length;s++){var m=t.tilesets[s],g=new i.Tileset(m.name,m.firstgid,m.tilewidth,m.tileheight,m.margin,m.spacing,m.properties);m.tileproperties&&(g.tileProperties=m.tileproperties),g.rows=Math.round((m.imageheight-m.margin)/(m.tileheight+m.spacing)),g.columns=Math.round((m.imagewidth-m.margin)/(m.tilewidth+m.spacing)),g.total=g.rows*g.columns,g.rows%1!==0||g.columns%1!==0?console.warn("TileSet image dimensions do not match expected dimensions. Tileset width/height must be evenly divisible by Tilemap tile width/height."):f.push(g)}n.tilesets=f;for(var y={},v={},s=0;s<t.layers.length;s++)if("objectgroup"===t.layers[s].type){y[t.layers[s].name]=[],v[t.layers[s].name]=[];for(var _=0,l=t.layers[s].objects.length;l>_;_++)if(t.layers[s].objects[_].gid){var b={gid:t.layers[s].objects[_].gid,name:t.layers[s].objects[_].name,x:t.layers[s].objects[_].x,y:t.layers[s].objects[_].y,visible:t.layers[s].objects[_].visible,properties:t.layers[s].objects[_].properties};y[t.layers[s].name].push(b)}else if(t.layers[s].objects[_].polyline){var b={name:t.layers[s].objects[_].name,x:t.layers[s].objects[_].x,y:t.layers[s].objects[_].y,width:t.layers[s].objects[_].width,height:t.layers[s].objects[_].height,visible:t.layers[s].objects[_].visible,properties:t.layers[s].objects[_].properties};b.polyline=[];for(var x=0;x<t.layers[s].objects[_].polyline.length;x++)b.polyline.push([t.layers[s].objects[_].polyline[x].x,t.layers[s].objects[_].polyline[x].y]);v[t.layers[s].name].push(b)}else if(t.layers[s].objects[_].polygon){var b=e(t.layers[s].objects[_],["name","x","y","visible","properties"]);b.polygon=[];for(var x=0;x<t.layers[s].objects[_].polygon.length;x++)b.polygon.push([t.layers[s].objects[_].polygon[x].x,t.layers[s].objects[_].polygon[x].y]);y[t.layers[s].name].push(b)}else if(t.layers[s].objects[_].ellipse){var b=e(t.layers[s].objects[_],["name","ellipse","x","y","width","height","visible","properties"]);y[t.layers[s].name].push(b)}else{var b=e(t.layers[s].objects[_],["name","x","y","width","height","visible","properties"]);b.rectangle=!0,y[t.layers[s].name].push(b)}}n.objects=y,n.collision=v,n.tiles=[];for(var s=0;s<n.tilesets.length;s++)for(var m=n.tilesets[s],a=m.tileMargin,w=m.tileMargin,T=0,S=0,C=0,c=m.firstgid;c<m.firstgid+m.total&&(n.tiles[c]=[a,w,s],a+=m.tileWidth+m.tileSpacing,T++,T!==m.total)&&(S++,S!==m.columns||(a=m.tileMargin,w+=m.tileHeight+m.tileSpacing,S=0,C++,C!==m.rows));c++);return n}},i.Tileset=function(t,e,i,n,r,s,o){("undefined"==typeof i||0>=i)&&(i=32),("undefined"==typeof n||0>=n)&&(n=32),"undefined"==typeof r&&(r=0),"undefined"==typeof s&&(s=0),this.name=t,this.firstgid=e,this.tileWidth=i,this.tileHeight=n,this.tileMargin=r,this.tileSpacing=s,this.properties=o,this.image=null,this.rows=0,this.columns=0,this.total=0,this.drawCoords=[]},i.Tileset.prototype={draw:function(t,e,i,n){this.image&&this.drawCoords[n]&&t.drawImage(this.image,this.drawCoords[n][0],this.drawCoords[n][1],this.tileWidth,this.tileHeight,e,i,this.tileWidth,this.tileHeight)},setImage:function(t){this.image=t,this.rows=Math.round((t.height-this.tileMargin)/(this.tileHeight+this.tileSpacing)),this.columns=Math.round((t.width-this.tileMargin)/(this.tileWidth+this.tileSpacing)),this.total=this.rows*this.columns,this.drawCoords.length=0;for(var e=this.tileMargin,i=this.tileMargin,n=this.firstgid,r=0;r<this.rows;r++){for(var s=0;s<this.columns;s++)this.drawCoords[n]=[e,i],e+=this.tileWidth+this.tileSpacing,n++;e=this.tileMargin,i+=this.tileHeight+this.tileSpacing}},setSpacing:function(t,e){this.tileMargin=t,this.tileSpacing=e,this.setImage(this.image)}},i.Tileset.prototype.constructor=i.Tileset,"undefined"!=typeof t?("undefined"!=typeof module&&module.exports&&(t=module.exports=i),t.Phaser=i):"undefined"!=typeof define&&define.amd?define("Phaser",function(){return e.Phaser=i}()):e.Phaser=i}.call(this)}).call(this),"undefined"==typeof Package&&(Package={}),Package["papitas-libs"]={}}(),function(){{var t,e,i,n,r,s,o,a,h;Package.meteor.Meteor,Package.underscore._}(function(){var t=300;o=function(t){Phaser.Group.call(this,game),this.h=0,this.isFinal=!1,this.isSolvable=!1,this.moves=0,this.totalCost=0,this.position0=0,t?this.arrNumbs=t:t=[]},o.prototype=Object.create(Phaser.Group.prototype),o.prototype.constructor=o,o.prototype.genFinal=function(){this.moves=0,this.arrNumbs=[1,2,3,4,5,6,7,8,0]},o.prototype.genRandom=function(){this.arrNumbs=[],this.moves=0,this.clearBoard();var t=[1,2,3,4,5,6,7,8,0];this.arrNumbs=Phaser.Utils.shuffle(t),this.checkSolvable(this.arrNumbs)?(this.isSolvable=!0,this.logBoard()):this.genRandom()},o.prototype.genTest=function(){this.arrNumbs=[],this.moves=0,this.clearBoard(),this.arrNumbs=[1,2,3,4,5,6,0,7,8],console.log("Solvable: "+this.checkSolvable(this.arrNumbs)),this.logBoard()
},o.prototype.checkSolvable=function(t){var e=0,i=0,n=0;for(i=t.length-1;i>=0;i--)for(n=i-1;n>=0;n--)t[n]>t[i]&&0!==t[i]&&0!==t[n]&&e++;return e%2===0?(console.log("Solvable - "+t+" - "+e),!0):(console.log("Unsulvable - "+t+" - "+e),!1)},o.prototype.equals=function(t){if(!t)return!1;if(!t.arrNumbs)return!1;if(this.arrNumbs.length!==t.arrNumbs.length)return!1;var e=0;for(e=this.arrNumbs.length-1;e>=0;e--)if(this.arrNumbs[e]!=t.arrNumbs[e])return!1;return!0},o.prototype.logBoard=function(){console.log("Board: "+this.arrNumbs)},o.prototype.checkPosition=function(t){var e=0;for(e=this.arrNumbs.length-1;e>=0;e--)if(this.arrNumbs[e]===t)return e},o.prototype.draw=function(){this.clearBoard(this);var e=0,i=0,n=0,r={};for(i=3;i>0;i--)for(n=3;n>0;n--)0!==this.arrNumbs[e]&&(r=new h((n-3)*-t,(i-3)*-t+t/2,this.arrNumbs[e],this),this.add(r)),e++},o.prototype.clearBoard=function(){this.forEach(this.clearTxt,this,!0),this.removeAll()},o.prototype.calcHueristic=function(){var t=0,e=0;for(e=this.arrNumbs.length-1;e>=0;e--)0!==this.arrNumbs[e]&&(t+=Math.abs(e-(this.arrNumbs[e]-1)));this.h=t},o.prototype.calcTotalCost=function(){this.totalCost=this.moves+this.h},o.prototype.clearTxt=function(t){t.txt.destroy()},o.prototype.move=function(t){if(a)return!1;a=!0,this.position0=this.checkPosition(0);var e={};if("up"===t){if(this.position0>=6&&this.position0<=8)return a=!1,!1;e=this.getAt(this.position0+2),e.move(t),this.remove(e),this.addAt(e,this.position0),this.arrNumbs[this.position0]=this.arrNumbs[this.position0+3],this.arrNumbs[this.position0+3]=0}else if("down"==t){if(this.position0>=0&&this.position0<=2)return a=!1,!1;e=this.getAt(this.position0-3),e.move(t),this.remove(e),this.addAt(e,this.position0-1),this.arrNumbs[this.position0]=this.arrNumbs[this.position0-3],this.arrNumbs[this.position0-3]=0}else if("right"==t){if(0===this.position0||3===this.position0||6===this.position0)return a=!1,!1;e=this.getAt(this.position0-1),e.move(t),this.remove(e),this.addAt(e,this.position0-1),this.arrNumbs[this.position0]=this.arrNumbs[this.position0-1],this.arrNumbs[this.position0-1]=0}else if("left"==t){if(2===this.position0||5===this.position0||8===this.position0)return a=!1,!1;e=this.getAt(this.position0),e.move(t),this.remove(e),this.addAt(e,this.position0),this.arrNumbs[this.position0]=this.arrNumbs[this.position0+1],this.arrNumbs[this.position0+1]=0}a=!1,this.moves++;var i=[1,2,3,4,5,6,7,8,0];this.arrNumbs.equals(i)&&(this.isFinal=!0),this.logBoard()}}).call(this),function(){var t=300;h=function(t,e,i){console.log("Inicia NumberBlock"),this.number=i,this.position=0,this.position0=1,Phaser.Sprite.call(this,game,t,e,"bloques","bloque"+i),this.txt=game.add.text(t+20,e+20,i,{font:"20px Source Code Pro",fill:"#F0F0F0",align:"center"})},h.prototype=Object.create(Phaser.Sprite.prototype),h.prototype.constructor=h,h.prototype.update=function(){this.txt.x=this.x+20,this.txt.y=this.y+20},h.prototype.move=function(e){var i=game.add.tween(this),n=game.add.tween(this.txt);switch(i.onStart.add(function(){a=!0}),i.onComplete.add(function(){a=!1}),e){case"left":i.to({x:this.x-t},250,Phaser.Easing.Linear.None,!1,0,0,!1),n.to({x:this.txt.x-t},250,null),n.start(),i.start();break;case"up":i.to({y:this.y-t},250,Phaser.Easing.Linear.None,!1,0,0,!1),n.to({y:this.txt.y-t},250,null),n.start(),i.start();break;case"right":i.to({x:this.x+t},250,Phaser.Easing.Linear.None,!1,0,0,!1),n.to({x:this.txt.x+t},250,null),n.start(),i.start();break;case"down":i.to({y:this.y+t},250,Phaser.Easing.Linear.None,!1,0,0,!1),n.to({y:this.txt.y+t},250,null),n.start(),i.start()}},h.prototype.onDown=function(){if(console.log(this.parent.arrNumbs),this.position=this.parent.checkPosition(this.number),this.position0=this.parent.checkPosition(0),this.position-this.position0!==0)switch(this.position){case 0:switch(this.position0){case 1:this.move(3);break;case 3:this.move(2);break;default:return}break;case 1:switch(this.position0){case 0:this.move(1);break;case 2:this.move(3);break;case 4:this.move(4);break;default:return}break;case 2:switch(this.position0){case 1:this.move(1);break;case 5:this.move(4);break;default:return}break;case 3:switch(this.position0){case 0:this.move(2);break;case 4:this.move(3);break;case 6:this.move(4);break;default:return}break;case 4:break;case 5:break;case 6:break;case 7:break;case 8:}console.log("Numbs: "+this.parent.arrNumbs),console.log(this.parent.arrNumbs)}}.call(this),function(){function e(){}e.prototype={preload:function(){this.load.image("loadingBG","assets/res/images/LoadingBG.png"),this.load.image("loading","assets/res/images/Loading.png"),this.load.image("fondo","assets/res/textures/etapa-01-bn.jpg")},create:function(){game.input.maxPointers=1,game.state.start("preloader")}},t=e}.call(this),function(){function t(){}t.prototype={create:function(){game.add.sprite(0,0,"frame"),game.stage.backgroundColor="#333333",this.enterKey=game.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enterKey.onDown.add(this.startGame,this),this.bttPlay=game.add.button(game.world.centerX,game.world.centerY+75,"btts",this.startGame,this,"play1","play0","play2"),this.bttAbout=game.add.button(game.world.centerX-75,game.world.centerY+75,"btts",this.mainMenu,this,"about1","about0","about2"),this.text=game.add.text(game.world.centerX,game.world.centerY-20,"Rompecabezas\n Papitas\n",{font:"17px Source Code Pro",fill:"#f0f0f0",align:"center"}),this.text.anchor.setTo(.5,.5)},update:function(){game.input.activePointer.justPressed()&&game.state.start("play")},startGame:function(){game.state.start("play")},mainMenu:function(){game.state.start("mainmenu")}},i=t}.call(this),function(){function t(){}t.prototype={create:function(){game.add.sprite(0,0,"frame"),game.stage.backgroundColor="#333333";var t=0,e=0;e=localStorage.getItem("lastScore"),t=localStorage.getItem("highScore"),null===t&&(t=e,localStorage.setItem("highScore",e)),t>e&&localStorage.setItem("highScore",e),this.enterKey=game.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enterKey.onDown.add(this.startGame,this),this.bttPlay=game.add.button(game.world.centerX,game.world.centerY+75,"btts",this.startGame,this,"play1","play0","play2"),this.bttAbout=game.add.button(game.world.centerX-75,game.world.centerY+75,"btts",this.mainMenu,this,"about1","about0","about2"),this.text=game.add.text(game.world.centerX,game.world.centerY-20,"You Won!! \n High Score\n "+t+"\n Last Score\n "+e,{font:"17px Source Code Pro",fill:"#f0f0f0",align:"center"}),this.text.anchor.setTo(.5,.5)},update:function(){game.input.activePointer.justPressed()&&game.state.start("play")},startGame:function(){game.state.start("play")},mainMenu:function(){game.state.start("mainmenu")}},n=t}.call(this),function(){function t(){}t.prototype={create:function(){game.stage.backgroundColor="#000",this.enterKey=game.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enterKey.onDown.add(this.startGame,this),this.text=game.add.text(game.world.centerX,game.world.centerY-240,"Rompecabezas",{font:"60px Source Code Pro",fill:"#fff",align:"center"}),this.textTut=game.add.text(game.world.centerX,game.world.centerY+40,"Usa las flechas para jugar\n Para comenzar presiona [ENTER]",{font:"45px Source Code Pro",fill:"#fff",align:"center"}),this.text.anchor.setTo(.5,.5),this.textTut.anchor.setTo(.5,.5)},update:function(){},startGame:function(){console.log("start"),game.state.start("play")},credits:function(){game.state.start("credits")}},r=t}.call(this),function(){function t(){}var e=300;t.prototype={create:function(){game.stage.backgroundColor="#000",game.add.sprite(0,e/2,"fondo"),this.botonesolve=game.add.button(game.world.centerX-75,this.world.height-75,"botones",function(){this.quitGame("mainmenu")},this,"restart1","restart0","restart2"),this.bttPlay=game.add.button(game.world.centerX,this.world.height-75,"botones",this.shuffleBoard,this,"random1","random0","random2"),this.movesTxt=game.add.text(game.world.centerX,35,"Movimientos: ",{font:"40px Source Code Pro",fill:"#fff",align:"center"}),this.movesTxt.anchor.setTo(.5,.5),this.upKey=game.input.keyboard.addKey(Phaser.Keyboard.UP),this.downKey=game.input.keyboard.addKey(Phaser.Keyboard.DOWN),this.leftKey=game.input.keyboard.addKey(Phaser.Keyboard.LEFT),this.rightKey=game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),this.board=new o,this.board.genRandom(),this.board.draw(),this.upKey.onDown.add(function(){this.board.move("up")},this),this.downKey.onDown.add(function(){this.board.move("down")},this),this.leftKey.onDown.add(function(){this.board.move("left")},this),this.rightKey.onDown.add(function(){this.board.move("right")},this)},update:function(){this.movesTxt.setText("Movimientos: "+this.board.moves),this.board.isFinal&&(localStorage.setItem("lastScore",this.board.moves),this.quitGame("leaderboards"))},quitGame:function(t){this.board.clearBoard(),this.board.destroy(),this.board=null,this.upKey.onDown.removeAll(),this.downKey.onDown.removeAll(),this.leftKey.onDown.removeAll(),this.rightKey.onDown.removeAll(),this.upKey=null,this.downKey=null,this.leftKey=null,this.rightKey=null,a=!1,game.state.start(t)},shuffleBoard:function(){console.clear(),this.board.genRandom(),this.board.draw()},solveBoard:function(){var t=new o;t.genFinal();var e=new Solver(this.board,t);e.solve()}},s=t}.call(this),function(){function t(){this.preloadBarBg=null,this.preloadBar=null}t.prototype={preload:function(){game.stage.backgroundColor="#000",this.preloadBarBg=this.add.sprite(300,400,"loadingBG"),this.preloadBar=this.add.sprite(304,405,"loading"),this.load.atlasJSONHash("botones","assets/res/spritesheets/botones.png","assets/res/spritesheets/botones.json"),this.load.atlasJSONHash("bloques","assets/res/spritesheets/bloques-etapa-01.jpg","assets/res/spritesheets/bloques-etapa-01.json"),this.load.setPreloadSprite(this.preloadBar)},create:function(){this.preloadBar.cropEnabled=!1,game.state.start("mainmenu")}},e=t}.call(this),function(){"use strict";var t;t={google:{families:["Source+Code+Pro::latin"]}},function(){var t=document.createElement("script");t.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",t.type="text/javascript",t.async="true";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()}.call(this),function(){var t=function(t,e){this.open=[],this.close=[],this.moves=0,this.boardI=t,this.boardF=e,this.open.push(Phaser.Utils.extend(!0,{},t))};t.prototype.solve=function(){for(var t=0;!this.open[this.open.length-1].equals(this.boardF)&&this.open.length>0;){var e=this.open.pop(),i=0;switch(this.close.push(Phaser.Utils.extend(!0,{},e)),i=e.checkPosition(0)){case 0:this.swap(e,3,i),this.swap(e,4,i);break;case 1:this.swap(e,1,i),this.swap(e,3,i),this.swap(e,4,i);break;case 2:this.swap(e,1,i),this.swap(e,4,i);break;case 3:this.swap(e,2,i),this.swap(e,3,i),this.swap(e,4,i);break;case 4:this.swap(e,1,i),this.swap(e,2,i),this.swap(e,3,i),this.swap(e,4,i);break;case 5:this.swap(e,1,i),this.swap(e,2,i),this.swap(e,4,i);break;case 6:this.swap(e,2,i),this.swap(e,3,i);break;case 7:this.swap(e,1,i),this.swap(e,2,i),this.swap(e,3,i);break;case 8:this.swap(e,1,i),this.swap(e,2,i)}this.open.sort(this.compare),0!==this.open.length&&(this.boardI.arrNumbs=this.open[this.open.length-1].arrNumbs,t++,console.log("solving - count: "+t+" - board: "+this.open[0].arrNumbs+" - closed-size: "+this.close.length+" - position: "+i))}this.boardI.draw(),console.log("Solved: "+this.open[this.open.length-1].arrNumbs)},t.prototype.swap=function(t,e,i){this.position=i;var n=Phaser.Utils.extend(!0,{},t),r=[];switch(e){case 1:n.arrNumbs[this.position]=n.arrNumbs[this.position-1],n.arrNumbs[this.position-1]=0;break;case 2:switch(this.position){case 3:n.arrNumbs[3]=n.arrNumbs[0],n.arrNumbs[0]=0;break;case 4:n.arrNumbs[4]=n.arrNumbs[1],n.arrNumbs[1]=0;break;case 5:n.arrNumbs[5]=n.arrNumbs[2],n.arrNumbs[2]=0;break;case 6:n.arrNumbs[6]=n.arrNumbs[3],n.arrNumbs[3]=0;break;case 7:n.arrNumbs[7]=n.arrNumbs[4],n.arrNumbs[4]=0;break;case 8:n.arrNumbs[8]=n.arrNumbs[5],n.arrNumbs[5]=0}break;case 3:n.arrNumbs[this.position]=n.arrNumbs[this.position+1],n.arrNumbs[this.position+1]=0;break;case 4:switch(this.position){case 0:n.arrNumbs[0]=n.arrNumbs[3],n.arrNumbs[3]=0;break;case 1:n.arrNumbs[1]=n.arrNumbs[4],n.arrNumbs[4]=0;break;case 2:n.arrNumbs[2]=n.arrNumbs[5],n.arrNumbs[5]=0;break;case 3:n.arrNumbs[3]=n.arrNumbs[6],n.arrNumbs[6]=0;break;case 4:n.arrNumbs[4]=n.arrNumbs[7],n.arrNumbs[7]=0;break;case 5:n.arrNumbs[5]=n.arrNumbs[8],n.arrNumbs[8]=0}}r=n.arrNumbs,n=new o(r,t),n.moves=t.moves+1,n.calcHueristic(),n.calcTotalCost(),this.checkClosed(n)||this.open.push(n)},t.prototype.checkClosed=function(t){var e=0;for(e=this.close.length-1;e>=0;e--)if(this.close[e].equals(t))return!0;return!1},t.prototype.compare=function(t,e){return t.totalCost>e.totalCost?-1:t.totalCost<e.totalCost?1:0}}.call(this),"undefined"==typeof Package&&(Package={}),Package["papitas-rompecabezas"]={BootState:t,PreloaderState:e,CreditsState:i,LeaderBoardsState:n,MainMenuState:r,PlayState:s}}(),Meteor=Package.meteor.Meteor,Log=Package.logging.Log,Deps=Package.deps.Deps,Session=Package.session.Session,UI=Package.ui.UI,Handlebars=Package.ui.Handlebars,Spacebars=Package.spacebars.Spacebars,Template=Package.templating.Template,check=Package.check.check,Match=Package.check.Match,_=Package.underscore._,$=Package.jquery.$,jQuery=Package.jquery.jQuery,Random=Package.random.Random,EJSON=Package.ejson.EJSON,GroundDB=Package.grounddb.GroundDB,BootState=Package["papitas-rompecabezas"].BootState,PreloaderState=Package["papitas-rompecabezas"].PreloaderState,CreditsState=Package["papitas-rompecabezas"].CreditsState,LeaderBoardsState=Package["papitas-rompecabezas"].LeaderBoardsState,MainMenuState=Package["papitas-rompecabezas"].MainMenuState,PlayState=Package["papitas-rompecabezas"].PlayState,HTML=Package.htmljs.HTML,function(){UI.body.contentParts.push(UI.Component.extend({render:function(){var t=this;return Spacebars.include(t.lookupTemplate("game"))}})),Meteor.startup(function(){UI.body.INSTANTIATED||(UI.body.INSTANTIATED=!0,UI.DomRange.insert(UI.render(UI.body).dom,document.body))}),Template.__define__("game",function(){return HTML.Raw('<div id="rompecabezas-container"></div>')})}(),function(){Array.prototype.equals=function(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var e=0,i=this.length;i>e;e++)if(this[e]instanceof Array&&t[e]instanceof Array){if(!this[e].compare(t[e]))return!1}else if(this[e]!=t[e])return!1;return!0};var t;Meteor.startup(function(){t=!1,game=new Phaser.Game(900,1200,Phaser.AUTO,"rompecabezas-container"),game.state.add("boot",BootState),game.state.add("preloader",PreloaderState),game.state.add("credits",CreditsState),game.state.add("leaderboards",LeaderBoardsState),game.state.add("mainmenu",MainMenuState),game.state.add("play",PlayState),game.state.start("boot")})}();